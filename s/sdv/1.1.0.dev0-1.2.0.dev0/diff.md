# Comparing `tmp/sdv-1.1.0.dev0.tar.gz` & `tmp/sdv-1.2.0.dev0.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "sdv-1.1.0.dev0.tar", last modified: Wed May 10 18:21:50 2023, max compression
+gzip compressed data, was "sdv-1.2.0.dev0.tar", last modified: Tue Jun  6 20:53:32 2023, max compression
```

## Comparing `sdv-1.1.0.dev0.tar` & `sdv-1.2.0.dev0.tar`

### file list

```diff
@@ -1,654 +1,657 @@
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.888128 sdv-1.1.0.dev0/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)       56 2023-01-24 21:06:49.000000 sdv-1.1.0.dev0/AUTHORS.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     8268 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/CONTRIBUTING.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    65249 2023-05-10 18:12:52.000000 sdv-1.1.0.dev0/HISTORY.md
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     4818 2023-01-24 21:06:49.000000 sdv-1.1.0.dev0/LICENSE
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      245 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/MANIFEST.in
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    76085 2023-05-10 18:21:50.888408 sdv-1.1.0.dev0/PKG-INFO
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     9801 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/README.md
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.748413 sdv-1.1.0.dev0/docs/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      604 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/Makefile
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.749440 sdv-1.1.0.dev0/docs/api_reference/
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.749982 sdv-1.1.0.dev0/docs/api_reference/constraints/
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.768556 sdv-1.1.0.dev0/docs/api_reference/constraints/api/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      161 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Constraint.filter_valid.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      132 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Constraint.fit.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Constraint.fit_transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      152 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Constraint.from_dict.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      149 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Constraint.is_valid.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      176 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Constraint.reverse_transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      575 2022-06-29 17:31:16.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Constraint.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      146 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Constraint.to_dict.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      150 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Constraint.transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      179 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.CustomConstraint.filter_valid.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      150 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.CustomConstraint.fit.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      182 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.CustomConstraint.fit_transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      170 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.CustomConstraint.from_dict.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      167 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.CustomConstraint.is_valid.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      194 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.CustomConstraint.reverse_transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      653 2022-06-29 17:31:16.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.CustomConstraint.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.CustomConstraint.to_dict.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      168 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.CustomConstraint.transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      182 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.FixedCombinations.filter_valid.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      153 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.FixedCombinations.fit.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      185 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.FixedCombinations.fit_transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      173 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.FixedCombinations.from_dict.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      170 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.FixedCombinations.is_valid.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      197 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.FixedCombinations.reverse_transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      666 2022-06-29 17:31:16.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.FixedCombinations.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      167 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.FixedCombinations.to_dict.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      171 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.FixedCombinations.transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      161 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Inequality.filter_valid.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      132 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Inequality.fit.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Inequality.fit_transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      152 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Inequality.from_dict.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      149 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Inequality.is_valid.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      176 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Inequality.reverse_transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      575 2022-06-29 17:31:16.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Inequality.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      146 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Inequality.to_dict.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      150 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Inequality.transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      155 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Negative.filter_valid.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      126 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Negative.fit.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      158 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Negative.fit_transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      146 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Negative.from_dict.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      143 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Negative.is_valid.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      170 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Negative.reverse_transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      549 2022-06-29 17:31:16.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Negative.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      140 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Negative.to_dict.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      144 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Negative.transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      173 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.OneHotEncoding.filter_valid.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      144 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.OneHotEncoding.fit.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      176 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.OneHotEncoding.fit_transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.OneHotEncoding.from_dict.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      161 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.OneHotEncoding.is_valid.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      188 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.OneHotEncoding.reverse_transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      627 2022-06-29 17:31:16.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.OneHotEncoding.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      158 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.OneHotEncoding.to_dict.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      162 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.OneHotEncoding.transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      155 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Positive.filter_valid.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      126 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Positive.fit.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      158 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Positive.fit_transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      146 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Positive.from_dict.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      143 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Positive.is_valid.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      170 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Positive.reverse_transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      549 2022-06-29 17:31:16.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Positive.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      140 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Positive.to_dict.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      144 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Positive.transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      146 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Range.filter_valid.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      117 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Range.fit.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      149 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Range.fit_transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      137 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Range.from_dict.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      134 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Range.is_valid.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      161 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Range.reverse_transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      510 2022-06-29 17:31:16.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Range.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      131 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Range.to_dict.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      135 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Range.transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      179 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarInequality.filter_valid.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      150 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarInequality.fit.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      182 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarInequality.fit_transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      170 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarInequality.from_dict.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      167 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarInequality.is_valid.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      194 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarInequality.reverse_transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      653 2022-06-29 17:31:16.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarInequality.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarInequality.to_dict.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      168 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarInequality.transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarRange.filter_valid.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      135 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarRange.fit.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      167 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarRange.fit_transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      155 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarRange.from_dict.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      152 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarRange.is_valid.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      179 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarRange.reverse_transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      588 2022-06-29 17:31:16.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarRange.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      149 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarRange.to_dict.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      153 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarRange.transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      149 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Unique.filter_valid.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      120 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Unique.fit.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      152 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Unique.fit_transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      140 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Unique.from_dict.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      137 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Unique.is_valid.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Unique.reverse_transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      523 2022-06-29 17:31:16.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Unique.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      134 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Unique.to_dict.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      138 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Unique.transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      359 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/base.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      124 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/index.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     2609 2022-07-22 02:55:50.000000 sdv-1.1.0.dev0/docs/api_reference/constraints/tabular.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      353 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/api_reference/demo.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      135 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/api_reference/evaluation.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      347 2022-07-22 02:55:50.000000 sdv-1.1.0.dev0/docs/api_reference/index.rst
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.769041 sdv-1.1.0.dev0/docs/api_reference/lite/
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.770800 sdv-1.1.0.dev0/docs/api_reference/lite/api/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      144 2022-06-29 17:31:16.000000 sdv-1.1.0.dev0/docs/api_reference/lite/api/sdv.lite.tabular.TabularPreset.fit.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      205 2022-06-29 17:31:16.000000 sdv-1.1.0.dev0/docs/api_reference/lite/api/sdv.lite.tabular.TabularPreset.list_available_presets.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      147 2022-06-29 17:31:16.000000 sdv-1.1.0.dev0/docs/api_reference/lite/api/sdv.lite.tabular.TabularPreset.load.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      502 2022-06-29 17:31:16.000000 sdv-1.1.0.dev0/docs/api_reference/lite/api/sdv.lite.tabular.TabularPreset.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      153 2022-06-29 17:31:16.000000 sdv-1.1.0.dev0/docs/api_reference/lite/api/sdv.lite.tabular.TabularPreset.sample.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      188 2022-06-29 17:31:16.000000 sdv-1.1.0.dev0/docs/api_reference/lite/api/sdv.lite.tabular.TabularPreset.sample_conditions.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      211 2022-06-29 17:31:16.000000 sdv-1.1.0.dev0/docs/api_reference/lite/api/sdv.lite.tabular.TabularPreset.sample_remaining_columns.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      147 2022-06-29 17:31:16.000000 sdv-1.1.0.dev0/docs/api_reference/lite/api/sdv.lite.tabular.TabularPreset.save.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)       94 2022-07-22 02:55:50.000000 sdv-1.1.0.dev0/docs/api_reference/lite/index.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      348 2022-07-22 02:55:50.000000 sdv-1.1.0.dev0/docs/api_reference/lite/tabular.rst
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.771534 sdv-1.1.0.dev0/docs/api_reference/metadata/
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.779923 sdv-1.1.0.dev0/docs/api_reference/metadata/api/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      161 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.add_field.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      182 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.add_relationship.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      161 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.add_table.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      170 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.get_children.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.get_dtypes.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      178 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.get_field_meta.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.get_fields.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      184 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.get_foreign_keys.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      167 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.get_parents.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      181 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.get_primary_key.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      178 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.get_table_meta.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.get_tables.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.load_table.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      167 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.load_tables.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      185 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.reverse_transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      877 2022-09-29 22:36:12.000000 sdv-1.1.0.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      181 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.set_primary_key.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      155 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.to_dict.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      155 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.to_json.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      159 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      156 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.validate.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      159 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.visualize.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      155 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metadata/api/sdv.metadata.table.Table.filter_valid.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      126 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metadata/api/sdv.metadata.table.Table.fit.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      146 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metadata/api/sdv.metadata.table.Table.from_dict.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      146 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metadata/api/sdv.metadata.table.Table.from_json.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      149 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metadata/api/sdv.metadata.table.Table.get_dtypes.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      149 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metadata/api/sdv.metadata.table.Table.get_fields.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      169 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metadata/api/sdv.metadata.table.Table.get_model_kwargs.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      170 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metadata/api/sdv.metadata.table.Table.reverse_transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      668 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metadata/api/sdv.metadata.table.Table.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      169 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metadata/api/sdv.metadata.table.Table.set_model_kwargs.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      166 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metadata/api/sdv.metadata.table.Table.set_primary_key.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      140 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metadata/api/sdv.metadata.table.Table.to_dict.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      140 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metadata/api/sdv.metadata.table.Table.to_json.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      144 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metadata/api/sdv.metadata.table.Table.transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      854 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/api_reference/metadata/dataset.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      116 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/api_reference/metadata/index.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      583 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/api_reference/metadata/table.rst
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.781224 sdv-1.1.0.dev0/docs/api_reference/metrics/
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.817828 sdv-1.1.0.dev0/docs/api_reference/metrics/api/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      167 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.demos.load_multi_table_demo.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      170 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.demos.load_single_table_demo.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      162 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.demos.load_timeseries_demo.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      171 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.BNLikelihood.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      194 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.BNLikelihood.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      578 2022-08-30 22:45:23.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.BNLikelihood.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      180 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.BNLogLikelihood.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      203 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.BNLogLikelihood.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      614 2022-08-30 22:45:23.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.BNLogLikelihood.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      153 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.CSTest.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      176 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.CSTest.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      506 2022-08-30 22:45:24.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.CSTest.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      203 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.DetectionMetric.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      573 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.DetectionMetric.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      171 2022-08-30 23:02:40.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.KSComplement.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      194 2022-08-30 23:02:40.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.KSComplement.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      578 2022-08-30 23:02:40.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.KSComplement.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      165 2022-08-30 23:02:15.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.KSTest.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      188 2022-08-30 23:02:15.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.KSTest.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      534 2022-08-30 23:02:15.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.KSTest.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      186 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.LogisticDetection.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      209 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.LogisticDetection.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      638 2022-08-30 22:45:24.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.LogisticDetection.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      219 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.LogisticParentChildDetection.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      242 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.LogisticParentChildDetection.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      716 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.LogisticParentChildDetection.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      224 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.MultiSingleTableMetric.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      598 2022-08-30 22:45:24.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.MultiSingleTableMetric.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      206 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.MultiTableMetric.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      584 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.MultiTableMetric.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      236 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.ParentChildDetectionMetric.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      582 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.ParentChildDetectionMetric.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      171 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.SVCDetection.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      194 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.SVCDetection.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      578 2022-08-30 22:45:24.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.SVCDetection.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      204 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.SVCParentChildDetection.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      227 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.SVCParentChildDetection.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      661 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.SVCParentChildDetection.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      162 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BNLikelihood.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      185 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BNLikelihood.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      569 2022-12-08 22:56:17.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BNLikelihood.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      171 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BNLogLikelihood.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      194 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BNLogLikelihood.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      605 2022-12-08 22:56:17.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BNLogLikelihood.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      198 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryAdaBoostClassifier.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      221 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryAdaBoostClassifier.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      837 2022-12-08 22:56:17.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryAdaBoostClassifier.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      210 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryDecisionTreeClassifier.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      233 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryDecisionTreeClassifier.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      897 2022-12-08 22:56:17.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryDecisionTreeClassifier.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      209 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryEfficacyMetric.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      811 2022-12-08 22:56:17.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryEfficacyMetric.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      198 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryLogisticRegression.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      221 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryLogisticRegression.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      837 2022-12-08 22:56:17.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryLogisticRegression.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      183 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryMLPClassifier.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      206 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryMLPClassifier.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      762 2022-12-08 22:56:17.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryMLPClassifier.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      144 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CSTest.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      167 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CSTest.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      565 2022-08-30 22:45:24.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CSTest.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      168 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalCAP.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      191 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalCAP.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      664 2022-12-08 22:56:17.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalCAP.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      183 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalEnsemble.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      206 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalEnsemble.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      734 2022-12-08 22:56:17.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalEnsemble.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      201 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalGeneralizedCAP.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      224 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalGeneralizedCAP.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      818 2022-12-08 22:56:17.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalGeneralizedCAP.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      168 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalKNN.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      191 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalKNN.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      664 2022-12-08 22:56:17.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalKNN.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      165 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalNB.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      188 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalNB.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      650 2022-12-08 22:56:17.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalNB.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      221 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalPrivacyMetric.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      842 2022-12-08 22:56:17.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalPrivacyMetric.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      165 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalRF.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      188 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalRF.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      650 2022-12-08 22:56:17.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalRF.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      168 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalSVM.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      191 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalSVM.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      664 2022-12-08 22:56:17.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalSVM.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      180 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalZeroCAP.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      203 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalZeroCAP.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      720 2022-12-08 22:56:17.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalZeroCAP.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      192 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.ContinuousKLDivergence.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      215 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.ContinuousKLDivergence.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      788 2022-10-05 00:20:25.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.ContinuousKLDivergence.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      194 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.DetectionMetric.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      605 2022-12-08 22:56:17.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.DetectionMetric.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      186 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.DiscreteKLDivergence.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      209 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.DiscreteKLDivergence.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      760 2022-10-05 00:20:25.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.DiscreteKLDivergence.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      171 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.GMLogLikelihood.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      194 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.GMLogLikelihood.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      605 2022-12-08 22:56:17.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.GMLogLikelihood.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      162 2022-08-30 23:02:40.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.KSComplement.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      185 2022-08-30 23:02:40.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.KSComplement.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      649 2022-08-30 23:02:40.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.KSComplement.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      156 2022-08-30 23:02:15.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.KSTest.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      179 2022-08-30 23:02:15.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.KSTest.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      605 2022-08-30 23:02:15.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.KSTest.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      174 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.LinearRegression.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      197 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.LinearRegression.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      717 2022-12-08 22:56:17.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.LinearRegression.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      177 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.LogisticDetection.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      200 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.LogisticDetection.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      629 2022-12-08 22:56:17.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.LogisticDetection.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      197 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MLEfficacyMetric.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      716 2022-12-08 22:56:17.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MLEfficacyMetric.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      162 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MLPRegressor.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      185 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MLPRegressor.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      657 2022-12-08 22:56:17.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MLPRegressor.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      215 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MultiColumnPairsMetric.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      688 2022-10-05 00:20:25.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MultiColumnPairsMetric.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      218 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MultiSingleColumnMetric.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      701 2022-08-30 22:45:24.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MultiSingleColumnMetric.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      222 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MulticlassDecisionTreeClassifier.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      245 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MulticlassDecisionTreeClassifier.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      957 2022-12-08 22:56:17.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MulticlassDecisionTreeClassifier.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      875 2022-12-08 22:56:17.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MulticlassEfficacyMetric.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      195 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MulticlassMLPClassifier.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      218 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MulticlassMLPClassifier.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      822 2022-12-08 22:56:17.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MulticlassMLPClassifier.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      159 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalLR.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      182 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalLR.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      629 2022-12-08 22:56:17.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalLR.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      162 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalMLP.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      185 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalMLP.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      643 2022-12-08 22:56:17.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalMLP.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      215 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalPrivacyMetric.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      819 2022-12-08 22:56:17.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalPrivacyMetric.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      216 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalRadiusNearestNeighbor.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      239 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalRadiusNearestNeighbor.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      895 2022-12-08 22:56:17.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalRadiusNearestNeighbor.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      162 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalSVR.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      185 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalSVR.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      643 2022-12-08 22:56:17.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalSVR.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      875 2022-12-08 22:56:17.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.RegressionEfficacyMetric.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      162 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.SVCDetection.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      185 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.SVCDetection.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      569 2022-12-08 22:56:17.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.SVCDetection.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      257 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.ScikitLearnClassifierDetectionMetric.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      857 2022-12-08 22:56:17.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.ScikitLearnClassifierDetectionMetric.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      200 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.SingleTableMetric.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      629 2022-12-08 22:56:17.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.SingleTableMetric.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      201 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.timeseries.LSTMClassifierEfficacy.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      224 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.timeseries.LSTMClassifierEfficacy.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      650 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.timeseries.LSTMClassifierEfficacy.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      174 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.timeseries.LSTMDetection.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      197 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.timeseries.LSTMDetection.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      551 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.timeseries.LSTMDetection.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      233 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.timeseries.TimeSeriesDetectionMetric.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      683 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.timeseries.TimeSeriesDetectionMetric.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      230 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.timeseries.TimeSeriesEfficacyMetric.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      672 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.timeseries.TimeSeriesEfficacyMetric.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      206 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.timeseries.TimeSeriesMetric.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      584 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.timeseries.TimeSeriesMetric.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      213 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/demos.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      143 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/index.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     1402 2022-09-22 23:47:45.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/relational.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     4109 2022-09-22 23:47:45.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/tabular.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      735 2022-12-21 22:30:23.000000 sdv-1.1.0.dev0/docs/api_reference/metrics/timeseries.rst
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.818296 sdv-1.1.0.dev0/docs/api_reference/relational/
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.819342 sdv-1.1.0.dev0/docs/api_reference/relational/api/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      123 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/relational/api/sdv.relational.hma.HMA1.fit.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      126 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/relational/api/sdv.relational.hma.HMA1.load.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      416 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/relational/api/sdv.relational.hma.HMA1.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      132 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/relational/api/sdv.relational.hma.HMA1.sample.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      126 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/relational/api/sdv.relational.hma.HMA1.save.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      173 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/api_reference/relational/hma1.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      109 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/api_reference/relational/index.rst
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.819705 sdv-1.1.0.dev0/docs/api_reference/sampling/
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.820306 sdv-1.1.0.dev0/docs/api_reference/sampling/api/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      166 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/sampling/api/sdv.sampling.Condition.get_column_values.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      151 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/sampling/api/sdv.sampling.Condition.get_num_rows.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      417 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/sampling/api/sdv.sampling.Condition.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      109 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/api_reference/sampling/index.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      227 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/api_reference/sampling/tabular.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      153 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/api_reference/sdv.rst
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.821219 sdv-1.1.0.dev0/docs/api_reference/tabular/
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.828528 sdv-1.1.0.dev0/docs/api_reference/tabular/api/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      147 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/tabular/api/sdv.tabular.copulagan.CopulaGAN.fit.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      191 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/tabular/api/sdv.tabular.copulagan.CopulaGAN.get_distributions.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      176 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/tabular/api/sdv.tabular.copulagan.CopulaGAN.get_metadata.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      150 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/tabular/api/sdv.tabular.copulagan.CopulaGAN.load.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      655 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/tabular/api/sdv.tabular.copulagan.CopulaGAN.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      156 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/tabular/api/sdv.tabular.copulagan.CopulaGAN.sample.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      191 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/tabular/api/sdv.tabular.copulagan.CopulaGAN.sample_conditions.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      214 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/tabular/api/sdv.tabular.copulagan.CopulaGAN.sample_remaining_columns.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      150 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/tabular/api/sdv.tabular.copulagan.CopulaGAN.save.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      156 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.fit.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      200 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.get_distributions.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      191 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.get_likelihood.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      185 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.get_metadata.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      191 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.get_parameters.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      159 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.load.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      663 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      165 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.sample.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      200 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.sample_conditions.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      223 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.sample_remaining_columns.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      159 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.save.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      191 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.set_parameters.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      123 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/tabular/api/sdv.tabular.ctgan.CTGAN.fit.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      152 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/tabular/api/sdv.tabular.ctgan.CTGAN.get_metadata.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      126 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/tabular/api/sdv.tabular.ctgan.CTGAN.load.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      463 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/tabular/api/sdv.tabular.ctgan.CTGAN.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      132 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/tabular/api/sdv.tabular.ctgan.CTGAN.sample.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      167 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/tabular/api/sdv.tabular.ctgan.CTGAN.sample_conditions.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      190 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/tabular/api/sdv.tabular.ctgan.CTGAN.sample_remaining_columns.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      126 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/tabular/api/sdv.tabular.ctgan.CTGAN.save.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      120 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/tabular/api/sdv.tabular.ctgan.TVAE.fit.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      149 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/tabular/api/sdv.tabular.ctgan.TVAE.get_metadata.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      123 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/tabular/api/sdv.tabular.ctgan.TVAE.load.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      450 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/tabular/api/sdv.tabular.ctgan.TVAE.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      129 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/tabular/api/sdv.tabular.ctgan.TVAE.sample.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/tabular/api/sdv.tabular.ctgan.TVAE.sample_conditions.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      187 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/tabular/api/sdv.tabular.ctgan.TVAE.sample_remaining_columns.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      123 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/tabular/api/sdv.tabular.ctgan.TVAE.save.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      339 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/api_reference/tabular/copulagan.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      489 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/api_reference/tabular/copulas.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      260 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/api_reference/tabular/ctgan.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      136 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/api_reference/tabular/index.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      249 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/api_reference/tabular/tvae.rst
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.828900 sdv-1.1.0.dev0/docs/api_reference/timeseries/
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.829915 sdv-1.1.0.dev0/docs/api_reference/timeseries/api/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      135 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/timeseries/api/sdv.timeseries.deepecho.PAR.fit.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/timeseries/api/sdv.timeseries.deepecho.PAR.get_metadata.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      138 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/timeseries/api/sdv.timeseries.deepecho.PAR.load.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      338 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/timeseries/api/sdv.timeseries.deepecho.PAR.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      144 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/timeseries/api/sdv.timeseries.deepecho.PAR.sample.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      138 2022-06-22 20:44:18.000000 sdv-1.1.0.dev0/docs/api_reference/timeseries/api/sdv.timeseries.deepecho.PAR.save.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      108 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/api_reference/timeseries/index.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      190 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/api_reference/timeseries/par.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     6934 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/docs/conf.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.830430 sdv-1.1.0.dev0/docs/developer_guides/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     8771 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/developer_guides/contributing.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      364 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/developer_guides/index.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     2905 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/developer_guides/overview.rst
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.831276 sdv-1.1.0.dev0/docs/developer_guides/sdv/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     5889 2022-07-22 02:55:50.000000 sdv-1.1.0.dev0/docs/developer_guides/sdv/constraints.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      292 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/developer_guides/sdv/index.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     7480 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/developer_guides/sdv/metadata.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     9508 2023-02-02 20:58:41.000000 sdv-1.1.0.dev0/docs/developer_guides/sdv/tabular.rst
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.831955 sdv-1.1.0.dev0/docs/getting_started/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      113 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/getting_started/index.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     2557 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/getting_started/install.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     3664 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/getting_started/quickstart.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)       29 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/history.rst
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.844627 sdv-1.1.0.dev0/docs/images/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    52078 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/images/CTGAN-DataCebo.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    50900 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/images/Copulas-DataCebo.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    60600 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/images/DataCebo-Blue.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    54065 2023-04-20 22:38:57.000000 sdv-1.1.0.dev0/docs/images/DataCebo.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    46250 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/images/DeepEcho-DataCebo.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    25573 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/images/RDT-DataCebo.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)   243101 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/docs/images/Real-vs-Synthetic-Evaluation.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    27285 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/images/SDGym-DataCebo.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    35670 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/images/SDMetrics-DataCebo.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    22394 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/images/SDV-DataCebo.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    64162 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/docs/images/SDV-logo.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     8765 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/images/SDV.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)   412158 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/docs/images/Single-Table-Metadata-Example.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    99815 2022-07-22 02:55:50.000000 sdv-1.1.0.dev0/docs/images/custom_constraint.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    50140 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/docs/images/datacebo-logo-dark-mode.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    50481 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/docs/images/datacebo-logo.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      547 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/images/google_colab.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    67403 2022-12-08 23:36:42.000000 sdv-1.1.0.dev0/docs/images/hma1_1.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     8748 2022-12-08 23:36:42.000000 sdv-1.1.0.dev0/docs/images/metadata_1.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    67425 2022-12-08 23:36:42.000000 sdv-1.1.0.dev0/docs/images/metadata_2.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     2497 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/images/mybinder.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    67403 2022-12-08 23:36:42.000000 sdv-1.1.0.dev0/docs/images/quickstart_1.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)   176980 2023-01-24 21:06:49.000000 sdv-1.1.0.dev0/docs/images/rdt_main_tranformation.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     2283 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/images/slack.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     6075 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/docs/index.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      765 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/make.bat
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.846453 sdv-1.1.0.dev0/docs/savefig/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    10974 2022-12-08 23:00:09.000000 sdv-1.1.0.dev0/docs/savefig/copulagan_experience_years_1.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    12668 2022-12-08 23:00:10.000000 sdv-1.1.0.dev0/docs/savefig/copulagan_experience_years_2.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    10277 2022-12-08 23:00:37.000000 sdv-1.1.0.dev0/docs/savefig/copulagan_experience_years_3.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    10974 2022-12-08 23:05:15.000000 sdv-1.1.0.dev0/docs/savefig/experience_years_1.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    10270 2022-12-08 23:05:16.000000 sdv-1.1.0.dev0/docs/savefig/experience_years_2.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    12415 2022-12-08 23:05:16.000000 sdv-1.1.0.dev0/docs/savefig/experience_years_3.png
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.740800 sdv-1.1.0.dev0/docs/sdv_theme/
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.847516 sdv-1.1.0.dev0/docs/sdv_theme/static/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     1046 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/sdv_theme/static/slack-32.png
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.848136 sdv-1.1.0.dev0/docs/user_guides/
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.849555 sdv-1.1.0.dev0/docs/user_guides/benchmarking/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     4753 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/user_guides/benchmarking/datasets.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     1885 2023-02-02 20:58:41.000000 sdv-1.1.0.dev0/docs/user_guides/benchmarking/docker.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      563 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/user_guides/benchmarking/index.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     2562 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/user_guides/benchmarking/install.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     7764 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/user_guides/benchmarking/run.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     1731 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/user_guides/benchmarking/synthesizers.rst
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.850375 sdv-1.1.0.dev0/docs/user_guides/evaluation/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     3240 2022-12-21 22:30:23.000000 sdv-1.1.0.dev0/docs/user_guides/evaluation/evaluation_framework.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      504 2022-12-21 22:30:23.000000 sdv-1.1.0.dev0/docs/user_guides/evaluation/index.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      219 2022-12-21 22:30:23.000000 sdv-1.1.0.dev0/docs/user_guides/evaluation/synthetic_data_metrics.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      277 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/user_guides/index.rst
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.851547 sdv-1.1.0.dev0/docs/user_guides/relational/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     2131 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/user_guides/relational/constraints.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      141 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/user_guides/relational/data_description.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     8143 2022-12-21 22:30:23.000000 sdv-1.1.0.dev0/docs/user_guides/relational/hma1.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      177 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/user_guides/relational/index.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)       79 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/user_guides/relational/models.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     6906 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/user_guides/relational/relational_metadata.rst
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.854871 sdv-1.1.0.dev0/docs/user_guides/single_table/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      135 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/user_guides/single_table/constraints.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    24765 2023-02-02 20:58:41.000000 sdv-1.1.0.dev0/docs/user_guides/single_table/copulagan.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    18899 2023-02-02 20:58:41.000000 sdv-1.1.0.dev0/docs/user_guides/single_table/ctgan.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     6108 2022-09-22 23:47:45.000000 sdv-1.1.0.dev0/docs/user_guides/single_table/custom_constraints.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      121 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/user_guides/single_table/data_description.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    20259 2023-02-02 20:58:41.000000 sdv-1.1.0.dev0/docs/user_guides/single_table/gaussian_copula.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    14530 2022-09-22 23:47:45.000000 sdv-1.1.0.dev0/docs/user_guides/single_table/handling_constraints.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      980 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/user_guides/single_table/index.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      510 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/user_guides/single_table/models.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)       65 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/user_guides/single_table/table_metadata.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     8354 2022-07-22 02:55:50.000000 sdv-1.1.0.dev0/docs/user_guides/single_table/tabular_preset.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    18149 2023-02-02 20:58:41.000000 sdv-1.1.0.dev0/docs/user_guides/single_table/tvae.rst
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.855566 sdv-1.1.0.dev0/docs/user_guides/timeseries/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)       92 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/user_guides/timeseries/index.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)       78 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/docs/user_guides/timeseries/models.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    14863 2022-12-21 22:30:23.000000 sdv-1.1.0.dev0/docs/user_guides/timeseries/par.rst
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.856606 sdv-1.1.0.dev0/sdv/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      372 2023-05-10 18:21:35.000000 sdv-1.1.0.dev0/sdv/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     1419 2023-05-09 18:58:51.000000 sdv-1.1.0.dev0/sdv/_addons.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.859567 sdv-1.1.0.dev0/sdv/constraints/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      645 2023-05-09 18:58:51.000000 sdv-1.1.0.dev0/sdv/constraints/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    18019 2023-04-20 22:38:57.000000 sdv-1.1.0.dev0/sdv/constraints/base.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      799 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/sdv/constraints/errors.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    52230 2023-05-09 18:58:51.000000 sdv-1.1.0.dev0/sdv/constraints/tabular.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     4953 2023-05-09 18:58:51.000000 sdv-1.1.0.dev0/sdv/constraints/utils.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.862868 sdv-1.1.0.dev0/sdv/data_processing/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      132 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/sdv/data_processing/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    34159 2023-04-24 19:25:22.000000 sdv-1.1.0.dev0/sdv/data_processing/data_processor.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     1526 2023-04-20 18:31:25.000000 sdv-1.1.0.dev0/sdv/data_processing/datetime_formatter.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      522 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/sdv/data_processing/errors.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     4010 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/sdv/data_processing/numerical_formatter.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      726 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/sdv/data_processing/utils.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.863458 sdv-1.1.0.dev0/sdv/datasets/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)       43 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/sdv/datasets/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     6625 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/sdv/datasets/demo.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     1117 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/sdv/datasets/local.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      694 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/sdv/errors.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.864072 sdv-1.1.0.dev0/sdv/evaluation/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)       49 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/sdv/evaluation/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     3701 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/sdv/evaluation/multi_table.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     3239 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/sdv/evaluation/single_table.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.864501 sdv-1.1.0.dev0/sdv/lite/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      145 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/sdv/lite/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     7153 2023-05-10 18:12:55.000000 sdv-1.1.0.dev0/sdv/lite/single_table.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.866445 sdv-1.1.0.dev0/sdv/metadata/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      400 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/sdv/metadata/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     3060 2023-05-02 20:56:42.000000 sdv-1.1.0.dev0/sdv/metadata/anonymization.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      238 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/sdv/metadata/errors.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    10362 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/sdv/metadata/metadata_upgrader.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    28381 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/sdv/metadata/multi_table.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    21722 2023-05-09 18:58:51.000000 sdv-1.1.0.dev0/sdv/metadata/single_table.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      793 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/sdv/metadata/utils.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     2475 2023-04-20 18:31:25.000000 sdv-1.1.0.dev0/sdv/metadata/visualization.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.867803 sdv-1.1.0.dev0/sdv/metrics/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      252 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/sdv/metrics/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      156 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/sdv/metrics/demos.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      188 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/sdv/metrics/relational.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      186 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/sdv/metrics/tabular.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      188 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/sdv/metrics/timeseries.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.868673 sdv-1.1.0.dev0/sdv/multi_table/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      229 2023-04-24 19:25:22.000000 sdv-1.1.0.dev0/sdv/multi_table/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    19487 2023-05-02 20:56:42.000000 sdv-1.1.0.dev0/sdv/multi_table/base.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    21934 2023-05-02 20:56:42.000000 sdv-1.1.0.dev0/sdv/multi_table/hma.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.869098 sdv-1.1.0.dev0/sdv/sampling/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      103 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/sdv/sampling/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      913 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/sdv/sampling/tabular.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.869447 sdv-1.1.0.dev0/sdv/sequential/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      124 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/sdv/sequential/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    14850 2023-04-24 19:25:22.000000 sdv-1.1.0.dev0/sdv/sequential/par.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.871007 sdv-1.1.0.dev0/sdv/single_table/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      454 2023-04-24 19:25:22.000000 sdv-1.1.0.dev0/sdv/single_table/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    44927 2023-05-10 18:12:55.000000 sdv-1.1.0.dev0/sdv/single_table/base.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    11148 2023-04-24 19:25:22.000000 sdv-1.1.0.dev0/sdv/single_table/copulagan.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    14901 2023-05-10 18:21:05.000000 sdv-1.1.0.dev0/sdv/single_table/copulas.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     9895 2023-04-24 19:25:22.000000 sdv-1.1.0.dev0/sdv/single_table/ctgan.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      341 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/sdv/single_table/errors.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    10141 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/sdv/single_table/utils.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     4719 2023-05-10 18:21:05.000000 sdv-1.1.0.dev0/sdv/utils.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.857627 sdv-1.1.0.dev0/sdv.egg-info/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    76085 2023-05-10 18:21:50.000000 sdv-1.1.0.dev0/sdv.egg-info/PKG-INFO
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    35574 2023-05-10 18:21:50.000000 sdv-1.1.0.dev0/sdv.egg-info/SOURCES.txt
--rw-r--r--   0 andrewmontanez   (501) staff       (20)        1 2023-05-10 18:21:50.000000 sdv-1.1.0.dev0/sdv.egg-info/dependency_links.txt
--rw-r--r--   0 andrewmontanez   (501) staff       (20)        1 2023-05-10 18:21:50.000000 sdv-1.1.0.dev0/sdv.egg-info/not-zip-safe
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     1479 2023-05-10 18:21:50.000000 sdv-1.1.0.dev0/sdv.egg-info/requires.txt
--rw-r--r--   0 andrewmontanez   (501) staff       (20)        4 2023-05-10 18:21:50.000000 sdv-1.1.0.dev0/sdv.egg-info/top_level.txt
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     1233 2023-05-10 18:21:50.888951 sdv-1.1.0.dev0/setup.cfg
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     3853 2023-05-10 18:21:35.000000 sdv-1.1.0.dev0/setup.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.871502 sdv-1.1.0.dev0/tests/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/tests/__init__.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.872051 sdv-1.1.0.dev0/tests/integration/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/tests/integration/__init__.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.872413 sdv-1.1.0.dev0/tests/integration/data_processing/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    12132 2023-04-24 19:25:22.000000 sdv-1.1.0.dev0/tests/integration/data_processing/test_data_processor.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      598 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/tests/integration/dataset.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.872812 sdv-1.1.0.dev0/tests/integration/datasets/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/tests/integration/datasets/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     3324 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/tests/integration/datasets/test_demo.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.873415 sdv-1.1.0.dev0/tests/integration/evaluation/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/tests/integration/evaluation/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     1133 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/tests/integration/evaluation/test_multi_table.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     1131 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/tests/integration/evaluation/test_single_table.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.873776 sdv-1.1.0.dev0/tests/integration/lite/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2022-07-22 02:55:50.000000 sdv-1.1.0.dev0/tests/integration/lite/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     1447 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/tests/integration/lite/test_single_table.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.874548 sdv-1.1.0.dev0/tests/integration/metadata/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/tests/integration/metadata/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      596 2023-04-24 19:25:22.000000 sdv-1.1.0.dev0/tests/integration/metadata/test_anonymization.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     4369 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/tests/integration/metadata/test_multi_table.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     6200 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/tests/integration/metadata/test_single_table.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.874899 sdv-1.1.0.dev0/tests/integration/multi_table/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/tests/integration/multi_table/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    22620 2023-04-20 18:31:25.000000 sdv-1.1.0.dev0/tests/integration/multi_table/test_hma.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.875554 sdv-1.1.0.dev0/tests/integration/sequential/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/tests/integration/sequential/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     6268 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/tests/integration/sequential/test_par.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.877338 sdv-1.1.0.dev0/tests/integration/single_table/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/tests/integration/single_table/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     1769 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/tests/integration/single_table/custom_constraints.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    27055 2023-05-09 18:58:51.000000 sdv-1.1.0.dev0/tests/integration/single_table/test_base.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     9991 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/tests/integration/single_table/test_copulas.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     2528 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/tests/integration/single_table/test_ctgan.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.877535 sdv-1.1.0.dev0/tests/readme_test/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    13973 2022-08-16 22:57:14.000000 sdv-1.1.0.dev0/tests/readme_test/README.md
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.878322 sdv-1.1.0.dev0/tests/unit/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/tests/unit/__init__.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.879723 sdv-1.1.0.dev0/tests/unit/constraints/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/tests/unit/constraints/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    32384 2023-04-20 22:38:57.000000 sdv-1.1.0.dev0/tests/unit/constraints/test_base.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)   165450 2023-05-09 18:58:51.000000 sdv-1.1.0.dev0/tests/unit/constraints/test_tabular.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    10194 2023-05-09 18:58:51.000000 sdv-1.1.0.dev0/tests/unit/constraints/test_utils.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.881326 sdv-1.1.0.dev0/tests/unit/data_processing/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/tests/unit/data_processing/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    82749 2023-04-24 19:25:22.000000 sdv-1.1.0.dev0/tests/unit/data_processing/test_data_processor.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     2765 2023-04-20 18:31:25.000000 sdv-1.1.0.dev0/tests/unit/data_processing/test_datetime_formatter.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    14718 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/tests/unit/data_processing/test_numerical_formatter.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      926 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/tests/unit/data_processing/test_utils.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.881954 sdv-1.1.0.dev0/tests/unit/datasets/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/tests/unit/datasets/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     9876 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/tests/unit/datasets/test_demo.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     2498 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/tests/unit/datasets/test_local.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.882390 sdv-1.1.0.dev0/tests/unit/evaluation/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     2865 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/tests/unit/evaluation/test_multi_table.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     2533 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/tests/unit/evaluation/test_single_table.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.882837 sdv-1.1.0.dev0/tests/unit/lite/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/tests/unit/lite/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    10135 2023-05-10 18:12:55.000000 sdv-1.1.0.dev0/tests/unit/lite/test_single_table.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.884240 sdv-1.1.0.dev0/tests/unit/metadata/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/tests/unit/metadata/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     5258 2023-05-02 20:56:42.000000 sdv-1.1.0.dev0/tests/unit/metadata/test_anonymization.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    22557 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/tests/unit/metadata/test_metadata_upgrader.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    74602 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/tests/unit/metadata/test_multi_table.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    66033 2023-04-20 18:31:25.000000 sdv-1.1.0.dev0/tests/unit/metadata/test_single_table.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.885715 sdv-1.1.0.dev0/tests/unit/multi_table/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/tests/unit/multi_table/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    39709 2023-05-02 20:56:42.000000 sdv-1.1.0.dev0/tests/unit/multi_table/test_base.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    26907 2023-05-10 18:21:05.000000 sdv-1.1.0.dev0/tests/unit/multi_table/test_hma.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.886021 sdv-1.1.0.dev0/tests/unit/sampling/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2022-07-22 02:55:50.000000 sdv-1.1.0.dev0/tests/unit/sampling/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     2140 2022-06-21 19:18:25.000000 sdv-1.1.0.dev0/tests/unit/sampling/test_tabular.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.886601 sdv-1.1.0.dev0/tests/unit/sequential/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)       50 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/tests/unit/sequential/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    29331 2023-04-24 19:25:22.000000 sdv-1.1.0.dev0/tests/unit/sequential/test_par.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-05-10 18:21:50.887818 sdv-1.1.0.dev0/tests/unit/single_table/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/tests/unit/single_table/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    76732 2023-04-24 19:25:22.000000 sdv-1.1.0.dev0/tests/unit/single_table/test_base.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    13777 2023-04-24 19:25:22.000000 sdv-1.1.0.dev0/tests/unit/single_table/test_copulagan.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    18091 2023-05-10 18:21:05.000000 sdv-1.1.0.dev0/tests/unit/single_table/test_copulas.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    10328 2023-04-24 19:25:22.000000 sdv-1.1.0.dev0/tests/unit/single_table/test_ctgan.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     8358 2023-03-28 20:22:54.000000 sdv-1.1.0.dev0/tests/unit/single_table/test_utils.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     2974 2023-05-09 18:58:51.000000 sdv-1.1.0.dev0/tests/unit/test__addons.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      922 2023-04-20 22:42:12.000000 sdv-1.1.0.dev0/tests/unit/test_utils.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     3051 2023-04-20 22:40:35.000000 sdv-1.1.0.dev0/tests/utils.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.073773 sdv-1.2.0.dev0/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)       56 2023-01-24 21:06:49.000000 sdv-1.2.0.dev0/AUTHORS.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     8110 2023-06-06 20:45:58.000000 sdv-1.2.0.dev0/CONTRIBUTING.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    67391 2023-05-10 21:10:34.000000 sdv-1.2.0.dev0/HISTORY.md
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     4818 2023-01-24 21:06:49.000000 sdv-1.2.0.dev0/LICENSE
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      245 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/MANIFEST.in
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    78227 2023-06-06 20:53:32.074042 sdv-1.2.0.dev0/PKG-INFO
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     9801 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/README.md
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:31.945238 sdv-1.2.0.dev0/docs/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      604 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/Makefile
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:31.946083 sdv-1.2.0.dev0/docs/api_reference/
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:31.946624 sdv-1.2.0.dev0/docs/api_reference/constraints/
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:31.966401 sdv-1.2.0.dev0/docs/api_reference/constraints/api/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      161 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Constraint.filter_valid.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      132 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Constraint.fit.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Constraint.fit_transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      152 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Constraint.from_dict.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      149 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Constraint.is_valid.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      176 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Constraint.reverse_transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      575 2022-06-29 17:31:16.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Constraint.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      146 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Constraint.to_dict.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      150 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Constraint.transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      179 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.CustomConstraint.filter_valid.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      150 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.CustomConstraint.fit.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      182 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.CustomConstraint.fit_transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      170 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.CustomConstraint.from_dict.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      167 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.CustomConstraint.is_valid.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      194 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.CustomConstraint.reverse_transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      653 2022-06-29 17:31:16.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.CustomConstraint.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.CustomConstraint.to_dict.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      168 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.CustomConstraint.transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      182 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.FixedCombinations.filter_valid.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      153 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.FixedCombinations.fit.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      185 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.FixedCombinations.fit_transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      173 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.FixedCombinations.from_dict.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      170 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.FixedCombinations.is_valid.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      197 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.FixedCombinations.reverse_transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      666 2022-06-29 17:31:16.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.FixedCombinations.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      167 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.FixedCombinations.to_dict.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      171 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.FixedCombinations.transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      161 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Inequality.filter_valid.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      132 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Inequality.fit.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Inequality.fit_transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      152 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Inequality.from_dict.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      149 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Inequality.is_valid.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      176 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Inequality.reverse_transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      575 2022-06-29 17:31:16.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Inequality.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      146 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Inequality.to_dict.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      150 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Inequality.transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      155 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Negative.filter_valid.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      126 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Negative.fit.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      158 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Negative.fit_transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      146 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Negative.from_dict.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      143 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Negative.is_valid.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      170 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Negative.reverse_transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      549 2022-06-29 17:31:16.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Negative.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      140 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Negative.to_dict.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      144 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Negative.transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      173 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.OneHotEncoding.filter_valid.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      144 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.OneHotEncoding.fit.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      176 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.OneHotEncoding.fit_transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.OneHotEncoding.from_dict.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      161 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.OneHotEncoding.is_valid.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      188 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.OneHotEncoding.reverse_transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      627 2022-06-29 17:31:16.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.OneHotEncoding.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      158 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.OneHotEncoding.to_dict.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      162 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.OneHotEncoding.transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      155 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Positive.filter_valid.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      126 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Positive.fit.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      158 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Positive.fit_transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      146 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Positive.from_dict.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      143 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Positive.is_valid.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      170 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Positive.reverse_transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      549 2022-06-29 17:31:16.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Positive.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      140 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Positive.to_dict.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      144 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Positive.transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      146 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Range.filter_valid.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      117 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Range.fit.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      149 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Range.fit_transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      137 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Range.from_dict.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      134 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Range.is_valid.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      161 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Range.reverse_transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      510 2022-06-29 17:31:16.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Range.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      131 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Range.to_dict.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      135 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Range.transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      179 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarInequality.filter_valid.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      150 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarInequality.fit.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      182 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarInequality.fit_transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      170 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarInequality.from_dict.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      167 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarInequality.is_valid.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      194 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarInequality.reverse_transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      653 2022-06-29 17:31:16.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarInequality.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarInequality.to_dict.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      168 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarInequality.transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarRange.filter_valid.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      135 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarRange.fit.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      167 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarRange.fit_transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      155 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarRange.from_dict.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      152 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarRange.is_valid.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      179 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarRange.reverse_transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      588 2022-06-29 17:31:16.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarRange.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      149 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarRange.to_dict.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      153 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarRange.transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      149 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Unique.filter_valid.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      120 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Unique.fit.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      152 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Unique.fit_transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      140 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Unique.from_dict.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      137 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Unique.is_valid.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Unique.reverse_transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      523 2022-06-29 17:31:16.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Unique.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      134 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Unique.to_dict.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      138 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Unique.transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      359 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/base.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      124 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/index.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     2609 2022-07-22 02:55:50.000000 sdv-1.2.0.dev0/docs/api_reference/constraints/tabular.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      353 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/api_reference/demo.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      135 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/api_reference/evaluation.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      347 2022-07-22 02:55:50.000000 sdv-1.2.0.dev0/docs/api_reference/index.rst
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:31.966950 sdv-1.2.0.dev0/docs/api_reference/lite/
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:31.968863 sdv-1.2.0.dev0/docs/api_reference/lite/api/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      144 2022-06-29 17:31:16.000000 sdv-1.2.0.dev0/docs/api_reference/lite/api/sdv.lite.tabular.TabularPreset.fit.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      205 2022-06-29 17:31:16.000000 sdv-1.2.0.dev0/docs/api_reference/lite/api/sdv.lite.tabular.TabularPreset.list_available_presets.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      147 2022-06-29 17:31:16.000000 sdv-1.2.0.dev0/docs/api_reference/lite/api/sdv.lite.tabular.TabularPreset.load.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      502 2022-06-29 17:31:16.000000 sdv-1.2.0.dev0/docs/api_reference/lite/api/sdv.lite.tabular.TabularPreset.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      153 2022-06-29 17:31:16.000000 sdv-1.2.0.dev0/docs/api_reference/lite/api/sdv.lite.tabular.TabularPreset.sample.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      188 2022-06-29 17:31:16.000000 sdv-1.2.0.dev0/docs/api_reference/lite/api/sdv.lite.tabular.TabularPreset.sample_conditions.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      211 2022-06-29 17:31:16.000000 sdv-1.2.0.dev0/docs/api_reference/lite/api/sdv.lite.tabular.TabularPreset.sample_remaining_columns.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      147 2022-06-29 17:31:16.000000 sdv-1.2.0.dev0/docs/api_reference/lite/api/sdv.lite.tabular.TabularPreset.save.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)       94 2022-07-22 02:55:50.000000 sdv-1.2.0.dev0/docs/api_reference/lite/index.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      348 2022-07-22 02:55:50.000000 sdv-1.2.0.dev0/docs/api_reference/lite/tabular.rst
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:31.969757 sdv-1.2.0.dev0/docs/api_reference/metadata/
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:31.979028 sdv-1.2.0.dev0/docs/api_reference/metadata/api/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      161 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.add_field.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      182 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.add_relationship.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      161 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.add_table.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      170 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.get_children.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.get_dtypes.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      178 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.get_field_meta.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.get_fields.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      184 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.get_foreign_keys.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      167 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.get_parents.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      181 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.get_primary_key.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      178 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.get_table_meta.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.get_tables.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.load_table.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      167 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.load_tables.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      185 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.reverse_transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      877 2022-09-29 22:36:12.000000 sdv-1.2.0.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      181 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.set_primary_key.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      155 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.to_dict.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      155 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.to_json.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      159 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      156 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.validate.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      159 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.visualize.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      155 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metadata/api/sdv.metadata.table.Table.filter_valid.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      126 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metadata/api/sdv.metadata.table.Table.fit.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      146 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metadata/api/sdv.metadata.table.Table.from_dict.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      146 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metadata/api/sdv.metadata.table.Table.from_json.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      149 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metadata/api/sdv.metadata.table.Table.get_dtypes.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      149 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metadata/api/sdv.metadata.table.Table.get_fields.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      169 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metadata/api/sdv.metadata.table.Table.get_model_kwargs.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      170 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metadata/api/sdv.metadata.table.Table.reverse_transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      668 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metadata/api/sdv.metadata.table.Table.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      169 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metadata/api/sdv.metadata.table.Table.set_model_kwargs.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      166 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metadata/api/sdv.metadata.table.Table.set_primary_key.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      140 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metadata/api/sdv.metadata.table.Table.to_dict.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      140 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metadata/api/sdv.metadata.table.Table.to_json.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      144 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metadata/api/sdv.metadata.table.Table.transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      854 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/api_reference/metadata/dataset.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      116 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/api_reference/metadata/index.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      583 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/api_reference/metadata/table.rst
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:31.980265 sdv-1.2.0.dev0/docs/api_reference/metrics/
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.017914 sdv-1.2.0.dev0/docs/api_reference/metrics/api/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      167 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.demos.load_multi_table_demo.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      170 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.demos.load_single_table_demo.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      162 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.demos.load_timeseries_demo.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      171 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.BNLikelihood.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      194 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.BNLikelihood.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      578 2022-08-30 22:45:23.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.BNLikelihood.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      180 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.BNLogLikelihood.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      203 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.BNLogLikelihood.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      614 2022-08-30 22:45:23.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.BNLogLikelihood.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      153 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.CSTest.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      176 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.CSTest.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      506 2022-08-30 22:45:24.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.CSTest.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      203 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.DetectionMetric.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      573 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.DetectionMetric.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      171 2022-08-30 23:02:40.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.KSComplement.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      194 2022-08-30 23:02:40.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.KSComplement.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      578 2022-08-30 23:02:40.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.KSComplement.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      165 2022-08-30 23:02:15.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.KSTest.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      188 2022-08-30 23:02:15.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.KSTest.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      534 2022-08-30 23:02:15.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.KSTest.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      186 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.LogisticDetection.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      209 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.LogisticDetection.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      638 2022-08-30 22:45:24.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.LogisticDetection.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      219 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.LogisticParentChildDetection.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      242 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.LogisticParentChildDetection.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      716 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.LogisticParentChildDetection.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      224 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.MultiSingleTableMetric.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      598 2022-08-30 22:45:24.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.MultiSingleTableMetric.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      206 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.MultiTableMetric.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      584 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.MultiTableMetric.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      236 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.ParentChildDetectionMetric.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      582 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.ParentChildDetectionMetric.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      171 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.SVCDetection.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      194 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.SVCDetection.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      578 2022-08-30 22:45:24.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.SVCDetection.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      204 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.SVCParentChildDetection.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      227 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.SVCParentChildDetection.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      661 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.SVCParentChildDetection.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      162 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BNLikelihood.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      185 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BNLikelihood.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      569 2022-12-08 22:56:17.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BNLikelihood.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      171 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BNLogLikelihood.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      194 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BNLogLikelihood.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      605 2022-12-08 22:56:17.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BNLogLikelihood.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      198 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryAdaBoostClassifier.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      221 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryAdaBoostClassifier.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      837 2022-12-08 22:56:17.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryAdaBoostClassifier.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      210 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryDecisionTreeClassifier.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      233 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryDecisionTreeClassifier.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      897 2022-12-08 22:56:17.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryDecisionTreeClassifier.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      209 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryEfficacyMetric.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      811 2022-12-08 22:56:17.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryEfficacyMetric.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      198 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryLogisticRegression.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      221 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryLogisticRegression.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      837 2022-12-08 22:56:17.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryLogisticRegression.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      183 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryMLPClassifier.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      206 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryMLPClassifier.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      762 2022-12-08 22:56:17.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryMLPClassifier.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      144 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CSTest.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      167 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CSTest.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      565 2022-08-30 22:45:24.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CSTest.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      168 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalCAP.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      191 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalCAP.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      664 2022-12-08 22:56:17.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalCAP.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      183 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalEnsemble.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      206 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalEnsemble.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      734 2022-12-08 22:56:17.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalEnsemble.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      201 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalGeneralizedCAP.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      224 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalGeneralizedCAP.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      818 2022-12-08 22:56:17.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalGeneralizedCAP.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      168 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalKNN.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      191 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalKNN.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      664 2022-12-08 22:56:17.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalKNN.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      165 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalNB.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      188 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalNB.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      650 2022-12-08 22:56:17.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalNB.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      221 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalPrivacyMetric.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      842 2022-12-08 22:56:17.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalPrivacyMetric.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      165 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalRF.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      188 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalRF.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      650 2022-12-08 22:56:17.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalRF.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      168 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalSVM.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      191 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalSVM.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      664 2022-12-08 22:56:17.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalSVM.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      180 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalZeroCAP.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      203 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalZeroCAP.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      720 2022-12-08 22:56:17.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalZeroCAP.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      192 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.ContinuousKLDivergence.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      215 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.ContinuousKLDivergence.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      788 2022-10-05 00:20:25.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.ContinuousKLDivergence.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      194 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.DetectionMetric.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      605 2022-12-08 22:56:17.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.DetectionMetric.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      186 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.DiscreteKLDivergence.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      209 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.DiscreteKLDivergence.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      760 2022-10-05 00:20:25.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.DiscreteKLDivergence.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      171 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.GMLogLikelihood.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      194 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.GMLogLikelihood.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      605 2022-12-08 22:56:17.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.GMLogLikelihood.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      162 2022-08-30 23:02:40.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.KSComplement.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      185 2022-08-30 23:02:40.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.KSComplement.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      649 2022-08-30 23:02:40.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.KSComplement.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      156 2022-08-30 23:02:15.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.KSTest.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      179 2022-08-30 23:02:15.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.KSTest.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      605 2022-08-30 23:02:15.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.KSTest.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      174 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.LinearRegression.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      197 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.LinearRegression.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      717 2022-12-08 22:56:17.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.LinearRegression.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      177 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.LogisticDetection.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      200 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.LogisticDetection.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      629 2022-12-08 22:56:17.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.LogisticDetection.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      197 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MLEfficacyMetric.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      716 2022-12-08 22:56:17.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MLEfficacyMetric.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      162 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MLPRegressor.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      185 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MLPRegressor.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      657 2022-12-08 22:56:17.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MLPRegressor.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      215 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MultiColumnPairsMetric.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      688 2022-10-05 00:20:25.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MultiColumnPairsMetric.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      218 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MultiSingleColumnMetric.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      701 2022-08-30 22:45:24.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MultiSingleColumnMetric.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      222 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MulticlassDecisionTreeClassifier.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      245 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MulticlassDecisionTreeClassifier.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      957 2022-12-08 22:56:17.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MulticlassDecisionTreeClassifier.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      875 2022-12-08 22:56:17.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MulticlassEfficacyMetric.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      195 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MulticlassMLPClassifier.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      218 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MulticlassMLPClassifier.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      822 2022-12-08 22:56:17.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MulticlassMLPClassifier.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      159 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalLR.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      182 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalLR.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      629 2022-12-08 22:56:17.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalLR.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      162 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalMLP.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      185 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalMLP.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      643 2022-12-08 22:56:17.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalMLP.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      215 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalPrivacyMetric.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      819 2022-12-08 22:56:17.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalPrivacyMetric.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      216 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalRadiusNearestNeighbor.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      239 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalRadiusNearestNeighbor.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      895 2022-12-08 22:56:17.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalRadiusNearestNeighbor.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      162 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalSVR.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      185 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalSVR.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      643 2022-12-08 22:56:17.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalSVR.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      875 2022-12-08 22:56:17.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.RegressionEfficacyMetric.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      162 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.SVCDetection.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      185 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.SVCDetection.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      569 2022-12-08 22:56:17.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.SVCDetection.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      257 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.ScikitLearnClassifierDetectionMetric.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      857 2022-12-08 22:56:17.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.ScikitLearnClassifierDetectionMetric.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      200 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.SingleTableMetric.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      629 2022-12-08 22:56:17.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.SingleTableMetric.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      201 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.timeseries.LSTMClassifierEfficacy.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      224 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.timeseries.LSTMClassifierEfficacy.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      650 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.timeseries.LSTMClassifierEfficacy.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      174 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.timeseries.LSTMDetection.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      197 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.timeseries.LSTMDetection.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      551 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.timeseries.LSTMDetection.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      233 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.timeseries.TimeSeriesDetectionMetric.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      683 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.timeseries.TimeSeriesDetectionMetric.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      230 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.timeseries.TimeSeriesEfficacyMetric.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      672 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.timeseries.TimeSeriesEfficacyMetric.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      206 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.timeseries.TimeSeriesMetric.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      584 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.timeseries.TimeSeriesMetric.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      213 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/demos.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      143 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/index.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     1402 2022-09-22 23:47:45.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/relational.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     4109 2022-09-22 23:47:45.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/tabular.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      735 2022-12-21 22:30:23.000000 sdv-1.2.0.dev0/docs/api_reference/metrics/timeseries.rst
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.018487 sdv-1.2.0.dev0/docs/api_reference/relational/
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.019604 sdv-1.2.0.dev0/docs/api_reference/relational/api/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      123 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/relational/api/sdv.relational.hma.HMA1.fit.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      126 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/relational/api/sdv.relational.hma.HMA1.load.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      416 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/relational/api/sdv.relational.hma.HMA1.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      132 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/relational/api/sdv.relational.hma.HMA1.sample.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      126 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/relational/api/sdv.relational.hma.HMA1.save.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      173 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/api_reference/relational/hma1.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      109 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/api_reference/relational/index.rst
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.020018 sdv-1.2.0.dev0/docs/api_reference/sampling/
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.020642 sdv-1.2.0.dev0/docs/api_reference/sampling/api/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      166 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/sampling/api/sdv.sampling.Condition.get_column_values.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      151 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/sampling/api/sdv.sampling.Condition.get_num_rows.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      417 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/sampling/api/sdv.sampling.Condition.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      109 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/api_reference/sampling/index.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      227 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/api_reference/sampling/tabular.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      153 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/api_reference/sdv.rst
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.021721 sdv-1.2.0.dev0/docs/api_reference/tabular/
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.029773 sdv-1.2.0.dev0/docs/api_reference/tabular/api/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      147 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/tabular/api/sdv.tabular.copulagan.CopulaGAN.fit.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      191 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/tabular/api/sdv.tabular.copulagan.CopulaGAN.get_distributions.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      176 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/tabular/api/sdv.tabular.copulagan.CopulaGAN.get_metadata.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      150 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/tabular/api/sdv.tabular.copulagan.CopulaGAN.load.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      655 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/tabular/api/sdv.tabular.copulagan.CopulaGAN.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      156 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/tabular/api/sdv.tabular.copulagan.CopulaGAN.sample.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      191 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/tabular/api/sdv.tabular.copulagan.CopulaGAN.sample_conditions.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      214 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/tabular/api/sdv.tabular.copulagan.CopulaGAN.sample_remaining_columns.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      150 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/tabular/api/sdv.tabular.copulagan.CopulaGAN.save.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      156 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.fit.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      200 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.get_distributions.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      191 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.get_likelihood.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      185 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.get_metadata.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      191 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.get_parameters.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      159 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.load.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      663 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      165 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.sample.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      200 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.sample_conditions.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      223 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.sample_remaining_columns.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      159 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.save.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      191 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.set_parameters.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      123 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/tabular/api/sdv.tabular.ctgan.CTGAN.fit.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      152 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/tabular/api/sdv.tabular.ctgan.CTGAN.get_metadata.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      126 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/tabular/api/sdv.tabular.ctgan.CTGAN.load.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      463 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/tabular/api/sdv.tabular.ctgan.CTGAN.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      132 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/tabular/api/sdv.tabular.ctgan.CTGAN.sample.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      167 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/tabular/api/sdv.tabular.ctgan.CTGAN.sample_conditions.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      190 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/tabular/api/sdv.tabular.ctgan.CTGAN.sample_remaining_columns.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      126 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/tabular/api/sdv.tabular.ctgan.CTGAN.save.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      120 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/tabular/api/sdv.tabular.ctgan.TVAE.fit.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      149 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/tabular/api/sdv.tabular.ctgan.TVAE.get_metadata.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      123 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/tabular/api/sdv.tabular.ctgan.TVAE.load.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      450 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/tabular/api/sdv.tabular.ctgan.TVAE.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      129 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/tabular/api/sdv.tabular.ctgan.TVAE.sample.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/tabular/api/sdv.tabular.ctgan.TVAE.sample_conditions.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      187 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/tabular/api/sdv.tabular.ctgan.TVAE.sample_remaining_columns.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      123 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/tabular/api/sdv.tabular.ctgan.TVAE.save.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      339 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/api_reference/tabular/copulagan.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      489 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/api_reference/tabular/copulas.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      260 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/api_reference/tabular/ctgan.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      136 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/api_reference/tabular/index.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      249 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/api_reference/tabular/tvae.rst
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.030140 sdv-1.2.0.dev0/docs/api_reference/timeseries/
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.031362 sdv-1.2.0.dev0/docs/api_reference/timeseries/api/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      135 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/timeseries/api/sdv.timeseries.deepecho.PAR.fit.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/timeseries/api/sdv.timeseries.deepecho.PAR.get_metadata.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      138 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/timeseries/api/sdv.timeseries.deepecho.PAR.load.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      338 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/timeseries/api/sdv.timeseries.deepecho.PAR.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      144 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/timeseries/api/sdv.timeseries.deepecho.PAR.sample.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      138 2022-06-22 20:44:18.000000 sdv-1.2.0.dev0/docs/api_reference/timeseries/api/sdv.timeseries.deepecho.PAR.save.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      108 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/api_reference/timeseries/index.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      190 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/api_reference/timeseries/par.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     6934 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/docs/conf.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.031874 sdv-1.2.0.dev0/docs/developer_guides/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     8613 2023-06-06 20:45:58.000000 sdv-1.2.0.dev0/docs/developer_guides/contributing.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      364 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/developer_guides/index.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     2905 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/developer_guides/overview.rst
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.032723 sdv-1.2.0.dev0/docs/developer_guides/sdv/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     5889 2022-07-22 02:55:50.000000 sdv-1.2.0.dev0/docs/developer_guides/sdv/constraints.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      292 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/developer_guides/sdv/index.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     7480 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/developer_guides/sdv/metadata.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     9508 2023-02-02 20:58:41.000000 sdv-1.2.0.dev0/docs/developer_guides/sdv/tabular.rst
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.033384 sdv-1.2.0.dev0/docs/getting_started/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      113 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/getting_started/index.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     2557 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/getting_started/install.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     3664 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/getting_started/quickstart.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)       29 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/history.rst
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.044170 sdv-1.2.0.dev0/docs/images/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    52078 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/images/CTGAN-DataCebo.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    50900 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/images/Copulas-DataCebo.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    60600 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/images/DataCebo-Blue.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    54065 2023-04-20 22:38:57.000000 sdv-1.2.0.dev0/docs/images/DataCebo.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    46250 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/images/DeepEcho-DataCebo.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    25573 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/images/RDT-DataCebo.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)   243101 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/docs/images/Real-vs-Synthetic-Evaluation.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    27285 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/images/SDGym-DataCebo.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    35670 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/images/SDMetrics-DataCebo.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    22394 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/images/SDV-DataCebo.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    64162 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/docs/images/SDV-logo.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     8765 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/images/SDV.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)   412158 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/docs/images/Single-Table-Metadata-Example.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    99815 2022-07-22 02:55:50.000000 sdv-1.2.0.dev0/docs/images/custom_constraint.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    50140 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/docs/images/datacebo-logo-dark-mode.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    50481 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/docs/images/datacebo-logo.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      547 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/images/google_colab.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    67403 2022-12-08 23:36:42.000000 sdv-1.2.0.dev0/docs/images/hma1_1.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     8748 2022-12-08 23:36:42.000000 sdv-1.2.0.dev0/docs/images/metadata_1.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    67425 2022-12-08 23:36:42.000000 sdv-1.2.0.dev0/docs/images/metadata_2.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     2497 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/images/mybinder.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    67403 2022-12-08 23:36:42.000000 sdv-1.2.0.dev0/docs/images/quickstart_1.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)   176980 2023-01-24 21:06:49.000000 sdv-1.2.0.dev0/docs/images/rdt_main_tranformation.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     2283 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/images/slack.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     6075 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/docs/index.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      765 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/make.bat
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.045994 sdv-1.2.0.dev0/docs/savefig/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    10974 2022-12-08 23:00:09.000000 sdv-1.2.0.dev0/docs/savefig/copulagan_experience_years_1.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    12668 2022-12-08 23:00:10.000000 sdv-1.2.0.dev0/docs/savefig/copulagan_experience_years_2.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    10277 2022-12-08 23:00:37.000000 sdv-1.2.0.dev0/docs/savefig/copulagan_experience_years_3.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    10974 2022-12-08 23:05:15.000000 sdv-1.2.0.dev0/docs/savefig/experience_years_1.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    10270 2022-12-08 23:05:16.000000 sdv-1.2.0.dev0/docs/savefig/experience_years_2.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    12415 2022-12-08 23:05:16.000000 sdv-1.2.0.dev0/docs/savefig/experience_years_3.png
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:31.937907 sdv-1.2.0.dev0/docs/sdv_theme/
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.046270 sdv-1.2.0.dev0/docs/sdv_theme/static/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     1046 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/sdv_theme/static/slack-32.png
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.046530 sdv-1.2.0.dev0/docs/user_guides/
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.047868 sdv-1.2.0.dev0/docs/user_guides/benchmarking/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     4753 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/user_guides/benchmarking/datasets.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     1885 2023-02-02 20:58:41.000000 sdv-1.2.0.dev0/docs/user_guides/benchmarking/docker.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      563 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/user_guides/benchmarking/index.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     2562 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/user_guides/benchmarking/install.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     7764 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/user_guides/benchmarking/run.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     1731 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/user_guides/benchmarking/synthesizers.rst
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.048659 sdv-1.2.0.dev0/docs/user_guides/evaluation/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     3240 2022-12-21 22:30:23.000000 sdv-1.2.0.dev0/docs/user_guides/evaluation/evaluation_framework.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      504 2022-12-21 22:30:23.000000 sdv-1.2.0.dev0/docs/user_guides/evaluation/index.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      219 2022-12-21 22:30:23.000000 sdv-1.2.0.dev0/docs/user_guides/evaluation/synthetic_data_metrics.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      277 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/user_guides/index.rst
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.049704 sdv-1.2.0.dev0/docs/user_guides/relational/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     2131 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/user_guides/relational/constraints.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      141 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/user_guides/relational/data_description.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     8143 2022-12-21 22:30:23.000000 sdv-1.2.0.dev0/docs/user_guides/relational/hma1.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      177 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/user_guides/relational/index.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)       79 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/user_guides/relational/models.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     6906 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/user_guides/relational/relational_metadata.rst
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.053008 sdv-1.2.0.dev0/docs/user_guides/single_table/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      135 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/user_guides/single_table/constraints.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    24765 2023-02-02 20:58:41.000000 sdv-1.2.0.dev0/docs/user_guides/single_table/copulagan.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    18899 2023-02-02 20:58:41.000000 sdv-1.2.0.dev0/docs/user_guides/single_table/ctgan.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     6108 2022-09-22 23:47:45.000000 sdv-1.2.0.dev0/docs/user_guides/single_table/custom_constraints.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      121 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/user_guides/single_table/data_description.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    20259 2023-02-02 20:58:41.000000 sdv-1.2.0.dev0/docs/user_guides/single_table/gaussian_copula.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    14530 2022-09-22 23:47:45.000000 sdv-1.2.0.dev0/docs/user_guides/single_table/handling_constraints.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      980 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/user_guides/single_table/index.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      510 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/user_guides/single_table/models.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)       65 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/user_guides/single_table/table_metadata.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     8354 2022-07-22 02:55:50.000000 sdv-1.2.0.dev0/docs/user_guides/single_table/tabular_preset.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    18149 2023-02-02 20:58:41.000000 sdv-1.2.0.dev0/docs/user_guides/single_table/tvae.rst
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.053596 sdv-1.2.0.dev0/docs/user_guides/timeseries/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)       92 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/user_guides/timeseries/index.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)       78 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/docs/user_guides/timeseries/models.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    14863 2022-12-21 22:30:23.000000 sdv-1.2.0.dev0/docs/user_guides/timeseries/par.rst
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.054120 sdv-1.2.0.dev0/sdv/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     2988 2023-06-06 20:53:11.000000 sdv-1.2.0.dev0/sdv/__init__.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.055954 sdv-1.2.0.dev0/sdv/constraints/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      542 2023-06-06 20:45:58.000000 sdv-1.2.0.dev0/sdv/constraints/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    18019 2023-04-20 22:38:57.000000 sdv-1.2.0.dev0/sdv/constraints/base.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      799 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/sdv/constraints/errors.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    53574 2023-05-25 15:59:25.000000 sdv-1.2.0.dev0/sdv/constraints/tabular.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     5822 2023-05-25 15:59:25.000000 sdv-1.2.0.dev0/sdv/constraints/utils.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.056898 sdv-1.2.0.dev0/sdv/data_processing/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      132 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/sdv/data_processing/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    34794 2023-06-06 20:45:58.000000 sdv-1.2.0.dev0/sdv/data_processing/data_processor.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     1526 2023-04-20 18:31:25.000000 sdv-1.2.0.dev0/sdv/data_processing/datetime_formatter.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      522 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/sdv/data_processing/errors.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     4010 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/sdv/data_processing/numerical_formatter.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      726 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/sdv/data_processing/utils.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.057368 sdv-1.2.0.dev0/sdv/datasets/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)       43 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/sdv/datasets/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     6625 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/sdv/datasets/demo.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     1117 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/sdv/datasets/local.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      694 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/sdv/errors.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.057848 sdv-1.2.0.dev0/sdv/evaluation/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)       49 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/sdv/evaluation/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     3701 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/sdv/evaluation/multi_table.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     3239 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/sdv/evaluation/single_table.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.058185 sdv-1.2.0.dev0/sdv/lite/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      145 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/sdv/lite/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     7153 2023-05-10 21:10:34.000000 sdv-1.2.0.dev0/sdv/lite/single_table.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.059432 sdv-1.2.0.dev0/sdv/metadata/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      400 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/sdv/metadata/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     3060 2023-05-10 21:10:34.000000 sdv-1.2.0.dev0/sdv/metadata/anonymization.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      238 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/sdv/metadata/errors.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    10362 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/sdv/metadata/metadata_upgrader.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    29106 2023-06-05 19:46:25.000000 sdv-1.2.0.dev0/sdv/metadata/multi_table.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    21941 2023-05-25 15:59:25.000000 sdv-1.2.0.dev0/sdv/metadata/single_table.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      793 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/sdv/metadata/utils.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     2475 2023-04-20 18:31:25.000000 sdv-1.2.0.dev0/sdv/metadata/visualization.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.060195 sdv-1.2.0.dev0/sdv/metrics/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      252 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/sdv/metrics/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      156 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/sdv/metrics/demos.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      188 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/sdv/metrics/relational.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      186 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/sdv/metrics/tabular.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      188 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/sdv/metrics/timeseries.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.060683 sdv-1.2.0.dev0/sdv/multi_table/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      126 2023-06-06 20:45:58.000000 sdv-1.2.0.dev0/sdv/multi_table/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    20699 2023-06-05 19:46:25.000000 sdv-1.2.0.dev0/sdv/multi_table/base.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    23027 2023-06-05 19:46:25.000000 sdv-1.2.0.dev0/sdv/multi_table/hma.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.061267 sdv-1.2.0.dev0/sdv/sampling/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      103 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/sdv/sampling/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     8638 2023-06-01 02:59:19.000000 sdv-1.2.0.dev0/sdv/sampling/hierarchical_sampler.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     5578 2023-06-05 19:46:25.000000 sdv-1.2.0.dev0/sdv/sampling/independent_sampler.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      913 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/sdv/sampling/tabular.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.061603 sdv-1.2.0.dev0/sdv/sequential/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      124 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/sdv/sequential/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    14850 2023-05-10 21:10:34.000000 sdv-1.2.0.dev0/sdv/sequential/par.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.062725 sdv-1.2.0.dev0/sdv/single_table/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      358 2023-06-06 20:45:58.000000 sdv-1.2.0.dev0/sdv/single_table/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    45383 2023-06-01 02:59:19.000000 sdv-1.2.0.dev0/sdv/single_table/base.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    11148 2023-05-10 21:10:34.000000 sdv-1.2.0.dev0/sdv/single_table/copulagan.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    14901 2023-05-10 21:10:34.000000 sdv-1.2.0.dev0/sdv/single_table/copulas.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     9895 2023-05-10 21:10:34.000000 sdv-1.2.0.dev0/sdv/single_table/ctgan.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      341 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/sdv/single_table/errors.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    10141 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/sdv/single_table/utils.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     5800 2023-05-25 15:59:25.000000 sdv-1.2.0.dev0/sdv/utils.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.055097 sdv-1.2.0.dev0/sdv.egg-info/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    78227 2023-06-06 20:53:31.000000 sdv-1.2.0.dev0/sdv.egg-info/PKG-INFO
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    35730 2023-06-06 20:53:31.000000 sdv-1.2.0.dev0/sdv.egg-info/SOURCES.txt
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)        1 2023-06-06 20:53:31.000000 sdv-1.2.0.dev0/sdv.egg-info/dependency_links.txt
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)        1 2023-06-06 20:53:31.000000 sdv-1.2.0.dev0/sdv.egg-info/not-zip-safe
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     1479 2023-06-06 20:53:31.000000 sdv-1.2.0.dev0/sdv.egg-info/requires.txt
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)        4 2023-06-06 20:53:31.000000 sdv-1.2.0.dev0/sdv.egg-info/top_level.txt
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     1233 2023-06-06 20:53:32.074544 sdv-1.2.0.dev0/setup.cfg
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     3853 2023-06-06 20:53:11.000000 sdv-1.2.0.dev0/setup.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.063039 sdv-1.2.0.dev0/tests/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/tests/__init__.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.063320 sdv-1.2.0.dev0/tests/integration/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/tests/integration/__init__.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.063490 sdv-1.2.0.dev0/tests/integration/data_processing/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    12132 2023-05-10 21:10:34.000000 sdv-1.2.0.dev0/tests/integration/data_processing/test_data_processor.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      598 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/tests/integration/dataset.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.063793 sdv-1.2.0.dev0/tests/integration/datasets/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/tests/integration/datasets/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     3324 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/tests/integration/datasets/test_demo.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.064295 sdv-1.2.0.dev0/tests/integration/evaluation/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/tests/integration/evaluation/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     1133 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/tests/integration/evaluation/test_multi_table.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     1131 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/tests/integration/evaluation/test_single_table.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.064608 sdv-1.2.0.dev0/tests/integration/lite/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2022-07-22 02:55:50.000000 sdv-1.2.0.dev0/tests/integration/lite/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     1447 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/tests/integration/lite/test_single_table.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.065240 sdv-1.2.0.dev0/tests/integration/metadata/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/tests/integration/metadata/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      596 2023-05-10 21:10:34.000000 sdv-1.2.0.dev0/tests/integration/metadata/test_anonymization.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     4369 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/tests/integration/metadata/test_multi_table.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     6200 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/tests/integration/metadata/test_single_table.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.065521 sdv-1.2.0.dev0/tests/integration/multi_table/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/tests/integration/multi_table/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    22620 2023-04-20 18:31:25.000000 sdv-1.2.0.dev0/tests/integration/multi_table/test_hma.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.065844 sdv-1.2.0.dev0/tests/integration/sequential/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/tests/integration/sequential/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     6268 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/tests/integration/sequential/test_par.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.066680 sdv-1.2.0.dev0/tests/integration/single_table/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/tests/integration/single_table/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     1769 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/tests/integration/single_table/custom_constraints.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    29336 2023-05-25 15:59:25.000000 sdv-1.2.0.dev0/tests/integration/single_table/test_base.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    12402 2023-06-06 20:45:58.000000 sdv-1.2.0.dev0/tests/integration/single_table/test_copulas.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     2528 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/tests/integration/single_table/test_ctgan.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.066862 sdv-1.2.0.dev0/tests/readme_test/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    13973 2022-08-16 22:57:14.000000 sdv-1.2.0.dev0/tests/readme_test/README.md
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.067630 sdv-1.2.0.dev0/tests/unit/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/tests/unit/__init__.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.068462 sdv-1.2.0.dev0/tests/unit/constraints/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/tests/unit/constraints/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    32384 2023-04-20 22:38:57.000000 sdv-1.2.0.dev0/tests/unit/constraints/test_base.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)   162819 2023-05-25 15:59:25.000000 sdv-1.2.0.dev0/tests/unit/constraints/test_tabular.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     6700 2023-05-25 15:59:25.000000 sdv-1.2.0.dev0/tests/unit/constraints/test_utils.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.069311 sdv-1.2.0.dev0/tests/unit/data_processing/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/tests/unit/data_processing/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    79588 2023-06-06 20:45:58.000000 sdv-1.2.0.dev0/tests/unit/data_processing/test_data_processor.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     2765 2023-04-20 18:31:25.000000 sdv-1.2.0.dev0/tests/unit/data_processing/test_datetime_formatter.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    14718 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/tests/unit/data_processing/test_numerical_formatter.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      926 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/tests/unit/data_processing/test_utils.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.069736 sdv-1.2.0.dev0/tests/unit/datasets/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/tests/unit/datasets/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     9876 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/tests/unit/datasets/test_demo.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     2498 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/tests/unit/datasets/test_local.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.070164 sdv-1.2.0.dev0/tests/unit/evaluation/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     2865 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/tests/unit/evaluation/test_multi_table.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     2533 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/tests/unit/evaluation/test_single_table.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.070512 sdv-1.2.0.dev0/tests/unit/lite/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/tests/unit/lite/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    10135 2023-05-10 21:10:34.000000 sdv-1.2.0.dev0/tests/unit/lite/test_single_table.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.071316 sdv-1.2.0.dev0/tests/unit/metadata/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/tests/unit/metadata/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     5258 2023-05-10 21:10:34.000000 sdv-1.2.0.dev0/tests/unit/metadata/test_anonymization.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    22557 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/tests/unit/metadata/test_metadata_upgrader.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    75538 2023-06-05 19:46:25.000000 sdv-1.2.0.dev0/tests/unit/metadata/test_multi_table.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    66306 2023-05-25 15:59:25.000000 sdv-1.2.0.dev0/tests/unit/metadata/test_single_table.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.071818 sdv-1.2.0.dev0/tests/unit/multi_table/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/tests/unit/multi_table/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    41567 2023-06-05 19:46:25.000000 sdv-1.2.0.dev0/tests/unit/multi_table/test_base.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    28011 2023-06-05 19:46:25.000000 sdv-1.2.0.dev0/tests/unit/multi_table/test_hma.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.072430 sdv-1.2.0.dev0/tests/unit/sampling/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2022-07-22 02:55:50.000000 sdv-1.2.0.dev0/tests/unit/sampling/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    13830 2023-06-01 02:59:19.000000 sdv-1.2.0.dev0/tests/unit/sampling/test_hierarchical_sampler.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    11155 2023-06-05 19:46:25.000000 sdv-1.2.0.dev0/tests/unit/sampling/test_independent_sampler.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     2140 2022-06-21 19:18:25.000000 sdv-1.2.0.dev0/tests/unit/sampling/test_tabular.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.072714 sdv-1.2.0.dev0/tests/unit/sequential/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)       50 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/tests/unit/sequential/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    29331 2023-05-10 21:10:34.000000 sdv-1.2.0.dev0/tests/unit/sequential/test_par.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-06-06 20:53:32.073626 sdv-1.2.0.dev0/tests/unit/single_table/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/tests/unit/single_table/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    77568 2023-06-01 02:59:19.000000 sdv-1.2.0.dev0/tests/unit/single_table/test_base.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    13777 2023-05-10 21:10:34.000000 sdv-1.2.0.dev0/tests/unit/single_table/test_copulagan.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    18091 2023-05-10 21:10:34.000000 sdv-1.2.0.dev0/tests/unit/single_table/test_copulas.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    10328 2023-05-10 21:10:34.000000 sdv-1.2.0.dev0/tests/unit/single_table/test_ctgan.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     8358 2023-03-28 20:22:54.000000 sdv-1.2.0.dev0/tests/unit/single_table/test_utils.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     4604 2023-06-06 20:45:58.000000 sdv-1.2.0.dev0/tests/unit/test___init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     5572 2023-05-25 15:59:25.000000 sdv-1.2.0.dev0/tests/unit/test_utils.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     3051 2023-05-10 21:10:34.000000 sdv-1.2.0.dev0/tests/utils.py
```

### Comparing `sdv-1.1.0.dev0/CONTRIBUTING.rst` & `sdv-1.2.0.dev0/CONTRIBUTING.rst`

 * *Files 4% similar despite different names*

```diff
@@ -115,20 +115,19 @@
 
 Before you submit a pull request, check that it meets these guidelines:
 
 1. It resolves an open GitHub Issue and contains its reference in the title or
    the comment. If there is no associated issue, feel free to create one.
 2. Whenever possible, it resolves only **one** issue. If your PR resolves more than
    one issue, try to split it in more than one pull request.
-3. The pull request should include unit tests that cover all the changed code
+3. The pull request should include unit tests that cover all the changed code.
 4. If the pull request adds functionality, the docs should be updated. Put
    your new functionality into a function with a docstring, and add the
    feature to the documentation in an appropriate place.
-5. The pull request should work for all the supported Python versions. Check the `Travis Build
-   Status page`_ and make sure that all the checks pass.
+5. The pull request should work for all the supported Python versions.
 
 Unit Testing Guidelines
 -----------------------
 
 All the Unit Tests should comply with the following requirements:
 
 1. Unit Tests should be based only in unittest and pytest modules.
@@ -229,9 +228,8 @@
 
 or in command line::
 
     pip install 'sdv>=X.Y.Z.dev'
 
 
 .. _GitHub issues page: https://github.com/sdv-dev/SDV/issues
-.. _Travis Build Status page: https://travis-ci.org/sdv-dev/SDV/pull_requests
 .. _Google docstrings style: https://google.github.io/styleguide/pyguide.html?showone=Comments#Comments
```

### Comparing `sdv-1.1.0.dev0/HISTORY.md` & `sdv-1.2.0.dev0/HISTORY.md`

 * *Files 0% similar despite different names*

```diff
@@ -1,9 +1,39 @@
 # Release Notes
 
+## 1.1.0 - 2023-05-10
+
+This release adds a new initialization parameter to synthesizers called `locales` that allows users to set the locales to use for all columns that have a locale based `sdtype` (eg. `address` or `phone_number`). Additionally, it adds support for Pandas 2.0!
+
+Multiple enhancements were made to improve the performance of data and metadata validation in synthesizers. The `Inequality` constraint was improved to be able to generate more scenarios of data concerning the presence of NaNs. Finally, many warnings have been resolved.
+
+### New Features
+
+* Add add-on detection for new constraints - Issue [#1397](https://github.com/sdv-dev/SDV/issues/1397) by @frances-h
+* Add add-on detection for multi and single table synthesizers - Issue [#1385](https://github.com/sdv-dev/SDV/issues/1385) by @frances-h
+* Setting a locale for all my anonymized (PII) columns - Issue [#1371](https://github.com/sdv-dev/SDV/issues/1371) by @frances-h
+
+### Bigs Fixed
+
+* Skip checking for Faker function if its a default sdtype - PR [#1410](https://github.com/sdv-dev/SDV/pull/1410) by @pvk-developer
+* Inequality constraint does not produce all possibilities of missing values - Issue [#1392](https://github.com/sdv-dev/SDV/issues/1392) by @R-Palazzo
+* Deprecated locale warning - Issue [#1400](https://github.com/sdv-dev/SDV/issues/1400) by @frances-h
+
+### Maintenance
+
+* Use cached Faker instance to discover if an sdtype is a Faker function. - Issue [#1405](https://github.com/sdv-dev/SDV/issues/1405) by @pvk-developer
+* Upgrade to pandas 2.0 - Issue [#1366](https://github.com/sdv-dev/SDV/issues/1366) by @pvk-developer
+
+### Internal
+
+* Refactor Multi Table Modeling - Issue [#1387](https://github.com/sdv-dev/SDV/issues/1387) by @pvk-developer
+* PytestConfigWarning: Unknown config option: collect_ignore - Issue [#1376](https://github.com/sdv-dev/SDV/issues/1376) by @amontanez24
+* Pandas FutureWarning: Could not cast to int64 - Issue [#1357](https://github.com/sdv-dev/SDV/issues/1357) by @R-Palazzo
+* RuntimeWarning: invalid value encountered in cast. - Issue [#1369](https://github.com/sdv-dev/SDV/issues/1369) by @amontanez24
+
 ## 1.0.1 - 2023-04-20
 
 This release improves the `load_custom_constraint_classes` method by removing the `table_name` parameter and just loading the constraint
 for all tables instead. It also improves some error messages as well as removes some of the warnings that have been surfacing.
 
 Support for sdtypes is enhanced by resolving a bug that was incorrecttly specifying Faker functions for some of them. Support for datetime formats has also been improved. Finally, the `path` argument in some `save` and `load` methods was changed to `filepath` for consistency.
```

### Comparing `sdv-1.1.0.dev0/LICENSE` & `sdv-1.2.0.dev0/LICENSE`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/PKG-INFO` & `sdv-1.2.0.dev0/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: sdv
-Version: 1.1.0.dev0
+Version: 1.2.0.dev0
 Summary: Generate synthetic data for single table, multi table and sequential data
 Home-page: https://github.com/sdv-dev/SDV
 Author: DataCebo, Inc.
 Author-email: info@sdv.dev
 License: BSL-1.1
 Keywords: sdv synthetic-data synhtetic-data-generation timeseries single-table multi-table
 Classifier: Development Status :: 5 - Production/Stable
@@ -242,14 +242,44 @@
 [Get started using the SDV package](https://bit.ly/sdv-docs) -- a fully
 integrated solution and your one-stop shop for synthetic data. Or, use the standalone libraries
 for specific needs.
 
 
 # Release Notes
 
+## 1.1.0 - 2023-05-10
+
+This release adds a new initialization parameter to synthesizers called `locales` that allows users to set the locales to use for all columns that have a locale based `sdtype` (eg. `address` or `phone_number`). Additionally, it adds support for Pandas 2.0!
+
+Multiple enhancements were made to improve the performance of data and metadata validation in synthesizers. The `Inequality` constraint was improved to be able to generate more scenarios of data concerning the presence of NaNs. Finally, many warnings have been resolved.
+
+### New Features
+
+* Add add-on detection for new constraints - Issue [#1397](https://github.com/sdv-dev/SDV/issues/1397) by @frances-h
+* Add add-on detection for multi and single table synthesizers - Issue [#1385](https://github.com/sdv-dev/SDV/issues/1385) by @frances-h
+* Setting a locale for all my anonymized (PII) columns - Issue [#1371](https://github.com/sdv-dev/SDV/issues/1371) by @frances-h
+
+### Bigs Fixed
+
+* Skip checking for Faker function if its a default sdtype - PR [#1410](https://github.com/sdv-dev/SDV/pull/1410) by @pvk-developer
+* Inequality constraint does not produce all possibilities of missing values - Issue [#1392](https://github.com/sdv-dev/SDV/issues/1392) by @R-Palazzo
+* Deprecated locale warning - Issue [#1400](https://github.com/sdv-dev/SDV/issues/1400) by @frances-h
+
+### Maintenance
+
+* Use cached Faker instance to discover if an sdtype is a Faker function. - Issue [#1405](https://github.com/sdv-dev/SDV/issues/1405) by @pvk-developer
+* Upgrade to pandas 2.0 - Issue [#1366](https://github.com/sdv-dev/SDV/issues/1366) by @pvk-developer
+
+### Internal
+
+* Refactor Multi Table Modeling - Issue [#1387](https://github.com/sdv-dev/SDV/issues/1387) by @pvk-developer
+* PytestConfigWarning: Unknown config option: collect_ignore - Issue [#1376](https://github.com/sdv-dev/SDV/issues/1376) by @amontanez24
+* Pandas FutureWarning: Could not cast to int64 - Issue [#1357](https://github.com/sdv-dev/SDV/issues/1357) by @R-Palazzo
+* RuntimeWarning: invalid value encountered in cast. - Issue [#1369](https://github.com/sdv-dev/SDV/issues/1369) by @amontanez24
+
 ## 1.0.1 - 2023-04-20
 
 This release improves the `load_custom_constraint_classes` method by removing the `table_name` parameter and just loading the constraint
 for all tables instead. It also improves some error messages as well as removes some of the warnings that have been surfacing.
 
 Support for sdtypes is enhanced by resolving a bug that was incorrecttly specifying Faker functions for some of them. Support for datetime formats has also been improved. Finally, the `path` argument in some `save` and `load` methods was changed to `filepath` for consistency.
```

#### html2text {}

```diff
@@ -1,8 +1,8 @@
-Metadata-Version: 2.1 Name: sdv Version: 1.1.0.dev0 Summary: Generate synthetic
+Metadata-Version: 2.1 Name: sdv Version: 1.2.0.dev0 Summary: Generate synthetic
 data for single table, multi table and sequential data Home-page: https://
 github.com/sdv-dev/SDV Author: DataCebo, Inc. Author-email: info@sdv.dev
 License: BSL-1.1 Keywords: sdv synthetic-data synhtetic-data-generation
 timeseries single-table multi-table Classifier: Development Status :: 5 -
 Production/Stable Classifier: Intended Audience :: Developers Classifier:
 License :: Free for non-commercial use Classifier: Natural Language :: English
 Classifier: Programming Language :: Python :: 3 Classifier: Programming
@@ -131,15 +131,43 @@
 including: *  Data discovery & transformation. Reverse the transforms to
 reproduce realistic data. *  Multiple machine learning models -- ranging
 from Copulas to Deep Learning -- to create tabular, multi table and time series
 data. *  Measuring quality and privacy of synthetic data, and comparing
 different synthetic data generation models. [Get started using the SDV package]
 (https://bit.ly/sdv-docs) -- a fully integrated solution and your one-stop shop
 for synthetic data. Or, use the standalone libraries for specific needs. #
-Release Notes ## 1.0.1 - 2023-04-20 This release improves the
+Release Notes ## 1.1.0 - 2023-05-10 This release adds a new initialization
+parameter to synthesizers called `locales` that allows users to set the locales
+to use for all columns that have a locale based `sdtype` (eg. `address` or
+`phone_number`). Additionally, it adds support for Pandas 2.0! Multiple
+enhancements were made to improve the performance of data and metadata
+validation in synthesizers. The `Inequality` constraint was improved to be able
+to generate more scenarios of data concerning the presence of NaNs. Finally,
+many warnings have been resolved. ### New Features * Add add-on detection for
+new constraints - Issue [#1397](https://github.com/sdv-dev/SDV/issues/1397) by
+@frances-h * Add add-on detection for multi and single table synthesizers -
+Issue [#1385](https://github.com/sdv-dev/SDV/issues/1385) by @frances-h *
+Setting a locale for all my anonymized (PII) columns - Issue [#1371](https://
+github.com/sdv-dev/SDV/issues/1371) by @frances-h ### Bigs Fixed * Skip
+checking for Faker function if its a default sdtype - PR [#1410](https://
+github.com/sdv-dev/SDV/pull/1410) by @pvk-developer * Inequality constraint
+does not produce all possibilities of missing values - Issue [#1392](https://
+github.com/sdv-dev/SDV/issues/1392) by @R-Palazzo * Deprecated locale warning -
+Issue [#1400](https://github.com/sdv-dev/SDV/issues/1400) by @frances-h ###
+Maintenance * Use cached Faker instance to discover if an sdtype is a Faker
+function. - Issue [#1405](https://github.com/sdv-dev/SDV/issues/1405) by @pvk-
+developer * Upgrade to pandas 2.0 - Issue [#1366](https://github.com/sdv-dev/
+SDV/issues/1366) by @pvk-developer ### Internal * Refactor Multi Table Modeling
+- Issue [#1387](https://github.com/sdv-dev/SDV/issues/1387) by @pvk-developer *
+PytestConfigWarning: Unknown config option: collect_ignore - Issue [#1376]
+(https://github.com/sdv-dev/SDV/issues/1376) by @amontanez24 * Pandas
+FutureWarning: Could not cast to int64 - Issue [#1357](https://github.com/sdv-
+dev/SDV/issues/1357) by @R-Palazzo * RuntimeWarning: invalid value encountered
+in cast. - Issue [#1369](https://github.com/sdv-dev/SDV/issues/1369) by
+@amontanez24 ## 1.0.1 - 2023-04-20 This release improves the
 `load_custom_constraint_classes` method by removing the `table_name` parameter
 and just loading the constraint for all tables instead. It also improves some
 error messages as well as removes some of the warnings that have been
 surfacing. Support for sdtypes is enhanced by resolving a bug that was
 incorrecttly specifying Faker functions for some of them. Support for datetime
 formats has also been improved. Finally, the `path` argument in some `save` and
 `load` methods was changed to `filepath` for consistency. ### New Features *
```

### Comparing `sdv-1.1.0.dev0/README.md` & `sdv-1.2.0.dev0/README.md`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/Makefile` & `sdv-1.2.0.dev0/docs/Makefile`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Constraint.rst` & `sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Constraint.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.CustomConstraint.rst` & `sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.CustomConstraint.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.FixedCombinations.rst` & `sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.FixedCombinations.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Inequality.rst` & `sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Inequality.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Negative.rst` & `sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Negative.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.OneHotEncoding.rst` & `sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.OneHotEncoding.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Positive.rst` & `sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Positive.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarInequality.rst` & `sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarInequality.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarRange.rst` & `sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarRange.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Unique.rst` & `sdv-1.2.0.dev0/docs/api_reference/constraints/api/sdv.constraints.Unique.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/constraints/tabular.rst` & `sdv-1.2.0.dev0/docs/api_reference/constraints/tabular.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.rst` & `sdv-1.2.0.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metadata/api/sdv.metadata.table.Table.rst` & `sdv-1.2.0.dev0/docs/api_reference/metadata/api/sdv.metadata.table.Table.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metadata/dataset.rst` & `sdv-1.2.0.dev0/docs/api_reference/metadata/dataset.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metadata/table.rst` & `sdv-1.2.0.dev0/docs/api_reference/metadata/table.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.BNLikelihood.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.BNLikelihood.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.BNLogLikelihood.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.BNLogLikelihood.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.DetectionMetric.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.DetectionMetric.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.KSComplement.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.KSComplement.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.KSTest.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.KSTest.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.LogisticDetection.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.LogisticDetection.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.LogisticParentChildDetection.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.LogisticParentChildDetection.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.MultiSingleTableMetric.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.MultiSingleTableMetric.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.MultiTableMetric.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.MultiTableMetric.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.ParentChildDetectionMetric.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.ParentChildDetectionMetric.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.SVCDetection.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.SVCDetection.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.SVCParentChildDetection.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.SVCParentChildDetection.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BNLikelihood.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BNLikelihood.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BNLogLikelihood.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BNLogLikelihood.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryAdaBoostClassifier.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryAdaBoostClassifier.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryDecisionTreeClassifier.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryDecisionTreeClassifier.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryEfficacyMetric.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryEfficacyMetric.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryLogisticRegression.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryLogisticRegression.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryMLPClassifier.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryMLPClassifier.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CSTest.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CSTest.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalCAP.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalCAP.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalEnsemble.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalEnsemble.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalGeneralizedCAP.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalGeneralizedCAP.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalKNN.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalKNN.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalNB.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalNB.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalPrivacyMetric.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalPrivacyMetric.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalRF.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalRF.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalSVM.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalSVM.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalZeroCAP.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalZeroCAP.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.ContinuousKLDivergence.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.ContinuousKLDivergence.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.DetectionMetric.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.DetectionMetric.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.DiscreteKLDivergence.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.DiscreteKLDivergence.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.GMLogLikelihood.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.GMLogLikelihood.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.KSComplement.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.KSComplement.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.KSTest.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.KSTest.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.LinearRegression.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.LinearRegression.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.LogisticDetection.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.LogisticDetection.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MLEfficacyMetric.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MLEfficacyMetric.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MLPRegressor.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MLPRegressor.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MultiColumnPairsMetric.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MultiColumnPairsMetric.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MultiSingleColumnMetric.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MultiSingleColumnMetric.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MulticlassDecisionTreeClassifier.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MulticlassDecisionTreeClassifier.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MulticlassEfficacyMetric.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MulticlassEfficacyMetric.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MulticlassMLPClassifier.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MulticlassMLPClassifier.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalLR.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalLR.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalMLP.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalMLP.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalPrivacyMetric.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalPrivacyMetric.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalRadiusNearestNeighbor.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalRadiusNearestNeighbor.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalSVR.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalSVR.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.RegressionEfficacyMetric.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.RegressionEfficacyMetric.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.SVCDetection.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.SVCDetection.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.ScikitLearnClassifierDetectionMetric.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.ScikitLearnClassifierDetectionMetric.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.SingleTableMetric.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.SingleTableMetric.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.timeseries.LSTMClassifierEfficacy.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.timeseries.LSTMClassifierEfficacy.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.timeseries.LSTMDetection.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.timeseries.LSTMDetection.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.timeseries.TimeSeriesDetectionMetric.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.timeseries.TimeSeriesDetectionMetric.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.timeseries.TimeSeriesEfficacyMetric.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.timeseries.TimeSeriesEfficacyMetric.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/api/sdv.metrics.timeseries.TimeSeriesMetric.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/api/sdv.metrics.timeseries.TimeSeriesMetric.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/relational.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/relational.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/tabular.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/tabular.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/metrics/timeseries.rst` & `sdv-1.2.0.dev0/docs/api_reference/metrics/timeseries.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/tabular/api/sdv.tabular.copulagan.CopulaGAN.rst` & `sdv-1.2.0.dev0/docs/api_reference/tabular/api/sdv.tabular.copulagan.CopulaGAN.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.rst` & `sdv-1.2.0.dev0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/conf.py` & `sdv-1.2.0.dev0/docs/conf.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/developer_guides/contributing.rst` & `sdv-1.2.0.dev0/docs/developer_guides/contributing.rst`

 * *Files 2% similar despite different names*

```diff
@@ -112,20 +112,19 @@
 
 Before you submit a pull request, check that it meets these guidelines:
 
 1. It resolves an open GitHub Issue and contains its reference in the title or
    the comment. If there is no associated issue, feel free to create one.
 2. Whenever possible, it resolves only **one** issue. If your PR resolves more than
    one issue, try to split it in more than one pull request.
-3. The pull request should include unit tests that cover all the changed code
+3. The pull request should include unit tests that cover all the changed code.
 4. If the pull request adds functionality, the docs should be updated. Put
    your new functionality into a function with a docstring, and add the
    feature to the documentation in an appropriate place.
-5. The pull request should work for all the supported Python versions. Check the `Travis Build
-   Status page`_ and make sure that all the checks pass.
+5. The pull request should work for all the supported Python versions.
 
 Unit Testing Guidelines
 -----------------------
 
 All the Unit Tests should comply with the following requirements:
 
 1. Unit Tests should be based only in unittest and pytest modules.
@@ -226,9 +225,8 @@
 
 or in command line::
 
     pip install 'sdv>=X.Y.Z.dev'
 
 
 .. _GitHub issues page: https://github.com/sdv-dev/SDV/issues
-.. _Travis Build Status page: https://travis-ci.org/sdv-dev/SDV/pull_requests
 .. _Google docstrings style: https://google.github.io/styleguide/pyguide.html?showone=Comments#Comments
```

### Comparing `sdv-1.1.0.dev0/docs/developer_guides/overview.rst` & `sdv-1.2.0.dev0/docs/developer_guides/overview.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/developer_guides/sdv/constraints.rst` & `sdv-1.2.0.dev0/docs/developer_guides/sdv/constraints.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/developer_guides/sdv/metadata.rst` & `sdv-1.2.0.dev0/docs/developer_guides/sdv/metadata.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/developer_guides/sdv/tabular.rst` & `sdv-1.2.0.dev0/docs/developer_guides/sdv/tabular.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/getting_started/install.rst` & `sdv-1.2.0.dev0/docs/getting_started/install.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/getting_started/quickstart.rst` & `sdv-1.2.0.dev0/docs/getting_started/quickstart.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/images/CTGAN-DataCebo.png` & `sdv-1.2.0.dev0/docs/images/CTGAN-DataCebo.png`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/images/Copulas-DataCebo.png` & `sdv-1.2.0.dev0/docs/images/Copulas-DataCebo.png`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/images/DataCebo-Blue.png` & `sdv-1.2.0.dev0/docs/images/DataCebo-Blue.png`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/images/DataCebo.png` & `sdv-1.2.0.dev0/docs/images/DataCebo.png`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/images/DeepEcho-DataCebo.png` & `sdv-1.2.0.dev0/docs/images/DeepEcho-DataCebo.png`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/images/RDT-DataCebo.png` & `sdv-1.2.0.dev0/docs/images/RDT-DataCebo.png`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/images/Real-vs-Synthetic-Evaluation.png` & `sdv-1.2.0.dev0/docs/images/Real-vs-Synthetic-Evaluation.png`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/images/SDGym-DataCebo.png` & `sdv-1.2.0.dev0/docs/images/SDGym-DataCebo.png`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/images/SDMetrics-DataCebo.png` & `sdv-1.2.0.dev0/docs/images/SDMetrics-DataCebo.png`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/images/SDV-DataCebo.png` & `sdv-1.2.0.dev0/docs/images/SDV-DataCebo.png`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/images/SDV-logo.png` & `sdv-1.2.0.dev0/docs/images/SDV-logo.png`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/images/SDV.png` & `sdv-1.2.0.dev0/docs/images/SDV.png`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/images/Single-Table-Metadata-Example.png` & `sdv-1.2.0.dev0/docs/images/Single-Table-Metadata-Example.png`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/images/custom_constraint.png` & `sdv-1.2.0.dev0/docs/images/custom_constraint.png`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/images/datacebo-logo-dark-mode.png` & `sdv-1.2.0.dev0/docs/images/datacebo-logo-dark-mode.png`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/images/datacebo-logo.png` & `sdv-1.2.0.dev0/docs/images/datacebo-logo.png`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/images/google_colab.png` & `sdv-1.2.0.dev0/docs/images/google_colab.png`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/images/hma1_1.png` & `sdv-1.2.0.dev0/docs/images/hma1_1.png`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/images/metadata_1.png` & `sdv-1.2.0.dev0/docs/images/metadata_1.png`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/images/metadata_2.png` & `sdv-1.2.0.dev0/docs/images/metadata_2.png`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/images/mybinder.png` & `sdv-1.2.0.dev0/docs/images/mybinder.png`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/images/quickstart_1.png` & `sdv-1.2.0.dev0/docs/images/quickstart_1.png`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/images/rdt_main_tranformation.png` & `sdv-1.2.0.dev0/docs/images/rdt_main_tranformation.png`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/images/slack.png` & `sdv-1.2.0.dev0/docs/images/slack.png`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/index.rst` & `sdv-1.2.0.dev0/docs/index.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/make.bat` & `sdv-1.2.0.dev0/docs/make.bat`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/savefig/copulagan_experience_years_1.png` & `sdv-1.2.0.dev0/docs/savefig/copulagan_experience_years_1.png`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/savefig/copulagan_experience_years_2.png` & `sdv-1.2.0.dev0/docs/savefig/copulagan_experience_years_2.png`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/savefig/copulagan_experience_years_3.png` & `sdv-1.2.0.dev0/docs/savefig/copulagan_experience_years_3.png`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/savefig/experience_years_1.png` & `sdv-1.2.0.dev0/docs/savefig/experience_years_1.png`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/savefig/experience_years_2.png` & `sdv-1.2.0.dev0/docs/savefig/experience_years_2.png`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/savefig/experience_years_3.png` & `sdv-1.2.0.dev0/docs/savefig/experience_years_3.png`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/sdv_theme/static/slack-32.png` & `sdv-1.2.0.dev0/docs/sdv_theme/static/slack-32.png`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/user_guides/benchmarking/datasets.rst` & `sdv-1.2.0.dev0/docs/user_guides/benchmarking/datasets.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/user_guides/benchmarking/docker.rst` & `sdv-1.2.0.dev0/docs/user_guides/benchmarking/docker.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/user_guides/benchmarking/index.rst` & `sdv-1.2.0.dev0/docs/user_guides/benchmarking/index.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/user_guides/benchmarking/install.rst` & `sdv-1.2.0.dev0/docs/user_guides/benchmarking/install.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/user_guides/benchmarking/run.rst` & `sdv-1.2.0.dev0/docs/user_guides/benchmarking/run.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/user_guides/benchmarking/synthesizers.rst` & `sdv-1.2.0.dev0/docs/user_guides/benchmarking/synthesizers.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/user_guides/evaluation/evaluation_framework.rst` & `sdv-1.2.0.dev0/docs/user_guides/evaluation/evaluation_framework.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/user_guides/relational/constraints.rst` & `sdv-1.2.0.dev0/docs/user_guides/relational/constraints.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/user_guides/relational/hma1.rst` & `sdv-1.2.0.dev0/docs/user_guides/relational/hma1.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/user_guides/relational/relational_metadata.rst` & `sdv-1.2.0.dev0/docs/user_guides/relational/relational_metadata.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/user_guides/single_table/copulagan.rst` & `sdv-1.2.0.dev0/docs/user_guides/single_table/copulagan.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/user_guides/single_table/ctgan.rst` & `sdv-1.2.0.dev0/docs/user_guides/single_table/ctgan.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/user_guides/single_table/custom_constraints.rst` & `sdv-1.2.0.dev0/docs/user_guides/single_table/custom_constraints.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/user_guides/single_table/gaussian_copula.rst` & `sdv-1.2.0.dev0/docs/user_guides/single_table/gaussian_copula.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/user_guides/single_table/handling_constraints.rst` & `sdv-1.2.0.dev0/docs/user_guides/single_table/handling_constraints.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/user_guides/single_table/index.rst` & `sdv-1.2.0.dev0/docs/user_guides/single_table/index.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/user_guides/single_table/tabular_preset.rst` & `sdv-1.2.0.dev0/docs/user_guides/single_table/tabular_preset.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/user_guides/single_table/tvae.rst` & `sdv-1.2.0.dev0/docs/user_guides/single_table/tvae.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/docs/user_guides/timeseries/par.rst` & `sdv-1.2.0.dev0/docs/user_guides/timeseries/par.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/sdv/constraints/__init__.py` & `sdv-1.2.0.dev0/sdv/constraints/__init__.py`

 * *Files 20% similar despite different names*

```diff
@@ -1,9 +1,8 @@
 """SDV Constraints module."""
-from sdv._addons import _find_addons
 from sdv.constraints.base import Constraint
 from sdv.constraints.tabular import (
     FixedCombinations, FixedIncrements, Inequality, Negative, OneHotEncoding, Positive, Range,
     ScalarInequality, ScalarRange, Unique, create_custom_constraint_class)
 
 __all__ = [
     'create_custom_constraint_class',
@@ -15,9 +14,7 @@
     'Range',
     'ScalarRange',
     'Negative',
     'Positive',
     'OneHotEncoding',
     'Unique'
 ]
-
-_find_addons('sdv.constraints_modules', globals(), add_all=True)
```

### Comparing `sdv-1.1.0.dev0/sdv/constraints/base.py` & `sdv-1.2.0.dev0/sdv/constraints/base.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/sdv/constraints/errors.py` & `sdv-1.2.0.dev0/sdv/constraints/errors.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/sdv/constraints/tabular.py` & `sdv-1.2.0.dev0/sdv/constraints/tabular.py`

 * *Files 5% similar despite different names*

```diff
@@ -36,17 +36,17 @@
 import numpy as np
 import pandas as pd
 
 from sdv.constraints.base import Constraint
 from sdv.constraints.errors import (
     AggregateConstraintsError, ConstraintMetadataError, FunctionError, InvalidFunctionError)
 from sdv.constraints.utils import (
-    cast_to_datetime64, compute_nans_column, logit, matches_datetime_format, revert_nans_columns,
-    sigmoid)
-from sdv.utils import convert_to_timedelta, is_datetime_type
+    cast_to_datetime64, compute_nans_column, get_datetime_diff, logit, matches_datetime_format,
+    revert_nans_columns, sigmoid)
+from sdv.utils import convert_to_timedelta, create_unique_name, is_datetime_type
 
 INEQUALITY_TO_OPERATION = {
     '>': np.greater,
     '>=': np.greater_equal,
     '<': np.less,
     '<=': np.less_equal
 }
@@ -454,40 +454,14 @@
         if self._is_datetime and self._dtype == 'O':
             low = cast_to_datetime64(low)
             high = cast_to_datetime64(high)
 
         valid = np.isnan(low) | np.isnan(high) | self._operator(high, low)
         return valid
 
-    def _get_datetime_diff(self, high, low):
-        """Calculate the difference between two datetime columns.
-
-        When casting datetimes to float using ``astype``, NaT values are not automatically
-        converted to NaN values. This method calculates the difference between the high
-        and low column values, preserving missing values as NaNs.
-
-        Args:
-            high (numpy.ndarray):
-                The high column values.
-            low (numpy.ndarray):
-                The low column values.
-
-        Returns:
-            numpy.ndarray:
-                The difference between the high and low column values.
-        """
-        if self._dtype == 'O':
-            low = cast_to_datetime64(low)
-            high = cast_to_datetime64(high)
-        diff_column = high - low
-        nan_mask = np.isnan(diff_column)
-        diff_column = diff_column.astype(np.float64)
-        diff_column[nan_mask] = np.nan
-        return diff_column
-
     def _transform(self, table_data):
         """Transform the table data.
 
         The transformation consists on replacing the ``high_column_name`` values with the
         difference between it and the ``low_column_name`` values.
 
         Afterwards, a logarithm is applied to the difference + 1 to ensure that the
@@ -499,23 +473,24 @@
 
         Returns:
             pandas.DataFrame:
                 Transformed data.
         """
         low, high = self._get_data(table_data)
         if self._is_datetime:
-            diff_column = self._get_datetime_diff(high, low)
+            diff_column = get_datetime_diff(high, low)
         else:
             diff_column = high - low
 
+        self._diff_column_name = create_unique_name(self._diff_column_name, table_data.columns)
         table_data[self._diff_column_name] = np.log(diff_column + 1)
 
         nan_col = compute_nans_column(table_data, [self._low_column_name, self._high_column_name])
         if nan_col is not None:
-            self._nan_column_name = nan_col.name
+            self._nan_column_name = create_unique_name(nan_col.name, table_data.columns)
             table_data[self._nan_column_name] = nan_col
             if self._is_datetime:
                 mean_value_low = table_data[self._low_column_name].mode()[0]
             else:
                 mean_value_low = table_data[self._low_column_name].mean()
             table_data = table_data.fillna({
                 self._low_column_name: mean_value_low,
@@ -706,14 +681,15 @@
                 Transformed data.
         """
         column = table_data[self._column_name].to_numpy()
         diff_column = abs(column - self._value)
         if self._is_datetime:
             diff_column = diff_column.astype(np.float64)
 
+        self._diff_column_name = create_unique_name(self._diff_column_name, table_data.columns)
         table_data[self._diff_column_name] = np.log(diff_column + 1)
         return table_data.drop(self._column_name, axis=1)
 
     def _reverse_transform(self, table_data):
         """Reverse transform the table data.
 
         The transformation is reversed by computing an exponential of the difference value,
@@ -802,17 +778,20 @@
         relation = '<' if strict_boundaries else '<='
         super().__init__(column_name=column_name, relation=relation, value=0)
 
 
 class Range(Constraint):
     """Ensure that the ``middle_column_name`` is between ``low`` and ``high`` columns.
 
-    The transformation strategy works by replacing the ``middle_column_name`` with a
-    scaled version and then applying a logit function. The reverse transform
-    applies a sigmoid to the data and then scales it back to the original space.
+    The transformation strategy works the same as the Inequality constraint but with two
+    columns instead of one. We compute the difference between the ``middle_column_name``
+    and the ``low`` column and then apply a logarithm to the difference + 1 to ensure
+    that the value stays positive when reverted afterwards using an exponential.
+    We do the same for the difference between the ``high`` and ``middle_column_name``.
+
 
     Args:
         low_column_name (str):
             Name of the column which will be the lower bound.
         middle_column_name (str):
             Name of the column that has to be between the lower bound and upper bound.
         high_column_name (str):
@@ -851,26 +830,20 @@
     def __init__(self, low_column_name, middle_column_name, high_column_name,
                  strict_boundaries=True):
 
         self.constraint_columns = (low_column_name, middle_column_name, high_column_name)
         self.low_column_name = low_column_name
         self.middle_column_name = middle_column_name
         self.high_column_name = high_column_name
+        self.nan_column_name = None
+        self._is_datetime = None
+        self._dtype = None
         self.strict_boundaries = strict_boundaries
         self._operator = operator.lt if strict_boundaries else operator.le
 
-    def _get_diff_column_name(self, table_data):
-        token = '#'
-        columns = [self.middle_column_name, self.low_column_name, self.high_column_name]
-        components = list(map(str, columns))
-        while token.join(components) in table_data.columns:
-            token += '#'
-
-        return token.join(components)
-
     def _get_is_datetime(self, table_data):
         low = table_data[self.low_column_name]
         middle = table_data[self.middle_column_name]
         high = table_data[self.high_column_name]
 
         is_low_datetime = is_datetime_type(low)
         is_middle_datetime = is_datetime_type(middle)
@@ -881,108 +854,141 @@
             raise ValueError('The constraint column and bounds must all be datetime.')
 
         return is_datetime
 
     def _fit(self, table_data):
         """Fit the constraint.
 
-        The fit process consists in generating the ``transformed_column`` name and determine
-        whether or not the data is ``UnixTimestampEncoder``.
-
         Args:
             table_data (pandas.DataFrame):
                 The Table data.
         """
         self._dtype = table_data[self.middle_column_name].dtypes
-        self._transformed_column = self._get_diff_column_name(table_data)
         self._is_datetime = self._get_is_datetime(table_data)
 
+        self.low_diff_column_name = f'{self.low_column_name}#{self.middle_column_name}'
+        self.high_diff_column_name = f'{self.middle_column_name}#{self.high_column_name}'
+        self.low_diff_column_name = create_unique_name(
+            self.low_diff_column_name, table_data.columns
+        )
+        self.high_diff_column_name = create_unique_name(
+            self.high_diff_column_name, table_data.columns
+        )
+
     def is_valid(self, table_data):
-        """Say whether the ``constraint_column`` is between the ``low`` and ``high`` values.
+        """Say whether the ``middle`` column is between the ``low`` and ``high`` columns.
 
         Args:
             table_data (pandas.DataFrame):
                 Table data.
 
         Returns:
             pandas.Series:
                 Whether each row is valid.
         """
         low = table_data[self.low_column_name]
         middle = table_data[self.middle_column_name]
         high = table_data[self.high_column_name]
 
-        satisfy_low_bound = np.logical_or(
-            self._operator(low, middle),
-            np.isnan(low),
-        )
-        satisfy_high_bound = np.logical_or(
-            self._operator(middle, high),
-            np.isnan(high),
-        )
+        low_is_nan = low.isna()
+        middle_is_nan = middle.isna()
+        high_is_nan = high.isna()
+
+        low_lt_middle = self._operator(low, middle) | low_is_nan | middle_is_nan
+        middle_lt_high = self._operator(middle, high) | middle_is_nan | high_is_nan
+        low_lt_high = self._operator(low, high) | low_is_nan | high_is_nan
 
-        return np.logical_or(
-            np.logical_and(satisfy_low_bound, satisfy_high_bound),
-            np.isnan(middle),
-        )
+        return low_lt_middle & middle_lt_high & low_lt_high
 
     def _transform(self, table_data):
         """Transform the table data.
 
-        The transformation consists of scaling the ``middle_column_name``
-        (``(middle_column-low)/(high-low)``) and then applying
-        a ``logit`` function to the scaled version of the column.
+        The transformation consists in replacing ``middle`` and ``high`` by the difference
+        between them and ``low`` and ``middle`` respectively. To avoid negative values, the
+        logarithm of the difference + 1 is taken.
 
         Args:
             table_data (pandas.DataFrame):
                 Table data.
 
         Returns:
             pandas.DataFrame:
                 Transformed data.
         """
         low = table_data[self.low_column_name]
+        middle = table_data[self.middle_column_name]
         high = table_data[self.high_column_name]
 
-        data = logit(table_data[self.middle_column_name], low, high)
-        table_data[self._transformed_column] = data
-        table_data = table_data.drop(self.middle_column_name, axis=1)
+        if self._is_datetime:
+            low_diff_column = get_datetime_diff(middle, low, self._dtype)
+            high_diff_column = get_datetime_diff(high, middle, self._dtype)
+        else:
+            low_diff_column = middle - low
+            high_diff_column = high - middle
+
+        table_data[self.low_diff_column_name] = np.log(low_diff_column + 1)
+        table_data[self.high_diff_column_name] = np.log(high_diff_column + 1)
 
-        return table_data
+        list_columns_nans = [self.low_column_name, self.middle_column_name, self.high_column_name]
+        nan_column = compute_nans_column(table_data, list_columns_nans)
+        if nan_column is not None:
+            self.nan_column_name = create_unique_name(nan_column.name, table_data.columns)
+            table_data[self.nan_column_name] = nan_column
+            if self._is_datetime:
+                mean_value_low = table_data[self.low_column_name].mode()[0]
+            else:
+                mean_value_low = table_data[self.low_column_name].mean()
+
+            table_data = table_data.fillna({
+                self.low_column_name: mean_value_low,
+                self.low_diff_column_name: table_data[self.low_diff_column_name].mean(),
+                self.high_diff_column_name: table_data[self.high_diff_column_name].mean()
+            })
+
+        return table_data.drop([self.middle_column_name, self.high_column_name], axis=1)
 
     def _reverse_transform(self, table_data):
         """Reverse transform the table data.
 
-        The reverse transform consists of applying a sigmoid to the transformed
-        ``middle_column_name`` and then scaling it back to the original space
-        ( ``middle_column * (high - low) / low`` ).
+        The reverse transformation consists in replacing ``low_diff_column`` and
+        ``high_diff_column`` by the sum of ``low`` and ``low_diff_column`` and ``middle``
+        and ``high_diff_column`` respectively.
 
         Args:
             table_data (pandas.DataFrame):
                 Table data.
 
         Returns:
             pandas.DataFrame:
                 Transformed data.
         """
-        low = table_data[self.low_column_name]
-        high = table_data[self.high_column_name]
-        data = table_data[self._transformed_column]
-
-        data = sigmoid(data, low, high)
-        data = data.clip(low, high)
+        low_diff_column = np.exp(table_data[self.low_diff_column_name]) - 1
+        high_diff_column = np.exp(table_data[self.high_diff_column_name]) - 1
+        if self._dtype != np.dtype('float'):
+            low_diff_column = low_diff_column.round()
+            high_diff_column = high_diff_column.round()
 
         if self._is_datetime:
-            table_data[self.middle_column_name] = pd.to_datetime(data)
-        else:
-            table_data[self.middle_column_name] = data.astype(self._dtype)
+            low_diff_column = convert_to_timedelta(low_diff_column)
+            high_diff_column = convert_to_timedelta(high_diff_column)
 
-        table_data = table_data.drop(self._transformed_column, axis=1)
+        low = table_data[self.low_column_name].to_numpy()
+        if self._is_datetime and self._dtype == 'O':
+            low = cast_to_datetime64(low)
 
-        return table_data
+        middle = pd.Series(low_diff_column + low).astype(self._dtype)
+        table_data[self.middle_column_name] = middle
+        table_data[self.high_column_name] = pd.Series(
+            high_diff_column + middle.to_numpy()
+        ).astype(self._dtype)
+
+        if self.nan_column_name in table_data.columns:
+            table_data = revert_nans_columns(table_data, self.nan_column_name)
+
+        return table_data.drop([self.low_diff_column_name, self.high_diff_column_name], axis=1)
 
 
 class ScalarRange(Constraint):
     """Ensure that the ``column_name`` is between the range of ``low`` and ``high``.
 
     The transformation strategy works by replacing the ``column_name`` with a
     scaled version and then applying a logit function. The reverse transform
```

### Comparing `sdv-1.1.0.dev0/sdv/constraints/utils.py` & `sdv-1.2.0.dev0/sdv/constraints/utils.py`

 * *Files 13% similar despite different names*

```diff
@@ -162,7 +162,35 @@
     combinations = table_data[nan_column_name].unique()
     for combination in combinations:
         if combination != 'None':
             column_names = [column_name.strip() for column_name in combination.split(',')]
             table_data.loc[table_data[nan_column_name] == combination, column_names] = np.nan
 
     return table_data.drop(columns=nan_column_name)
+
+
+def get_datetime_diff(high, low, dtype='O'):
+    """Calculate the difference between two datetime columns.
+
+    When casting datetimes to float using ``astype``, NaT values are not automatically
+    converted to NaN values. This method calculates the difference between the high
+    and low column values, preserving missing values as NaNs.
+
+    Args:
+        high (numpy.ndarray):
+            The high column values.
+        low (numpy.ndarray):
+            The low column values.
+
+    Returns:
+        numpy.ndarray:
+            The difference between the high and low column values.
+    """
+    if dtype == 'O':
+        low = cast_to_datetime64(low)
+        high = cast_to_datetime64(high)
+
+    diff_column = high - low
+    nan_mask = np.isnan(diff_column)
+    diff_column = diff_column.astype(np.float64)
+    diff_column[nan_mask] = np.nan
+    return diff_column
```

### Comparing `sdv-1.1.0.dev0/sdv/data_processing/data_processor.py` & `sdv-1.2.0.dev0/sdv/data_processing/data_processor.py`

 * *Files 2% similar despite different names*

```diff
@@ -282,15 +282,31 @@
 
         Returns:
             list:
                 List of dictionaries describing the constraints for this data processor.
         """
         return deepcopy(self._constraints_list)
 
+    def _load_constraints(self):
+        loaded_constraints = []
+        default_constraints_classes = list(get_subclasses(Constraint))
+        for constraint in self._constraints_list:
+            if constraint['constraint_class'] in default_constraints_classes:
+                loaded_constraints.append(Constraint.from_dict(constraint))
+
+            else:
+                constraint_class = self._custom_constraint_classes[constraint['constraint_class']]
+                loaded_constraints.append(
+                    constraint_class(**constraint.get('constraint_parameters', {}))
+                )
+
+        return loaded_constraints
+
     def _fit_constraints(self, data):
+        self._constraints = self._load_constraints()
         errors = []
         for constraint in self._constraints:
             try:
                 constraint.fit(data)
             except Exception as e:
                 errors.append(e)
 
@@ -329,23 +345,14 @@
                 errors.append(error)
 
         if errors:
             raise AggregateConstraintsError(errors)
 
         return data
 
-    def _fit_transform_constraints(self, data):
-        # Fit and validate all constraints first because `transform` might change columns
-        # making the following constraints invalid
-        self._constraints = self._load_constraints()
-        self._fit_constraints(data)
-        data = self._transform_constraints(data)
-
-        return data
-
     def _update_transformers_by_sdtypes(self, sdtype, transformer):
         self._transformers_by_sdtype[sdtype] = transformer
 
     @staticmethod
     def create_anonymized_transformer(sdtype, column_metadata, enforce_uniqueness, locales=None):
         """Create an instance of an ``AnonymizedFaker``.
 
@@ -571,15 +578,18 @@
             self._dtypes = data[list(data.columns)].dtypes
 
             self.formatters = {}
             LOGGER.info(f'Fitting formatters for table {self.table_name}')
             self._fit_formatters(data)
 
             LOGGER.info(f'Fitting constraints for table {self.table_name}')
-            constrained = self._fit_transform_constraints(data)
+            if len(self._constraints_list) != len(self._constraints):
+                self._fit_constraints(data)
+
+            constrained = self._transform_constraints(data)
             columns_created_by_constraints = set(constrained.columns) - set(data.columns)
 
             config = self._hyper_transformer.get_config()
             missing_columns = columns_created_by_constraints - config.get('sdtypes').keys()
             if not config.get('sdtypes'):
                 LOGGER.info((
                     'Setting the configuration for the ``HyperTransformer`` '
@@ -595,29 +605,14 @@
                     config
                 )
                 self._hyper_transformer = rdt.HyperTransformer()
                 self._hyper_transformer.set_config(config)
 
             self._prepared_for_fitting = True
 
-    def _load_constraints(self):
-        loaded_constraints = []
-        default_constraints_classes = list(get_subclasses(Constraint))
-        for constraint in self._constraints_list:
-            if constraint['constraint_class'] in default_constraints_classes:
-                loaded_constraints.append(Constraint.from_dict(constraint))
-
-            else:
-                constraint_class = self._custom_constraint_classes[constraint['constraint_class']]
-                loaded_constraints.append(
-                    constraint_class(**constraint.get('constraint_parameters', {}))
-                )
-
-        return loaded_constraints
-
     def fit(self, data):
         """Fit this metadata to the given data.
 
         Args:
             data (pandas.DataFrame):
                 Table to be analyzed.
         """
@@ -752,15 +747,31 @@
             else:
                 column_data = reversed_data[column_name]
 
             dtype = self._dtypes[column_name]
             if is_integer_dtype(dtype) and is_float_dtype(column_data.dtype):
                 column_data = column_data.round()
 
-            reversed_data[column_name] = column_data[column_data.notna()].astype(dtype)
+            reversed_data[column_name] = column_data[column_data.notna()]
+            try:
+                reversed_data[column_name] = reversed_data[column_name].astype(dtype)
+            except ValueError as e:
+                column_metadata = self.metadata.columns.get(column_name)
+                sdtype = column_metadata.get('sdtype')
+                if sdtype not in self._DTYPE_TO_SDTYPE.values():
+                    LOGGER.info(
+                        f"The real data in '{column_name}' was stored as '{dtype}' but the "
+                        'synthetic data could not be cast back to this type. If this is a '
+                        'problem, please check your input data and metadata settings.'
+                    )
+                    if column_name in self.formatters:
+                        self.formatters.pop(column_name)
+
+                else:
+                    raise ValueError(e)
 
         # reformat columns using the formatters
         for column in sampled_columns:
             if column in self.formatters:
                 data_to_format = reversed_data[column]
                 reversed_data[column] = self.formatters[column].format_data(data_to_format)
```

### Comparing `sdv-1.1.0.dev0/sdv/data_processing/datetime_formatter.py` & `sdv-1.2.0.dev0/sdv/data_processing/datetime_formatter.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/sdv/data_processing/errors.py` & `sdv-1.2.0.dev0/sdv/data_processing/errors.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/sdv/data_processing/numerical_formatter.py` & `sdv-1.2.0.dev0/sdv/data_processing/numerical_formatter.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/sdv/data_processing/utils.py` & `sdv-1.2.0.dev0/sdv/data_processing/utils.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/sdv/datasets/demo.py` & `sdv-1.2.0.dev0/sdv/datasets/demo.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/sdv/datasets/local.py` & `sdv-1.2.0.dev0/sdv/datasets/local.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/sdv/errors.py` & `sdv-1.2.0.dev0/sdv/errors.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/sdv/evaluation/multi_table.py` & `sdv-1.2.0.dev0/sdv/evaluation/multi_table.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/sdv/evaluation/single_table.py` & `sdv-1.2.0.dev0/sdv/evaluation/single_table.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/sdv/lite/single_table.py` & `sdv-1.2.0.dev0/sdv/lite/single_table.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/sdv/metadata/anonymization.py` & `sdv-1.2.0.dev0/sdv/metadata/anonymization.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/sdv/metadata/metadata_upgrader.py` & `sdv-1.2.0.dev0/sdv/metadata/metadata_upgrader.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/sdv/metadata/multi_table.py` & `sdv-1.2.0.dev0/sdv/metadata/multi_table.py`

 * *Files 2% similar despite different names*

```diff
@@ -182,14 +182,32 @@
         for relation in self.relationships:
             parent_name = relation['parent_table_name']
             child_name = relation['child_table_name']
             child_map[parent_name].add(child_name)
 
         return child_map
 
+    def _get_foreign_keys(self, parent_table_name, child_table_name):
+        """Get all foreign keys for the parent table."""
+        foreign_keys = []
+        for relation in self.relationships:
+            if parent_table_name == relation['parent_table_name'] and\
+               child_table_name == relation['child_table_name']:
+                foreign_keys.append(deepcopy(relation['child_foreign_key']))
+
+        return foreign_keys
+
+    def _get_all_foreign_keys(self, table_name):
+        foreign_keys = []
+        for relation in self.relationships:
+            if table_name == relation['child_table_name']:
+                foreign_keys.append(deepcopy(relation['child_foreign_key']))
+
+        return foreign_keys
+
     def add_relationship(self, parent_table_name, child_table_name,
                          parent_primary_key, child_foreign_key):
         """Add a relationship between two tables.
 
         Args:
             parent_table_name (str):
                 A string representing the name of the parent table.
```

### Comparing `sdv-1.1.0.dev0/sdv/metadata/single_table.py` & `sdv-1.2.0.dev0/sdv/metadata/single_table.py`

 * *Files 2% similar despite different names*

```diff
@@ -131,20 +131,26 @@
         if unexpected_kwargs:
             unexpected_kwargs = sorted(unexpected_kwargs)
             unexpected_kwargs = ', '.join(unexpected_kwargs)
             raise InvalidMetadataError(
                 f"Invalid values '({unexpected_kwargs})' for {sdtype} column '{column_name}'.")
 
     def _validate_sdtype(self, sdtype):
+        if not isinstance(sdtype, str):
+            raise InvalidMetadataError(
+                f'Invalid sdtype: {sdtype} is not a string. Please use one of the '
+                'supported SDV sdtypes.'
+            )
+
         if sdtype in self._DEFAULT_SDTYPES:
             return
 
         if not is_faker_function(sdtype):
             raise InvalidMetadataError(
-                f"Invalid sdtype : '{sdtype}' is not recognized. Please use one of the "
+                f"Invalid sdtype: '{sdtype}' is not recognized. Please use one of the "
                 'supported SDV sdtypes.'
             )
 
     def _validate_column(self, column_name, sdtype, **kwargs):
         self._validate_sdtype(sdtype)
         self._validate_unexpected_kwargs(column_name, sdtype, **kwargs)
         if sdtype == 'categorical':
```

### Comparing `sdv-1.1.0.dev0/sdv/metadata/utils.py` & `sdv-1.2.0.dev0/sdv/metadata/utils.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/sdv/metadata/visualization.py` & `sdv-1.2.0.dev0/sdv/metadata/visualization.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/sdv/multi_table/base.py` & `sdv-1.2.0.dev0/sdv/multi_table/base.py`

 * *Files 3% similar despite different names*

```diff
@@ -5,14 +5,15 @@
 from collections import defaultdict
 from copy import deepcopy
 
 import cloudpickle
 import numpy as np
 import pandas as pd
 import pkg_resources
+from tqdm import tqdm
 
 from sdv.errors import SynthesizerInputError
 from sdv.single_table.copulas import GaussianCopulaSynthesizer
 from sdv.single_table.errors import InvalidDataError
 
 
 class BaseMultiTableSynthesizer:
@@ -23,16 +24,19 @@
 
     Args:
         metadata (sdv.metadata.multi_table.MultiTableMetadata):
             Multi table metadata representing the data tables that this synthesizer will be used
             for.
         locales (list or str):
             The default locale(s) to use for AnonymizedFaker transformers. Defaults to ``None``.
+        verbose (bool):
+            Whether to print progress for fitting or not.
     """
 
+    DEFAULT_SYNTHESIZER_KWARGS = None
     _synthesizer = GaussianCopulaSynthesizer
     _numpy_seed = 73251
 
     @contextlib.contextmanager
     def _set_temp_numpy_seed(self):
         initial_state = np.random.get_state()
         if isinstance(self._numpy_seed, int):
@@ -52,20 +56,43 @@
             synthesizer_parameters = self._table_parameters.get(table_name, {})
             self._table_synthesizers[table_name] = self._synthesizer(
                 metadata=table_metadata,
                 locales=self.locales,
                 **synthesizer_parameters
             )
 
-    def __init__(self, metadata, locales=None):
+    def _get_pbar_args(self, **kwargs):
+        """Return a dictionary with the updated keyword args for a progress bar."""
+        pbar_args = {'disable': not self.verbose}
+        pbar_args.update(kwargs)
+
+        return pbar_args
+
+    def _print(self, text='', **kwargs):
+        if self.verbose:
+            print(text, **kwargs)  # noqa: T001
+
+    def __init__(self, metadata, locales=None, synthesizer_kwargs=None, verbose=True):
         self.metadata = metadata
         self.metadata.validate()
         self.locales = locales
+        self.verbose = verbose
         self._table_synthesizers = {}
         self._table_parameters = defaultdict(dict)
+        if synthesizer_kwargs is not None:
+            warn_message = (
+                'The `synthesizer_kwargs` parameter is deprecated as of SDV 1.2.0 and does not '
+                'affect the synthesizer. Please use the `set_table_parameters` method instead.'
+            )
+            warnings.warn(warn_message, FutureWarning)
+
+        if self.DEFAULT_SYNTHESIZER_KWARGS:
+            for table_name in self.metadata.tables:
+                self._table_parameters[table_name] = deepcopy(self.DEFAULT_SYNTHESIZER_KWARGS)
+
         self._initialize_models()
         self._fitted = False
         self._creation_date = datetime.datetime.today().strftime('%Y-%m-%d')
         self._fitted_date = None
         self._fitted_sdv_version = None
 
     def get_table_parameters(self, table_name):
@@ -288,15 +315,16 @@
         if self._fitted:
             warnings.warn(
                 'This model has already been fitted. To use the new preprocessed data, '
                 "please refit the model using 'fit' or 'fit_processed_data'."
             )
 
         processed_data = {}
-        for table_name, table_data in data.items():
+        pbar_args = self._get_pbar_args(desc='Preprocess Tables')
+        for table_name, table_data in tqdm(data.items(), **pbar_args):
             synthesizer = self._table_synthesizers[table_name]
             self._assign_table_transformers(synthesizer, table_name, table_data)
             processed_data[table_name] = synthesizer._preprocess(table_data)
 
         return processed_data
 
     def _model_tables(self, augmented_data):
@@ -336,14 +364,15 @@
         Args:
             data (dict):
                 Dictionary mapping each table name to a ``pandas.DataFrame`` in the raw format
                 (before any transformations).
         """
         self._fitted = False
         processed_data = self.preprocess(data)
+        self._print(text='\n', end='')
         self.fit_processed_data(processed_data)
 
     def reset_sampling(self):
         """Reset the sampling to the state that was left right after fitting."""
         self._numpy_seed = 73251
         for synthesizer in self._table_synthesizers.values():
             synthesizer.reset_sampling()
```

### Comparing `sdv-1.1.0.dev0/sdv/multi_table/hma.py` & `sdv-1.2.0.dev0/sdv/multi_table/hma.py`

 * *Files 9% similar despite different names*

```diff
@@ -2,14 +2,15 @@
 
 import logging
 import math
 from copy import deepcopy
 
 import numpy as np
 import pandas as pd
+from tqdm import tqdm
 
 from sdv.multi_table.base import BaseMultiTableSynthesizer
 
 LOGGER = logging.getLogger(__name__)
 
 
 class HMASynthesizer(BaseMultiTableSynthesizer):
@@ -17,66 +18,73 @@
 
     Args:
         metadata (sdv.metadata.multi_table.MultiTableMetadata):
             Multi table metadata representing the data tables that this synthesizer will be used
             for.
         locales (list or str):
             The default locale(s) to use for AnonymizedFaker transformers. Defaults to ``None``.
+        verbose (bool):
+            Whether to print progress for fitting or not.
     """
 
     DEFAULT_SYNTHESIZER_KWARGS = {
         'default_distribution': 'beta'
     }
 
-    def __init__(self, metadata, locales=None, synthesizer_kwargs=None):
+    def __init__(self, metadata, locales=None, verbose=True):
         super().__init__(metadata, locales=locales)
-        self._synthesizer_kwargs = synthesizer_kwargs or self.DEFAULT_SYNTHESIZER_KWARGS
         self._table_sizes = {}
         self._max_child_rows = {}
         self._augmented_tables = []
-        for table_name in self.metadata.tables:
-            self.set_table_parameters(table_name, self._synthesizer_kwargs)
+        self._learned_relationships = 0
+        self.verbose = verbose
 
-    def _get_extension(self, child_name, child_table, foreign_key):
+    def _get_extension(self, child_name, child_table, foreign_key, progress_bar_desc):
         """Generate the extension columns for this child table.
 
         The resulting dataframe will have an index that contains all the foreign key values.
         The values for a given index are generated by flattening a synthesizer fitted with
         the child rows with that foreign key value.
 
         Args:
             child_name (str):
                 Name of the child table.
             child_table (pandas.DataFrame):
                 Data for the child table.
             foreign_key (str):
                 Name of the foreign key field.
+            progress_bar_desc (str):
+                Progress bar description.
 
         Returns:
             pandas.DataFrame
         """
         table_meta = self._table_synthesizers[child_name].get_metadata()
 
         extension_rows = []
         foreign_key_columns = self._get_all_foreign_keys(child_name)
         foreign_key_values = child_table[foreign_key].unique()
         child_table = child_table.set_index(foreign_key)
 
         index = []
         scale_columns = None
-        for foreign_key_value in foreign_key_values:
+        pbar_args = self._get_pbar_args(desc=progress_bar_desc)
+        for foreign_key_value in tqdm(foreign_key_values, **pbar_args):
             child_rows = child_table.loc[[foreign_key_value]]
             child_rows = child_rows[child_rows.columns.difference(foreign_key_columns)]
 
             try:
                 if child_rows.empty:
                     row = pd.Series({'num_rows': len(child_rows)})
                     row.index = f'__{child_name}__{foreign_key}__' + row.index
                 else:
-                    synthesizer = self._synthesizer(table_meta, **self._synthesizer_kwargs)
+                    synthesizer = self._synthesizer(
+                        table_meta,
+                        **self._table_parameters[child_name]
+                    )
                     synthesizer.fit_processed_data(child_rows.reset_index(drop=True))
                     row = synthesizer._get_parameters()
                     row = pd.Series(row)
                     row.index = f'__{child_name}__{foreign_key}__' + row.index
 
                     if scale_columns is None:
                         scale_columns = [
@@ -132,29 +140,40 @@
 
         Returns:
             pandas.DataFrame:
                 The extended table.
         """
         self._table_sizes[table_name] = len(table)
         LOGGER.info('Computing extensions for table %s', table_name)
-        for child_name in self.metadata._get_child_map()[table_name]:
+        child_map = self.metadata._get_child_map()[table_name]
+        for child_name in child_map:
             if child_name not in self._augmented_tables:
                 child_table = self._augment_table(tables[child_name], tables, child_name)
 
             else:
                 child_table = tables[child_name]
 
             foreign_keys = self._get_foreign_keys(table_name, child_name)
-            for index, foreign_key in enumerate(foreign_keys):
-                extension = self._get_extension(child_name, child_table.copy(), foreign_key)
+            for foreign_key in foreign_keys:
+                progress_bar_desc = (
+                    f'({self._learned_relationships + 1}/{len(self.metadata.relationships)}) '
+                    f"Tables '{table_name}' and '{child_name}' ('{foreign_key}')"
+                )
+                extension = self._get_extension(
+                    child_name,
+                    child_table.copy(),
+                    foreign_key,
+                    progress_bar_desc
+                )
                 table = table.merge(extension, how='left', right_index=True, left_index=True)
                 num_rows_key = f'__{child_name}__{foreign_key}__num_rows'
                 table[num_rows_key] = table[num_rows_key].fillna(0)
                 self._max_child_rows[num_rows_key] = table[num_rows_key].max()
                 tables[table_name] = table
+                self._learned_relationships += 1
 
         self._augmented_tables.append(table_name)
         self._clear_nans(table)
         return table
 
     def _pop_foreign_keys(self, table_data, table_name):
         """Remove foreign keys from the ``table_data``.
@@ -179,15 +198,23 @@
     def _model_tables(self, augmented_data):
         """Model the augmented tables.
 
         Args:
             augmented_data (dict):
                 Dictionary mapping each table name to an augmented ``pandas.DataFrame``.
         """
-        for table_name, table in augmented_data.items():
+        parent_map = self.metadata._get_parent_map()
+        augmented_data_to_model = [
+            (table_name, table)
+            for table_name, table in augmented_data.items()
+            if table_name not in parent_map
+        ]
+        self._print(text='\n', end='')
+        pbar_args = self._get_pbar_args(desc='Modeling Tables')
+        for table_name, table in tqdm(augmented_data_to_model, **pbar_args):
             keys = self._pop_foreign_keys(table, table_name)
             self._clear_nans(table)
             LOGGER.info('Fitting %s for table %s; shape: %s', self._synthesizer.__name__,
                         table_name, table.shape)
 
             if not table.empty:
                 self._table_synthesizers[table_name].fit_processed_data(table)
@@ -200,15 +227,17 @@
 
         Args:
             processed_data (dict):
                 Dictionary mapping each table name to a preprocessed ``pandas.DataFrame``.
         """
         augmented_data = deepcopy(processed_data)
         self._augmented_tables = []
+        self._learned_relationships = 0
         parent_map = self.metadata._get_parent_map()
+        self._print(text='Learning relationships:')
         for table_name in processed_data:
             if not parent_map.get(table_name):
                 self._augment_table(augmented_data[table_name], augmented_data, table_name)
 
         LOGGER.info('Augmentation Complete')
         return augmented_data
 
@@ -317,15 +346,15 @@
             sampled_rows = pd.DataFrame(index=range(num_rows))
 
         return self._process_samples(table_name, sampled_rows)
 
     def _get_child_synthesizer(self, parent_row, table_name, foreign_key):
         parameters = self._extract_parameters(parent_row, table_name, foreign_key)
         table_meta = self.metadata.tables[table_name]
-        synthesizer = self._synthesizer(table_meta, **self._synthesizer_kwargs)
+        synthesizer = self._synthesizer(table_meta, **self._table_parameters[table_name])
         synthesizer._set_parameters(parameters)
 
         return synthesizer
 
     def _sample_child_rows(self, table_name, parent_name, parent_row, sampled_data):
         """Sample child rows that reference the given parent row.
 
@@ -440,15 +469,15 @@
 
         data_processor = self._table_synthesizers[table_name]._data_processor
         table_rows = data_processor.transform(table_rows)
 
         for parent_id, row in parent_rows.iterrows():
             parameters = self._extract_parameters(row, table_name, foreign_key)
             table_meta = self._table_synthesizers[table_name].get_metadata()
-            synthesizer = self._synthesizer(table_meta, **self._synthesizer_kwargs)
+            synthesizer = self._synthesizer(table_meta, **self._table_parameters[table_name])
             synthesizer._set_parameters(parameters)
             try:
                 with np.random.default_rng(np.random.get_state()[1]):
                     likelihoods[parent_id] = synthesizer._get_likelihood(table_rows)
 
             except (AttributeError, np.linalg.LinAlgError):
                 likelihoods[parent_id] = None
```

### Comparing `sdv-1.1.0.dev0/sdv/sampling/tabular.py` & `sdv-1.2.0.dev0/sdv/sampling/tabular.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/sdv/sequential/par.py` & `sdv-1.2.0.dev0/sdv/sequential/par.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/sdv/single_table/base.py` & `sdv-1.2.0.dev0/sdv/single_table/base.py`

 * *Files 2% similar despite different names*

```diff
@@ -14,14 +14,15 @@
 import copulas
 import numpy as np
 import pandas as pd
 import pkg_resources
 import tqdm
 from copulas.multivariate import GaussianMultivariate
 
+from sdv.constraints.errors import AggregateConstraintsError
 from sdv.data_processing.data_processor import DataProcessor
 from sdv.errors import ConstraintsNotMetError, SynthesizerInputError
 from sdv.single_table.errors import InvalidDataError
 from sdv.single_table.utils import check_num_rows, handle_sampling_error, validate_file_path
 from sdv.utils import (
     groupby_list, is_boolean_type, is_datetime_type, is_numerical_type, validate_datetime_format)
 
@@ -200,14 +201,24 @@
     def _validate(self, data):
         """Validate any rules that only apply to specific synthesizers.
 
         This method should be overridden by subclasses.
         """
         return []
 
+    def _validate_constraints(self, data):
+        """Validate that the data satisfies the constraints."""
+        errors = []
+        try:
+            self._data_processor._fit_constraints(data)
+        except AggregateConstraintsError as e:
+            errors.append(e)
+
+        return errors
+
     def validate(self, data):
         """Validate data.
 
         Args:
             data (pd.DataFrame):
                 The data to validate.
 
@@ -231,14 +242,17 @@
         errors = []
         # Primary, sequence and alternate keys can't have missing values
         errors += self._validate_keys_dont_have_missing_values(data)
 
         # Primary and alternate key values must be unique
         errors += self._validate_key_values_are_unique(data)
 
+        # Validate constraints
+        errors += self._validate_constraints(data)
+
         # Any other rules that must be met
         errors += self._validate(data)
 
         # Every column must satisfy the properties of their sdtypes
         for column in data:
             errors += self._validate_column(data[column])
 
@@ -541,22 +555,22 @@
                 Rows from the sampled data that match the conditions.
         """
         for column, value in conditions.items():
             column_values = sampled[column]
             if column_values.dtype.kind == 'f':
                 distance = value * float_rtol
                 sampled = sampled[np.abs(column_values - value) <= distance]
-                sampled[column] = value
+                sampled.loc[:, column] = value
             else:
                 sampled = sampled[column_values == value]
 
         return sampled
 
     def _sample_rows(self, num_rows, conditions=None, transformed_conditions=None,
-                     float_rtol=0.1, previous_rows=None):
+                     float_rtol=0.1, previous_rows=None, keep_extra_columns=False):
         """Sample rows with the given conditions.
 
         Input conditions is taken both in the raw input format, which will be used
         for filtering during the reject-sampling loop, and already transformed
         to the model format, which will be passed down to the model if it supports
         conditional sampling natively.
 
@@ -576,35 +590,43 @@
                 The dictionary of conditioning values in the original format.
             transformed_conditions (dict):
                 The dictionary of conditioning values transformed to the model format.
             float_rtol (float):
                 Maximum tolerance when considering a float match.
             previous_rows (pandas.DataFrame):
                 Valid rows sampled in the previous iterations.
+            remove_extra_columns (bool):
+                Whether to keep extra columns from the sampled data. Defaults to False.
 
         Returns:
             tuple:
                 * pandas.DataFrame:
                     Rows from the sampled data that match the conditions.
                 * int:
                     Number of rows that are considered valid.
         """
         if not self._random_state_set:
             self._set_random_state(FIXED_RNG_SEED)
 
         if self._data_processor.get_sdtypes(primary_keys=False):
             if conditions is None:
-                sampled = self._sample(num_rows)
+                raw_sampled = self._sample(num_rows)
             else:
                 try:
-                    sampled = self._sample(num_rows, transformed_conditions)
+                    raw_sampled = self._sample(num_rows, transformed_conditions)
                 except NotImplementedError:
-                    sampled = self._sample(num_rows)
+                    raw_sampled = self._sample(num_rows)
 
-            sampled = self._data_processor.reverse_transform(sampled)
+            sampled = self._data_processor.reverse_transform(raw_sampled)
+            if keep_extra_columns:
+                input_columns = self._data_processor._hyper_transformer._input_columns
+                missing_cols = list(
+                    set(raw_sampled.columns) - set(input_columns) - set(sampled.columns)
+                )
+                sampled = pd.concat([sampled, raw_sampled[missing_cols]], axis=1)
 
             if previous_rows is not None:
                 sampled = pd.concat([previous_rows, sampled], ignore_index=True)
 
             sampled = self._data_processor.filter_valid(sampled)
 
             if conditions is not None:
@@ -617,15 +639,15 @@
         else:
             sampled = pd.DataFrame(index=range(num_rows))
             sampled = self._data_processor.reverse_transform(sampled)
             return sampled, num_rows
 
     def _sample_batch(self, batch_size, max_tries=100,
                       conditions=None, transformed_conditions=None, float_rtol=0.01,
-                      progress_bar=None, output_file_path=None):
+                      progress_bar=None, output_file_path=None, keep_extra_columns=False):
         """Sample a batch of rows with the given conditions.
 
         This will enter a reject-sampling loop in which rows will be sampled until
         all of them are valid and match the requested conditions. If ``max_tries``
         is exceeded, it will return as many rows as it has sampled, which may be less
         than the target number of rows.
 
@@ -656,14 +678,16 @@
                 Maximum tolerance when considering a float match.
             progress_bar (tqdm.tqdm or None):
                 The progress bar to update when sampling. If None, a new tqdm progress
                 bar will be created.
             output_file_path (str or None):
                 The file to periodically write sampled rows to. If None, does not write
                 rows anywhere.
+            remove_extra_columns (bool):
+                Whether to keep extra columns from the sampled data. Defaults to False.
 
         Returns:
             pandas.DataFrame:
                 Sampled data.
         """
         num_rows_to_sample = batch_size
 
@@ -676,15 +700,16 @@
         while num_valid < batch_size and counter < max_tries:
             prev_num_valid = num_valid
             sampled, num_valid = self._sample_rows(
                 num_rows_to_sample,
                 conditions,
                 transformed_conditions,
                 float_rtol,
-                sampled
+                sampled,
+                keep_extra_columns
             )
 
             num_new_valid_rows = num_valid - prev_num_valid
             num_increase = min(num_new_valid_rows, remaining)
             num_sampled = min(len(sampled), batch_size)
             if num_increase > 0:
                 if output_file_path:
@@ -964,17 +989,43 @@
 
         all_sampled_rows = all_sampled_rows.set_index(COND_IDX)
         all_sampled_rows.index.name = conditions.index.name
         all_sampled_rows = all_sampled_rows.sort_index()
 
         return all_sampled_rows
 
-    def _sample_from_conditions(self, conditions, max_tries_per_batch,
-                                batch_size, output_file_path):
-        """Sample rows from this table with the given conditions."""
+    def sample_from_conditions(self, conditions, max_tries_per_batch=100,
+                               batch_size=None, output_file_path=None):
+        """Sample rows from this table with the given conditions.
+
+        Args:
+            conditions (list[sdv.sampling.Condition]):
+                A list of sdv.sampling.Condition objects, which specify the column
+                values in a condition, along with the number of rows for that
+                condition.
+            max_tries_per_batch (int):
+                Number of times to retry sampling until the batch size is met. Defaults to 100.
+            batch_size (int):
+                The batch size to use per sampling call.
+            output_file_path (str or None):
+                The file to periodically write sampled rows to. Defaults to
+                a temporary file, if None.
+
+        Returns:
+            pandas.DataFrame:
+                Sampled data.
+
+        Raises:
+            ConstraintsNotMetError:
+                If the conditions are not valid for the given constraints.
+            ValueError:
+                If any of the following happens:
+                    * any of the conditions' columns are not valid.
+                    * no rows could be generated.
+        """
         output_file_path = validate_file_path(output_file_path)
 
         num_rows = functools.reduce(
             lambda num_rows, condition: condition.get_num_rows() + num_rows, conditions, 0)
 
         conditions = self._make_condition_dfs(conditions)
         for condition_dataframe in conditions:
@@ -1008,23 +1059,23 @@
 
         else:
             if output_file_path == TMP_FILE_NAME and os.path.exists(output_file_path):
                 os.remove(output_file_path)
 
         return sampled
 
-    def sample_from_conditions(self, conditions, max_tries_per_batch=100,
-                               batch_size=None, output_file_path=None):
-        """Sample rows from this table with the given conditions.
+    def sample_remaining_columns(self, known_columns, max_tries_per_batch=100,
+                                 batch_size=None, output_file_path=None):
+        """Sample remaining rows from already known columns.
 
         Args:
-            conditions (list[sdv.sampling.Condition]):
-                A list of sdv.sampling.Condition objects, which specify the column
-                values in a condition, along with the number of rows for that
-                condition.
+            known_columns (pandas.DataFrame):
+                A pandas.DataFrame with the columns that are already known. The output
+                is a DataFrame such that each row in the output is sampled
+                conditionally on the corresponding row in the input.
             max_tries_per_batch (int):
                 Number of times to retry sampling until the batch size is met. Defaults to 100.
             batch_size (int):
                 The batch size to use per sampling call.
             output_file_path (str or None):
                 The file to periodically write sampled rows to. Defaults to
                 a temporary file, if None.
@@ -1037,20 +1088,14 @@
             ConstraintsNotMetError:
                 If the conditions are not valid for the given constraints.
             ValueError:
                 If any of the following happens:
                     * any of the conditions' columns are not valid.
                     * no rows could be generated.
         """
-        return self._sample_from_conditions(
-            conditions, max_tries_per_batch, batch_size, output_file_path)
-
-    def _sample_remaining_columns(self, known_columns, max_tries_per_batch,
-                                  batch_size, output_file_path):
-        """Sample the remaining columns of a given DataFrame."""
         output_file_path = validate_file_path(output_file_path)
 
         known_columns = known_columns.copy()
         self._validate_conditions(known_columns)
         sampled = pd.DataFrame()
         try:
             with tqdm.tqdm(total=len(known_columns)) as progress_bar:
@@ -1072,43 +1117,7 @@
             handle_sampling_error(output_file_path == TMP_FILE_NAME, output_file_path, error)
 
         else:
             if output_file_path == TMP_FILE_NAME and os.path.exists(output_file_path):
                 os.remove(output_file_path)
 
         return sampled
-
-    def sample_remaining_columns(self, known_columns, max_tries_per_batch=100,
-                                 batch_size=None, output_file_path=None):
-        """Sample remaining rows from already known columns.
-
-        Args:
-            known_columns (pandas.DataFrame):
-                A pandas.DataFrame with the columns that are already known. The output
-                is a DataFrame such that each row in the output is sampled
-                conditionally on the corresponding row in the input.
-            max_tries_per_batch (int):
-                Number of times to retry sampling until the batch size is met. Defaults to 100.
-            batch_size (int):
-                The batch size to use per sampling call.
-            output_file_path (str or None):
-                The file to periodically write sampled rows to. Defaults to
-                a temporary file, if None.
-
-        Returns:
-            pandas.DataFrame:
-                Sampled data.
-
-        Raises:
-            ConstraintsNotMetError:
-                If the conditions are not valid for the given constraints.
-            ValueError:
-                If any of the following happens:
-                    * any of the conditions' columns are not valid.
-                    * no rows could be generated.
-        """
-        return self._sample_remaining_columns(
-            known_columns,
-            max_tries_per_batch,
-            batch_size,
-            output_file_path
-        )
```

### Comparing `sdv-1.1.0.dev0/sdv/single_table/copulagan.py` & `sdv-1.2.0.dev0/sdv/single_table/copulagan.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/sdv/single_table/copulas.py` & `sdv-1.2.0.dev0/sdv/single_table/copulas.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/sdv/single_table/ctgan.py` & `sdv-1.2.0.dev0/sdv/single_table/ctgan.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/sdv/single_table/utils.py` & `sdv-1.2.0.dev0/sdv/single_table/utils.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/sdv/utils.py` & `sdv-1.2.0.dev0/sdv/utils.py`

 * *Files 11% similar despite different names*

```diff
@@ -1,37 +1,64 @@
 """Miscellaneous utility functions."""
+from collections.abc import Iterable
 from datetime import datetime
 from pathlib import Path
 
-import numpy as np
 import pandas as pd
 from pandas.core.tools.datetimes import _guess_datetime_format_for_array
 
 
 def cast_to_iterable(value):
     """Return a ``list`` if the input object is not a ``list`` or ``tuple``."""
     if isinstance(value, (list, tuple)):
         return value
 
     return [value]
 
 
+def get_first_non_nan_value(input_value):
+    """Return the first not ``nan`` value when possible.
+
+    Convert to ``pandas.Series`` if the ``input_value`` is not already. This helps to detect
+    easier the ``nan`` values. We filter the values that are ``nans`` since pandas does not
+    detect them properly in their ``_guess_datetime_format_for_array``. Also there is a bug in
+    ``pandas`` that does not support ``numpy.str_`` data type, that is why we use
+    ``pandas.Series`` and convert the data type to ``string`` and then to ``numpy.ndarray``.
+
+    Args:
+       input_value (pandas.Series, np.ndarray, list, or str):
+            Input to return the first non ``nan`` value.
+
+    Returns:
+        str or ``nan``:
+            Returns either the first valid value or ``nan``.
+    """
+    value = input_value
+    if not isinstance(value, pd.Series):
+        value = pd.Series(input_value)
+
+    value = value[~value.isna()]
+    value = value.astype(str).to_numpy()
+    if len(value):
+        return value[0]
+
+    if isinstance(input_value, Iterable) and not isinstance(input_value, str):
+        return input_value[0]
+
+    return input_value
+
+
 def get_datetime_format(value):
     """Get the ``strftime`` format for a given ``value``.
 
     This function returns the ``strftime`` format of a given ``value`` when possible.
     If the ``_guess_datetime_format_for_array`` from ``pandas.core.tools.datetimes`` is
     able to detect the ``strftime`` it will return it as a ``string`` if not, a ``None``
     will be returned.
 
-    In order to achieve this we have to ensure that the given input array has no ``nans``
-    since pandas does not validate it properly. Also there is a bug in ``pandas`` that
-    does not support ``numpy.str_`` data type, that is why we use ``pandas.Series`` and convert
-    the data type to ``string`` and then to ``numpy.ndarray``.
-
     Args:
         value (pandas.Series, np.ndarray, list, or str):
             Input to attempt detecting the format.
 
     Return:
         String representing the datetime format in ``strftime`` format or ``None`` if not detected.
     """
@@ -50,16 +77,16 @@
         value (pandas.DataFrame, int, str or datetime):
             Input to evaluate.
 
     Returns:
         bool:
             True if the input is a datetime type, False if not.
     """
-    if isinstance(value, (np.ndarray, pd.Series, list)):
-        value = value[0]
+    if isinstance(value, Iterable) and not isinstance(value, str):
+        value = get_first_non_nan_value(value)
 
     return (
         pd.api.types.is_datetime64_any_dtype(value)
         or isinstance(value, pd.Timestamp)
         or isinstance(value, datetime)
         or bool(get_datetime_format([value]))
     )
@@ -153,7 +180,16 @@
     data = pd.read_csv(filepath, **pandas_kwargs)
     return data
 
 
 def groupby_list(list_to_check):
     """Return the first element of the list if the length is 1 else the entire list."""
     return list_to_check[0] if len(list_to_check) == 1 else list_to_check
+
+
+def create_unique_name(name, list_names):
+    """Modify the ``name`` parameter if it already exists in the list of names."""
+    result = name
+    while result in list_names:
+        result += '_'
+
+    return result
```

### Comparing `sdv-1.1.0.dev0/sdv.egg-info/PKG-INFO` & `sdv-1.2.0.dev0/sdv.egg-info/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: sdv
-Version: 1.1.0.dev0
+Version: 1.2.0.dev0
 Summary: Generate synthetic data for single table, multi table and sequential data
 Home-page: https://github.com/sdv-dev/SDV
 Author: DataCebo, Inc.
 Author-email: info@sdv.dev
 License: BSL-1.1
 Keywords: sdv synthetic-data synhtetic-data-generation timeseries single-table multi-table
 Classifier: Development Status :: 5 - Production/Stable
@@ -242,14 +242,44 @@
 [Get started using the SDV package](https://bit.ly/sdv-docs) -- a fully
 integrated solution and your one-stop shop for synthetic data. Or, use the standalone libraries
 for specific needs.
 
 
 # Release Notes
 
+## 1.1.0 - 2023-05-10
+
+This release adds a new initialization parameter to synthesizers called `locales` that allows users to set the locales to use for all columns that have a locale based `sdtype` (eg. `address` or `phone_number`). Additionally, it adds support for Pandas 2.0!
+
+Multiple enhancements were made to improve the performance of data and metadata validation in synthesizers. The `Inequality` constraint was improved to be able to generate more scenarios of data concerning the presence of NaNs. Finally, many warnings have been resolved.
+
+### New Features
+
+* Add add-on detection for new constraints - Issue [#1397](https://github.com/sdv-dev/SDV/issues/1397) by @frances-h
+* Add add-on detection for multi and single table synthesizers - Issue [#1385](https://github.com/sdv-dev/SDV/issues/1385) by @frances-h
+* Setting a locale for all my anonymized (PII) columns - Issue [#1371](https://github.com/sdv-dev/SDV/issues/1371) by @frances-h
+
+### Bigs Fixed
+
+* Skip checking for Faker function if its a default sdtype - PR [#1410](https://github.com/sdv-dev/SDV/pull/1410) by @pvk-developer
+* Inequality constraint does not produce all possibilities of missing values - Issue [#1392](https://github.com/sdv-dev/SDV/issues/1392) by @R-Palazzo
+* Deprecated locale warning - Issue [#1400](https://github.com/sdv-dev/SDV/issues/1400) by @frances-h
+
+### Maintenance
+
+* Use cached Faker instance to discover if an sdtype is a Faker function. - Issue [#1405](https://github.com/sdv-dev/SDV/issues/1405) by @pvk-developer
+* Upgrade to pandas 2.0 - Issue [#1366](https://github.com/sdv-dev/SDV/issues/1366) by @pvk-developer
+
+### Internal
+
+* Refactor Multi Table Modeling - Issue [#1387](https://github.com/sdv-dev/SDV/issues/1387) by @pvk-developer
+* PytestConfigWarning: Unknown config option: collect_ignore - Issue [#1376](https://github.com/sdv-dev/SDV/issues/1376) by @amontanez24
+* Pandas FutureWarning: Could not cast to int64 - Issue [#1357](https://github.com/sdv-dev/SDV/issues/1357) by @R-Palazzo
+* RuntimeWarning: invalid value encountered in cast. - Issue [#1369](https://github.com/sdv-dev/SDV/issues/1369) by @amontanez24
+
 ## 1.0.1 - 2023-04-20
 
 This release improves the `load_custom_constraint_classes` method by removing the `table_name` parameter and just loading the constraint
 for all tables instead. It also improves some error messages as well as removes some of the warnings that have been surfacing.
 
 Support for sdtypes is enhanced by resolving a bug that was incorrecttly specifying Faker functions for some of them. Support for datetime formats has also been improved. Finally, the `path` argument in some `save` and `load` methods was changed to `filepath` for consistency.
```

#### html2text {}

```diff
@@ -1,8 +1,8 @@
-Metadata-Version: 2.1 Name: sdv Version: 1.1.0.dev0 Summary: Generate synthetic
+Metadata-Version: 2.1 Name: sdv Version: 1.2.0.dev0 Summary: Generate synthetic
 data for single table, multi table and sequential data Home-page: https://
 github.com/sdv-dev/SDV Author: DataCebo, Inc. Author-email: info@sdv.dev
 License: BSL-1.1 Keywords: sdv synthetic-data synhtetic-data-generation
 timeseries single-table multi-table Classifier: Development Status :: 5 -
 Production/Stable Classifier: Intended Audience :: Developers Classifier:
 License :: Free for non-commercial use Classifier: Natural Language :: English
 Classifier: Programming Language :: Python :: 3 Classifier: Programming
@@ -131,15 +131,43 @@
 including: *  Data discovery & transformation. Reverse the transforms to
 reproduce realistic data. *  Multiple machine learning models -- ranging
 from Copulas to Deep Learning -- to create tabular, multi table and time series
 data. *  Measuring quality and privacy of synthetic data, and comparing
 different synthetic data generation models. [Get started using the SDV package]
 (https://bit.ly/sdv-docs) -- a fully integrated solution and your one-stop shop
 for synthetic data. Or, use the standalone libraries for specific needs. #
-Release Notes ## 1.0.1 - 2023-04-20 This release improves the
+Release Notes ## 1.1.0 - 2023-05-10 This release adds a new initialization
+parameter to synthesizers called `locales` that allows users to set the locales
+to use for all columns that have a locale based `sdtype` (eg. `address` or
+`phone_number`). Additionally, it adds support for Pandas 2.0! Multiple
+enhancements were made to improve the performance of data and metadata
+validation in synthesizers. The `Inequality` constraint was improved to be able
+to generate more scenarios of data concerning the presence of NaNs. Finally,
+many warnings have been resolved. ### New Features * Add add-on detection for
+new constraints - Issue [#1397](https://github.com/sdv-dev/SDV/issues/1397) by
+@frances-h * Add add-on detection for multi and single table synthesizers -
+Issue [#1385](https://github.com/sdv-dev/SDV/issues/1385) by @frances-h *
+Setting a locale for all my anonymized (PII) columns - Issue [#1371](https://
+github.com/sdv-dev/SDV/issues/1371) by @frances-h ### Bigs Fixed * Skip
+checking for Faker function if its a default sdtype - PR [#1410](https://
+github.com/sdv-dev/SDV/pull/1410) by @pvk-developer * Inequality constraint
+does not produce all possibilities of missing values - Issue [#1392](https://
+github.com/sdv-dev/SDV/issues/1392) by @R-Palazzo * Deprecated locale warning -
+Issue [#1400](https://github.com/sdv-dev/SDV/issues/1400) by @frances-h ###
+Maintenance * Use cached Faker instance to discover if an sdtype is a Faker
+function. - Issue [#1405](https://github.com/sdv-dev/SDV/issues/1405) by @pvk-
+developer * Upgrade to pandas 2.0 - Issue [#1366](https://github.com/sdv-dev/
+SDV/issues/1366) by @pvk-developer ### Internal * Refactor Multi Table Modeling
+- Issue [#1387](https://github.com/sdv-dev/SDV/issues/1387) by @pvk-developer *
+PytestConfigWarning: Unknown config option: collect_ignore - Issue [#1376]
+(https://github.com/sdv-dev/SDV/issues/1376) by @amontanez24 * Pandas
+FutureWarning: Could not cast to int64 - Issue [#1357](https://github.com/sdv-
+dev/SDV/issues/1357) by @R-Palazzo * RuntimeWarning: invalid value encountered
+in cast. - Issue [#1369](https://github.com/sdv-dev/SDV/issues/1369) by
+@amontanez24 ## 1.0.1 - 2023-04-20 This release improves the
 `load_custom_constraint_classes` method by removing the `table_name` parameter
 and just loading the constraint for all tables instead. It also improves some
 error messages as well as removes some of the warnings that have been
 surfacing. Support for sdtypes is enhanced by resolving a bug that was
 incorrecttly specifying Faker functions for some of them. Support for datetime
 formats has also been improved. Finally, the `path` argument in some `save` and
 `load` methods was changed to `filepath` for consistency. ### New Features *
```

### Comparing `sdv-1.1.0.dev0/sdv.egg-info/SOURCES.txt` & `sdv-1.2.0.dev0/sdv.egg-info/SOURCES.txt`

 * *Files 0% similar despite different names*

```diff
@@ -462,15 +462,14 @@
 docs/user_guides/single_table/table_metadata.rst
 docs/user_guides/single_table/tabular_preset.rst
 docs/user_guides/single_table/tvae.rst
 docs/user_guides/timeseries/index.rst
 docs/user_guides/timeseries/models.rst
 docs/user_guides/timeseries/par.rst
 sdv/__init__.py
-sdv/_addons.py
 sdv/errors.py
 sdv/utils.py
 sdv.egg-info/PKG-INFO
 sdv.egg-info/SOURCES.txt
 sdv.egg-info/dependency_links.txt
 sdv.egg-info/not-zip-safe
 sdv.egg-info/requires.txt
@@ -507,14 +506,16 @@
 sdv/metrics/relational.py
 sdv/metrics/tabular.py
 sdv/metrics/timeseries.py
 sdv/multi_table/__init__.py
 sdv/multi_table/base.py
 sdv/multi_table/hma.py
 sdv/sampling/__init__.py
+sdv/sampling/hierarchical_sampler.py
+sdv/sampling/independent_sampler.py
 sdv/sampling/tabular.py
 sdv/sequential/__init__.py
 sdv/sequential/par.py
 sdv/single_table/__init__.py
 sdv/single_table/base.py
 sdv/single_table/copulagan.py
 sdv/single_table/copulas.py
@@ -544,15 +545,15 @@
 tests/integration/single_table/__init__.py
 tests/integration/single_table/custom_constraints.py
 tests/integration/single_table/test_base.py
 tests/integration/single_table/test_copulas.py
 tests/integration/single_table/test_ctgan.py
 tests/readme_test/README.md
 tests/unit/__init__.py
-tests/unit/test__addons.py
+tests/unit/test___init__.py
 tests/unit/test_utils.py
 tests/unit/constraints/__init__.py
 tests/unit/constraints/test_base.py
 tests/unit/constraints/test_tabular.py
 tests/unit/constraints/test_utils.py
 tests/unit/data_processing/__init__.py
 tests/unit/data_processing/test_data_processor.py
@@ -571,14 +572,16 @@
 tests/unit/metadata/test_metadata_upgrader.py
 tests/unit/metadata/test_multi_table.py
 tests/unit/metadata/test_single_table.py
 tests/unit/multi_table/__init__.py
 tests/unit/multi_table/test_base.py
 tests/unit/multi_table/test_hma.py
 tests/unit/sampling/__init__.py
+tests/unit/sampling/test_hierarchical_sampler.py
+tests/unit/sampling/test_independent_sampler.py
 tests/unit/sampling/test_tabular.py
 tests/unit/sequential/__init__.py
 tests/unit/sequential/test_par.py
 tests/unit/single_table/__init__.py
 tests/unit/single_table/test_base.py
 tests/unit/single_table/test_copulagan.py
 tests/unit/single_table/test_copulas.py
```

### Comparing `sdv-1.1.0.dev0/sdv.egg-info/requires.txt` & `sdv-1.2.0.dev0/sdv.egg-info/requires.txt`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/setup.cfg` & `sdv-1.2.0.dev0/setup.cfg`

 * *Files 7% similar despite different names*

```diff
@@ -1,9 +1,9 @@
 [bumpversion]
-current_version = 1.1.0.dev0
+current_version = 1.2.0.dev0
 commit = True
 tag = True
 parse = (?P<major>\d+)\.(?P<minor>\d+)\.(?P<patch>\d+)(\.(?P<release>[a-z]+)(?P<candidate>\d+))?
 serialize = 
 	{major}.{minor}.{patch}.{release}{candidate}
 	{major}.{minor}.{patch}
```

### Comparing `sdv-1.1.0.dev0/setup.py` & `sdv-1.2.0.dev0/setup.py`

 * *Files 1% similar despite different names*

```diff
@@ -132,10 +132,10 @@
     name='sdv',
     packages=find_packages(include=['sdv', 'sdv.*']),
     python_requires='>=3.7,<3.11',
     setup_requires=setup_requires,
     test_suite='tests',
     tests_require=tests_require,
     url='https://github.com/sdv-dev/SDV',
-    version='1.1.0.dev0',
+    version='1.2.0.dev0',
     zip_safe=False,
 )
```

### Comparing `sdv-1.1.0.dev0/tests/integration/data_processing/test_data_processor.py` & `sdv-1.2.0.dev0/tests/integration/data_processing/test_data_processor.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/tests/integration/dataset.py` & `sdv-1.2.0.dev0/tests/integration/dataset.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/tests/integration/datasets/test_demo.py` & `sdv-1.2.0.dev0/tests/integration/datasets/test_demo.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/tests/integration/evaluation/test_multi_table.py` & `sdv-1.2.0.dev0/tests/integration/evaluation/test_multi_table.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/tests/integration/evaluation/test_single_table.py` & `sdv-1.2.0.dev0/tests/integration/evaluation/test_single_table.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/tests/integration/lite/test_single_table.py` & `sdv-1.2.0.dev0/tests/integration/lite/test_single_table.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/tests/integration/metadata/test_anonymization.py` & `sdv-1.2.0.dev0/tests/integration/metadata/test_anonymization.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/tests/integration/metadata/test_multi_table.py` & `sdv-1.2.0.dev0/tests/integration/metadata/test_multi_table.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/tests/integration/metadata/test_single_table.py` & `sdv-1.2.0.dev0/tests/integration/metadata/test_single_table.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/tests/integration/multi_table/test_hma.py` & `sdv-1.2.0.dev0/tests/integration/multi_table/test_hma.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/tests/integration/sequential/test_par.py` & `sdv-1.2.0.dev0/tests/integration/sequential/test_par.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/tests/integration/single_table/custom_constraints.py` & `sdv-1.2.0.dev0/tests/integration/single_table/custom_constraints.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/tests/integration/single_table/test_base.py` & `sdv-1.2.0.dev0/tests/integration/single_table/test_base.py`

 * *Files 3% similar despite different names*

```diff
@@ -822,15 +822,14 @@
         'columns': {
             'A': {'sdtype': 'numerical'},
             'B': {'sdtype': 'numerical'},
         }
     })
 
     synthesizer = GaussianCopulaSynthesizer(metadata)
-
     synthesizer.add_constraints(
         [
             {
                 'constraint_class': 'Inequality',
                 'constraint_parameters': {
                     'low_column_name': 'A',
                     'high_column_name': 'B'
@@ -846,14 +845,74 @@
     # Assert
     assert (~(pd.isna(synthetic_data['A'])) & ~(pd.isna(synthetic_data['B']))).any()
     assert ((pd.isna(synthetic_data['A'])) & ~(pd.isna(synthetic_data['B']))).any()
     assert (~(pd.isna(synthetic_data['A'])) & (pd.isna(synthetic_data['B']))).any()
     assert (~(pd.isna(synthetic_data['A'])) & ~(pd.isna(synthetic_data['B']))).any()
 
 
+def test_range_constraint_all_possible_nans_configurations():
+    """Test that the range constraint works with all possible NaN configurations."""
+    # Setup
+    data = pd.DataFrame(data={
+        'low': [1, 4, np.nan, 0, 4, np.nan, np.nan, 5, np.nan],
+        'middle': [2, 5, 3, np.nan, 5, np.nan, 5, np.nan, np.nan],
+        'high': [3, 7, 8, 4, np.nan, 9, np.nan, np.nan, np.nan]
+    })
+
+    metadata_dict = {
+        'columns': {
+            'low': {'sdtype': 'numerical'},
+            'middle': {'sdtype': 'numerical'},
+            'high': {'sdtype': 'numerical'}
+        }
+    }
+
+    metadata = SingleTableMetadata.load_from_dict(metadata_dict)
+    synthesizer = GaussianCopulaSynthesizer(metadata)
+
+    my_constraint = {
+        'constraint_class': 'Range',
+        'constraint_parameters': {
+            'low_column_name': 'low',
+            'middle_column_name': 'middle',
+            'high_column_name': 'high'
+        }
+    }
+
+    # Run
+    synthesizer.add_constraints(constraints=[my_constraint])
+    synthesizer.fit(data)
+
+    s_data = synthesizer.sample(2000)
+
+    # Assert
+    synt_data_not_nan_low_middle = s_data[~(pd.isna(s_data['low'])) & ~(pd.isna(s_data['middle']))]
+    synt_data_not_nan_middle_high = s_data[
+        ~(pd.isna(s_data['middle'])) & ~(pd.isna(s_data['high']))
+    ]
+    synt_data_not_nan_low_high = s_data[~(pd.isna(s_data['low'])) & ~(pd.isna(s_data['high']))]
+
+    is_nan_low = pd.isna(s_data['low'])
+    is_nan_middle = pd.isna(s_data['middle'])
+    is_nan_high = pd.isna(s_data['high'])
+
+    assert all(synt_data_not_nan_low_middle['low'] <= synt_data_not_nan_low_middle['middle'])
+    assert all(synt_data_not_nan_middle_high['middle'] <= synt_data_not_nan_middle_high['high'])
+    assert all(synt_data_not_nan_low_high['low'] <= synt_data_not_nan_low_high['high'])
+
+    assert any(is_nan_low & is_nan_middle & is_nan_high)
+    assert any(is_nan_low & is_nan_middle & ~is_nan_high)
+    assert any(is_nan_low & ~is_nan_middle & is_nan_high)
+    assert any(is_nan_low & ~is_nan_middle & ~is_nan_high)
+    assert any(~is_nan_low & is_nan_middle & is_nan_high)
+    assert any(~is_nan_low & is_nan_middle & ~is_nan_high)
+    assert any(~is_nan_low & ~is_nan_middle & is_nan_high)
+    assert any(~is_nan_low & ~is_nan_middle & ~is_nan_high)
+
+
 def test_save_and_load(tmp_path):
     """Test that synthesizers can be saved and loaded properly."""
     # Setup
     metadata = SingleTableMetadata()
     instance = BaseSingleTableSynthesizer(metadata)
     synthesizer_path = tmp_path / 'synthesizer.pkl'
     instance.save(synthesizer_path)
```

### Comparing `sdv-1.1.0.dev0/tests/integration/single_table/test_copulas.py` & `sdv-1.2.0.dev0/tests/integration/single_table/test_copulas.py`

 * *Files 22% similar despite different names*

```diff
@@ -1,17 +1,20 @@
 from uuid import UUID
 
 import pandas as pd
+import pytest
 from rdt.transformers import (
     AnonymizedFaker, CustomLabelEncoder, FloatFormatter, PseudoAnonymizedFaker)
 
 from sdv.datasets.demo import download_demo
 from sdv.evaluation.single_table import evaluate_quality, get_column_pair_plot, get_column_plot
+from sdv.metadata import SingleTableMetadata
 from sdv.sampling import Condition
 from sdv.single_table import GaussianCopulaSynthesizer
+from sdv.single_table.errors import InvalidDataError
 
 
 def test_synthesize_table_gaussian_copula(tmp_path):
     """End to end test for the Gaussian Copula synthesizer.
 
     Tests fitting and sampling from the synthesizer, anonymization, quality reports, and
     synthesizer customization.
@@ -279,7 +282,82 @@
 
     # Assert - Anonymization
     anonymized_transformers = anonymization_synthesizer.get_transformers()
     assert anonymized_transformers['guest_email'] == guest_email_transformer
     assert anonymized_transformers['billing_address'] == billing_address_transformer
     assert [UUID(uuid) for uuid in anonymized_sample['guest_email']]
     assert any(anonymized_sample['billing_address'].value_counts() > 1)
+
+
+def test_validate_with_failing_constraint():
+    """Validate that the ``constraint`` are raising errors if there is an error during validate."""
+    # Setup
+    real_data, metadata = download_demo(
+        modality='single_table',
+        dataset_name='fake_hotel_guests'
+    )
+    real_data['checkin_date'][0] = real_data['checkout_date'][1]
+    gc = GaussianCopulaSynthesizer(metadata)
+
+    checkin_lessthan_checkout = {
+        'constraint_class': 'Inequality',
+        'constraint_parameters': {
+            'low_column_name': 'checkin_date',
+            'high_column_name': 'checkout_date'
+        }
+    }
+    gc.add_constraints([
+        checkin_lessthan_checkout
+    ])
+
+    error_msg = (
+        'The provided data does not match the metadata:'
+        "\n\nData is not valid for the 'Inequality' constraint:"
+        '\n  checkin_date checkout_date'
+        '\n0  02 Jan 2021   29 Dec 2020'
+    )
+
+    # Run / Assert
+    with pytest.raises(InvalidDataError, match=error_msg):
+        gc.validate(real_data)
+
+
+def test_numerical_columns_gets_pii():
+    """Test that the synthesizer works when a ``numerical`` column gets converted to ``PII``."""
+    # Setup
+    data = pd.DataFrame(data={
+        'id': [0, 1, 2, 3, 4],
+        'city': [0, 0, 0, 0, 0],
+        'numerical': [21, 22, 23, 24, 25]
+    })
+    metadata = SingleTableMetadata.load_from_dict({
+        'primary_key': 'id',
+        'columns': {
+            'id': {'sdtype': 'id'},
+            'city': {'sdtype': 'city'},
+            'numerical': {'sdtype': 'numerical'}
+        }
+    })
+    synth = GaussianCopulaSynthesizer(metadata)
+    synth.fit(data)
+
+    # Run
+    sampled = synth.sample(10)
+
+    # Assert
+    expected_sampled = pd.DataFrame({
+        'id': {0: 0, 1: 1, 2: 2, 3: 3, 4: 4, 5: 5, 6: 6, 7: 7, 8: 8, 9: 9},
+        'city': {
+            0: 'Danielfort',
+            1: 'Glendaside',
+            2: 'Port Jenniferchester',
+            3: 'Port Susan',
+            4: 'West Michellemouth',
+            5: 'West Jason',
+            6: 'Ryanfort',
+            7: 'West Stephenland',
+            8: 'Davidland',
+            9: 'Port Christopher'
+        },
+        'numerical': {0: 21, 1: 24, 2: 22, 3: 23, 4: 22, 5: 24, 6: 23, 7: 23, 8: 24, 9: 23}
+    })
+    pd.testing.assert_frame_equal(expected_sampled, sampled)
```

### Comparing `sdv-1.1.0.dev0/tests/integration/single_table/test_ctgan.py` & `sdv-1.2.0.dev0/tests/integration/single_table/test_ctgan.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/tests/readme_test/README.md` & `sdv-1.2.0.dev0/tests/readme_test/README.md`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/tests/unit/constraints/test_base.py` & `sdv-1.2.0.dev0/tests/unit/constraints/test_base.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/tests/unit/constraints/test_tabular.py` & `sdv-1.2.0.dev0/tests/unit/constraints/test_tabular.py`

 * *Files 2% similar despite different names*

```diff
@@ -3109,7233 +3109,7069 @@
 0000c240: 2020 2320 4173 7365 7274 0a20 2020 2020    # Assert.     
 0000c250: 2020 2065 7870 6563 7465 645f 6f75 7420     expected_out 
 0000c260: 3d20 5b54 7275 652c 2046 616c 7365 2c20  = [True, False, 
 0000c270: 5472 7565 5d0a 2020 2020 2020 2020 6e70  True].        np
 0000c280: 2e74 6573 7469 6e67 2e61 7373 6572 745f  .testing.assert_
 0000c290: 6172 7261 795f 6571 7561 6c28 6578 7065  array_equal(expe
 0000c2a0: 6374 6564 5f6f 7574 2c20 6f75 7429 0a0a  cted_out, out)..
-0000c2b0: 2020 2020 6465 6620 7465 7374 5f5f 6765      def test__ge
-0000c2c0: 745f 6461 7465 7469 6d65 5f64 6966 6628  t_datetime_diff(
-0000c2d0: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
-0000c2e0: 2222 5465 7374 2074 6865 2060 6049 6e65  ""Test the ``Ine
-0000c2f0: 7175 616c 6974 792e 5f67 6574 5f64 6174  quality._get_dat
-0000c300: 6574 696d 655f 6469 6666 206d 6574 686f  etime_diff metho
-0000c310: 642e 0a0a 2020 2020 2020 2020 5468 6520  d...        The 
-0000c320: 6d65 7468 6f64 2069 7320 6578 7065 6374  method is expect
-0000c330: 6564 2074 6f20 636f 6d70 7574 6520 7468  ed to compute th
-0000c340: 6520 6469 6666 6572 656e 6365 2062 6574  e difference bet
-0000c350: 7765 656e 2074 6865 2068 6967 6820 616e  ween the high an
-0000c360: 6420 6c6f 770a 2020 2020 2020 2020 6461  d low.        da
-0000c370: 7465 7469 6d65 2063 6f6c 756d 6e73 2c20  tetime columns, 
-0000c380: 7472 6561 7469 6e67 206d 6973 7369 6e67  treating missing
-0000c390: 2076 616c 7565 7320 6173 204e 614e 2e0a   values as NaN..
-0000c3a0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0000c3b0: 2020 2020 2320 5365 7475 700a 2020 2020      # Setup.    
-0000c3c0: 2020 2020 696e 7374 616e 6365 203d 2049      instance = I
-0000c3d0: 6e65 7175 616c 6974 7928 6c6f 775f 636f  nequality(low_co
-0000c3e0: 6c75 6d6e 5f6e 616d 653d 2761 272c 2068  lumn_name='a', h
-0000c3f0: 6967 685f 636f 6c75 6d6e 5f6e 616d 653d  igh_column_name=
-0000c400: 2762 2729 0a20 2020 2020 2020 2069 6e73  'b').        ins
-0000c410: 7461 6e63 652e 5f64 7479 7065 203d 2027  tance._dtype = '
-0000c420: 4f27 0a20 2020 2020 2020 2068 6967 6820  O'.        high 
-0000c430: 3d20 7064 2e53 6572 6965 7328 5b27 3230  = pd.Series(['20
-0000c440: 3232 2d30 322d 3032 272c 2027 272c 2027  22-02-02', '', '
-0000c450: 3230 3233 2d30 312d 3032 275d 292e 746f  2023-01-02']).to
-0000c460: 5f6e 756d 7079 2829 0a20 2020 2020 2020  _numpy().       
-0000c470: 206c 6f77 203d 2070 642e 5365 7269 6573   low = pd.Series
-0000c480: 285b 2732 3032 322d 3032 2d30 3127 2c20  (['2022-02-01', 
-0000c490: 2732 3032 322d 3032 2d30 3227 2c20 2732  '2022-02-02', '2
-0000c4a0: 3032 332d 3031 2d30 3127 5d29 2e74 6f5f  023-01-01']).to_
-0000c4b0: 6e75 6d70 7928 290a 2020 2020 2020 2020  numpy().        
-0000c4c0: 6578 7065 6374 6564 203d 206e 702e 6172  expected = np.ar
-0000c4d0: 7261 7928 5b38 2e36 3465 3133 2c20 6e70  ray([8.64e13, np
-0000c4e0: 2e6e 616e 2c20 382e 3634 6531 335d 290a  .nan, 8.64e13]).
-0000c4f0: 0a20 2020 2020 2020 2023 2052 756e 0a20  .        # Run. 
-0000c500: 2020 2020 2020 2064 6966 6620 3d20 696e         diff = in
-0000c510: 7374 616e 6365 2e5f 6765 745f 6461 7465  stance._get_date
-0000c520: 7469 6d65 5f64 6966 6628 6869 6768 2c20  time_diff(high, 
-0000c530: 6c6f 7729 0a0a 2020 2020 2020 2020 2320  low)..        # 
-0000c540: 4173 7365 7274 0a20 2020 2020 2020 2061  Assert.        a
-0000c550: 7373 6572 7420 6e70 2e61 7272 6179 5f65  ssert np.array_e
-0000c560: 7175 616c 2865 7870 6563 7465 642c 2064  qual(expected, d
-0000c570: 6966 662c 2065 7175 616c 5f6e 616e 3d54  iff, equal_nan=T
-0000c580: 7275 6529 0a0a 2020 2020 6465 6620 7465  rue)..    def te
-0000c590: 7374 5f5f 7472 616e 7366 6f72 6d28 7365  st__transform(se
-0000c5a0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-0000c5b0: 5465 7374 2074 6865 2060 6049 6e65 7175  Test the ``Inequ
-0000c5c0: 616c 6974 792e 5f74 7261 6e73 666f 726d  ality._transform
-0000c5d0: 6060 206d 6574 686f 642e 0a0a 2020 2020  `` method...    
-0000c5e0: 2020 2020 5468 6520 6d65 7468 6f64 2069      The method i
-0000c5f0: 7320 6578 7065 6374 6564 2074 6f20 636f  s expected to co
-0000c600: 6d70 7574 6520 7468 6520 6469 7374 616e  mpute the distan
-0000c610: 6365 2062 6574 7765 656e 2074 6865 2068  ce between the h
-0000c620: 6967 6820 616e 6420 6c6f 7720 636f 6c75  igh and low colu
-0000c630: 6d6e 730a 2020 2020 2020 2020 616e 6420  mns.        and 
-0000c640: 6372 6561 7465 2061 2064 6966 6620 636f  create a diff co
-0000c650: 6c75 6d6e 2077 6974 6820 7468 6520 6c6f  lumn with the lo
-0000c660: 6761 7269 7468 6d20 6f66 2074 6865 2064  garithm of the d
-0000c670: 6973 7461 6e63 6520 2b20 312e 0a0a 2020  istance + 1...  
-0000c680: 2020 2020 2020 5365 7475 703a 0a20 2020        Setup:.   
-0000c690: 2020 2020 202d 2060 605f 6469 6666 5f63       - ``_diff_c
-0000c6a0: 6f6c 756d 6e5f 6e61 6d65 6060 2069 7320  olumn_name`` is 
-0000c6b0: 7365 7420 746f 2060 6027 6123 6227 6060  set to ``'a#b'``
-0000c6c0: 2e0a 2020 2020 2020 2020 496e 7075 743a  ..        Input:
-0000c6d0: 0a20 2020 2020 2020 202d 2054 6162 6c65  .        - Table
-0000c6e0: 2077 6974 6820 7477 6f20 636f 6c75 6d6e   with two column
-0000c6f0: 7320 6174 2061 2063 6f6e 7374 616e 7420  s at a constant 
-0000c700: 6469 7374 616e 6365 206f 6620 3320 616e  distance of 3 an
-0000c710: 6420 6f6e 6520 6164 6469 7469 6f6e 616c  d one additional
-0000c720: 2064 756d 6d79 2063 6f6c 756d 6e2e 0a20   dummy column.. 
-0000c730: 2020 2020 2020 204f 7574 7075 743a 0a20         Output:. 
-0000c740: 2020 2020 2020 202d 2053 616d 6520 7461         - Same ta
-0000c750: 626c 6520 7769 7468 2061 2064 6966 6620  ble with a diff 
-0000c760: 636f 6c75 6d6e 206f 6620 7468 6520 6c6f  column of the lo
-0000c770: 6720 6f66 2064 6973 7461 6e63 6573 202b  g of distances +
-0000c780: 2031 2c20 7768 6963 6820 6973 206e 702e   1, which is np.
-0000c790: 6c6f 6728 3429 2e0a 2020 2020 2020 2020  log(4)..        
-0000c7a0: 2222 220a 2020 2020 2020 2020 2320 5365  """.        # Se
-0000c7b0: 7475 700a 2020 2020 2020 2020 696e 7374  tup.        inst
-0000c7c0: 616e 6365 203d 2049 6e65 7175 616c 6974  ance = Inequalit
-0000c7d0: 7928 6c6f 775f 636f 6c75 6d6e 5f6e 616d  y(low_column_nam
-0000c7e0: 653d 2761 272c 2068 6967 685f 636f 6c75  e='a', high_colu
-0000c7f0: 6d6e 5f6e 616d 653d 2762 2729 0a20 2020  mn_name='b').   
-0000c800: 2020 2020 2069 6e73 7461 6e63 652e 5f64       instance._d
-0000c810: 6966 665f 636f 6c75 6d6e 5f6e 616d 6520  iff_column_name 
-0000c820: 3d20 2761 2362 270a 0a20 2020 2020 2020  = 'a#b'..       
-0000c830: 2023 2052 756e 0a20 2020 2020 2020 2074   # Run.        t
-0000c840: 6162 6c65 5f64 6174 6120 3d20 7064 2e44  able_data = pd.D
-0000c850: 6174 6146 7261 6d65 287b 0a20 2020 2020  ataFrame({.     
-0000c860: 2020 2020 2020 2027 6127 3a20 5b31 2c20         'a': [1, 
-0000c870: 322c 2033 5d2c 0a20 2020 2020 2020 2020  2, 3],.         
-0000c880: 2020 2027 6227 3a20 5b34 2c20 352c 2036     'b': [4, 5, 6
-0000c890: 5d2c 0a20 2020 2020 2020 2020 2020 2027  ],.            '
-0000c8a0: 6327 3a20 5b37 2c20 382c 2039 5d2c 0a20  c': [7, 8, 9],. 
-0000c8b0: 2020 2020 2020 207d 290a 2020 2020 2020         }).      
-0000c8c0: 2020 6f75 7420 3d20 696e 7374 616e 6365    out = instance
-0000c8d0: 2e5f 7472 616e 7366 6f72 6d28 7461 626c  ._transform(tabl
-0000c8e0: 655f 6461 7461 290a 0a20 2020 2020 2020  e_data)..       
-0000c8f0: 2023 2041 7373 6572 740a 2020 2020 2020   # Assert.      
-0000c900: 2020 6578 7065 6374 6564 5f6f 7574 203d    expected_out =
-0000c910: 2070 642e 4461 7461 4672 616d 6528 7b0a   pd.DataFrame({.
-0000c920: 2020 2020 2020 2020 2020 2020 2761 273a              'a':
-0000c930: 205b 312c 2032 2c20 335d 2c0a 2020 2020   [1, 2, 3],.    
-0000c940: 2020 2020 2020 2020 2763 273a 205b 372c          'c': [7,
-0000c950: 2038 2c20 395d 2c0a 2020 2020 2020 2020   8, 9],.        
-0000c960: 2020 2020 2761 2362 273a 205b 6e70 2e6c      'a#b': [np.l
-0000c970: 6f67 2834 295d 202a 2033 2c0a 2020 2020  og(4)] * 3,.    
-0000c980: 2020 2020 7d29 0a20 2020 2020 2020 2070      }).        p
-0000c990: 642e 7465 7374 696e 672e 6173 7365 7274  d.testing.assert
-0000c9a0: 5f66 7261 6d65 5f65 7175 616c 286f 7574  _frame_equal(out
-0000c9b0: 2c20 6578 7065 6374 6564 5f6f 7574 290a  , expected_out).
-0000c9c0: 0a20 2020 2064 6566 2074 6573 745f 5f74  .    def test__t
-0000c9d0: 7261 6e73 666f 726d 5f77 6974 685f 6e61  ransform_with_na
-0000c9e0: 6e73 2873 656c 6629 3a0a 0a20 2020 2020  ns(self):..     
-0000c9f0: 2020 2023 2053 6574 7570 0a20 2020 2020     # Setup.     
-0000ca00: 2020 2069 6e73 7461 6e63 6520 3d20 496e     instance = In
-0000ca10: 6571 7561 6c69 7479 286c 6f77 5f63 6f6c  equality(low_col
-0000ca20: 756d 6e5f 6e61 6d65 3d27 6127 2c20 6869  umn_name='a', hi
-0000ca30: 6768 5f63 6f6c 756d 6e5f 6e61 6d65 3d27  gh_column_name='
-0000ca40: 6227 290a 2020 2020 2020 2020 696e 7374  b').        inst
-0000ca50: 616e 6365 2e5f 6469 6666 5f63 6f6c 756d  ance._diff_colum
-0000ca60: 6e5f 6e61 6d65 203d 2027 6123 6227 0a0a  n_name = 'a#b'..
-0000ca70: 2020 2020 2020 2020 7461 626c 655f 6461          table_da
-0000ca80: 7461 5f77 6974 685f 6e61 6e73 203d 2070  ta_with_nans = p
-0000ca90: 642e 4461 7461 4672 616d 6528 7b0a 2020  d.DataFrame({.  
-0000caa0: 2020 2020 2020 2020 2020 2761 273a 205b            'a': [
-0000cab0: 312c 206e 702e 6e61 6e2c 2033 2c20 6e70  1, np.nan, 3, np
-0000cac0: 2e6e 616e 5d2c 2027 6227 3a20 5b6e 702e  .nan], 'b': [np.
-0000cad0: 6e61 6e2c 2032 2c20 342c 206e 702e 6e61  nan, 2, 4, np.na
-0000cae0: 6e5d 0a20 2020 2020 2020 207d 290a 0a20  n].        }).. 
-0000caf0: 2020 2020 2020 2074 6162 6c65 5f64 6174         table_dat
-0000cb00: 615f 7769 7468 6f75 745f 6e61 6e73 203d  a_without_nans =
-0000cb10: 2070 642e 4461 7461 4672 616d 6528 7b0a   pd.DataFrame({.
-0000cb20: 2020 2020 2020 2020 2020 2020 2761 273a              'a':
-0000cb30: 205b 312c 2032 2c20 335d 2c20 2762 273a   [1, 2, 3], 'b':
-0000cb40: 205b 322c 2033 2c20 345d 0a20 2020 2020   [2, 3, 4].     
-0000cb50: 2020 207d 290a 0a20 2020 2020 2020 2023     })..        #
-0000cb60: 2052 756e 0a20 2020 2020 2020 206f 7574   Run.        out
-0000cb70: 7075 745f 7769 7468 5f6e 616e 7320 3d20  put_with_nans = 
-0000cb80: 696e 7374 616e 6365 2e5f 7472 616e 7366  instance._transf
-0000cb90: 6f72 6d28 7461 626c 655f 6461 7461 5f77  orm(table_data_w
-0000cba0: 6974 685f 6e61 6e73 290a 2020 2020 2020  ith_nans).      
-0000cbb0: 2020 6f75 7470 7574 5f77 6974 686f 7574    output_without
-0000cbc0: 5f6e 616e 7320 3d20 696e 7374 616e 6365  _nans = instance
-0000cbd0: 2e5f 7472 616e 7366 6f72 6d28 7461 626c  ._transform(tabl
-0000cbe0: 655f 6461 7461 5f77 6974 686f 7574 5f6e  e_data_without_n
-0000cbf0: 616e 7329 0a0a 2020 2020 2020 2020 2320  ans)..        # 
-0000cc00: 4173 7365 7274 0a20 2020 2020 2020 2065  Assert.        e
-0000cc10: 7870 6563 7465 645f 6f75 7470 7574 5f77  xpected_output_w
-0000cc20: 6974 685f 6e61 6e73 203d 2070 642e 4461  ith_nans = pd.Da
-0000cc30: 7461 4672 616d 6528 7b0a 2020 2020 2020  taFrame({.      
-0000cc40: 2020 2020 2020 2761 273a 205b 312e 2c20        'a': [1., 
-0000cc50: 322e 2c20 332e 2c20 322e 5d2c 0a20 2020  2., 3., 2.],.   
-0000cc60: 2020 2020 2020 2020 2027 6123 6227 3a20           'a#b': 
-0000cc70: 5b6e 702e 6c6f 6728 3229 5d20 2a20 342c  [np.log(2)] * 4,
-0000cc80: 0a20 2020 2020 2020 2020 2020 2027 6123  .            'a#
-0000cc90: 622e 6e61 6e5f 636f 6d70 6f6e 656e 7427  b.nan_component'
-0000cca0: 3a20 5b27 6227 2c20 2761 272c 2027 4e6f  : ['b', 'a', 'No
-0000ccb0: 6e65 272c 2027 612c 2062 275d 0a20 2020  ne', 'a, b'].   
-0000ccc0: 2020 2020 207d 290a 0a20 2020 2020 2020       })..       
-0000ccd0: 2065 7870 6563 7465 645f 6f75 7470 7574   expected_output
-0000cce0: 5f77 6974 686f 7574 5f6e 616e 7320 3d20  _without_nans = 
-0000ccf0: 7064 2e44 6174 6146 7261 6d65 287b 0a20  pd.DataFrame({. 
-0000cd00: 2020 2020 2020 2020 2020 2027 6127 3a20             'a': 
-0000cd10: 5b31 2c20 322c 2033 5d2c 0a20 2020 2020  [1, 2, 3],.     
-0000cd20: 2020 2020 2020 2027 6123 6227 3a20 5b6e         'a#b': [n
-0000cd30: 702e 6c6f 6728 3229 5d20 2a20 332c 0a20  p.log(2)] * 3,. 
-0000cd40: 2020 2020 2020 207d 290a 0a20 2020 2020         })..     
-0000cd50: 2020 2070 642e 7465 7374 696e 672e 6173     pd.testing.as
-0000cd60: 7365 7274 5f66 7261 6d65 5f65 7175 616c  sert_frame_equal
-0000cd70: 286f 7574 7075 745f 7769 7468 5f6e 616e  (output_with_nan
-0000cd80: 732c 2065 7870 6563 7465 645f 6f75 7470  s, expected_outp
-0000cd90: 7574 5f77 6974 685f 6e61 6e73 290a 2020  ut_with_nans).  
-0000cda0: 2020 2020 2020 7064 2e74 6573 7469 6e67        pd.testing
-0000cdb0: 2e61 7373 6572 745f 6672 616d 655f 6571  .assert_frame_eq
-0000cdc0: 7561 6c28 6f75 7470 7574 5f77 6974 686f  ual(output_witho
-0000cdd0: 7574 5f6e 616e 732c 2065 7870 6563 7465  ut_nans, expecte
-0000cde0: 645f 6f75 7470 7574 5f77 6974 686f 7574  d_output_without
-0000cdf0: 5f6e 616e 7329 0a0a 2020 2020 6465 6620  _nans)..    def 
-0000ce00: 7465 7374 5f5f 7472 616e 7366 6f72 6d5f  test__transform_
-0000ce10: 6461 7465 7469 6d65 2873 656c 6629 3a0a  datetime(self):.
-0000ce20: 2020 2020 2020 2020 2222 2254 6573 7420          """Test 
-0000ce30: 7468 6520 6060 496e 6571 7561 6c69 7479  the ``Inequality
-0000ce40: 2e5f 7472 616e 7366 6f72 6d60 6020 6d65  ._transform`` me
-0000ce50: 7468 6f64 2e0a 0a20 2020 2020 2020 2054  thod...        T
-0000ce60: 6865 206d 6574 686f 6420 6973 2065 7870  he method is exp
-0000ce70: 6563 7465 6420 746f 2063 6f6d 7075 7465  ected to compute
-0000ce80: 2074 6865 2064 6973 7461 6e63 6520 6265   the distance be
-0000ce90: 7477 6565 6e20 7468 6520 6869 6768 2061  tween the high a
-0000cea0: 6e64 206c 6f77 2063 6f6c 756d 6e73 0a20  nd low columns. 
-0000ceb0: 2020 2020 2020 2061 6e64 2063 7265 6174         and creat
-0000cec0: 6520 6120 6469 6666 2063 6f6c 756d 6e20  e a diff column 
-0000ced0: 7769 7468 2074 6865 206c 6f67 6172 6974  with the logarit
-0000cee0: 686d 206f 6620 7468 6520 6469 7374 616e  hm of the distan
-0000cef0: 6365 202b 2031 2e0a 0a20 2020 2020 2020  ce + 1...       
-0000cf00: 2053 6574 7570 3a0a 2020 2020 2020 2020   Setup:.        
-0000cf10: 2d20 6060 5f64 6966 665f 636f 6c75 6d6e  - ``_diff_column
-0000cf20: 5f6e 616d 6560 6020 6973 2073 6574 2074  _name`` is set t
-0000cf30: 6f20 6060 2761 2362 2760 602e 0a20 2020  o ``'a#b'``..   
-0000cf40: 2020 2020 2049 6e70 7574 3a0a 2020 2020       Input:.    
-0000cf50: 2020 2020 2d20 5461 626c 6520 7769 7468      - Table with
-0000cf60: 2074 776f 2064 6174 6574 696d 6520 636f   two datetime co
-0000cf70: 6c75 6d6e 7320 6174 2061 2064 6973 7461  lumns at a dista
-0000cf80: 6e63 6520 6f66 2033 2061 6e64 206f 6e65  nce of 3 and one
-0000cf90: 2061 6464 6974 696f 6e61 6c20 6475 6d6d   additional dumm
-0000cfa0: 7920 636f 6c75 6d6e 2e0a 2020 2020 2020  y column..      
-0000cfb0: 2020 4f75 7470 7574 3a0a 2020 2020 2020    Output:.      
-0000cfc0: 2020 2d20 5361 6d65 2074 6162 6c65 2077    - Same table w
-0000cfd0: 6974 6820 6120 6469 6666 2063 6f6c 756d  ith a diff colum
-0000cfe0: 6e20 6f66 2074 6865 206c 6f67 206f 6620  n of the log of 
-0000cff0: 6469 7374 616e 6365 7320 2b20 312c 2077  distances + 1, w
-0000d000: 6869 6368 2069 7320 6e70 2e6c 6f67 2834  hich is np.log(4
-0000d010: 292e 0a20 2020 2020 2020 2022 2222 0a20  )..        """. 
-0000d020: 2020 2020 2020 2023 2053 6574 7570 0a20         # Setup. 
-0000d030: 2020 2020 2020 2069 6e73 7461 6e63 6520         instance 
-0000d040: 3d20 496e 6571 7561 6c69 7479 286c 6f77  = Inequality(low
-0000d050: 5f63 6f6c 756d 6e5f 6e61 6d65 3d27 6127  _column_name='a'
-0000d060: 2c20 6869 6768 5f63 6f6c 756d 6e5f 6e61  , high_column_na
-0000d070: 6d65 3d27 6227 290a 2020 2020 2020 2020  me='b').        
-0000d080: 696e 7374 616e 6365 2e5f 6469 6666 5f63  instance._diff_c
-0000d090: 6f6c 756d 6e5f 6e61 6d65 203d 2027 6123  olumn_name = 'a#
-0000d0a0: 6227 0a20 2020 2020 2020 2069 6e73 7461  b'.        insta
-0000d0b0: 6e63 652e 5f69 735f 6461 7465 7469 6d65  nce._is_datetime
-0000d0c0: 203d 2054 7275 650a 0a20 2020 2020 2020   = True..       
-0000d0d0: 2023 2052 756e 0a20 2020 2020 2020 2074   # Run.        t
-0000d0e0: 6162 6c65 5f64 6174 6120 3d20 7064 2e44  able_data = pd.D
-0000d0f0: 6174 6146 7261 6d65 287b 0a20 2020 2020  ataFrame({.     
-0000d100: 2020 2020 2020 2027 6127 3a20 7064 2e74         'a': pd.t
-0000d110: 6f5f 6461 7465 7469 6d65 285b 2732 3032  o_datetime(['202
-0000d120: 302d 3031 2d30 3154 3030 3a30 303a 3030  0-01-01T00:00:00
-0000d130: 272c 2027 3230 3230 2d30 312d 3032 5430  ', '2020-01-02T0
-0000d140: 303a 3030 3a30 3027 5d29 2c0a 2020 2020  0:00:00']),.    
-0000d150: 2020 2020 2020 2020 2762 273a 2070 642e          'b': pd.
-0000d160: 746f 5f64 6174 6574 696d 6528 5b27 3230  to_datetime(['20
-0000d170: 3230 2d30 312d 3031 5430 303a 3030 3a30  20-01-01T00:00:0
-0000d180: 3127 2c20 2732 3032 302d 3031 2d30 3254  1', '2020-01-02T
-0000d190: 3030 3a30 303a 3031 275d 292c 0a20 2020  00:00:01']),.   
-0000d1a0: 2020 2020 2020 2020 2027 6327 3a20 5b31           'c': [1
-0000d1b0: 2c20 325d 2c0a 2020 2020 2020 2020 7d29  , 2],.        })
-0000d1c0: 0a20 2020 2020 2020 206f 7574 203d 2069  .        out = i
-0000d1d0: 6e73 7461 6e63 652e 5f74 7261 6e73 666f  nstance._transfo
-0000d1e0: 726d 2874 6162 6c65 5f64 6174 6129 0a0a  rm(table_data)..
-0000d1f0: 2020 2020 2020 2020 2320 4173 7365 7274          # Assert
-0000d200: 0a20 2020 2020 2020 2065 7870 6563 7465  .        expecte
-0000d210: 645f 6f75 7420 3d20 7064 2e44 6174 6146  d_out = pd.DataF
-0000d220: 7261 6d65 287b 0a20 2020 2020 2020 2020  rame({.         
-0000d230: 2020 2027 6127 3a20 7064 2e74 6f5f 6461     'a': pd.to_da
-0000d240: 7465 7469 6d65 285b 2732 3032 302d 3031  tetime(['2020-01
-0000d250: 2d30 3154 3030 3a30 303a 3030 272c 2027  -01T00:00:00', '
-0000d260: 3230 3230 2d30 312d 3032 5430 303a 3030  2020-01-02T00:00
-0000d270: 3a30 3027 5d29 2c0a 2020 2020 2020 2020  :00']),.        
-0000d280: 2020 2020 2763 273a 205b 312c 2032 5d2c      'c': [1, 2],
-0000d290: 0a20 2020 2020 2020 2020 2020 2027 6123  .            'a#
-0000d2a0: 6227 3a20 5b6e 702e 6c6f 6728 315f 3030  b': [np.log(1_00
-0000d2b0: 305f 3030 305f 3030 3129 2c20 6e70 2e6c  0_000_001), np.l
-0000d2c0: 6f67 2831 5f30 3030 5f30 3030 5f30 3031  og(1_000_000_001
-0000d2d0: 295d 2c0a 2020 2020 2020 2020 7d29 0a20  )],.        }). 
-0000d2e0: 2020 2020 2020 2070 642e 7465 7374 696e         pd.testin
-0000d2f0: 672e 6173 7365 7274 5f66 7261 6d65 5f65  g.assert_frame_e
-0000d300: 7175 616c 286f 7574 2c20 6578 7065 6374  qual(out, expect
-0000d310: 6564 5f6f 7574 290a 0a20 2020 2064 6566  ed_out)..    def
-0000d320: 2074 6573 745f 5f74 7261 6e73 666f 726d   test__transform
-0000d330: 5f64 6174 6574 696d 655f 6474 7970 655f  _datetime_dtype_
-0000d340: 6f62 6a65 6374 2873 656c 6629 3a0a 2020  object(self):.  
-0000d350: 2020 2020 2020 2222 2254 6573 7420 7468        """Test th
-0000d360: 6520 6060 496e 6571 7561 6c69 7479 2e5f  e ``Inequality._
-0000d370: 7472 616e 7366 6f72 6d60 6020 6d65 7468  transform`` meth
-0000d380: 6f64 2e0a 0a20 2020 2020 2020 2054 6865  od...        The
-0000d390: 206d 6574 686f 6420 6973 2065 7870 6563   method is expec
-0000d3a0: 7465 6420 746f 2063 6f6d 7075 7465 2074  ted to compute t
-0000d3b0: 6865 2064 6973 7461 6e63 6520 6265 7477  he distance betw
-0000d3c0: 6565 6e20 7468 6520 6869 6768 2061 6e64  een the high and
-0000d3d0: 206c 6f77 2063 6f6c 756d 6e73 0a20 2020   low columns.   
-0000d3e0: 2020 2020 2061 6e64 2063 7265 6174 6520       and create 
-0000d3f0: 6120 6469 6666 2063 6f6c 756d 6e20 7769  a diff column wi
-0000d400: 7468 2074 6865 206c 6f67 6172 6974 686d  th the logarithm
-0000d410: 206f 6620 7468 6520 6469 7374 616e 6365   of the distance
-0000d420: 202b 2031 2065 7665 6e20 7768 656e 2074   + 1 even when t
-0000d430: 686f 7365 0a20 2020 2020 2020 2061 7265  hose.        are
-0000d440: 2066 726f 6d20 6060 5f64 7479 7065 6060   from ``_dtype``
-0000d450: 206f 626a 6563 7420 6275 7420 6172 6520   object but are 
-0000d460: 7265 7072 6573 656e 7469 6e67 2061 2064  representing a d
-0000d470: 6174 6574 696d 652e 0a20 2020 2020 2020  atetime..       
-0000d480: 2022 2222 0a20 2020 2020 2020 2023 2053   """.        # S
-0000d490: 6574 7570 0a20 2020 2020 2020 2069 6e73  etup.        ins
-0000d4a0: 7461 6e63 6520 3d20 496e 6571 7561 6c69  tance = Inequali
-0000d4b0: 7479 286c 6f77 5f63 6f6c 756d 6e5f 6e61  ty(low_column_na
-0000d4c0: 6d65 3d27 6127 2c20 6869 6768 5f63 6f6c  me='a', high_col
-0000d4d0: 756d 6e5f 6e61 6d65 3d27 6227 290a 2020  umn_name='b').  
-0000d4e0: 2020 2020 2020 696e 7374 616e 6365 2e5f        instance._
-0000d4f0: 6469 6666 5f63 6f6c 756d 6e5f 6e61 6d65  diff_column_name
-0000d500: 203d 2027 6123 6227 0a20 2020 2020 2020   = 'a#b'.       
-0000d510: 2069 6e73 7461 6e63 652e 5f69 735f 6461   instance._is_da
-0000d520: 7465 7469 6d65 203d 2054 7275 650a 2020  tetime = True.  
-0000d530: 2020 2020 2020 696e 7374 616e 6365 2e5f        instance._
-0000d540: 6474 7970 6520 3d20 274f 270a 0a20 2020  dtype = 'O'..   
-0000d550: 2020 2020 2023 2052 756e 0a20 2020 2020       # Run.     
-0000d560: 2020 2074 6162 6c65 5f64 6174 6120 3d20     table_data = 
-0000d570: 7064 2e44 6174 6146 7261 6d65 287b 0a20  pd.DataFrame({. 
-0000d580: 2020 2020 2020 2020 2020 2027 6127 3a20             'a': 
-0000d590: 5b27 3230 3230 2d30 312d 3031 5430 303a  ['2020-01-01T00:
-0000d5a0: 3030 3a30 3027 2c20 2732 3032 302d 3031  00:00', '2020-01
-0000d5b0: 2d30 3254 3030 3a30 303a 3030 275d 2c0a  -02T00:00:00'],.
-0000d5c0: 2020 2020 2020 2020 2020 2020 2762 273a              'b':
-0000d5d0: 205b 2732 3032 302d 3031 2d30 3154 3030   ['2020-01-01T00
-0000d5e0: 3a30 303a 3031 272c 2027 3230 3230 2d30  :00:01', '2020-0
-0000d5f0: 312d 3032 5430 303a 3030 3a30 3127 5d2c  1-02T00:00:01'],
-0000d600: 0a20 2020 2020 2020 2020 2020 2027 6327  .            'c'
-0000d610: 3a20 5b31 2c20 325d 2c0a 2020 2020 2020  : [1, 2],.      
-0000d620: 2020 7d29 0a20 2020 2020 2020 206f 7574    }).        out
-0000d630: 203d 2069 6e73 7461 6e63 652e 5f74 7261   = instance._tra
-0000d640: 6e73 666f 726d 2874 6162 6c65 5f64 6174  nsform(table_dat
-0000d650: 6129 0a0a 2020 2020 2020 2020 2320 4173  a)..        # As
-0000d660: 7365 7274 0a20 2020 2020 2020 2065 7870  sert.        exp
-0000d670: 6563 7465 645f 6f75 7420 3d20 7064 2e44  ected_out = pd.D
-0000d680: 6174 6146 7261 6d65 287b 0a20 2020 2020  ataFrame({.     
-0000d690: 2020 2020 2020 2027 6127 3a20 5b27 3230         'a': ['20
-0000d6a0: 3230 2d30 312d 3031 5430 303a 3030 3a30  20-01-01T00:00:0
-0000d6b0: 3027 2c20 2732 3032 302d 3031 2d30 3254  0', '2020-01-02T
-0000d6c0: 3030 3a30 303a 3030 275d 2c0a 2020 2020  00:00:00'],.    
-0000d6d0: 2020 2020 2020 2020 2763 273a 205b 312c          'c': [1,
-0000d6e0: 2032 5d2c 0a20 2020 2020 2020 2020 2020   2],.           
-0000d6f0: 2027 6123 6227 3a20 5b6e 702e 6c6f 6728   'a#b': [np.log(
-0000d700: 315f 3030 305f 3030 305f 3030 3129 2c20  1_000_000_001), 
-0000d710: 6e70 2e6c 6f67 2831 5f30 3030 5f30 3030  np.log(1_000_000
-0000d720: 5f30 3031 295d 2c0a 2020 2020 2020 2020  _001)],.        
-0000d730: 7d29 0a20 2020 2020 2020 2070 642e 7465  }).        pd.te
-0000d740: 7374 696e 672e 6173 7365 7274 5f66 7261  sting.assert_fra
-0000d750: 6d65 5f65 7175 616c 286f 7574 2c20 6578  me_equal(out, ex
-0000d760: 7065 6374 6564 5f6f 7574 290a 0a20 2020  pected_out)..   
-0000d770: 2064 6566 2074 6573 745f 7265 7665 7273   def test_revers
-0000d780: 655f 7472 616e 7366 6f72 6d28 7365 6c66  e_transform(self
-0000d790: 293a 0a20 2020 2020 2020 2022 2222 5465  ):.        """Te
-0000d7a0: 7374 2074 6865 2060 6049 6e65 7175 616c  st the ``Inequal
-0000d7b0: 6974 792e 7265 7665 7273 655f 7472 616e  ity.reverse_tran
-0000d7c0: 7366 6f72 6d60 6020 6d65 7468 6f64 2e0a  sform`` method..
-0000d7d0: 0a20 2020 2020 2020 2054 6865 206d 6574  .        The met
-0000d7e0: 686f 6420 6973 2065 7870 6563 7465 6420  hod is expected 
-0000d7f0: 746f 3a0a 2020 2020 2020 2020 2020 2020  to:.            
-0000d800: 2d20 6170 706c 7920 616e 2065 7870 6f6e  - apply an expon
-0000d810: 656e 7469 616c 2074 6f20 7468 6520 696e  ential to the in
-0000d820: 7075 740a 2020 2020 2020 2020 2020 2020  put.            
-0000d830: 2d20 7375 6274 7261 6374 2031 0a20 2020  - subtract 1.   
-0000d840: 2020 2020 2020 2020 202d 2061 6464 2074           - add t
-0000d850: 6865 206c 6f77 2063 6f6c 756d 6e0a 2020  he low column.  
-0000d860: 2020 2020 2020 2020 2020 2d20 636f 6e76            - conv
-0000d870: 6572 7420 7468 6520 6f75 7470 7574 2074  ert the output t
-0000d880: 6f20 696e 7465 6765 7273 0a20 2020 2020  o integers.     
-0000d890: 2020 2020 2020 202d 2061 6464 2062 6163         - add bac
-0000d8a0: 6b20 7468 6520 6472 6f70 7065 6420 636f  k the dropped co
-0000d8b0: 6c75 6d6e 0a0a 2020 2020 2020 2020 5365  lumn..        Se
-0000d8c0: 7475 703a 0a20 2020 2020 2020 202d 2060  tup:.        - `
-0000d8d0: 605f 6469 6666 5f63 6f6c 756d 6e5f 6e61  `_diff_column_na
-0000d8e0: 6d65 203d 2027 6123 6227 6060 0a20 2020  me = 'a#b'``.   
-0000d8f0: 2020 2020 202d 2060 605f 6474 7970 6560       - ``_dtype`
-0000d900: 6020 6173 2069 6e74 6567 6572 0a20 2020  ` as integer.   
-0000d910: 2020 2020 2049 6e70 7574 3a0a 2020 2020       Input:.    
-0000d920: 2020 2020 2d20 5461 626c 6520 7769 7468      - Table with
-0000d930: 2061 2064 6966 6620 636f 6c75 6d6e 2074   a diff column t
-0000d940: 6861 7420 636f 6e74 6169 6e73 2074 6865  hat contains the
-0000d950: 2063 6f6e 7374 616e 7420 6e70 2e6c 6f67   constant np.log
-0000d960: 2834 292e 0a20 2020 2020 2020 204f 7574  (4)..        Out
-0000d970: 7075 743a 0a20 2020 2020 2020 202d 2053  put:.        - S
-0000d980: 616d 6520 7461 626c 6520 7769 7468 2074  ame table with t
-0000d990: 6865 2068 6967 6820 636f 6c75 6d6e 2072  he high column r
-0000d9a0: 6570 6c61 6365 6420 6279 2074 6865 206c  eplaced by the l
-0000d9b0: 6f77 206f 6e65 202b 2033 2077 6974 6820  ow one + 3 with 
-0000d9c0: 6469 6666 2063 6f6c 756d 6e20 6472 6f70  diff column drop
-0000d9d0: 7065 642e 0a20 2020 2020 2020 2022 2222  ped..        """
-0000d9e0: 0a20 2020 2020 2020 2023 2053 6574 7570  .        # Setup
-0000d9f0: 0a20 2020 2020 2020 2069 6e73 7461 6e63  .        instanc
-0000da00: 6520 3d20 496e 6571 7561 6c69 7479 286c  e = Inequality(l
-0000da10: 6f77 5f63 6f6c 756d 6e5f 6e61 6d65 3d27  ow_column_name='
-0000da20: 6127 2c20 6869 6768 5f63 6f6c 756d 6e5f  a', high_column_
-0000da30: 6e61 6d65 3d27 6227 290a 2020 2020 2020  name='b').      
-0000da40: 2020 696e 7374 616e 6365 2e5f 6474 7970    instance._dtyp
-0000da50: 6520 3d20 7064 2e53 6572 6965 7328 5b31  e = pd.Series([1
-0000da60: 5d29 2e64 7479 7065 2020 2320 6578 6163  ]).dtype  # exac
-0000da70: 7420 6474 7970 6520 2833 3220 6f72 2036  t dtype (32 or 6
-0000da80: 3429 2064 6570 656e 6473 206f 6e20 4f53  4) depends on OS
-0000da90: 0a20 2020 2020 2020 2069 6e73 7461 6e63  .        instanc
-0000daa0: 652e 5f64 6966 665f 636f 6c75 6d6e 5f6e  e._diff_column_n
-0000dab0: 616d 6520 3d20 2761 2362 270a 0a20 2020  ame = 'a#b'..   
-0000dac0: 2020 2020 2023 2052 756e 0a20 2020 2020       # Run.     
-0000dad0: 2020 2074 7261 6e73 666f 726d 6564 203d     transformed =
-0000dae0: 2070 642e 4461 7461 4672 616d 6528 7b0a   pd.DataFrame({.
-0000daf0: 2020 2020 2020 2020 2020 2020 2761 273a              'a':
-0000db00: 205b 312c 2032 2c20 335d 2c0a 2020 2020   [1, 2, 3],.    
-0000db10: 2020 2020 2020 2020 2763 273a 205b 372c          'c': [7,
-0000db20: 2038 2c20 395d 2c0a 2020 2020 2020 2020   8, 9],.        
-0000db30: 2020 2020 2761 2362 273a 205b 6e70 2e6c      'a#b': [np.l
-0000db40: 6f67 2834 295d 202a 2033 2c0a 2020 2020  og(4)] * 3,.    
-0000db50: 2020 2020 7d29 0a20 2020 2020 2020 206f      }).        o
-0000db60: 7574 203d 2069 6e73 7461 6e63 652e 7265  ut = instance.re
-0000db70: 7665 7273 655f 7472 616e 7366 6f72 6d28  verse_transform(
-0000db80: 7472 616e 7366 6f72 6d65 6429 0a0a 2020  transformed)..  
-0000db90: 2020 2020 2020 2320 4173 7365 7274 0a20        # Assert. 
-0000dba0: 2020 2020 2020 2065 7870 6563 7465 645f         expected_
-0000dbb0: 6f75 7420 3d20 7064 2e44 6174 6146 7261  out = pd.DataFra
-0000dbc0: 6d65 287b 0a20 2020 2020 2020 2020 2020  me({.           
-0000dbd0: 2027 6127 3a20 5b31 2c20 322c 2033 5d2c   'a': [1, 2, 3],
-0000dbe0: 0a20 2020 2020 2020 2020 2020 2027 6327  .            'c'
-0000dbf0: 3a20 5b37 2c20 382c 2039 5d2c 0a20 2020  : [7, 8, 9],.   
-0000dc00: 2020 2020 2020 2020 2027 6227 3a20 5b34           'b': [4
-0000dc10: 2c20 352c 2036 5d2c 0a20 2020 2020 2020  , 5, 6],.       
-0000dc20: 207d 290a 2020 2020 2020 2020 7064 2e74   }).        pd.t
-0000dc30: 6573 7469 6e67 2e61 7373 6572 745f 6672  esting.assert_fr
-0000dc40: 616d 655f 6571 7561 6c28 6f75 742c 2065  ame_equal(out, e
-0000dc50: 7870 6563 7465 645f 6f75 7429 0a0a 2020  xpected_out)..  
-0000dc60: 2020 6465 6620 7465 7374 5f72 6576 6572    def test_rever
-0000dc70: 7365 5f74 7261 6e73 666f 726d 5f66 6c6f  se_transform_flo
-0000dc80: 6174 7328 7365 6c66 293a 0a20 2020 2020  ats(self):.     
-0000dc90: 2020 2022 2222 5465 7374 2074 6865 2060     """Test the `
-0000dca0: 6049 6e65 7175 616c 6974 792e 7265 7665  `Inequality.reve
-0000dcb0: 7273 655f 7472 616e 7366 6f72 6d60 6020  rse_transform`` 
-0000dcc0: 6d65 7468 6f64 2e0a 0a20 2020 2020 2020  method...       
-0000dcd0: 2054 6865 206d 6574 686f 6420 6973 2065   The method is e
-0000dce0: 7870 6563 7465 6420 746f 3a0a 2020 2020  xpected to:.    
-0000dcf0: 2020 2020 2020 2020 2d20 6170 706c 7920          - apply 
-0000dd00: 616e 2065 7870 6f6e 656e 7469 616c 2074  an exponential t
-0000dd10: 6f20 7468 6520 696e 7075 740a 2020 2020  o the input.    
-0000dd20: 2020 2020 2020 2020 2d20 7375 6274 7261          - subtra
-0000dd30: 6374 2031 0a20 2020 2020 2020 2020 2020  ct 1.           
-0000dd40: 202d 2061 6464 2074 6865 206c 6f77 2063   - add the low c
-0000dd50: 6f6c 756d 6e0a 2020 2020 2020 2020 2020  olumn.          
-0000dd60: 2020 2d20 636f 6e76 6572 7420 7468 6520    - convert the 
-0000dd70: 6f75 7470 7574 2074 6f20 666c 6f61 7473  output to floats
-0000dd80: 0a20 2020 2020 2020 2020 2020 202d 2061  .            - a
-0000dd90: 6464 2062 6163 6b20 7468 6520 6472 6f70  dd back the drop
-0000dda0: 7065 6420 636f 6c75 6d6e 0a0a 2020 2020  ped column..    
-0000ddb0: 2020 2020 5365 7475 703a 0a20 2020 2020      Setup:.     
-0000ddc0: 2020 202d 2060 605f 6469 6666 5f63 6f6c     - ``_diff_col
-0000ddd0: 756d 6e5f 6e61 6d65 203d 2027 6123 6227  umn_name = 'a#b'
-0000dde0: 6060 0a20 2020 2020 2020 202d 2060 605f  ``.        - ``_
-0000ddf0: 6474 7970 6560 6020 6173 2066 6c6f 6174  dtype`` as float
-0000de00: 0a20 2020 2020 2020 2049 6e70 7574 3a0a  .        Input:.
-0000de10: 2020 2020 2020 2020 2d20 5461 626c 6520          - Table 
-0000de20: 7769 7468 2061 2064 6966 6620 636f 6c75  with a diff colu
-0000de30: 6d6e 2074 6861 7420 636f 6e74 6169 6e73  mn that contains
-0000de40: 2074 6865 2063 6f6e 7374 616e 7420 6e70   the constant np
-0000de50: 2e6c 6f67 2834 292e 0a20 2020 2020 2020  .log(4)..       
-0000de60: 204f 7574 7075 743a 0a20 2020 2020 2020   Output:.       
-0000de70: 202d 2053 616d 6520 7461 626c 6520 7769   - Same table wi
-0000de80: 7468 2074 6865 2068 6967 6820 636f 6c75  th the high colu
-0000de90: 6d6e 2072 6570 6c61 6365 6420 6279 2074  mn replaced by t
-0000dea0: 6865 206c 6f77 206f 6e65 202b 2033 2077  he low one + 3 w
-0000deb0: 6974 6820 6469 6666 2063 6f6c 756d 6e20  ith diff column 
-0000dec0: 6472 6f70 7065 642e 0a20 2020 2020 2020  dropped..       
-0000ded0: 2022 2222 0a20 2020 2020 2020 2023 2053   """.        # S
-0000dee0: 6574 7570 0a20 2020 2020 2020 2069 6e73  etup.        ins
-0000def0: 7461 6e63 6520 3d20 496e 6571 7561 6c69  tance = Inequali
-0000df00: 7479 286c 6f77 5f63 6f6c 756d 6e5f 6e61  ty(low_column_na
-0000df10: 6d65 3d27 6127 2c20 6869 6768 5f63 6f6c  me='a', high_col
-0000df20: 756d 6e5f 6e61 6d65 3d27 6227 290a 2020  umn_name='b').  
-0000df30: 2020 2020 2020 696e 7374 616e 6365 2e5f        instance._
-0000df40: 6474 7970 6520 3d20 6e70 2e64 7479 7065  dtype = np.dtype
-0000df50: 2827 666c 6f61 7427 290a 2020 2020 2020  ('float').      
-0000df60: 2020 696e 7374 616e 6365 2e5f 6469 6666    instance._diff
-0000df70: 5f63 6f6c 756d 6e5f 6e61 6d65 203d 2027  _column_name = '
-0000df80: 6123 6227 0a0a 2020 2020 2020 2020 2320  a#b'..        # 
-0000df90: 5275 6e0a 2020 2020 2020 2020 7472 616e  Run.        tran
-0000dfa0: 7366 6f72 6d65 6420 3d20 7064 2e44 6174  sformed = pd.Dat
-0000dfb0: 6146 7261 6d65 287b 0a20 2020 2020 2020  aFrame({.       
-0000dfc0: 2020 2020 2027 6127 3a20 5b31 2e31 2c20       'a': [1.1, 
-0000dfd0: 322e 322c 2033 2e33 5d2c 0a20 2020 2020  2.2, 3.3],.     
-0000dfe0: 2020 2020 2020 2027 6327 3a20 5b37 2c20         'c': [7, 
-0000dff0: 382c 2039 5d2c 0a20 2020 2020 2020 2020  8, 9],.         
-0000e000: 2020 2027 6123 6227 3a20 5b6e 702e 6c6f     'a#b': [np.lo
-0000e010: 6728 3429 5d20 2a20 332c 0a20 2020 2020  g(4)] * 3,.     
-0000e020: 2020 207d 290a 2020 2020 2020 2020 6f75     }).        ou
-0000e030: 7420 3d20 696e 7374 616e 6365 2e72 6576  t = instance.rev
-0000e040: 6572 7365 5f74 7261 6e73 666f 726d 2874  erse_transform(t
-0000e050: 7261 6e73 666f 726d 6564 290a 0a20 2020  ransformed)..   
-0000e060: 2020 2020 2023 2041 7373 6572 740a 2020       # Assert.  
-0000e070: 2020 2020 2020 6578 7065 6374 6564 5f6f        expected_o
-0000e080: 7574 203d 2070 642e 4461 7461 4672 616d  ut = pd.DataFram
-0000e090: 6528 7b0a 2020 2020 2020 2020 2020 2020  e({.            
-0000e0a0: 2761 273a 205b 312e 312c 2032 2e32 2c20  'a': [1.1, 2.2, 
-0000e0b0: 332e 335d 2c0a 2020 2020 2020 2020 2020  3.3],.          
-0000e0c0: 2020 2763 273a 205b 372c 2038 2c20 395d    'c': [7, 8, 9]
-0000e0d0: 2c0a 2020 2020 2020 2020 2020 2020 2762  ,.            'b
-0000e0e0: 273a 205b 342e 312c 2035 2e32 2c20 362e  ': [4.1, 5.2, 6.
-0000e0f0: 335d 2c0a 2020 2020 2020 2020 7d29 0a20  3],.        }). 
-0000e100: 2020 2020 2020 2070 642e 7465 7374 696e         pd.testin
-0000e110: 672e 6173 7365 7274 5f66 7261 6d65 5f65  g.assert_frame_e
-0000e120: 7175 616c 286f 7574 2c20 6578 7065 6374  qual(out, expect
-0000e130: 6564 5f6f 7574 290a 0a20 2020 2064 6566  ed_out)..    def
-0000e140: 2074 6573 745f 7265 7665 7273 655f 7472   test_reverse_tr
-0000e150: 616e 7366 6f72 6d5f 6461 7465 7469 6d65  ansform_datetime
-0000e160: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-0000e170: 2222 2254 6573 7420 7468 6520 6060 496e  """Test the ``In
-0000e180: 6571 7561 6c69 7479 2e72 6576 6572 7365  equality.reverse
-0000e190: 5f74 7261 6e73 666f 726d 6060 206d 6574  _transform`` met
-0000e1a0: 686f 642e 0a0a 2020 2020 2020 2020 5468  hod...        Th
-0000e1b0: 6520 6d65 7468 6f64 2069 7320 6578 7065  e method is expe
-0000e1c0: 6374 6564 2074 6f3a 0a20 2020 2020 2020  cted to:.       
-0000e1d0: 2020 2020 202d 2061 7070 6c79 2061 6e20       - apply an 
-0000e1e0: 6578 706f 6e65 6e74 6961 6c20 746f 2074  exponential to t
-0000e1f0: 6865 2069 6e70 7574 0a20 2020 2020 2020  he input.       
-0000e200: 2020 2020 202d 2073 7562 7472 6163 7420       - subtract 
-0000e210: 310a 2020 2020 2020 2020 2020 2020 2d20  1.            - 
-0000e220: 6164 6420 7468 6520 6c6f 7720 636f 6c75  add the low colu
-0000e230: 6d6e 0a20 2020 2020 2020 2020 2020 202d  mn.            -
-0000e240: 2063 6f6e 7665 7274 2074 6865 206f 7574   convert the out
-0000e250: 7075 7420 746f 2064 6174 6574 696d 650a  put to datetime.
-0000e260: 2020 2020 2020 2020 2020 2020 2d20 6164              - ad
-0000e270: 6420 6261 636b 2074 6865 2064 726f 7070  d back the dropp
-0000e280: 6564 2063 6f6c 756d 6e0a 0a20 2020 2020  ed column..     
-0000e290: 2020 2053 6574 7570 3a0a 2020 2020 2020     Setup:.      
-0000e2a0: 2020 2d20 6060 5f64 6966 665f 636f 6c75    - ``_diff_colu
-0000e2b0: 6d6e 5f6e 616d 6520 3d20 2761 2362 2760  mn_name = 'a#b'`
-0000e2c0: 600a 2020 2020 2020 2020 2d20 6060 5f64  `.        - ``_d
-0000e2d0: 7479 7065 6060 2061 7320 6461 7465 7469  type`` as dateti
-0000e2e0: 6d65 0a20 2020 2020 2020 2049 6e70 7574  me.        Input
-0000e2f0: 3a0a 2020 2020 2020 2020 2d20 5461 626c  :.        - Tabl
-0000e300: 6520 7769 7468 2061 2064 6966 6620 636f  e with a diff co
-0000e310: 6c75 6d6e 2074 6861 7420 636f 6e74 6169  lumn that contai
-0000e320: 6e73 2074 6865 2063 6f6e 7374 616e 7420  ns the constant 
-0000e330: 6e70 2e6c 6f67 2834 292e 0a20 2020 2020  np.log(4)..     
-0000e340: 2020 204f 7574 7075 743a 0a20 2020 2020     Output:.     
-0000e350: 2020 202d 2053 616d 6520 7461 626c 6520     - Same table 
-0000e360: 7769 7468 2074 6865 2068 6967 6820 636f  with the high co
-0000e370: 6c75 6d6e 2072 6570 6c61 6365 6420 6279  lumn replaced by
-0000e380: 2074 6865 206c 6f77 206f 6e65 202b 2031   the low one + 1
-0000e390: 7365 6320 7769 7468 2064 6966 6620 636f  sec with diff co
-0000e3a0: 6c75 6d6e 2064 726f 7070 6564 2e0a 2020  lumn dropped..  
-0000e3b0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0000e3c0: 2020 2320 5365 7475 700a 2020 2020 2020    # Setup.      
-0000e3d0: 2020 696e 7374 616e 6365 203d 2049 6e65    instance = Ine
-0000e3e0: 7175 616c 6974 7928 6c6f 775f 636f 6c75  quality(low_colu
-0000e3f0: 6d6e 5f6e 616d 653d 2761 272c 2068 6967  mn_name='a', hig
-0000e400: 685f 636f 6c75 6d6e 5f6e 616d 653d 2762  h_column_name='b
-0000e410: 2729 0a20 2020 2020 2020 2069 6e73 7461  ').        insta
-0000e420: 6e63 652e 5f64 7479 7065 203d 206e 702e  nce._dtype = np.
-0000e430: 6474 7970 6528 273c 4d38 5b6e 735d 2729  dtype('<M8[ns]')
-0000e440: 0a20 2020 2020 2020 2069 6e73 7461 6e63  .        instanc
-0000e450: 652e 5f64 6966 665f 636f 6c75 6d6e 5f6e  e._diff_column_n
-0000e460: 616d 6520 3d20 2761 2362 270a 2020 2020  ame = 'a#b'.    
-0000e470: 2020 2020 696e 7374 616e 6365 2e5f 6973      instance._is
-0000e480: 5f64 6174 6574 696d 6520 3d20 5472 7565  _datetime = True
-0000e490: 0a0a 2020 2020 2020 2020 2320 5275 6e0a  ..        # Run.
-0000e4a0: 2020 2020 2020 2020 7472 616e 7366 6f72          transfor
-0000e4b0: 6d65 6420 3d20 7064 2e44 6174 6146 7261  med = pd.DataFra
-0000e4c0: 6d65 287b 0a20 2020 2020 2020 2020 2020  me({.           
-0000e4d0: 2027 6127 3a20 7064 2e74 6f5f 6461 7465   'a': pd.to_date
-0000e4e0: 7469 6d65 285b 2732 3032 302d 3031 2d30  time(['2020-01-0
-0000e4f0: 3154 3030 3a30 303a 3030 272c 2027 3230  1T00:00:00', '20
-0000e500: 3230 2d30 312d 3032 5430 303a 3030 3a30  20-01-02T00:00:0
-0000e510: 3027 5d29 2c0a 2020 2020 2020 2020 2020  0']),.          
-0000e520: 2020 2763 273a 205b 312c 2032 5d2c 0a20    'c': [1, 2],. 
-0000e530: 2020 2020 2020 2020 2020 2027 6123 6227             'a#b'
-0000e540: 3a20 5b6e 702e 6c6f 6728 315f 3030 305f  : [np.log(1_000_
-0000e550: 3030 305f 3030 3129 2c20 6e70 2e6c 6f67  000_001), np.log
-0000e560: 2831 5f30 3030 5f30 3030 5f30 3031 295d  (1_000_000_001)]
-0000e570: 2c0a 2020 2020 2020 2020 7d29 0a20 2020  ,.        }).   
-0000e580: 2020 2020 206f 7574 203d 2069 6e73 7461       out = insta
-0000e590: 6e63 652e 7265 7665 7273 655f 7472 616e  nce.reverse_tran
-0000e5a0: 7366 6f72 6d28 7472 616e 7366 6f72 6d65  sform(transforme
-0000e5b0: 6429 0a0a 2020 2020 2020 2020 2320 4173  d)..        # As
-0000e5c0: 7365 7274 0a20 2020 2020 2020 2065 7870  sert.        exp
-0000e5d0: 6563 7465 645f 6f75 7420 3d20 7064 2e44  ected_out = pd.D
-0000e5e0: 6174 6146 7261 6d65 287b 0a20 2020 2020  ataFrame({.     
-0000e5f0: 2020 2020 2020 2027 6127 3a20 7064 2e74         'a': pd.t
-0000e600: 6f5f 6461 7465 7469 6d65 285b 2732 3032  o_datetime(['202
-0000e610: 302d 3031 2d30 3154 3030 3a30 303a 3030  0-01-01T00:00:00
-0000e620: 272c 2027 3230 3230 2d30 312d 3032 5430  ', '2020-01-02T0
-0000e630: 303a 3030 3a30 3027 5d29 2c0a 2020 2020  0:00:00']),.    
-0000e640: 2020 2020 2020 2020 2763 273a 205b 312c          'c': [1,
-0000e650: 2032 5d2c 0a20 2020 2020 2020 2020 2020   2],.           
-0000e660: 2027 6227 3a20 7064 2e74 6f5f 6461 7465   'b': pd.to_date
-0000e670: 7469 6d65 285b 2732 3032 302d 3031 2d30  time(['2020-01-0
-0000e680: 3154 3030 3a30 303a 3031 272c 2027 3230  1T00:00:01', '20
-0000e690: 3230 2d30 312d 3032 5430 303a 3030 3a30  20-01-02T00:00:0
-0000e6a0: 3127 5d29 0a20 2020 2020 2020 207d 290a  1']).        }).
-0000e6b0: 2020 2020 2020 2020 7064 2e74 6573 7469          pd.testi
-0000e6c0: 6e67 2e61 7373 6572 745f 6672 616d 655f  ng.assert_frame_
-0000e6d0: 6571 7561 6c28 6f75 742c 2065 7870 6563  equal(out, expec
-0000e6e0: 7465 645f 6f75 7429 0a0a 2020 2020 6465  ted_out)..    de
-0000e6f0: 6620 7465 7374 5f72 6576 6572 7365 5f74  f test_reverse_t
-0000e700: 7261 6e73 666f 726d 5f64 6174 6574 696d  ransform_datetim
-0000e710: 655f 6474 7970 655f 6973 5f6f 626a 6563  e_dtype_is_objec
-0000e720: 7428 7365 6c66 293a 0a20 2020 2020 2020  t(self):.       
-0000e730: 2022 2222 5465 7374 2074 6865 2060 6049   """Test the ``I
-0000e740: 6e65 7175 616c 6974 792e 7265 7665 7273  nequality.revers
-0000e750: 655f 7472 616e 7366 6f72 6d60 6020 6d65  e_transform`` me
-0000e760: 7468 6f64 2e0a 0a20 2020 2020 2020 2054  thod...        T
-0000e770: 6869 7320 7368 6f75 6c64 2063 6173 7420  his should cast 
-0000e780: 7468 6520 6060 6c6f 7760 6020 636f 6c75  the ``low`` colu
-0000e790: 6d6e 2074 6f20 6060 6461 7465 7469 6d65  mn to ``datetime
-0000e7a0: 6060 2077 6865 6e20 7468 6520 6060 6474  `` when the ``dt
-0000e7b0: 7970 6560 6020 6973 0a20 2020 2020 2020  ype`` is.       
-0000e7c0: 206f 626a 6563 742e 0a20 2020 2020 2020   object..       
-0000e7d0: 2022 2222 0a20 2020 2020 2020 2023 2053   """.        # S
-0000e7e0: 6574 7570 0a20 2020 2020 2020 2069 6e73  etup.        ins
-0000e7f0: 7461 6e63 6520 3d20 496e 6571 7561 6c69  tance = Inequali
-0000e800: 7479 286c 6f77 5f63 6f6c 756d 6e5f 6e61  ty(low_column_na
-0000e810: 6d65 3d27 6127 2c20 6869 6768 5f63 6f6c  me='a', high_col
-0000e820: 756d 6e5f 6e61 6d65 3d27 6227 290a 2020  umn_name='b').  
-0000e830: 2020 2020 2020 696e 7374 616e 6365 2e5f        instance._
-0000e840: 6474 7970 6520 3d20 6e70 2e64 7479 7065  dtype = np.dtype
-0000e850: 2827 4f27 290a 2020 2020 2020 2020 696e  ('O').        in
-0000e860: 7374 616e 6365 2e5f 6469 6666 5f63 6f6c  stance._diff_col
-0000e870: 756d 6e5f 6e61 6d65 203d 2027 6123 6227  umn_name = 'a#b'
-0000e880: 0a20 2020 2020 2020 2069 6e73 7461 6e63  .        instanc
-0000e890: 652e 5f69 735f 6461 7465 7469 6d65 203d  e._is_datetime =
-0000e8a0: 2054 7275 650a 0a20 2020 2020 2020 2023   True..        #
-0000e8b0: 2052 756e 0a20 2020 2020 2020 2074 7261   Run.        tra
-0000e8c0: 6e73 666f 726d 6564 203d 2070 642e 4461  nsformed = pd.Da
-0000e8d0: 7461 4672 616d 6528 7b0a 2020 2020 2020  taFrame({.      
-0000e8e0: 2020 2020 2020 2761 273a 205b 2732 3032        'a': ['202
-0000e8f0: 302d 3031 2d30 3154 3030 3a30 303a 3030  0-01-01T00:00:00
-0000e900: 272c 2027 3230 3230 2d30 312d 3032 5430  ', '2020-01-02T0
-0000e910: 303a 3030 3a30 3027 5d2c 0a20 2020 2020  0:00:00'],.     
-0000e920: 2020 2020 2020 2027 6327 3a20 5b31 2c20         'c': [1, 
-0000e930: 325d 2c0a 2020 2020 2020 2020 2020 2020  2],.            
-0000e940: 2761 2362 273a 205b 6e70 2e6c 6f67 2831  'a#b': [np.log(1
-0000e950: 5f30 3030 5f30 3030 5f30 3031 292c 206e  _000_000_001), n
-0000e960: 702e 6c6f 6728 315f 3030 305f 3030 305f  p.log(1_000_000_
-0000e970: 3030 3129 5d2c 0a20 2020 2020 2020 207d  001)],.        }
-0000e980: 290a 2020 2020 2020 2020 6f75 7420 3d20  ).        out = 
-0000e990: 696e 7374 616e 6365 2e72 6576 6572 7365  instance.reverse
-0000e9a0: 5f74 7261 6e73 666f 726d 2874 7261 6e73  _transform(trans
-0000e9b0: 666f 726d 6564 290a 0a20 2020 2020 2020  formed)..       
-0000e9c0: 2023 2041 7373 6572 740a 2020 2020 2020   # Assert.      
-0000e9d0: 2020 6578 7065 6374 6564 5f6f 7574 203d    expected_out =
-0000e9e0: 2070 642e 4461 7461 4672 616d 6528 7b0a   pd.DataFrame({.
-0000e9f0: 2020 2020 2020 2020 2020 2020 2761 273a              'a':
-0000ea00: 205b 2732 3032 302d 3031 2d30 3154 3030   ['2020-01-01T00
-0000ea10: 3a30 303a 3030 272c 2027 3230 3230 2d30  :00:00', '2020-0
-0000ea20: 312d 3032 5430 303a 3030 3a30 3027 5d2c  1-02T00:00:00'],
-0000ea30: 0a20 2020 2020 2020 2020 2020 2027 6327  .            'c'
-0000ea40: 3a20 5b31 2c20 325d 2c0a 2020 2020 2020  : [1, 2],.      
-0000ea50: 2020 2020 2020 2762 273a 205b 7064 2e54        'b': [pd.T
-0000ea60: 696d 6573 7461 6d70 2827 3230 3230 2d30  imestamp('2020-0
-0000ea70: 312d 3031 2030 303a 3030 3a30 3127 292c  1-01 00:00:01'),
-0000ea80: 2070 642e 5469 6d65 7374 616d 7028 2732   pd.Timestamp('2
-0000ea90: 3032 302d 3031 2d30 3220 3030 3a30 303a  020-01-02 00:00:
-0000eaa0: 3031 2729 5d0a 2020 2020 2020 2020 7d29  01')].        })
-0000eab0: 0a20 2020 2020 2020 2065 7870 6563 7465  .        expecte
-0000eac0: 645f 6f75 745b 2762 275d 203d 2065 7870  d_out['b'] = exp
-0000ead0: 6563 7465 645f 6f75 745b 2762 275d 2e61  ected_out['b'].a
-0000eae0: 7374 7970 6528 6e70 2e64 7479 7065 2827  stype(np.dtype('
-0000eaf0: 4f27 2929 0a20 2020 2020 2020 2070 642e  O')).        pd.
-0000eb00: 7465 7374 696e 672e 6173 7365 7274 5f66  testing.assert_f
-0000eb10: 7261 6d65 5f65 7175 616c 286f 7574 2c20  rame_equal(out, 
-0000eb20: 6578 7065 6374 6564 5f6f 7574 290a 0a0a  expected_out)...
-0000eb30: 636c 6173 7320 5465 7374 5363 616c 6172  class TestScalar
-0000eb40: 496e 6571 7561 6c69 7479 2829 3a0a 0a20  Inequality():.. 
-0000eb50: 2020 2064 6566 2074 6573 745f 5f76 616c     def test__val
-0000eb60: 6964 6174 655f 696e 7075 7473 2873 656c  idate_inputs(sel
-0000eb70: 6629 3a0a 2020 2020 2020 2020 2222 2254  f):.        """T
-0000eb80: 6573 7420 7468 6520 6060 5363 616c 6172  est the ``Scalar
-0000eb90: 496e 6571 7561 6c69 7479 2e5f 7661 6c69  Inequality._vali
-0000eba0: 6461 7465 5f69 6e70 7574 7360 6020 6d65  date_inputs`` me
-0000ebb0: 7468 6f64 2e0a 0a20 2020 2020 2020 2049  thod...        I
-0000ebc0: 6e70 7574 3a0a 2020 2020 2020 2020 2d20  nput:.        - 
-0000ebd0: 2049 6e63 6f72 7265 6374 2070 6172 616d   Incorrect param
-0000ebe0: 6574 6572 7320 666f 7220 7468 6520 6d65  eters for the me
-0000ebf0: 7468 6f64 0a20 2020 2020 2020 2052 6169  thod.        Rai
-0000ec00: 7365 733a 0a20 2020 2020 2020 202d 204c  ses:.        - L
-0000ec10: 6973 7420 6f66 2056 616c 7565 4572 726f  ist of ValueErro
-0000ec20: 7273 0a20 2020 2020 2020 2022 2222 0a20  rs.        """. 
-0000ec30: 2020 2020 2020 2023 2052 756e 202f 2041         # Run / A
-0000ec40: 7373 6572 740a 2020 2020 2020 2020 7769  ssert.        wi
-0000ec50: 7468 2070 7974 6573 742e 7261 6973 6573  th pytest.raises
-0000ec60: 2841 6767 7265 6761 7465 436f 6e73 7472  (AggregateConstr
-0000ec70: 6169 6e74 7345 7272 6f72 2920 6173 2065  aintsError) as e
-0000ec80: 7272 6f72 3a0a 2020 2020 2020 2020 2020  rror:.          
-0000ec90: 2020 5363 616c 6172 496e 6571 7561 6c69    ScalarInequali
-0000eca0: 7479 2e5f 7661 6c69 6461 7465 5f69 6e70  ty._validate_inp
-0000ecb0: 7574 7328 0a20 2020 2020 2020 2020 2020  uts(.           
-0000ecc0: 2020 2020 206e 6f74 5f68 6967 685f 636f       not_high_co
-0000ecd0: 6c75 6d6e 3d4e 6f6e 652c 206e 6f74 5f6c  lumn=None, not_l
-0000ece0: 6f77 5f63 6f6c 756d 6e3d 4e6f 6e65 2c20  ow_column=None, 
-0000ecf0: 7265 6c61 7469 6f6e 3d27 2b27 290a 0a20  relation='+').. 
-0000ed00: 2020 2020 2020 2065 7272 5f6d 7367 203d         err_msg =
-0000ed10: 2028 0a20 2020 2020 2020 2020 2020 2072   (.            r
-0000ed20: 274d 6973 7369 6e67 2072 6571 7569 7265  'Missing require
-0000ed30: 6420 7661 6c75 6573 207b 282e 2a29 7d20  d values {(.*)} 
-0000ed40: 696e 2061 2053 6361 6c61 7249 6e65 7175  in a ScalarInequ
-0000ed50: 616c 6974 7920 636f 6e73 7472 6169 6e74  ality constraint
-0000ed60: 2e27 0a20 2020 2020 2020 2020 2020 2072  .'.            r
-0000ed70: 275c 6e5c 6e49 6e76 616c 6964 2076 616c  '\n\nInvalid val
-0000ed80: 7565 7320 7b28 2e2a 297d 2061 7265 2070  ues {(.*)} are p
-0000ed90: 7265 7365 6e74 2069 6e20 6120 5363 616c  resent in a Scal
-0000eda0: 6172 496e 6571 7561 6c69 7479 2063 6f6e  arInequality con
-0000edb0: 7374 7261 696e 742e 270a 2020 2020 2020  straint.'.      
-0000edc0: 2020 2020 2020 7227 5c6e 5c6e 496e 7661        r'\n\nInva
-0000edd0: 6c69 6420 7265 6c61 7469 6f6e 2076 616c  lid relation val
-0000ede0: 7565 207b 282e 2a29 7d20 696e 2061 2053  ue {(.*)} in a S
-0000edf0: 6361 6c61 7249 6e65 7175 616c 6974 7920  calarInequality 
-0000ee00: 636f 6e73 7472 6169 6e74 2e27 0a20 2020  constraint.'.   
-0000ee10: 2020 2020 2020 2020 2022 2054 6865 2072           " The r
-0000ee20: 656c 6174 696f 6e20 6d75 7374 2062 6520  elation must be 
-0000ee30: 6f6e 6520 6f66 3a20 273e 272c 2027 3e3d  one of: '>', '>=
-0000ee40: 272c 2027 3c27 206f 7220 273c 3d27 2e22  ', '<' or '<='."
-0000ee50: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-0000ee60: 2020 2067 726f 7570 7320 3d20 7265 2e73     groups = re.s
-0000ee70: 6561 7263 6828 6572 725f 6d73 672c 2073  earch(err_msg, s
-0000ee80: 7472 2865 7272 6f72 2e76 616c 7565 2929  tr(error.value))
-0000ee90: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-0000eea0: 6772 6f75 7073 2069 7320 6e6f 7420 4e6f  groups is not No
-0000eeb0: 6e65 0a20 2020 2020 2020 2061 7373 6572  ne.        asser
-0000eec0: 7420 7365 7428 6576 616c 2867 726f 7570  t set(eval(group
-0000eed0: 732e 6772 6f75 7028 3129 2929 203d 3d20  s.group(1))) == 
-0000eee0: 7b27 636f 6c75 6d6e 5f6e 616d 6527 2c20  {'column_name', 
-0000eef0: 2776 616c 7565 277d 0a20 2020 2020 2020  'value'}.       
-0000ef00: 2061 7373 6572 7420 7365 7428 6576 616c   assert set(eval
-0000ef10: 2867 726f 7570 732e 6772 6f75 7028 3229  (groups.group(2)
-0000ef20: 2929 203d 3d20 7b27 6e6f 745f 6869 6768  )) == {'not_high
-0000ef30: 5f63 6f6c 756d 6e27 2c20 276e 6f74 5f6c  _column', 'not_l
-0000ef40: 6f77 5f63 6f6c 756d 6e27 7d0a 2020 2020  ow_column'}.    
-0000ef50: 2020 2020 6173 7365 7274 2073 7472 2865      assert str(e
-0000ef60: 7661 6c28 6772 6f75 7073 2e67 726f 7570  val(groups.group
-0000ef70: 2833 2929 2920 3d3d 2027 2b27 0a0a 2020  (3))) == '+'..  
-0000ef80: 2020 6465 6620 7465 7374 5f5f 7661 6c69    def test__vali
-0000ef90: 6461 7465 5f6d 6574 6164 6174 615f 636f  date_metadata_co
-0000efa0: 6c75 6d6e 7328 7365 6c66 293a 0a20 2020  lumns(self):.   
-0000efb0: 2020 2020 2022 2222 5465 7374 2074 6865       """Test the
-0000efc0: 2060 605f 7661 6c69 6461 7465 5f6d 6574   ``_validate_met
-0000efd0: 6164 6174 615f 636f 6c75 6d6e 7360 6020  adata_columns`` 
-0000efe0: 6d65 7468 6f64 2e0a 0a20 2020 2020 2020  method...       
-0000eff0: 2041 6c6c 206f 6620 7468 6520 636f 6c75   All of the colu
-0000f000: 6d6e 7320 7061 7373 6564 2069 6e20 636f  mns passed in co
-0000f010: 6c75 6d6e 5f6e 616d 6573 2073 686f 756c  lumn_names shoul
-0000f020: 6420 6265 2069 6e20 7468 6520 6d65 7461  d be in the meta
-0000f030: 6461 7461 2e0a 0a20 2020 2020 2020 2049  data...        I
-0000f040: 6e70 7574 3a0a 2020 2020 2020 2020 2020  nput:.          
-0000f050: 2020 2d20 636f 6c75 6d6e 5f6e 616d 6520    - column_name 
-0000f060: 7769 7468 2063 6f6c 756d 6e20 7468 6174  with column that
-0000f070: 2069 7320 696e 2074 6865 206d 6574 6164   is in the metad
-0000f080: 6174 612e 0a0a 2020 2020 2020 2020 5369  ata...        Si
-0000f090: 6465 2065 6666 6563 743a 0a20 2020 2020  de effect:.     
-0000f0a0: 2020 2020 2020 202d 204e 6f20 6572 726f         - No erro
-0000f0b0: 7220 7368 6f75 6c64 2062 6520 7261 6973  r should be rais
-0000f0c0: 6564 2e0a 2020 2020 2020 2020 2222 220a  ed..        """.
-0000f0d0: 2020 2020 2020 2020 2320 5365 7475 700a          # Setup.
-0000f0e0: 2020 2020 2020 2020 6d65 7461 6461 7461          metadata
-0000f0f0: 203d 204d 6f63 6b28 290a 2020 2020 2020   = Mock().      
-0000f100: 2020 6d65 7461 6461 7461 2e63 6f6c 756d    metadata.colum
-0000f110: 6e73 203d 207b 2761 273a 2031 2c20 2762  ns = {'a': 1, 'b
-0000f120: 273a 2032 7d0a 0a20 2020 2020 2020 2023  ': 2}..        #
-0000f130: 2052 756e 0a20 2020 2020 2020 2053 6361   Run.        Sca
-0000f140: 6c61 7249 6e65 7175 616c 6974 792e 5f76  larInequality._v
-0000f150: 616c 6964 6174 655f 6d65 7461 6461 7461  alidate_metadata
-0000f160: 5f63 6f6c 756d 6e73 286d 6574 6164 6174  _columns(metadat
-0000f170: 612c 2063 6f6c 756d 6e5f 6e61 6d65 3d27  a, column_name='
-0000f180: 6127 290a 0a20 2020 2064 6566 2074 6573  a')..    def tes
-0000f190: 745f 5f76 616c 6964 6174 655f 6d65 7461  t__validate_meta
-0000f1a0: 6461 7461 5f63 6f6c 756d 6e73 5f72 6169  data_columns_rai
-0000f1b0: 7365 735f 6572 726f 7228 7365 6c66 293a  ses_error(self):
-0000f1c0: 0a20 2020 2020 2020 2022 2222 5465 7374  .        """Test
-0000f1d0: 2074 6865 2060 605f 7661 6c69 6461 7465   the ``_validate
-0000f1e0: 5f6d 6574 6164 6174 615f 636f 6c75 6d6e  _metadata_column
-0000f1f0: 7360 6020 6d65 7468 6f64 2773 2065 7272  s`` method's err
-0000f200: 6f72 2063 6f6e 6469 7469 6f6e 2e0a 0a20  or condition... 
-0000f210: 2020 2020 2020 2049 6620 7468 6520 636f         If the co
-0000f220: 6c75 6d6e 5f6e 616d 6520 6973 206e 6f74  lumn_name is not
-0000f230: 2069 6e20 7468 6520 6d65 7461 6461 7461   in the metadata
-0000f240: 2c20 616e 2065 7272 6f72 2073 686f 756c  , an error shoul
-0000f250: 6420 6265 2072 6169 7365 642e 0a0a 2020  d be raised...  
-0000f260: 2020 2020 2020 496e 7075 743a 0a20 2020        Input:.   
-0000f270: 2020 2020 2020 2020 202d 2063 6f6c 756d           - colum
-0000f280: 6e5f 6e61 6d65 2074 6861 7420 6973 206e  n_name that is n
-0000f290: 6f74 2069 6e20 7468 6520 6d65 7461 6461  ot in the metada
-0000f2a0: 7461 2e0a 0a20 2020 2020 2020 2053 6964  ta...        Sid
-0000f2b0: 6520 6566 6665 6374 3a0a 2020 2020 2020  e effect:.      
-0000f2c0: 2020 2020 2020 2d20 436f 6e73 7472 6169        - Constrai
-0000f2d0: 6e74 4d65 7461 6461 7461 4572 726f 7220  ntMetadataError 
-0000f2e0: 7368 6f75 6c64 2062 6520 7261 6973 6564  should be raised
-0000f2f0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-0000f300: 2020 2020 2020 2320 5365 7475 700a 2020        # Setup.  
-0000f310: 2020 2020 2020 6d65 7461 6461 7461 203d        metadata =
-0000f320: 204d 6f63 6b28 290a 2020 2020 2020 2020   Mock().        
-0000f330: 6d65 7461 6461 7461 2e63 6f6c 756d 6e73  metadata.columns
-0000f340: 203d 207b 2761 273a 2031 2c20 2762 273a   = {'a': 1, 'b':
-0000f350: 2032 7d0a 0a20 2020 2020 2020 2023 2052   2}..        # R
-0000f360: 756e 0a20 2020 2020 2020 2065 7272 6f72  un.        error
-0000f370: 5f6d 6573 7361 6765 203d 2072 652e 6573  _message = re.es
-0000f380: 6361 7065 280a 2020 2020 2020 2020 2020  cape(.          
-0000f390: 2020 2741 2053 6361 6c61 7249 6e65 7175    'A ScalarInequ
-0000f3a0: 616c 6974 7920 636f 6e73 7472 6169 6e74  ality constraint
-0000f3b0: 2069 7320 6265 696e 6720 6170 706c 6965   is being applie
-0000f3c0: 6420 746f 2069 6e76 616c 6964 2063 6f6c  d to invalid col
-0000f3d0: 756d 6e20 6e61 6d65 7320 270a 2020 2020  umn names '.    
-0000f3e0: 2020 2020 2020 2020 227b 2763 277d 2e20          "{'c'}. 
-0000f3f0: 5468 6520 636f 6c75 6d6e 7320 6d75 7374  The columns must
-0000f400: 2065 7869 7374 2069 6e20 7468 6520 7461   exist in the ta
-0000f410: 626c 652e 220a 2020 2020 2020 2020 290a  ble.".        ).
-0000f420: 2020 2020 2020 2020 7769 7468 2070 7974          with pyt
-0000f430: 6573 742e 7261 6973 6573 2843 6f6e 7374  est.raises(Const
-0000f440: 7261 696e 744d 6574 6164 6174 6145 7272  raintMetadataErr
-0000f450: 6f72 2c20 6d61 7463 683d 6572 726f 725f  or, match=error_
-0000f460: 6d65 7373 6167 6529 3a0a 2020 2020 2020  message):.      
-0000f470: 2020 2020 2020 5363 616c 6172 496e 6571        ScalarIneq
-0000f480: 7561 6c69 7479 2e5f 7661 6c69 6461 7465  uality._validate
-0000f490: 5f6d 6574 6164 6174 615f 636f 6c75 6d6e  _metadata_column
-0000f4a0: 7328 6d65 7461 6461 7461 2c20 636f 6c75  s(metadata, colu
-0000f4b0: 6d6e 5f6e 616d 653d 2763 2729 0a0a 2020  mn_name='c')..  
-0000f4c0: 2020 6465 6620 7465 7374 5f5f 7661 6c69    def test__vali
-0000f4d0: 6461 7465 5f6d 6574 6164 6174 615f 7370  date_metadata_sp
-0000f4e0: 6563 6966 6963 5f74 6f5f 636f 6e73 7472  ecific_to_constr
-0000f4f0: 6169 6e74 5f6e 756d 6572 6963 616c 2873  aint_numerical(s
-0000f500: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-0000f510: 2254 6573 7420 7468 6520 6060 5f76 616c  "Test the ``_val
-0000f520: 6964 6174 655f 6d65 7461 6461 7461 5f73  idate_metadata_s
-0000f530: 7065 6369 6669 635f 746f 5f63 6f6e 7374  pecific_to_const
-0000f540: 7261 696e 7460 6020 6d65 7468 6f64 2e0a  raint`` method..
-0000f550: 0a20 2020 2020 2020 2049 6620 7468 6520  .        If the 
-0000f560: 636f 6c75 6d6e 5f6e 616d 6520 6861 7320  column_name has 
-0000f570: 616e 2073 6474 7970 6520 6f66 206e 756d  an sdtype of num
-0000f580: 6572 6963 616c 2c20 616e 6420 7468 6520  erical, and the 
-0000f590: 7661 6c75 650a 2020 2020 2020 2020 6973  value.        is
-0000f5a0: 2061 6e20 696e 7420 6f72 2066 6c6f 6174   an int or float
-0000f5b0: 2c20 7468 656e 206e 6f20 6572 726f 7220  , then no error 
-0000f5c0: 7368 6f75 6c64 2062 6520 7261 6973 6564  should be raised
-0000f5d0: 2e0a 0a20 2020 2020 2020 2053 6574 7570  ...        Setup
-0000f5e0: 3a0a 2020 2020 2020 2020 2020 2020 2d20  :.            - 
-0000f5f0: 4d65 7461 6461 7461 2077 6974 6820 7468  Metadata with th
-0000f600: 6520 7364 7479 7065 2073 6574 2074 6f20  e sdtype set to 
-0000f610: 6e75 6d65 7269 6361 6c2e 0a0a 2020 2020  numerical...    
-0000f620: 2020 2020 496e 7075 743a 0a20 2020 2020      Input:.     
-0000f630: 2020 2020 2020 202d 2054 6865 2063 6f6c         - The col
-0000f640: 756d 6e20 6e61 6d65 2061 6e64 2061 2076  umn name and a v
-0000f650: 616c 7565 2073 6574 2074 6f20 6120 6e75  alue set to a nu
-0000f660: 6d62 6572 2e0a 2020 2020 2020 2020 2222  mber..        ""
-0000f670: 220a 2020 2020 2020 2020 2320 5365 7475  ".        # Setu
-0000f680: 700a 2020 2020 2020 2020 6d65 7461 6461  p.        metada
-0000f690: 7461 203d 204d 6f63 6b28 290a 2020 2020  ta = Mock().    
-0000f6a0: 2020 2020 6d65 7461 6461 7461 2e63 6f6c      metadata.col
-0000f6b0: 756d 6e73 203d 207b 2761 273a 207b 2773  umns = {'a': {'s
-0000f6c0: 6474 7970 6527 3a20 276e 756d 6572 6963  dtype': 'numeric
-0000f6d0: 616c 277d 7d0a 0a20 2020 2020 2020 2023  al'}}..        #
-0000f6e0: 2052 756e 0a20 2020 2020 2020 2053 6361   Run.        Sca
-0000f6f0: 6c61 7249 6e65 7175 616c 6974 792e 5f76  larInequality._v
-0000f700: 616c 6964 6174 655f 6d65 7461 6461 7461  alidate_metadata
-0000f710: 5f73 7065 6369 6669 635f 746f 5f63 6f6e  _specific_to_con
-0000f720: 7374 7261 696e 7428 0a20 2020 2020 2020  straint(.       
-0000f730: 2020 2020 206d 6574 6164 6174 612c 0a20       metadata,. 
-0000f740: 2020 2020 2020 2020 2020 2063 6f6c 756d             colum
-0000f750: 6e5f 6e61 6d65 3d27 6127 2c0a 2020 2020  n_name='a',.    
-0000f760: 2020 2020 2020 2020 7265 6c61 7469 6f6e          relation
-0000f770: 3d27 3e27 2c0a 2020 2020 2020 2020 2020  ='>',.          
-0000f780: 2020 7661 6c75 653d 370a 2020 2020 2020    value=7.      
-0000f790: 2020 290a 0a20 2020 2064 6566 2074 6573    )..    def tes
-0000f7a0: 745f 5f76 616c 6964 6174 655f 6d65 7461  t__validate_meta
-0000f7b0: 6461 7461 5f73 7065 6369 6669 635f 746f  data_specific_to
-0000f7c0: 5f63 6f6e 7374 7261 696e 745f 6e75 6d65  _constraint_nume
-0000f7d0: 7269 6361 6c5f 6572 726f 7228 7365 6c66  rical_error(self
-0000f7e0: 293a 0a20 2020 2020 2020 2022 2222 5465  ):.        """Te
-0000f7f0: 7374 2074 6865 2060 605f 7661 6c69 6461  st the ``_valida
-0000f800: 7465 5f6d 6574 6164 6174 615f 7370 6563  te_metadata_spec
-0000f810: 6966 6963 5f74 6f5f 636f 6e73 7472 6169  ific_to_constrai
-0000f820: 6e74 6060 206d 6574 686f 642e 0a0a 2020  nt`` method...  
-0000f830: 2020 2020 2020 4966 2074 6865 2063 6f6c        If the col
-0000f840: 756d 6e5f 6e61 6d65 2068 6173 2061 6e20  umn_name has an 
-0000f850: 7364 7479 7065 206f 6620 6e75 6d65 7269  sdtype of numeri
-0000f860: 6361 6c2c 2061 6e64 2074 6865 2076 616c  cal, and the val
-0000f870: 7565 0a20 2020 2020 2020 2069 7320 6e6f  ue.        is no
-0000f880: 7420 616e 2069 6e74 206f 7220 666c 6f61  t an int or floa
-0000f890: 742c 2074 6865 6e20 616e 2065 7272 6f72  t, then an error
-0000f8a0: 2073 686f 756c 6420 6265 2072 6169 7365   should be raise
-0000f8b0: 642e 0a0a 2020 2020 2020 2020 5365 7475  d...        Setu
-0000f8c0: 703a 0a20 2020 2020 2020 2020 2020 202d  p:.            -
-0000f8d0: 204d 6574 6164 6174 6120 7769 7468 2074   Metadata with t
-0000f8e0: 6865 2073 6474 7970 6520 7365 7420 746f  he sdtype set to
-0000f8f0: 206e 756d 6572 6963 616c 2e0a 0a20 2020   numerical...   
-0000f900: 2020 2020 2049 6e70 7574 3a0a 2020 2020       Input:.    
-0000f910: 2020 2020 2020 2020 2d20 5468 6520 636f          - The co
-0000f920: 6c75 6d6e 206e 616d 6520 616e 6420 6120  lumn name and a 
-0000f930: 7661 6c75 6520 7365 7420 746f 2061 2073  value set to a s
-0000f940: 7472 696e 672e 0a20 2020 2020 2020 2022  tring..        "
-0000f950: 2222 0a20 2020 2020 2020 2023 2053 6574  "".        # Set
-0000f960: 7570 0a20 2020 2020 2020 206d 6574 6164  up.        metad
-0000f970: 6174 6120 3d20 4d6f 636b 2829 0a20 2020  ata = Mock().   
-0000f980: 2020 2020 206d 6574 6164 6174 612e 636f       metadata.co
-0000f990: 6c75 6d6e 7320 3d20 7b27 6127 3a20 7b27  lumns = {'a': {'
-0000f9a0: 7364 7479 7065 273a 2027 6e75 6d65 7269  sdtype': 'numeri
-0000f9b0: 6361 6c27 7d7d 0a0a 2020 2020 2020 2020  cal'}}..        
-0000f9c0: 2320 5275 6e0a 2020 2020 2020 2020 6572  # Run.        er
-0000f9d0: 726f 725f 6d65 7373 6167 6520 3d20 2227  ror_message = "'
-0000f9e0: 7661 6c75 6527 206d 7573 7420 6265 2061  value' must be a
-0000f9f0: 6e20 696e 7420 6f72 2066 6c6f 6174 2e22  n int or float."
-0000fa00: 0a20 2020 2020 2020 2077 6974 6820 7079  .        with py
-0000fa10: 7465 7374 2e72 6169 7365 7328 436f 6e73  test.raises(Cons
-0000fa20: 7472 6169 6e74 4d65 7461 6461 7461 4572  traintMetadataEr
-0000fa30: 726f 722c 206d 6174 6368 3d65 7272 6f72  ror, match=error
-0000fa40: 5f6d 6573 7361 6765 293a 0a20 2020 2020  _message):.     
-0000fa50: 2020 2020 2020 2053 6361 6c61 7249 6e65         ScalarIne
-0000fa60: 7175 616c 6974 792e 5f76 616c 6964 6174  quality._validat
-0000fa70: 655f 6d65 7461 6461 7461 5f73 7065 6369  e_metadata_speci
-0000fa80: 6669 635f 746f 5f63 6f6e 7374 7261 696e  fic_to_constrain
-0000fa90: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
-0000faa0: 2020 206d 6574 6164 6174 612c 0a20 2020     metadata,.   
-0000fab0: 2020 2020 2020 2020 2020 2020 2063 6f6c               col
-0000fac0: 756d 6e5f 6e61 6d65 3d27 6127 2c0a 2020  umn_name='a',.  
-0000fad0: 2020 2020 2020 2020 2020 2020 2020 7265                re
-0000fae0: 6c61 7469 6f6e 3d27 3e27 2c0a 2020 2020  lation='>',.    
-0000faf0: 2020 2020 2020 2020 2020 2020 7661 6c75              valu
-0000fb00: 653d 2737 270a 2020 2020 2020 2020 2020  e='7'.          
-0000fb10: 2020 290a 0a20 2020 2040 7061 7463 6828    )..    @patch(
-0000fb20: 2773 6476 2e63 6f6e 7374 7261 696e 7473  'sdv.constraints
-0000fb30: 2e74 6162 756c 6172 2e6d 6174 6368 6573  .tabular.matches
-0000fb40: 5f64 6174 6574 696d 655f 666f 726d 6174  _datetime_format
-0000fb50: 2729 0a20 2020 2064 6566 2074 6573 745f  ').    def test_
-0000fb60: 5f76 616c 6964 6174 655f 6d65 7461 6461  _validate_metada
-0000fb70: 7461 5f73 7065 6369 6669 635f 746f 5f63  ta_specific_to_c
-0000fb80: 6f6e 7374 7261 696e 745f 6461 7465 7469  onstraint_dateti
-0000fb90: 6d65 2873 656c 662c 2064 6174 6574 696d  me(self, datetim
-0000fba0: 655f 666f 726d 6174 5f6d 6f63 6b29 3a0a  e_format_mock):.
-0000fbb0: 2020 2020 2020 2020 2222 2254 6573 7420          """Test 
-0000fbc0: 7468 6520 6060 5f76 616c 6964 6174 655f  the ``_validate_
-0000fbd0: 6d65 7461 6461 7461 5f73 7065 6369 6669  metadata_specifi
-0000fbe0: 635f 746f 5f63 6f6e 7374 7261 696e 7460  c_to_constraint`
-0000fbf0: 6020 6d65 7468 6f64 2e0a 0a20 2020 2020  ` method...     
-0000fc00: 2020 2049 6620 7468 6520 636f 6c75 6d6e     If the column
-0000fc10: 5f6e 616d 6520 6861 7320 616e 2073 6474  _name has an sdt
-0000fc20: 7970 6520 6f66 2064 6174 6574 696d 652c  ype of datetime,
-0000fc30: 2061 6e64 2074 6865 2076 616c 7565 0a20   and the value. 
-0000fc40: 2020 2020 2020 2069 7320 6120 6461 7465         is a date
-0000fc50: 7469 6d65 2073 7472 696e 6720 7468 6174  time string that
-0000fc60: 206d 6174 6368 6573 2074 6865 2066 6f72   matches the for
-0000fc70: 6d61 742c 2074 6865 6e20 6e6f 2065 7272  mat, then no err
-0000fc80: 6f72 2073 686f 756c 6420 6265 2072 6169  or should be rai
-0000fc90: 7365 642e 0a0a 2020 2020 2020 2020 5365  sed...        Se
-0000fca0: 7475 703a 0a20 2020 2020 2020 2020 2020  tup:.           
-0000fcb0: 202d 204d 6574 6164 6174 6120 7769 7468   - Metadata with
-0000fcc0: 2074 6865 2073 6474 7970 6520 7365 7420   the sdtype set 
-0000fcd0: 746f 2064 6174 6574 696d 6520 616e 6420  to datetime and 
-0000fce0: 6120 6461 7465 7469 6d65 5f66 6f72 6d61  a datetime_forma
-0000fcf0: 742e 0a20 2020 2020 2020 2020 2020 202d  t..            -
-0000fd00: 204d 6f63 6b20 7468 6520 6060 6d61 7463   Mock the ``matc
-0000fd10: 6865 735f 6461 7465 7469 6d65 5f66 6f72  hes_datetime_for
-0000fd20: 6d61 7460 6020 6675 6e63 7469 6f6e 2074  mat`` function t
-0000fd30: 6f20 7265 7475 726e 2054 7275 652e 0a0a  o return True...
-0000fd40: 2020 2020 2020 2020 496e 7075 743a 0a20          Input:. 
-0000fd50: 2020 2020 2020 2020 2020 202d 2054 6865             - The
-0000fd60: 2063 6f6c 756d 6e20 6e61 6d65 2061 6e64   column name and
-0000fd70: 2061 2076 616c 7565 2073 6574 2074 6f20   a value set to 
-0000fd80: 6120 6461 7465 7469 6d65 206f 6620 7468  a datetime of th
-0000fd90: 6520 7269 6768 7420 666f 726d 6174 2e0a  e right format..
-0000fda0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0000fdb0: 2020 2020 2320 5365 7475 700a 2020 2020      # Setup.    
-0000fdc0: 2020 2020 6d65 7461 6461 7461 203d 204d      metadata = M
-0000fdd0: 6f63 6b28 290a 2020 2020 2020 2020 6d65  ock().        me
-0000fde0: 7461 6461 7461 2e63 6f6c 756d 6e73 203d  tadata.columns =
-0000fdf0: 207b 2761 273a 207b 2773 6474 7970 6527   {'a': {'sdtype'
-0000fe00: 3a20 2764 6174 6574 696d 6527 2c20 2764  : 'datetime', 'd
-0000fe10: 6174 6574 696d 655f 666f 726d 6174 273a  atetime_format':
-0000fe20: 2027 6d2f 642f 7927 7d7d 0a20 2020 2020   'm/d/y'}}.     
-0000fe30: 2020 2064 6174 6574 696d 655f 666f 726d     datetime_form
-0000fe40: 6174 5f6d 6f63 6b2e 7265 7475 726e 5f76  at_mock.return_v
-0000fe50: 616c 7565 203d 2054 7275 650a 0a20 2020  alue = True..   
-0000fe60: 2020 2020 2023 2052 756e 0a20 2020 2020       # Run.     
-0000fe70: 2020 2053 6361 6c61 7249 6e65 7175 616c     ScalarInequal
-0000fe80: 6974 792e 5f76 616c 6964 6174 655f 6d65  ity._validate_me
-0000fe90: 7461 6461 7461 5f73 7065 6369 6669 635f  tadata_specific_
-0000fea0: 746f 5f63 6f6e 7374 7261 696e 7428 0a20  to_constraint(. 
-0000feb0: 2020 2020 2020 2020 2020 206d 6574 6164             metad
-0000fec0: 6174 612c 0a20 2020 2020 2020 2020 2020  ata,.           
-0000fed0: 2063 6f6c 756d 6e5f 6e61 6d65 3d27 6127   column_name='a'
-0000fee0: 2c0a 2020 2020 2020 2020 2020 2020 7265  ,.            re
-0000fef0: 6c61 7469 6f6e 3d27 3e27 2c0a 2020 2020  lation='>',.    
-0000ff00: 2020 2020 2020 2020 7661 6c75 653d 2731          value='1
-0000ff10: 2f31 2f32 3032 3027 0a20 2020 2020 2020  /1/2020'.       
-0000ff20: 2029 0a0a 2020 2020 4070 6174 6368 2827   )..    @patch('
-0000ff30: 7364 762e 636f 6e73 7472 6169 6e74 732e  sdv.constraints.
-0000ff40: 7461 6275 6c61 722e 6d61 7463 6865 735f  tabular.matches_
-0000ff50: 6461 7465 7469 6d65 5f66 6f72 6d61 7427  datetime_format'
-0000ff60: 290a 2020 2020 6465 6620 7465 7374 5f5f  ).    def test__
-0000ff70: 7661 6c69 6461 7465 5f6d 6574 6164 6174  validate_metadat
-0000ff80: 615f 7370 6563 6966 6963 5f74 6f5f 636f  a_specific_to_co
-0000ff90: 6e73 7472 6169 6e74 5f64 6174 6574 696d  nstraint_datetim
-0000ffa0: 655f 6572 726f 7228 7365 6c66 2c20 6461  e_error(self, da
-0000ffb0: 7465 7469 6d65 5f66 6f72 6d61 745f 6d6f  tetime_format_mo
-0000ffc0: 636b 293a 0a20 2020 2020 2020 2022 2222  ck):.        """
-0000ffd0: 5465 7374 2074 6865 2060 605f 7661 6c69  Test the ``_vali
-0000ffe0: 6461 7465 5f6d 6574 6164 6174 615f 7370  date_metadata_sp
-0000fff0: 6563 6966 6963 5f74 6f5f 636f 6e73 7472  ecific_to_constr
-00010000: 6169 6e74 6060 206d 6574 686f 642e 0a0a  aint`` method...
-00010010: 2020 2020 2020 2020 4966 2074 6865 2063          If the c
-00010020: 6f6c 756d 6e5f 6e61 6d65 2068 6173 2061  olumn_name has a
-00010030: 6e20 7364 7479 7065 206f 6620 6461 7465  n sdtype of date
-00010040: 7469 6d65 2c20 616e 6420 7468 6520 7661  time, and the va
-00010050: 6c75 650a 2020 2020 2020 2020 6973 2061  lue.        is a
-00010060: 2064 6174 6574 696d 6520 7374 7269 6e67   datetime string
-00010070: 2074 6861 7420 646f 6573 6e27 7420 6d61   that doesn't ma
-00010080: 7463 6820 7468 6520 666f 726d 6174 2c20  tch the format, 
-00010090: 7468 656e 2061 6e20 6572 726f 7220 7368  then an error sh
-000100a0: 6f75 6c64 2062 6520 7261 6973 6564 2e0a  ould be raised..
-000100b0: 0a20 2020 2020 2020 2053 6574 7570 3a0a  .        Setup:.
-000100c0: 2020 2020 2020 2020 2020 2020 2d20 4d65              - Me
-000100d0: 7461 6461 7461 2077 6974 6820 7468 6520  tadata with the 
-000100e0: 7364 7479 7065 2073 6574 2074 6f20 6461  sdtype set to da
-000100f0: 7465 7469 6d65 2061 6e64 2061 2064 6174  tetime and a dat
-00010100: 6574 696d 655f 666f 726d 6174 2e0a 2020  etime_format..  
-00010110: 2020 2020 2020 2020 2020 2d20 4d6f 636b            - Mock
-00010120: 2074 6865 2060 606d 6174 6368 6573 5f64   the ``matches_d
-00010130: 6174 6574 696d 655f 666f 726d 6174 6060  atetime_format``
-00010140: 2066 756e 6374 696f 6e20 746f 2072 6574   function to ret
-00010150: 7572 6e20 4661 6c73 652e 0a0a 2020 2020  urn False...    
-00010160: 2020 2020 496e 7075 743a 0a20 2020 2020      Input:.     
-00010170: 2020 2020 2020 202d 2054 6865 2063 6f6c         - The col
-00010180: 756d 6e20 6e61 6d65 2061 6e64 2061 2076  umn name and a v
-00010190: 616c 7565 2073 6574 2074 6f20 6120 6461  alue set to a da
-000101a0: 7465 7469 6d65 206f 6620 7468 6520 7772  tetime of the wr
-000101b0: 6f6e 6720 666f 726d 6174 2e0a 0a20 2020  ong format...   
-000101c0: 2020 2020 2053 6964 6520 6566 6665 6374       Side effect
-000101d0: 3a0a 2020 2020 2020 2020 2020 2020 2d20  :.            - 
-000101e0: 4120 436f 6e73 7472 6169 6e74 4d65 7461  A ConstraintMeta
-000101f0: 6461 7461 4572 726f 7220 7368 6f75 6c64  dataError should
-00010200: 2062 6520 7261 6973 6564 2e0a 2020 2020   be raised..    
-00010210: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00010220: 2320 5365 7475 700a 2020 2020 2020 2020  # Setup.        
-00010230: 6d65 7461 6461 7461 203d 204d 6f63 6b28  metadata = Mock(
-00010240: 290a 2020 2020 2020 2020 6d65 7461 6461  ).        metada
-00010250: 7461 2e63 6f6c 756d 6e73 203d 207b 2761  ta.columns = {'a
-00010260: 273a 207b 2773 6474 7970 6527 3a20 2764  ': {'sdtype': 'd
-00010270: 6174 6574 696d 6527 2c20 2764 6174 6574  atetime', 'datet
-00010280: 696d 655f 666f 726d 6174 273a 2027 6d2f  ime_format': 'm/
-00010290: 642f 7927 7d7d 0a20 2020 2020 2020 2064  d/y'}}.        d
-000102a0: 6174 6574 696d 655f 666f 726d 6174 5f6d  atetime_format_m
-000102b0: 6f63 6b2e 7265 7475 726e 5f76 616c 7565  ock.return_value
-000102c0: 203d 2046 616c 7365 0a0a 2020 2020 2020   = False..      
-000102d0: 2020 2320 5275 6e0a 2020 2020 2020 2020    # Run.        
-000102e0: 6572 726f 725f 6d65 7373 6167 6520 3d20  error_message = 
-000102f0: 2227 7661 6c75 6527 206d 7573 7420 6265  "'value' must be
-00010300: 2061 2064 6174 6574 696d 6520 7374 7269   a datetime stri
-00010310: 6e67 206f 6620 7468 6520 7269 6768 7420  ng of the right 
-00010320: 666f 726d 6174 220a 2020 2020 2020 2020  format".        
-00010330: 7769 7468 2070 7974 6573 742e 7261 6973  with pytest.rais
-00010340: 6573 2843 6f6e 7374 7261 696e 744d 6574  es(ConstraintMet
-00010350: 6164 6174 6145 7272 6f72 2c20 6d61 7463  adataError, matc
-00010360: 683d 6572 726f 725f 6d65 7373 6167 6529  h=error_message)
-00010370: 3a0a 2020 2020 2020 2020 2020 2020 5363  :.            Sc
-00010380: 616c 6172 496e 6571 7561 6c69 7479 2e5f  alarInequality._
-00010390: 7661 6c69 6461 7465 5f6d 6574 6164 6174  validate_metadat
-000103a0: 615f 7370 6563 6966 6963 5f74 6f5f 636f  a_specific_to_co
-000103b0: 6e73 7472 6169 6e74 280a 2020 2020 2020  nstraint(.      
-000103c0: 2020 2020 2020 2020 2020 6d65 7461 6461            metada
-000103d0: 7461 2c0a 2020 2020 2020 2020 2020 2020  ta,.            
-000103e0: 2020 2020 636f 6c75 6d6e 5f6e 616d 653d      column_name=
-000103f0: 2761 272c 0a20 2020 2020 2020 2020 2020  'a',.           
-00010400: 2020 2020 2072 656c 6174 696f 6e3d 273e       relation='>
-00010410: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
-00010420: 2020 2076 616c 7565 3d27 312d 312d 3230     value='1-1-20
-00010430: 3230 270a 2020 2020 2020 2020 2020 2020  20'.            
-00010440: 290a 0a20 2020 2064 6566 2074 6573 745f  )..    def test_
-00010450: 5f76 616c 6964 6174 655f 6d65 7461 6461  _validate_metada
-00010460: 7461 5f73 7065 6369 6669 635f 746f 5f63  ta_specific_to_c
-00010470: 6f6e 7374 7261 696e 745f 6261 645f 7479  onstraint_bad_ty
-00010480: 7065 2873 656c 6629 3a0a 2020 2020 2020  pe(self):.      
-00010490: 2020 2222 2254 6573 7420 7468 6520 6060    """Test the ``
-000104a0: 5f76 616c 6964 6174 655f 6d65 7461 6461  _validate_metada
-000104b0: 7461 5f73 7065 6369 6669 635f 746f 5f63  ta_specific_to_c
-000104c0: 6f6e 7374 7261 696e 7460 6020 6d65 7468  onstraint`` meth
-000104d0: 6f64 2e0a 0a20 2020 2020 2020 2049 6620  od...        If 
-000104e0: 7468 6520 636f 6c75 6d6e 5f6e 616d 6520  the column_name 
-000104f0: 6861 7320 616e 2073 6474 7970 6520 7468  has an sdtype th
-00010500: 6174 2069 7320 6e6f 7420 6120 6461 7465  at is not a date
-00010510: 7469 6d65 2073 7472 696e 672c 2069 6e74  time string, int
-00010520: 206f 720a 2020 2020 2020 2020 666c 6f61   or.        floa
-00010530: 7420 7468 656e 2061 6e20 6572 726f 7220  t then an error 
-00010540: 7368 6f75 6c64 2062 6520 7261 6973 6564  should be raised
-00010550: 2e0a 0a20 2020 2020 2020 2053 6574 7570  ...        Setup
-00010560: 3a0a 2020 2020 2020 2020 2020 2020 2d20  :.            - 
-00010570: 4d65 7461 6461 7461 2077 6974 6820 7468  Metadata with th
-00010580: 6520 7364 7479 7065 2073 6574 2074 6f20  e sdtype set to 
-00010590: 6361 7465 676f 7269 6361 6c2e 0a0a 2020  categorical...  
-000105a0: 2020 2020 2020 496e 7075 743a 0a20 2020        Input:.   
-000105b0: 2020 2020 2020 2020 202d 2054 6865 2063           - The c
-000105c0: 6f6c 756d 6e20 6e61 6d65 2c20 7265 6c61  olumn name, rela
-000105d0: 7469 6f6e 2061 6e64 2076 616c 7565 2e0a  tion and value..
-000105e0: 0a20 2020 2020 2020 2053 6964 6520 6566  .        Side ef
-000105f0: 6665 6374 3a0a 2020 2020 2020 2020 2020  fect:.          
-00010600: 2020 2d20 4120 436f 6e73 7472 6169 6e74    - A Constraint
-00010610: 4d65 7461 6461 7461 4572 726f 7220 7368  MetadataError sh
-00010620: 6f75 6c64 2062 6520 7261 6973 6564 2e0a  ould be raised..
-00010630: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00010640: 2020 2020 2320 5365 7475 700a 2020 2020      # Setup.    
-00010650: 2020 2020 6d65 7461 6461 7461 203d 204d      metadata = M
-00010660: 6f63 6b28 290a 2020 2020 2020 2020 6d65  ock().        me
-00010670: 7461 6461 7461 2e63 6f6c 756d 6e73 203d  tadata.columns =
-00010680: 207b 2761 273a 207b 2773 6474 7970 6527   {'a': {'sdtype'
-00010690: 3a20 2763 6174 6567 6f72 6963 616c 277d  : 'categorical'}
-000106a0: 7d0a 0a20 2020 2020 2020 2023 2052 756e  }..        # Run
-000106b0: 0a20 2020 2020 2020 2065 7272 6f72 5f6d  .        error_m
-000106c0: 6573 7361 6765 203d 2028 0a20 2020 2020  essage = (.     
-000106d0: 2020 2020 2020 2027 4120 5363 616c 6172         'A Scalar
-000106e0: 496e 6571 7561 6c69 7479 2063 6f6e 7374  Inequality const
-000106f0: 7261 696e 7420 6973 2062 6569 6e67 2061  raint is being a
-00010700: 7070 6c69 6564 2074 6f20 636f 6c75 6d6e  pplied to column
-00010710: 7320 7769 7468 206d 6973 6d61 7463 6865  s with mismatche
-00010720: 6420 7364 7479 7065 732e 2027 0a20 2020  d sdtypes. '.   
-00010730: 2020 2020 2020 2020 2027 4e75 6d65 7269           'Numeri
-00010740: 6361 6c20 636f 6c75 6d6e 7320 6d75 7374  cal columns must
-00010750: 2062 6520 636f 6d70 6172 6564 2074 6f20   be compared to 
-00010760: 696e 7465 6765 7220 6f72 2066 6c6f 6174  integer or float
-00010770: 2076 616c 7565 732e 2027 0a20 2020 2020   values. '.     
-00010780: 2020 2020 2020 2027 4461 7465 7469 6d65         'Datetime
-00010790: 7320 636f 6c75 6d6e 206d 7573 7420 6265  s column must be
-000107a0: 2063 6f6d 7061 7265 6420 746f 2064 6174   compared to dat
-000107b0: 6574 696d 6520 7374 7269 6e67 732e 270a  etime strings.'.
-000107c0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-000107d0: 2020 7769 7468 2070 7974 6573 742e 7261    with pytest.ra
-000107e0: 6973 6573 2843 6f6e 7374 7261 696e 744d  ises(ConstraintM
-000107f0: 6574 6164 6174 6145 7272 6f72 2c20 6d61  etadataError, ma
-00010800: 7463 683d 6572 726f 725f 6d65 7373 6167  tch=error_messag
-00010810: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
-00010820: 5363 616c 6172 496e 6571 7561 6c69 7479  ScalarInequality
-00010830: 2e5f 7661 6c69 6461 7465 5f6d 6574 6164  ._validate_metad
-00010840: 6174 615f 7370 6563 6966 6963 5f74 6f5f  ata_specific_to_
-00010850: 636f 6e73 7472 6169 6e74 280a 2020 2020  constraint(.    
-00010860: 2020 2020 2020 2020 2020 2020 6d65 7461              meta
-00010870: 6461 7461 2c0a 2020 2020 2020 2020 2020  data,.          
-00010880: 2020 2020 2020 636f 6c75 6d6e 5f6e 616d        column_nam
-00010890: 653d 2761 272c 0a20 2020 2020 2020 2020  e='a',.         
-000108a0: 2020 2020 2020 2072 656c 6174 696f 6e3d         relation=
-000108b0: 273e 272c 0a20 2020 2020 2020 2020 2020  '>',.           
-000108c0: 2020 2020 2076 616c 7565 3d37 0a20 2020       value=7.   
-000108d0: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-000108e0: 6465 6620 7465 7374 5f5f 7661 6c69 6461  def test__valida
-000108f0: 7465 5f69 6e69 745f 696e 7075 7473 5f69  te_init_inputs_i
-00010900: 6e63 6f72 7265 6374 5f63 6f6c 756d 6e28  ncorrect_column(
-00010910: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
-00010920: 2222 5465 7374 2074 6865 2060 605f 7661  ""Test the ``_va
-00010930: 6c69 6461 7465 5f69 6e69 745f 696e 7075  lidate_init_inpu
-00010940: 7473 6060 206d 6574 686f 642e 0a0a 2020  ts`` method...  
-00010950: 2020 2020 2020 456e 7375 7265 2074 6865        Ensure the
-00010960: 206d 6574 686f 6420 7261 6973 6573 2061   method raises a
-00010970: 6e20 6572 726f 7220 7768 656e 2074 6865  n error when the
-00010980: 2063 6f6c 756d 6e20 6e61 6d65 2069 7320   column name is 
-00010990: 6e6f 7420 6120 7374 7269 6e67 2e0a 0a20  not a string... 
-000109a0: 2020 2020 2020 2049 6e70 7574 3a0a 2020         Input:.  
-000109b0: 2020 2020 2020 2d20 6120 6e6f 6e2d 7374        - a non-st
-000109c0: 7269 6e67 0a20 2020 2020 2020 202d 2061  ring.        - a
-000109d0: 206e 756d 6265 720a 2020 2020 2020 2020   number.        
-000109e0: 2d20 616e 2069 6e65 7175 616c 6974 790a  - an inequality.
-000109f0: 2020 2020 2020 2020 5369 6465 2065 6666          Side eff
-00010a00: 6563 743a 0a20 2020 2020 2020 202d 2052  ect:.        - R
-00010a10: 6169 7365 2060 6056 616c 7565 4572 726f  aise ``ValueErro
-00010a20: 7260 6020 6265 6361 7573 6520 7468 6520  r`` because the 
-00010a30: 636f 6c75 6d6e 206e 616d 6520 6d75 7374  column name must
-00010a40: 2062 6520 6120 7374 7269 6e67 0a20 2020   be a string.   
-00010a50: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00010a60: 2023 2052 756e 202f 2041 7373 6572 740a   # Run / Assert.
-00010a70: 2020 2020 2020 2020 6572 725f 6d73 6720          err_msg 
-00010a80: 3d20 2760 636f 6c75 6d6e 5f6e 616d 6560  = '`column_name`
-00010a90: 206d 7573 7420 6265 2061 2073 7472 696e   must be a strin
-00010aa0: 672e 270a 2020 2020 2020 2020 7769 7468  g.'.        with
-00010ab0: 2070 7974 6573 742e 7261 6973 6573 2856   pytest.raises(V
-00010ac0: 616c 7565 4572 726f 722c 206d 6174 6368  alueError, match
-00010ad0: 3d65 7272 5f6d 7367 293a 0a20 2020 2020  =err_msg):.     
-00010ae0: 2020 2020 2020 2053 6361 6c61 7249 6e65         ScalarIne
-00010af0: 7175 616c 6974 792e 5f76 616c 6964 6174  quality._validat
-00010b00: 655f 696e 6974 5f69 6e70 7574 7328 636f  e_init_inputs(co
-00010b10: 6c75 6d6e 5f6e 616d 653d 5b27 6127 5d2c  lumn_name=['a'],
-00010b20: 2076 616c 7565 3d31 2c20 7265 6c61 7469   value=1, relati
-00010b30: 6f6e 3d27 3e27 290a 0a20 2020 2064 6566  on='>')..    def
-00010b40: 2074 6573 745f 5f76 616c 6964 6174 655f   test__validate_
-00010b50: 696e 6974 5f69 6e70 7574 735f 696e 636f  init_inputs_inco
-00010b60: 7272 6563 745f 7661 6c75 655f 6461 7465  rrect_value_date
-00010b70: 7469 6d65 2873 656c 6629 3a0a 2020 2020  time(self):.    
-00010b80: 2020 2020 2222 2254 6573 7420 7468 6520      """Test the 
-00010b90: 6060 5f76 616c 6964 6174 655f 696e 6974  ``_validate_init
-00010ba0: 5f69 6e70 7574 7360 6020 6d65 7468 6f64  _inputs`` method
-00010bb0: 2e0a 0a20 2020 2020 2020 2045 6e73 7572  ...        Ensur
-00010bc0: 6520 7468 6520 6d65 7468 6f64 2072 6169  e the method rai
-00010bd0: 7365 7320 616e 2065 7272 6f72 2077 6865  ses an error whe
-00010be0: 6e20 7468 6520 6060 7661 6c75 6560 6020  n the ``value`` 
-00010bf0: 6973 206e 6f74 2061 2060 6044 6174 6574  is not a ``Datet
-00010c00: 696d 6560 6020 7265 7072 6573 656e 7465  ime`` represente
-00010c10: 640a 2020 2020 2020 2020 6173 2073 7472  d.        as str
-00010c20: 696e 672e 0a0a 2020 2020 2020 2020 496e  ing...        In
-00010c30: 7075 743a 0a20 2020 2020 2020 202d 2061  put:.        - a
-00010c40: 2073 7472 696e 670a 2020 2020 2020 2020   string.        
-00010c50: 2d20 6120 6e6f 6e20 7374 7269 6e67 2064  - a non string d
-00010c60: 6174 6574 696d 650a 2020 2020 2020 2020  atetime.        
-00010c70: 2d20 616e 2069 6e65 7175 616c 6974 790a  - an inequality.
-00010c80: 2020 2020 2020 2020 5369 6465 2065 6666          Side eff
-00010c90: 6563 743a 0a20 2020 2020 2020 202d 2052  ect:.        - R
-00010ca0: 6169 7365 2060 6056 616c 7565 4572 726f  aise ``ValueErro
-00010cb0: 7260 6020 6265 6361 7573 6520 7468 6520  r`` because the 
-00010cc0: 6461 7465 7469 6d65 2068 6173 2074 6f20  datetime has to 
-00010cd0: 6265 2072 6570 7265 7365 6e74 6564 2061  be represented a
-00010ce0: 7320 6120 7374 7269 6e67 2e0a 2020 2020  s a string..    
-00010cf0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00010d00: 2320 5275 6e20 2f20 4173 7365 7274 0a20  # Run / Assert. 
-00010d10: 2020 2020 2020 2076 616c 7565 203d 2070         value = p
-00010d20: 642e 746f 5f64 6174 6574 696d 6528 2732  d.to_datetime('2
-00010d30: 3032 312d 3032 2d30 3127 290a 2020 2020  021-02-01').    
-00010d40: 2020 2020 6572 725f 6d73 6720 3d20 2744      err_msg = 'D
-00010d50: 6174 6574 696d 6520 6d75 7374 2062 6520  atetime must be 
-00010d60: 7265 7072 6573 656e 7465 6420 6173 2061  represented as a
-00010d70: 2073 7472 696e 672e 270a 2020 2020 2020   string.'.      
-00010d80: 2020 7769 7468 2070 7974 6573 742e 7261    with pytest.ra
-00010d90: 6973 6573 2856 616c 7565 4572 726f 722c  ises(ValueError,
-00010da0: 206d 6174 6368 3d65 7272 5f6d 7367 293a   match=err_msg):
-00010db0: 0a20 2020 2020 2020 2020 2020 2053 6361  .            Sca
-00010dc0: 6c61 7249 6e65 7175 616c 6974 792e 5f76  larInequality._v
-00010dd0: 616c 6964 6174 655f 696e 6974 5f69 6e70  alidate_init_inp
-00010de0: 7574 7328 636f 6c75 6d6e 5f6e 616d 653d  uts(column_name=
-00010df0: 2761 272c 2076 616c 7565 3d76 616c 7565  'a', value=value
-00010e00: 2c20 7265 6c61 7469 6f6e 3d27 3e27 290a  , relation='>').
-00010e10: 0a20 2020 2064 6566 2074 6573 745f 5f76  .    def test__v
-00010e20: 616c 6964 6174 655f 696e 6974 5f69 6e70  alidate_init_inp
-00010e30: 7574 735f 696e 636f 7272 6563 745f 7661  uts_incorrect_va
-00010e40: 6c75 6528 7365 6c66 293a 0a20 2020 2020  lue(self):.     
-00010e50: 2020 2022 2222 5465 7374 2074 6865 2060     """Test the `
-00010e60: 605f 7661 6c69 6461 7465 5f69 6e69 745f  `_validate_init_
-00010e70: 696e 7075 7473 6060 206d 6574 686f 642e  inputs`` method.
-00010e80: 0a0a 2020 2020 2020 2020 456e 7375 7265  ..        Ensure
-00010e90: 2074 6865 206d 6574 686f 6420 7261 6973   the method rais
-00010ea0: 6573 2061 6e20 6572 726f 7220 7768 656e  es an error when
-00010eb0: 2074 6865 2076 616c 7565 2069 7320 6e6f   the value is no
-00010ec0: 7420 6e75 6d65 7269 6361 6c2e 0a0a 2020  t numerical...  
-00010ed0: 2020 2020 2020 496e 7075 743a 0a20 2020        Input:.   
-00010ee0: 2020 2020 202d 2061 2073 7472 696e 670a       - a string.
-00010ef0: 2020 2020 2020 2020 2d20 6120 6e6f 6e2d          - a non-
-00010f00: 6e75 6d62 6572 0a20 2020 2020 2020 202d  number.        -
-00010f10: 2061 6e20 696e 6571 7561 6c69 7479 0a20   an inequality. 
-00010f20: 2020 2020 2020 2053 6964 6520 6566 6665         Side effe
-00010f30: 6374 3a0a 2020 2020 2020 2020 2d20 5261  ct:.        - Ra
-00010f40: 6973 6520 6060 5661 6c75 6545 7272 6f72  ise ``ValueError
-00010f50: 6060 2062 6563 6175 7365 2074 6865 2076  `` because the v
-00010f60: 616c 7565 206d 7573 7420 6265 2061 206e  alue must be a n
-00010f70: 756d 6572 6963 616c 0a20 2020 2020 2020  umerical.       
-00010f80: 2022 2222 0a20 2020 2020 2020 2023 2052   """.        # R
-00010f90: 756e 202f 2041 7373 6572 740a 2020 2020  un / Assert.    
-00010fa0: 2020 2020 6572 725f 6d73 6720 3d20 2760      err_msg = '`
-00010fb0: 7661 6c75 6560 206d 7573 7420 6265 2061  value` must be a
-00010fc0: 206e 756d 6265 7220 6f72 2061 2073 7472   number or a str
-00010fd0: 696e 6720 7468 6174 2072 6570 7265 7365  ing that represe
-00010fe0: 6e74 7320 6120 6461 7465 7469 6d65 2e27  nts a datetime.'
-00010ff0: 0a20 2020 2020 2020 2077 6974 6820 7079  .        with py
-00011000: 7465 7374 2e72 6169 7365 7328 5661 6c75  test.raises(Valu
-00011010: 6545 7272 6f72 2c20 6d61 7463 683d 6572  eError, match=er
-00011020: 725f 6d73 6729 3a0a 2020 2020 2020 2020  r_msg):.        
-00011030: 2020 2020 5363 616c 6172 496e 6571 7561      ScalarInequa
-00011040: 6c69 7479 2e5f 7661 6c69 6461 7465 5f69  lity._validate_i
-00011050: 6e69 745f 696e 7075 7473 2863 6f6c 756d  nit_inputs(colum
-00011060: 6e5f 6e61 6d65 3d27 6127 2c20 7661 6c75  n_name='a', valu
-00011070: 653d 2762 272c 2072 656c 6174 696f 6e3d  e='b', relation=
-00011080: 273e 2729 0a0a 2020 2020 6465 6620 7465  '>')..    def te
-00011090: 7374 5f5f 7661 6c69 6461 7465 5f69 6e69  st__validate_ini
-000110a0: 745f 696e 7075 7473 5f69 6e63 6f72 7265  t_inputs_incorre
-000110b0: 6374 5f72 656c 6174 696f 6e28 7365 6c66  ct_relation(self
-000110c0: 293a 0a20 2020 2020 2020 2022 2222 5465  ):.        """Te
-000110d0: 7374 2074 6865 2060 605f 7661 6c69 6461  st the ``_valida
-000110e0: 7465 5f69 6e69 745f 696e 7075 7473 6060  te_init_inputs``
-000110f0: 206d 6574 686f 642e 0a0a 2020 2020 2020   method...      
-00011100: 2020 5261 6973 6520 616e 2065 7272 6f72    Raise an error
-00011110: 2077 6865 6e20 7468 6520 7265 6c61 7469   when the relati
-00011120: 6f6e 2069 7320 6e6f 7420 7661 6c69 642e  on is not valid.
-00011130: 0a0a 2020 2020 2020 2020 496e 7075 743a  ..        Input:
-00011140: 0a20 2020 2020 2020 202d 2061 2073 7472  .        - a str
-00011150: 696e 670a 2020 2020 2020 2020 2d20 6120  ing.        - a 
-00011160: 6e75 6d62 6572 0a20 2020 2020 2020 202d  number.        -
-00011170: 2061 206e 6f6e 2d69 6e65 7175 616c 6974   a non-inequalit
-00011180: 790a 2020 2020 2020 2020 5369 6465 2065  y.        Side e
-00011190: 6666 6563 743a 0a20 2020 2020 2020 202d  ffect:.        -
-000111a0: 2052 6169 7365 2060 6056 616c 7565 4572   Raise ``ValueEr
-000111b0: 726f 7260 6020 6265 6361 7573 6520 7468  ror`` because th
-000111c0: 6520 7265 6c61 7469 6f6e 206d 7573 7420  e relation must 
-000111d0: 6265 2061 6e20 696e 6571 7561 6c69 7479  be an inequality
-000111e0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-000111f0: 2020 2020 2023 2052 756e 202f 2041 7373       # Run / Ass
-00011200: 6572 740a 2020 2020 2020 2020 6572 725f  ert.        err_
-00011210: 6d73 6720 3d20 2760 7265 6c61 7469 6f6e  msg = '`relation
-00011220: 6020 6d75 7374 2062 6520 6f6e 6520 6f66  ` must be one of
-00011230: 2074 6865 2066 6f6c 6c6f 7769 6e67 3a20   the following: 
-00011240: 603e 602c 2060 3e3d 602c 2060 3c60 2c20  `>`, `>=`, `<`, 
-00011250: 603c 3d60 270a 2020 2020 2020 2020 7769  `<=`'.        wi
-00011260: 7468 2070 7974 6573 742e 7261 6973 6573  th pytest.raises
-00011270: 2856 616c 7565 4572 726f 722c 206d 6174  (ValueError, mat
-00011280: 6368 3d65 7272 5f6d 7367 293a 0a20 2020  ch=err_msg):.   
-00011290: 2020 2020 2020 2020 2053 6361 6c61 7249           ScalarI
-000112a0: 6e65 7175 616c 6974 792e 5f76 616c 6964  nequality._valid
-000112b0: 6174 655f 696e 6974 5f69 6e70 7574 7328  ate_init_inputs(
-000112c0: 636f 6c75 6d6e 5f6e 616d 653d 2761 272c  column_name='a',
-000112d0: 2076 616c 7565 3d31 2c20 7265 6c61 7469   value=1, relati
-000112e0: 6f6e 3d27 3d27 290a 0a20 2020 2040 7061  on='=')..    @pa
-000112f0: 7463 6828 2773 6476 2e63 6f6e 7374 7261  tch('sdv.constra
-00011300: 696e 7473 2e53 6361 6c61 7249 6e65 7175  ints.ScalarInequ
-00011310: 616c 6974 792e 5f76 616c 6964 6174 655f  ality._validate_
-00011320: 696e 6974 5f69 6e70 7574 7327 290a 2020  init_inputs').  
-00011330: 2020 6465 6620 7465 7374 5f5f 5f69 6e69    def test___ini
-00011340: 745f 5f5f 2873 656c 662c 206d 6f63 6b5f  t___(self, mock_
-00011350: 7661 6c69 6461 7465 293a 0a20 2020 2020  validate):.     
-00011360: 2020 2022 2222 5465 7374 2074 6865 2060     """Test the `
-00011370: 6053 6361 6c61 7249 6e65 7175 616c 6974  `ScalarInequalit
-00011380: 792e 5f5f 696e 6974 5f5f 6060 206d 6574  y.__init__`` met
-00011390: 686f 642e 0a0a 2020 2020 2020 2020 5468  hod...        Th
-000113a0: 6520 7061 7373 6564 2061 7267 756d 656e  e passed argumen
-000113b0: 7473 2073 686f 756c 6420 6265 2073 746f  ts should be sto
-000113c0: 7265 6420 6173 2061 7474 7269 6275 7465  red as attribute
-000113d0: 732e 0a0a 2020 2020 2020 2020 496e 7075  s...        Inpu
-000113e0: 743a 0a20 2020 2020 2020 202d 2063 6f6c  t:.        - col
-000113f0: 756d 6e5f 6e61 6d65 2073 686f 756c 6420  umn_name should 
-00011400: 6265 2061 2063 6f6c 756d 6e20 6e61 6d65  be a column name
-00011410: 0a20 2020 2020 2020 202d 2076 616c 7565  .        - value
-00011420: 2073 686f 756c 6420 6265 2061 206e 756d   should be a num
-00011430: 6265 720a 2020 2020 2020 2020 2d20 7265  ber.        - re
-00011440: 6c61 7469 6f6e 2073 686f 756c 6420 6265  lation should be
-00011450: 2061 6e20 696e 6571 7561 6c69 7479 2073   an inequality s
-00011460: 796d 626f 6c0a 2020 2020 2020 2020 5369  ymbol.        Si
-00011470: 6465 2065 6666 6563 7473 3a0a 2020 2020  de effects:.    
-00011480: 2020 2020 2d20 5f63 6f6c 756d 6e5f 6e61      - _column_na
-00011490: 6d65 2069 7320 7365 7420 746f 2063 6f6c  me is set to col
-000114a0: 756d 6e5f 6e61 6d65 0a20 2020 2020 2020  umn_name.       
-000114b0: 202d 205f 7661 6c75 6520 6973 2073 6574   - _value is set
-000114c0: 2074 6f20 7661 6c75 650a 2020 2020 2020   to value.      
-000114d0: 2020 2d20 5f64 6966 665f 636f 6c75 6d6e    - _diff_column
-000114e0: 5f6e 616d 6520 6973 2073 6574 2074 6f20  _name is set to 
-000114f0: 2763 6f6c 756d 6e5f 6e61 6d65 2364 6966  'column_name#dif
-00011500: 6627 0a20 2020 2020 2020 202d 205f 6f70  f'.        - _op
-00011510: 6572 6174 6f72 2069 7320 7365 7420 746f  erator is set to
-00011520: 2074 6865 206e 756d 7079 206f 7065 7261   the numpy opera
-00011530: 7469 6f6e 2063 6f72 7265 7370 6f6e 6469  tion correspondi
-00011540: 6e67 2074 6f20 7468 6520 696e 7075 7420  ng to the input 
-00011550: 7265 6c61 7469 6f6e 0a20 2020 2020 2020  relation.       
-00011560: 202d 205f 6474 7970 6520 616e 6420 5f69   - _dtype and _i
-00011570: 735f 6461 7465 7469 6d65 2061 7265 204e  s_datetime are N
-00011580: 6f6e 650a 2020 2020 2020 2020 2d20 5f76  one.        - _v
-00011590: 616c 6964 6174 655f 696e 6974 5f69 6e70  alidate_init_inp
-000115a0: 7574 7320 6973 2063 616c 6c65 6420 6f6e  uts is called on
-000115b0: 6365 0a20 2020 2020 2020 2022 2222 0a20  ce.        """. 
-000115c0: 2020 2020 2020 2023 2052 756e 0a20 2020         # Run.   
-000115d0: 2020 2020 2069 6e73 7461 6e63 6520 3d20       instance = 
-000115e0: 5363 616c 6172 496e 6571 7561 6c69 7479  ScalarInequality
-000115f0: 2863 6f6c 756d 6e5f 6e61 6d65 3d27 6127  (column_name='a'
-00011600: 2c20 7661 6c75 653d 312c 2072 656c 6174  , value=1, relat
-00011610: 696f 6e3d 273e 2729 0a0a 2020 2020 2020  ion='>')..      
-00011620: 2020 2320 4173 7365 7274 730a 2020 2020    # Asserts.    
-00011630: 2020 2020 6173 7365 7274 2069 6e73 7461      assert insta
-00011640: 6e63 652e 5f63 6f6c 756d 6e5f 6e61 6d65  nce._column_name
-00011650: 203d 3d20 2761 270a 2020 2020 2020 2020   == 'a'.        
-00011660: 6173 7365 7274 2069 6e73 7461 6e63 652e  assert instance.
-00011670: 5f76 616c 7565 203d 3d20 310a 2020 2020  _value == 1.    
-00011680: 2020 2020 6173 7365 7274 2069 6e73 7461      assert insta
-00011690: 6e63 652e 5f64 6966 665f 636f 6c75 6d6e  nce._diff_column
-000116a0: 5f6e 616d 6520 3d3d 2027 6123 6469 6666  _name == 'a#diff
-000116b0: 270a 2020 2020 2020 2020 6173 7365 7274  '.        assert
-000116c0: 2069 6e73 7461 6e63 652e 5f6f 7065 7261   instance._opera
-000116d0: 746f 7220 3d3d 206e 702e 6772 6561 7465  tor == np.greate
-000116e0: 720a 2020 2020 2020 2020 6173 7365 7274  r.        assert
-000116f0: 2069 6e73 7461 6e63 652e 5f64 7479 7065   instance._dtype
-00011700: 2069 7320 4e6f 6e65 0a20 2020 2020 2020   is None.       
-00011710: 2061 7373 6572 7420 696e 7374 616e 6365   assert instance
-00011720: 2e5f 6973 5f64 6174 6574 696d 6520 6973  ._is_datetime is
-00011730: 204e 6f6e 650a 2020 2020 2020 2020 6d6f   None.        mo
-00011740: 636b 5f76 616c 6964 6174 652e 6173 7365  ck_validate.asse
-00011750: 7274 5f63 616c 6c65 645f 6f6e 6365 5f77  rt_called_once_w
-00011760: 6974 6828 2761 272c 2031 2c20 273e 2729  ith('a', 1, '>')
-00011770: 0a0a 2020 2020 6465 6620 7465 7374 5f5f  ..    def test__
-00011780: 6765 745f 6973 5f64 6174 6574 696d 655f  get_is_datetime_
-00011790: 696e 636f 7272 6563 745f 6461 7461 2873  incorrect_data(s
-000117a0: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-000117b0: 2254 6573 7420 7468 6520 6060 5363 616c  "Test the ``Scal
-000117c0: 6172 496e 6571 7561 6c69 7479 2e5f 6765  arInequality._ge
-000117d0: 745f 6973 5f64 6174 6574 696d 6560 6020  t_is_datetime`` 
-000117e0: 6d65 7468 6f64 2e0a 0a20 2020 2020 2020  method...       
-000117f0: 2045 6e73 7572 6520 7468 6174 2069 6620   Ensure that if 
-00011800: 6f6e 6520 6f66 2063 6f6c 756d 6e2f 7661  one of column/va
-00011810: 6c75 6520 6973 2064 6174 6574 696d 652c  lue is datetime,
-00011820: 2062 6f74 6820 6f66 2074 6865 6d20 6172   both of them ar
-00011830: 652e 0a0a 2020 2020 2020 2020 496e 7075  e...        Inpu
-00011840: 743a 0a20 2020 2020 2020 202d 2054 6162  t:.        - Tab
-00011850: 6c65 2064 6174 612e 0a20 2020 2020 2020  le data..       
-00011860: 2053 6964 6520 4566 6665 6374 3a0a 2020   Side Effect:.  
-00011870: 2020 2020 2020 2d20 5261 6973 6573 2060        - Raises `
-00011880: 6056 616c 7565 4572 726f 7260 6020 6966  `ValueError`` if
-00011890: 206f 6e6c 7920 6f6e 6520 6f66 2063 6f6c   only one of col
-000118a0: 756d 6e2f 7661 6c75 6520 6973 2064 6174  umn/value is dat
-000118b0: 6574 696d 652e 0a20 2020 2020 2020 2022  etime..        "
-000118c0: 2222 0a20 2020 2020 2020 2023 2053 6574  "".        # Set
-000118d0: 7570 790a 2020 2020 2020 2020 7461 626c  upy.        tabl
-000118e0: 655f 6461 7461 203d 2070 642e 4461 7461  e_data = pd.Data
-000118f0: 4672 616d 6528 7b0a 2020 2020 2020 2020  Frame({.        
-00011900: 2020 2020 2761 273a 2070 642e 746f 5f64      'a': pd.to_d
-00011910: 6174 6574 696d 6528 5b27 3230 3230 2d30  atetime(['2020-0
-00011920: 312d 3031 275d 292c 0a20 2020 2020 2020  1-01']),.       
-00011930: 207d 290a 2020 2020 2020 2020 696e 7374   }).        inst
-00011940: 616e 6365 203d 2053 6361 6c61 7249 6e65  ance = ScalarIne
-00011950: 7175 616c 6974 7928 636f 6c75 6d6e 5f6e  quality(column_n
-00011960: 616d 653d 2761 272c 2076 616c 7565 3d31  ame='a', value=1
-00011970: 2c20 7265 6c61 7469 6f6e 3d27 3c27 290a  , relation='<').
-00011980: 0a20 2020 2020 2020 2023 2052 756e 202f  .        # Run /
-00011990: 2041 7373 6572 740a 2020 2020 2020 2020   Assert.        
-000119a0: 6572 725f 6d73 6720 3d20 2742 6f74 6820  err_msg = 'Both 
-000119b0: 636f 6c75 6d6e 2061 6e64 2076 616c 7565  column and value
-000119c0: 206d 7573 7420 6265 2064 6174 6574 696d   must be datetim
-000119d0: 652e 270a 2020 2020 2020 2020 7769 7468  e.'.        with
-000119e0: 2070 7974 6573 742e 7261 6973 6573 2856   pytest.raises(V
-000119f0: 616c 7565 4572 726f 722c 206d 6174 6368  alueError, match
-00011a00: 3d65 7272 5f6d 7367 293a 0a20 2020 2020  =err_msg):.     
-00011a10: 2020 2020 2020 2069 6e73 7461 6e63 652e         instance.
-00011a20: 5f67 6574 5f69 735f 6461 7465 7469 6d65  _get_is_datetime
-00011a30: 2874 6162 6c65 5f64 6174 6129 0a0a 2020  (table_data)..  
-00011a40: 2020 6465 6620 7465 7374 5f5f 7661 6c69    def test__vali
-00011a50: 6461 7465 5f63 6f6c 756d 6e73 5f65 7869  date_columns_exi
-00011a60: 7374 5f69 6e63 6f72 7265 6374 5f63 6f6c  st_incorrect_col
-00011a70: 756d 6e73 2873 656c 6629 3a0a 2020 2020  umns(self):.    
-00011a80: 2020 2020 2222 2254 6573 7420 7468 6520      """Test the 
-00011a90: 6060 5363 616c 6172 496e 6571 7561 6c69  ``ScalarInequali
-00011aa0: 7479 2e5f 7661 6c69 6461 7465 5f63 6f6c  ty._validate_col
-00011ab0: 756d 6e73 5f65 7869 7374 6060 206d 6574  umns_exist`` met
-00011ac0: 686f 642e 0a0a 2020 2020 2020 2020 5468  hod...        Th
-00011ad0: 6973 206d 6574 686f 6420 7261 6973 6573  is method raises
-00011ae0: 2061 6e20 6572 726f 7220 6966 2060 6063   an error if ``c
-00011af0: 6f6c 756d 6e5f 6e61 6d65 6060 2064 6f65  olumn_name`` doe
-00011b00: 7320 6e6f 7420 6578 6973 742e 0a0a 2020  s not exist...  
-00011b10: 2020 2020 2020 496e 7075 743a 0a20 2020        Input:.   
-00011b20: 2020 2020 202d 2054 6162 6c65 2077 6974       - Table wit
-00011b30: 6820 6769 7665 6e20 6461 7461 2e0a 2020  h given data..  
-00011b40: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00011b50: 2020 2320 5365 7475 700a 2020 2020 2020    # Setup.      
-00011b60: 2020 7461 626c 655f 6461 7461 203d 2070    table_data = p
-00011b70: 642e 4461 7461 4672 616d 6528 7b0a 2020  d.DataFrame({.  
-00011b80: 2020 2020 2020 2020 2020 2761 273a 205b            'a': [
-00011b90: 312c 2032 2c20 345d 2c0a 2020 2020 2020  1, 2, 4],.      
-00011ba0: 2020 2020 2020 2762 273a 205b 342c 2035        'b': [4, 5
-00011bb0: 2c20 365d 0a20 2020 2020 2020 207d 290a  , 6].        }).
-00011bc0: 2020 2020 2020 2020 696e 7374 616e 6365          instance
-00011bd0: 203d 2053 6361 6c61 7249 6e65 7175 616c   = ScalarInequal
-00011be0: 6974 7928 636f 6c75 6d6e 5f6e 616d 653d  ity(column_name=
-00011bf0: 2763 272c 2076 616c 7565 3d35 2c20 7265  'c', value=5, re
-00011c00: 6c61 7469 6f6e 3d27 3e27 290a 0a20 2020  lation='>')..   
-00011c10: 2020 2020 2023 2052 756e 202f 2041 7373       # Run / Ass
-00011c20: 6572 740a 2020 2020 2020 2020 7769 7468  ert.        with
-00011c30: 2070 7974 6573 742e 7261 6973 6573 284b   pytest.raises(K
-00011c40: 6579 4572 726f 7229 3a0a 2020 2020 2020  eyError):.      
-00011c50: 2020 2020 2020 696e 7374 616e 6365 2e5f        instance._
-00011c60: 7661 6c69 6461 7465 5f63 6f6c 756d 6e73  validate_columns
-00011c70: 5f65 7869 7374 2874 6162 6c65 5f64 6174  _exist(table_dat
-00011c80: 6129 0a0a 2020 2020 6465 6620 7465 7374  a)..    def test
-00011c90: 5f5f 6669 7428 7365 6c66 293a 0a20 2020  __fit(self):.   
-00011ca0: 2020 2020 2022 2222 5465 7374 2074 6865       """Test the
-00011cb0: 2060 6053 6361 6c61 7249 6e65 7175 616c   ``ScalarInequal
-00011cc0: 6974 792e 5f66 6974 6060 206d 6574 686f  ity._fit`` metho
-00011cd0: 642e 0a0a 2020 2020 2020 2020 5468 6520  d...        The 
-00011ce0: 6d65 7468 6f64 2073 686f 756c 6420 6c65  method should le
-00011cf0: 6172 6e20 7468 6520 6060 6474 7970 6560  arn the ``dtype`
-00011d00: 6020 6f66 2060 6063 6f6c 756d 6e5f 6e61  ` of ``column_na
-00011d10: 6d65 6060 2061 6e64 2060 605f 6973 5f64  me`` and ``_is_d
-00011d20: 6174 6574 696d 6560 602e 0a0a 2020 2020  atetime``...    
-00011d30: 2020 2020 496e 7075 743a 0a20 2020 2020      Input:.     
-00011d40: 2020 202d 2054 6162 6c65 2064 6174 6120     - Table data 
-00011d50: 7769 7468 2069 6e74 6567 6572 732e 0a20  with integers.. 
-00011d60: 2020 2020 2020 2053 6964 6520 4566 6665         Side Effe
-00011d70: 6374 3a0a 2020 2020 2020 2020 2d20 5f76  ct:.        - _v
-00011d80: 616c 6964 6174 655f 636f 6c75 6d6e 735f  alidate_columns_
-00011d90: 6578 6973 7420 7368 6f75 6c64 2062 6520  exist should be 
-00011da0: 6361 6c6c 6564 206f 6e63 650a 2020 2020  called once.    
-00011db0: 2020 2020 2d20 5f67 6574 5f69 735f 6461      - _get_is_da
-00011dc0: 7465 7469 6d65 2073 686f 756c 6420 6265  tetime should be
-00011dd0: 2063 616c 6c65 6420 6f6e 6365 0a20 2020   called once.   
-00011de0: 2020 2020 202d 205f 6973 5f64 6174 6574       - _is_datet
-00011df0: 696d 6520 7368 6f75 6c64 2072 6563 6569  ime should recei
-00011e00: 7665 2074 6865 206f 7574 7075 7420 6f66  ve the output of
-00011e10: 205f 6765 745f 6973 5f64 6174 6574 696d   _get_is_datetim
-00011e20: 650a 2020 2020 2020 2020 2d20 5f64 7479  e.        - _dty
-00011e30: 7065 2073 686f 756c 6420 6265 2061 206c  pe should be a l
-00011e40: 6973 7420 6f66 2069 6e74 6567 6572 2064  ist of integer d
-00011e50: 7479 7065 732e 0a20 2020 2020 2020 2022  types..        "
-00011e60: 2222 0a20 2020 2020 2020 2023 2053 6574  "".        # Set
-00011e70: 7570 0a20 2020 2020 2020 2074 6162 6c65  up.        table
-00011e80: 5f64 6174 6120 3d20 7064 2e44 6174 6146  _data = pd.DataF
-00011e90: 7261 6d65 287b 0a20 2020 2020 2020 2020  rame({.         
-00011ea0: 2020 2027 6127 3a20 5b31 2c20 322c 2034     'a': [1, 2, 4
-00011eb0: 5d2c 0a20 2020 2020 2020 2020 2020 2027  ],.            '
-00011ec0: 6227 3a20 5b34 2c20 352c 2036 5d0a 2020  b': [4, 5, 6].  
-00011ed0: 2020 2020 2020 7d29 0a20 2020 2020 2020        }).       
-00011ee0: 2069 6e73 7461 6e63 6520 3d20 5363 616c   instance = Scal
-00011ef0: 6172 496e 6571 7561 6c69 7479 2863 6f6c  arInequality(col
-00011f00: 756d 6e5f 6e61 6d65 3d27 6227 2c20 7661  umn_name='b', va
-00011f10: 6c75 653d 332c 2072 656c 6174 696f 6e3d  lue=3, relation=
-00011f20: 273e 2729 0a20 2020 2020 2020 2069 6e73  '>').        ins
-00011f30: 7461 6e63 652e 5f76 616c 6964 6174 655f  tance._validate_
-00011f40: 636f 6c75 6d6e 735f 6578 6973 7420 3d20  columns_exist = 
-00011f50: 4d6f 636b 2829 0a20 2020 2020 2020 2069  Mock().        i
-00011f60: 6e73 7461 6e63 652e 5f67 6574 5f69 735f  nstance._get_is_
-00011f70: 6461 7465 7469 6d65 203d 204d 6f63 6b28  datetime = Mock(
-00011f80: 7265 7475 726e 5f76 616c 7565 3d46 616c  return_value=Fal
-00011f90: 7365 290a 0a20 2020 2020 2020 2023 2052  se)..        # R
-00011fa0: 756e 0a20 2020 2020 2020 2069 6e73 7461  un.        insta
-00011fb0: 6e63 652e 5f66 6974 2874 6162 6c65 5f64  nce._fit(table_d
-00011fc0: 6174 6129 0a0a 2020 2020 2020 2020 2320  ata)..        # 
-00011fd0: 4173 7365 7274 0a20 2020 2020 2020 2069  Assert.        i
-00011fe0: 6e73 7461 6e63 652e 5f76 616c 6964 6174  nstance._validat
-00011ff0: 655f 636f 6c75 6d6e 735f 6578 6973 742e  e_columns_exist.
-00012000: 6173 7365 7274 5f63 616c 6c65 645f 6f6e  assert_called_on
-00012010: 6365 5f77 6974 6828 7461 626c 655f 6461  ce_with(table_da
-00012020: 7461 290a 2020 2020 2020 2020 696e 7374  ta).        inst
-00012030: 616e 6365 2e5f 6765 745f 6973 5f64 6174  ance._get_is_dat
-00012040: 6574 696d 652e 6173 7365 7274 5f63 616c  etime.assert_cal
-00012050: 6c65 645f 6f6e 6365 5f77 6974 6828 7461  led_once_with(ta
-00012060: 626c 655f 6461 7461 290a 2020 2020 2020  ble_data).      
-00012070: 2020 6173 7365 7274 206e 6f74 2069 6e73    assert not ins
-00012080: 7461 6e63 652e 5f69 735f 6461 7465 7469  tance._is_dateti
-00012090: 6d65 0a20 2020 2020 2020 2061 7373 6572  me.        asser
-000120a0: 7420 696e 7374 616e 6365 2e5f 6474 7970  t instance._dtyp
-000120b0: 6520 3d3d 2070 642e 5365 7269 6573 285b  e == pd.Series([
-000120c0: 315d 292e 6474 7970 6520 2023 2065 7861  1]).dtype  # exa
-000120d0: 6374 2064 7479 7065 2028 3332 206f 7220  ct dtype (32 or 
-000120e0: 3634 2920 6465 7065 6e64 7320 6f6e 204f  64) depends on O
-000120f0: 530a 0a20 2020 2064 6566 2074 6573 745f  S..    def test_
-00012100: 5f66 6974 5f66 6c6f 6174 7328 7365 6c66  _fit_floats(self
-00012110: 293a 0a20 2020 2020 2020 2022 2222 5465  ):.        """Te
-00012120: 7374 2074 6865 2060 6053 6361 6c61 7249  st the ``ScalarI
-00012130: 6e65 7175 616c 6974 792e 5f66 6974 6060  nequality._fit``
-00012140: 206d 6574 686f 642e 0a0a 2020 2020 2020   method...      
-00012150: 2020 5468 6520 6174 7472 6962 7574 6520    The attribute 
-00012160: 6060 5f64 7479 7065 6060 2073 686f 756c  ``_dtype`` shoul
-00012170: 6420 6265 2066 6c6f 6174 2077 6865 6e20  d be float when 
-00012180: 6060 636f 6c75 6d6e 5f6e 616d 6560 6020  ``column_name`` 
-00012190: 636f 6e74 6169 6e73 2066 6c6f 6174 732e  contains floats.
-000121a0: 0a0a 2020 2020 2020 2020 496e 7075 743a  ..        Input:
-000121b0: 0a20 2020 2020 2020 202d 2054 6162 6c65  .        - Table
-000121c0: 2064 6174 6120 7769 7468 2066 6c6f 6174   data with float
-000121d0: 732e 0a20 2020 2020 2020 2053 6964 6520  s..        Side 
-000121e0: 4566 6665 6374 3a0a 2020 2020 2020 2020  Effect:.        
-000121f0: 2d20 5f64 7479 7065 2073 686f 756c 6420  - _dtype should 
-00012200: 6265 2061 2066 6c6f 6174 2064 7479 7065  be a float dtype
-00012210: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00012220: 2020 2020 2020 2320 5365 7475 700a 2020        # Setup.  
-00012230: 2020 2020 2020 7461 626c 655f 6461 7461        table_data
-00012240: 203d 2070 642e 4461 7461 4672 616d 6528   = pd.DataFrame(
-00012250: 7b0a 2020 2020 2020 2020 2020 2020 2761  {.            'a
-00012260: 273a 205b 312c 2032 2c20 345d 2c0a 2020  ': [1, 2, 4],.  
-00012270: 2020 2020 2020 2020 2020 2762 273a 205b            'b': [
-00012280: 342e 2c20 352e 2c20 362e 5d0a 2020 2020  4., 5., 6.].    
-00012290: 2020 2020 7d29 0a20 2020 2020 2020 2069      }).        i
-000122a0: 6e73 7461 6e63 6520 3d20 5363 616c 6172  nstance = Scalar
-000122b0: 496e 6571 7561 6c69 7479 2863 6f6c 756d  Inequality(colum
-000122c0: 6e5f 6e61 6d65 3d27 6227 2c20 7661 6c75  n_name='b', valu
-000122d0: 653d 3130 2c20 7265 6c61 7469 6f6e 3d27  e=10, relation='
-000122e0: 3e27 290a 0a20 2020 2020 2020 2023 2052  >')..        # R
-000122f0: 756e 0a20 2020 2020 2020 2069 6e73 7461  un.        insta
-00012300: 6e63 652e 5f66 6974 2874 6162 6c65 5f64  nce._fit(table_d
-00012310: 6174 6129 0a0a 2020 2020 2020 2020 2320  ata)..        # 
-00012320: 4173 7365 7274 0a20 2020 2020 2020 2061  Assert.        a
-00012330: 7373 6572 7420 696e 7374 616e 6365 2e5f  ssert instance._
-00012340: 6474 7970 6520 3d3d 206e 702e 6474 7970  dtype == np.dtyp
-00012350: 6528 2766 6c6f 6174 2729 0a0a 2020 2020  e('float')..    
-00012360: 6465 6620 7465 7374 5f5f 6669 745f 6461  def test__fit_da
-00012370: 7465 7469 6d65 2873 656c 6629 3a0a 2020  tetime(self):.  
-00012380: 2020 2020 2020 2222 2254 6573 7420 7468        """Test th
-00012390: 6520 6060 5363 616c 6172 496e 6571 7561  e ``ScalarInequa
-000123a0: 6c69 7479 2e5f 6669 7460 6020 6d65 7468  lity._fit`` meth
-000123b0: 6f64 2e0a 0a20 2020 2020 2020 2054 6865  od...        The
-000123c0: 2061 7474 7269 6275 7465 2060 605f 6474   attribute ``_dt
-000123d0: 7970 6560 6020 7368 6f75 6c64 2062 6520  ype`` should be 
-000123e0: 6461 7465 7469 6d65 2077 6865 6e20 6060  datetime when ``
-000123f0: 636f 6c75 6d6e 5f6e 616d 6560 6020 636f  column_name`` co
-00012400: 6e74 6169 6e73 2064 6174 6574 696d 6573  ntains datetimes
-00012410: 2e0a 0a20 2020 2020 2020 2049 6e70 7574  ...        Input
-00012420: 3a0a 2020 2020 2020 2020 2d20 5461 626c  :.        - Tabl
-00012430: 6520 6461 7461 2077 6974 6820 6461 7465  e data with date
-00012440: 7469 6d65 732e 0a20 2020 2020 2020 2053  times..        S
-00012450: 6964 6520 4566 6665 6374 3a0a 2020 2020  ide Effect:.    
-00012460: 2020 2020 2d20 5f64 7479 7065 2073 686f      - _dtype sho
-00012470: 756c 6420 6265 2061 206c 6973 7420 6f66  uld be a list of
-00012480: 2064 6174 6574 696d 6520 6474 7970 6573   datetime dtypes
-00012490: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-000124a0: 2020 2020 2020 2320 5365 7475 700a 2020        # Setup.  
-000124b0: 2020 2020 2020 7461 626c 655f 6461 7461        table_data
-000124c0: 203d 2070 642e 4461 7461 4672 616d 6528   = pd.DataFrame(
-000124d0: 7b0a 2020 2020 2020 2020 2020 2020 2761  {.            'a
-000124e0: 273a 2070 642e 746f 5f64 6174 6574 696d  ': pd.to_datetim
-000124f0: 6528 5b27 3230 3230 2d30 312d 3031 275d  e(['2020-01-01']
-00012500: 292c 0a20 2020 2020 2020 2020 2020 2027  ),.            '
-00012510: 6227 3a20 7064 2e74 6f5f 6461 7465 7469  b': pd.to_dateti
-00012520: 6d65 285b 2732 3032 302d 3031 2d30 3227  me(['2020-01-02'
-00012530: 5d29 0a20 2020 2020 2020 207d 290a 2020  ]).        }).  
-00012540: 2020 2020 2020 696e 7374 616e 6365 203d        instance =
-00012550: 2053 6361 6c61 7249 6e65 7175 616c 6974   ScalarInequalit
-00012560: 7928 636f 6c75 6d6e 5f6e 616d 653d 2762  y(column_name='b
-00012570: 272c 2076 616c 7565 3d27 3230 3230 2d30  ', value='2020-0
-00012580: 312d 3031 272c 2072 656c 6174 696f 6e3d  1-01', relation=
-00012590: 273e 2729 0a0a 2020 2020 2020 2020 2320  '>')..        # 
-000125a0: 5275 6e0a 2020 2020 2020 2020 696e 7374  Run.        inst
-000125b0: 616e 6365 2e5f 6669 7428 7461 626c 655f  ance._fit(table_
-000125c0: 6461 7461 290a 0a20 2020 2020 2020 2023  data)..        #
-000125d0: 2041 7373 6572 740a 2020 2020 2020 2020   Assert.        
-000125e0: 6173 7365 7274 2069 6e73 7461 6e63 652e  assert instance.
-000125f0: 5f64 7479 7065 203d 3d20 6e70 2e64 7479  _dtype == np.dty
-00012600: 7065 2827 3c4d 385b 6e73 5d27 290a 0a20  pe('<M8[ns]').. 
-00012610: 2020 2064 6566 2074 6573 745f 6973 5f76     def test_is_v
-00012620: 616c 6964 2873 656c 6629 3a0a 2020 2020  alid(self):.    
-00012630: 2020 2020 2222 2254 6573 7420 7468 6520      """Test the 
-00012640: 6060 5363 616c 6172 496e 6571 7561 6c69  ``ScalarInequali
-00012650: 7479 2e69 735f 7661 6c69 6460 6020 6d65  ty.is_valid`` me
-00012660: 7468 6f64 2077 6974 6820 6060 7265 6c61  thod with ``rela
-00012670: 7469 6f6e 203d 2027 3e27 6060 2e0a 0a20  tion = '>'``... 
-00012680: 2020 2020 2020 2054 6865 206d 6574 686f         The metho
-00012690: 6420 7368 6f75 6c64 2072 6574 7572 6e20  d should return 
-000126a0: 5472 7565 2077 6865 6e20 6060 636f 6c75  True when ``colu
-000126b0: 6d6e 5f6e 616d 6560 6020 6973 2067 7265  mn_name`` is gre
-000126c0: 6174 6572 2074 6861 6e0a 2020 2020 2020  ater than.      
-000126d0: 2020 6060 7661 6c75 6560 6020 6f72 2074    ``value`` or t
-000126e0: 6865 2072 6f77 2063 6f6e 7461 696e 7320  he row contains 
-000126f0: 6e61 6e2c 206f 7468 6572 7769 7365 2072  nan, otherwise r
-00012700: 6574 7572 6e20 4661 6c73 652e 0a0a 2020  eturn False...  
-00012710: 2020 2020 2020 496e 7075 743a 0a20 2020        Input:.   
-00012720: 2020 2020 202d 2054 6162 6c65 2077 6974       - Table wit
-00012730: 6820 6120 6d69 7874 7572 6520 6f66 2076  h a mixture of v
-00012740: 616c 6964 2061 6e64 2069 6e76 616c 6964  alid and invalid
-00012750: 2072 6f77 732c 2061 7320 7765 6c6c 2061   rows, as well a
-00012760: 7320 6e70 2e6e 616e 732e 0a20 2020 2020  s np.nans..     
-00012770: 2020 204f 7574 7075 743a 0a20 2020 2020     Output:.     
-00012780: 2020 202d 2046 616c 7365 2073 686f 756c     - False shoul
-00012790: 6420 6265 2072 6574 7572 6e65 6420 666f  d be returned fo
-000127a0: 7220 7468 6520 7374 7269 6374 6c79 2069  r the strictly i
-000127b0: 6e76 616c 6964 2072 6f77 7320 616e 6420  nvalid rows and 
-000127c0: 5472 7565 2066 6f72 2074 6865 2072 6573  True for the res
-000127d0: 742e 0a20 2020 2020 2020 2022 2222 0a20  t..        """. 
-000127e0: 2020 2020 2020 2023 2053 6574 7570 0a20         # Setup. 
-000127f0: 2020 2020 2020 2069 6e73 7461 6e63 6520         instance 
-00012800: 3d20 5363 616c 6172 496e 6571 7561 6c69  = ScalarInequali
-00012810: 7479 2863 6f6c 756d 6e5f 6e61 6d65 3d27  ty(column_name='
-00012820: 6227 2c20 7661 6c75 653d 322c 2072 656c  b', value=2, rel
-00012830: 6174 696f 6e3d 273e 2729 0a0a 2020 2020  ation='>')..    
-00012840: 2020 2020 2320 5275 6e0a 2020 2020 2020      # Run.      
-00012850: 2020 7461 626c 655f 6461 7461 203d 2070    table_data = p
-00012860: 642e 4461 7461 4672 616d 6528 7b0a 2020  d.DataFrame({.  
-00012870: 2020 2020 2020 2020 2020 2761 273a 205b            'a': [
-00012880: 312c 206e 702e 6e61 6e2c 2033 2c20 342c  1, np.nan, 3, 4,
-00012890: 204e 6f6e 655d 2c0a 2020 2020 2020 2020   None],.        
-000128a0: 2020 2020 2762 273a 205b 342c 2032 2c20      'b': [4, 2, 
-000128b0: 6e70 2e6e 616e 2c20 2d36 2c20 4e6f 6e65  np.nan, -6, None
-000128c0: 5d2c 0a20 2020 2020 2020 207d 290a 2020  ],.        }).  
-000128d0: 2020 2020 2020 6f75 7420 3d20 696e 7374        out = inst
-000128e0: 616e 6365 2e69 735f 7661 6c69 6428 7461  ance.is_valid(ta
-000128f0: 626c 655f 6461 7461 290a 0a20 2020 2020  ble_data)..     
-00012900: 2020 2023 2041 7373 6572 740a 2020 2020     # Assert.    
-00012910: 2020 2020 6578 7065 6374 6564 5f6f 7574      expected_out
-00012920: 203d 205b 5472 7565 2c20 4661 6c73 652c   = [True, False,
-00012930: 2054 7275 652c 2046 616c 7365 2c20 5472   True, False, Tr
-00012940: 7565 5d0a 2020 2020 2020 2020 6e70 2e74  ue].        np.t
-00012950: 6573 7469 6e67 2e61 7373 6572 745f 6172  esting.assert_ar
-00012960: 7261 795f 6571 7561 6c28 6578 7065 6374  ray_equal(expect
-00012970: 6564 5f6f 7574 2c20 6f75 7429 0a0a 2020  ed_out, out)..  
-00012980: 2020 6465 6620 7465 7374 5f69 735f 7661    def test_is_va
-00012990: 6c69 645f 6461 7465 7469 6d65 7328 7365  lid_datetimes(se
-000129a0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-000129b0: 5465 7374 2074 6865 2060 6053 6361 6c61  Test the ``Scala
-000129c0: 7249 6e65 7175 616c 6974 792e 6973 5f76  rInequality.is_v
-000129d0: 616c 6964 6060 206d 6574 686f 6420 7769  alid`` method wi
-000129e0: 7468 2064 6174 6574 696d 6573 2061 6e64  th datetimes and
-000129f0: 2060 6072 656c 6174 696f 6e20 3d20 273c   ``relation = '<
-00012a00: 3d27 6060 2e0a 0a20 2020 2020 2020 2054  ='``...        T
-00012a10: 6865 206d 6574 686f 6420 7368 6f75 6c64  he method should
-00012a20: 2072 6574 7572 6e20 5472 7565 2077 6865   return True whe
-00012a30: 6e20 6060 636f 6c75 6d6e 5f6e 616d 6560  n ``column_name`
-00012a40: 6020 6973 2067 7265 6174 6572 206f 7220  ` is greater or 
-00012a50: 6571 7561 6c20 746f 0a20 2020 2020 2020  equal to.       
-00012a60: 2060 6076 616c 7565 6060 206f 7220 7468   ``value`` or th
-00012a70: 6520 726f 7720 636f 6e74 6169 6e73 206e  e row contains n
-00012a80: 616e 2c20 6f74 6865 7277 6973 6520 7265  an, otherwise re
-00012a90: 7475 726e 2046 616c 7365 2e0a 0a20 2020  turn False...   
-00012aa0: 2020 2020 2049 6e70 7574 3a0a 2020 2020       Input:.    
-00012ab0: 2020 2020 2d20 5461 626c 6520 7769 7468      - Table with
-00012ac0: 2064 6174 6574 696d 6573 2061 6e64 206e   datetimes and n
-00012ad0: 702e 6e61 6e73 2e0a 2020 2020 2020 2020  p.nans..        
-00012ae0: 4f75 7470 7574 3a0a 2020 2020 2020 2020  Output:.        
-00012af0: 2d20 4661 6c73 6520 7368 6f75 6c64 2062  - False should b
-00012b00: 6520 7265 7475 726e 6564 2066 6f72 2074  e returned for t
-00012b10: 6865 2073 7472 6963 746c 7920 696e 7661  he strictly inva
-00012b20: 6c69 6420 726f 7773 2061 6e64 2054 7275  lid rows and Tru
-00012b30: 6520 666f 7220 7468 6520 7265 7374 2e0a  e for the rest..
-00012b40: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00012b50: 2020 2020 2320 5365 7475 700a 2020 2020      # Setup.    
-00012b60: 2020 2020 696e 7374 616e 6365 203d 2053      instance = S
-00012b70: 6361 6c61 7249 6e65 7175 616c 6974 7928  calarInequality(
-00012b80: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
-00012b90: 756d 6e5f 6e61 6d65 3d27 6227 2c0a 2020  umn_name='b',.  
-00012ba0: 2020 2020 2020 2020 2020 7661 6c75 653d            value=
-00012bb0: 2738 2f33 312f 3230 3231 272c 0a20 2020  '8/31/2021',.   
-00012bc0: 2020 2020 2020 2020 2072 656c 6174 696f           relatio
-00012bd0: 6e3d 273e 3d27 290a 0a20 2020 2020 2020  n='>=')..       
-00012be0: 2023 2052 756e 0a20 2020 2020 2020 2074   # Run.        t
-00012bf0: 6162 6c65 5f64 6174 6120 3d20 7064 2e44  able_data = pd.D
-00012c00: 6174 6146 7261 6d65 287b 0a20 2020 2020  ataFrame({.     
-00012c10: 2020 2020 2020 2027 6227 3a20 5b64 6174         'b': [dat
-00012c20: 6574 696d 6528 3230 3231 2c20 382c 2033  etime(2021, 8, 3
-00012c30: 3029 2c20 6461 7465 7469 6d65 2832 3032  0), datetime(202
-00012c40: 312c 2038 2c20 3331 292c 2064 6174 6574  1, 8, 31), datet
-00012c50: 696d 6528 3230 3231 2c20 392c 2032 292c  ime(2021, 9, 2),
-00012c60: 206e 702e 6e61 6e5d 2c0a 2020 2020 2020   np.nan],.      
-00012c70: 2020 2020 2020 2763 273a 205b 372c 2038        'c': [7, 8
-00012c80: 2c20 392c 2031 305d 0a20 2020 2020 2020  , 9, 10].       
-00012c90: 207d 290a 2020 2020 2020 2020 6f75 7420   }).        out 
-00012ca0: 3d20 696e 7374 616e 6365 2e69 735f 7661  = instance.is_va
-00012cb0: 6c69 6428 7461 626c 655f 6461 7461 290a  lid(table_data).
-00012cc0: 0a20 2020 2020 2020 2023 2041 7373 6572  .        # Asser
-00012cd0: 740a 2020 2020 2020 2020 6578 7065 6374  t.        expect
-00012ce0: 6564 5f6f 7574 203d 205b 4661 6c73 652c  ed_out = [False,
-00012cf0: 2054 7275 652c 2054 7275 652c 2054 7275   True, True, Tru
-00012d00: 655d 0a20 2020 2020 2020 206e 702e 7465  e].        np.te
-00012d10: 7374 696e 672e 6173 7365 7274 5f61 7272  sting.assert_arr
-00012d20: 6179 5f65 7175 616c 2865 7870 6563 7465  ay_equal(expecte
-00012d30: 645f 6f75 742c 206f 7574 290a 0a20 2020  d_out, out)..   
-00012d40: 2064 6566 2074 6573 745f 6973 5f76 616c   def test_is_val
-00012d50: 6964 5f64 6174 6574 696d 6573 5f61 735f  id_datetimes_as_
-00012d60: 6f62 6a65 6374 2873 656c 6629 3a0a 2020  object(self):.  
-00012d70: 2020 2020 2020 2222 2254 6573 7420 7468        """Test th
-00012d80: 6520 6060 5363 616c 6172 496e 6571 7561  e ``ScalarInequa
-00012d90: 6c69 7479 2e69 735f 7661 6c69 6460 6020  lity.is_valid`` 
-00012da0: 6d65 7468 6f64 2077 6974 6820 6461 7465  method with date
-00012db0: 7469 6d65 7320 616e 6420 7468 6569 7220  times and their 
-00012dc0: 6474 7970 6520 6973 206f 626a 6563 742e  dtype is object.
-00012dd0: 0a0a 2020 2020 2020 2020 5468 6520 6d65  ..        The me
-00012de0: 7468 6f64 2073 686f 756c 6420 7265 7475  thod should retu
-00012df0: 726e 2054 7275 6520 7768 656e 2060 6063  rn True when ``c
-00012e00: 6f6c 756d 6e5f 6e61 6d65 6060 2069 7320  olumn_name`` is 
-00012e10: 6772 6561 7465 7220 6f72 2065 7175 616c  greater or equal
-00012e20: 2074 6f0a 2020 2020 2020 2020 6060 7661   to.        ``va
-00012e30: 6c75 6560 6020 6f72 2074 6865 2072 6f77  lue`` or the row
-00012e40: 2063 6f6e 7461 696e 7320 6e61 6e2c 2065   contains nan, e
-00012e50: 7665 6e20 7768 656e 2074 6865 2060 6064  ven when the ``d
-00012e60: 6174 6574 696d 6560 6020 6973 2070 6173  atetime`` is pas
-00012e70: 7365 6420 6173 2061 6e20 6f62 6a65 6374  sed as an object
-00012e80: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00012e90: 2020 2020 2020 2320 5365 7475 700a 2020        # Setup.  
-00012ea0: 2020 2020 2020 696e 7374 616e 6365 203d        instance =
-00012eb0: 2053 6361 6c61 7249 6e65 7175 616c 6974   ScalarInequalit
-00012ec0: 7928 0a20 2020 2020 2020 2020 2020 2063  y(.            c
-00012ed0: 6f6c 756d 6e5f 6e61 6d65 3d27 6227 2c0a  olumn_name='b',.
-00012ee0: 2020 2020 2020 2020 2020 2020 7661 6c75              valu
-00012ef0: 653d 2738 2f33 312f 3230 3231 272c 0a20  e='8/31/2021',. 
-00012f00: 2020 2020 2020 2020 2020 2072 656c 6174             relat
-00012f10: 696f 6e3d 273e 3d27 0a20 2020 2020 2020  ion='>='.       
-00012f20: 2029 0a20 2020 2020 2020 2069 6e73 7461   ).        insta
-00012f30: 6e63 652e 5f64 7479 7065 203d 206e 702e  nce._dtype = np.
-00012f40: 6474 7970 6528 274f 2729 0a20 2020 2020  dtype('O').     
-00012f50: 2020 2069 6e73 7461 6e63 652e 5f69 735f     instance._is_
-00012f60: 6461 7465 7469 6d65 203d 2054 7275 650a  datetime = True.
-00012f70: 0a20 2020 2020 2020 2023 2052 756e 0a20  .        # Run. 
-00012f80: 2020 2020 2020 2074 6162 6c65 5f64 6174         table_dat
-00012f90: 6120 3d20 7064 2e44 6174 6146 7261 6d65  a = pd.DataFrame
-00012fa0: 287b 0a20 2020 2020 2020 2020 2020 2027  ({.            '
-00012fb0: 6227 3a20 5b27 3230 3231 2c20 382c 2033  b': ['2021, 8, 3
-00012fc0: 3027 2c20 2732 3032 312c 2038 2c20 3331  0', '2021, 8, 31
-00012fd0: 272c 2027 3230 3231 2c20 392c 2032 272c  ', '2021, 9, 2',
-00012fe0: 206e 702e 6e61 6e5d 2c0a 2020 2020 2020   np.nan],.      
-00012ff0: 2020 2020 2020 2763 273a 205b 372c 2038        'c': [7, 8
-00013000: 2c20 392c 2031 305d 0a20 2020 2020 2020  , 9, 10].       
-00013010: 207d 290a 2020 2020 2020 2020 6f75 7420   }).        out 
-00013020: 3d20 696e 7374 616e 6365 2e69 735f 7661  = instance.is_va
-00013030: 6c69 6428 7461 626c 655f 6461 7461 290a  lid(table_data).
-00013040: 0a20 2020 2020 2020 2023 2041 7373 6572  .        # Asser
-00013050: 740a 2020 2020 2020 2020 6578 7065 6374  t.        expect
-00013060: 6564 5f6f 7574 203d 205b 4661 6c73 652c  ed_out = [False,
-00013070: 2054 7275 652c 2054 7275 652c 2054 7275   True, True, Tru
-00013080: 655d 0a20 2020 2020 2020 206e 702e 7465  e].        np.te
-00013090: 7374 696e 672e 6173 7365 7274 5f61 7272  sting.assert_arr
-000130a0: 6179 5f65 7175 616c 2865 7870 6563 7465  ay_equal(expecte
-000130b0: 645f 6f75 742c 206f 7574 290a 0a20 2020  d_out, out)..   
-000130c0: 2064 6566 2074 6573 745f 5f74 7261 6e73   def test__trans
-000130d0: 666f 726d 2873 656c 6629 3a0a 2020 2020  form(self):.    
-000130e0: 2020 2020 2222 2254 6573 7420 7468 6520      """Test the 
-000130f0: 6060 5363 616c 6172 496e 6571 7561 6c69  ``ScalarInequali
-00013100: 7479 2e5f 7472 616e 7366 6f72 6d60 6020  ty._transform`` 
-00013110: 6d65 7468 6f64 2e0a 0a20 2020 2020 2020  method...       
-00013120: 2054 6865 206d 6574 686f 6420 6973 2065   The method is e
-00013130: 7870 6563 7465 6420 746f 2063 6f6d 7075  xpected to compu
-00013140: 7465 2074 6865 2064 6973 7461 6e63 6520  te the distance 
-00013150: 6265 7477 6565 6e20 7468 6520 6060 636f  between the ``co
-00013160: 6c75 6d6e 5f6e 616d 6560 6020 616e 6420  lumn_name`` and 
-00013170: 6060 7661 6c75 6560 600a 2020 2020 2020  ``value``.      
-00013180: 2020 616e 6420 6372 6561 7465 2061 2064    and create a d
-00013190: 6966 6620 636f 6c75 6d6e 2077 6974 6820  iff column with 
-000131a0: 7468 6520 6c6f 6761 7269 7468 6d20 6f66  the logarithm of
-000131b0: 2074 6865 2064 6973 7461 6e63 6520 2b20   the distance + 
-000131c0: 312e 0a0a 2020 2020 2020 2020 5365 7475  1...        Setu
-000131d0: 703a 0a20 2020 2020 2020 202d 2060 605f  p:.        - ``_
-000131e0: 6469 6666 5f63 6f6c 756d 6e5f 6e61 6d65  diff_column_name
-000131f0: 6060 2069 7320 7365 7420 746f 2060 6027  `` is set to ``'
-00013200: 6123 2760 602e 0a20 2020 2020 2020 2049  a#'``..        I
-00013210: 6e70 7574 3a0a 2020 2020 2020 2020 2d20  nput:.        - 
-00013220: 5461 626c 6520 6461 7461 2e0a 2020 2020  Table data..    
-00013230: 2020 2020 4f75 7470 7574 3a0a 2020 2020      Output:.    
-00013240: 2020 2020 2d20 5361 6d65 2074 6162 6c65      - Same table
-00013250: 2077 6974 6820 6120 6469 6666 2063 6f6c   with a diff col
-00013260: 756d 6e20 6f66 2074 6865 206c 6f67 206f  umn of the log o
-00013270: 6620 7468 6520 6469 7374 616e 6365 7320  f the distances 
-00013280: 2b20 310a 2020 2020 2020 2020 2020 696e  + 1.          in
-00013290: 2074 6865 2060 6063 6f6c 756d 6e5f 6e61   the ``column_na
-000132a0: 6d65 6060 2773 2070 6c61 6365 2e0a 2020  me``'s place..  
-000132b0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-000132c0: 2020 2320 5365 7475 700a 2020 2020 2020    # Setup.      
-000132d0: 2020 696e 7374 616e 6365 203d 2053 6361    instance = Sca
-000132e0: 6c61 7249 6e65 7175 616c 6974 7928 636f  larInequality(co
-000132f0: 6c75 6d6e 5f6e 616d 653d 2761 272c 2076  lumn_name='a', v
-00013300: 616c 7565 3d31 2c20 7265 6c61 7469 6f6e  alue=1, relation
-00013310: 3d27 3e3d 2729 0a20 2020 2020 2020 2069  ='>=').        i
-00013320: 6e73 7461 6e63 652e 5f64 6966 665f 636f  nstance._diff_co
-00013330: 6c75 6d6e 5f6e 616d 6520 3d20 2761 2327  lumn_name = 'a#'
-00013340: 0a0a 2020 2020 2020 2020 2320 5275 6e0a  ..        # Run.
-00013350: 2020 2020 2020 2020 7461 626c 655f 6461          table_da
-00013360: 7461 203d 2070 642e 4461 7461 4672 616d  ta = pd.DataFram
-00013370: 6528 7b0a 2020 2020 2020 2020 2020 2020  e({.            
-00013380: 2761 273a 205b 312c 2032 2c20 335d 2c0a  'a': [1, 2, 3],.
-00013390: 2020 2020 2020 2020 2020 2020 2763 273a              'c':
-000133a0: 205b 372c 2038 2c20 395d 2c0a 2020 2020   [7, 8, 9],.    
-000133b0: 2020 2020 7d29 0a20 2020 2020 2020 206f      }).        o
-000133c0: 7574 203d 2069 6e73 7461 6e63 652e 5f74  ut = instance._t
-000133d0: 7261 6e73 666f 726d 2874 6162 6c65 5f64  ransform(table_d
-000133e0: 6174 6129 0a0a 2020 2020 2020 2020 2320  ata)..        # 
-000133f0: 4173 7365 7274 0a20 2020 2020 2020 2065  Assert.        e
-00013400: 7870 6563 7465 645f 6f75 7420 3d20 7064  xpected_out = pd
-00013410: 2e44 6174 6146 7261 6d65 287b 0a20 2020  .DataFrame({.   
-00013420: 2020 2020 2020 2020 2027 6327 3a20 5b37           'c': [7
-00013430: 2c20 382c 2039 5d2c 0a20 2020 2020 2020  , 8, 9],.       
-00013440: 2020 2020 2027 6123 273a 205b 6e70 2e6c       'a#': [np.l
-00013450: 6f67 2831 292c 206e 702e 6c6f 6728 3229  og(1), np.log(2)
-00013460: 2c20 6e70 2e6c 6f67 2833 295d 2c0a 2020  , np.log(3)],.  
-00013470: 2020 2020 2020 7d29 0a20 2020 2020 2020        }).       
-00013480: 2070 642e 7465 7374 696e 672e 6173 7365   pd.testing.asse
-00013490: 7274 5f66 7261 6d65 5f65 7175 616c 286f  rt_frame_equal(o
-000134a0: 7574 2c20 6578 7065 6374 6564 5f6f 7574  ut, expected_out
-000134b0: 290a 0a20 2020 2064 6566 2074 6573 745f  )..    def test_
-000134c0: 5f74 7261 6e73 666f 726d 5f64 6174 6574  _transform_datet
-000134d0: 696d 6528 7365 6c66 293a 0a20 2020 2020  ime(self):.     
-000134e0: 2020 2022 2222 5465 7374 2074 6865 2060     """Test the `
-000134f0: 6053 6361 6c61 7249 6e65 7175 616c 6974  `ScalarInequalit
-00013500: 792e 5f74 7261 6e73 666f 726d 6060 206d  y._transform`` m
-00013510: 6574 686f 642e 0a0a 2020 2020 2020 2020  ethod...        
-00013520: 5468 6520 6d65 7468 6f64 2069 7320 6578  The method is ex
-00013530: 7065 6374 6564 2074 6f20 636f 6d70 7574  pected to comput
-00013540: 6520 7468 6520 6469 7374 616e 6365 2062  e the distance b
-00013550: 6574 7765 656e 2074 6865 2060 6063 6f6c  etween the ``col
-00013560: 756d 6e5f 6e61 6d65 6060 2061 6e64 2060  umn_name`` and `
-00013570: 6076 616c 7565 6060 0a20 2020 2020 2020  `value``.       
-00013580: 2061 6e64 2063 7265 6174 6520 6120 6469   and create a di
-00013590: 6666 2063 6f6c 756d 6e20 7769 7468 2074  ff column with t
-000135a0: 6865 206c 6f67 6172 6974 686d 206f 6620  he logarithm of 
-000135b0: 7468 6520 6469 7374 616e 6365 202b 2031  the distance + 1
-000135c0: 2e0a 0a20 2020 2020 2020 2053 6574 7570  ...        Setup
-000135d0: 3a0a 2020 2020 2020 2020 2d20 6060 5f64  :.        - ``_d
-000135e0: 6966 665f 636f 6c75 6d6e 5f6e 616d 6560  iff_column_name`
-000135f0: 6020 6973 2073 6574 2074 6f20 6060 2761  ` is set to ``'a
-00013600: 2327 6060 2e0a 2020 2020 2020 2020 496e  #'``..        In
-00013610: 7075 743a 0a20 2020 2020 2020 202d 2054  put:.        - T
-00013620: 6162 6c65 2064 6174 6120 7769 7468 2064  able data with d
-00013630: 6174 6574 696d 6573 2e0a 2020 2020 2020  atetimes..      
-00013640: 2020 4f75 7470 7574 3a0a 2020 2020 2020    Output:.      
-00013650: 2020 2d20 5361 6d65 2074 6162 6c65 2077    - Same table w
-00013660: 6974 6820 6120 6469 6666 2063 6f6c 756d  ith a diff colum
-00013670: 6e20 6f66 2074 6865 206c 6f67 6172 6974  n of the logarit
-00013680: 686d 7320 6f66 2074 6865 2064 6973 7461  hms of the dista
-00013690: 6e63 6573 202b 2031 0a20 2020 2020 2020  nces + 1.       
-000136a0: 2020 2069 6e20 7468 6520 6060 636f 6c75     in the ``colu
-000136b0: 6d6e 5f6e 616d 6560 6027 7320 706c 6163  mn_name``'s plac
-000136c0: 652e 0a20 2020 2020 2020 2022 2222 0a20  e..        """. 
-000136d0: 2020 2020 2020 2023 2053 6574 7570 0a20         # Setup. 
-000136e0: 2020 2020 2020 2069 6e73 7461 6e63 6520         instance 
-000136f0: 3d20 5363 616c 6172 496e 6571 7561 6c69  = ScalarInequali
-00013700: 7479 280a 2020 2020 2020 2020 2020 2020  ty(.            
-00013710: 636f 6c75 6d6e 5f6e 616d 653d 2761 272c  column_name='a',
-00013720: 0a20 2020 2020 2020 2020 2020 2076 616c  .            val
-00013730: 7565 3d27 3230 3230 2d30 312d 3031 5430  ue='2020-01-01T0
-00013740: 303a 3030 3a30 3027 2c0a 2020 2020 2020  0:00:00',.      
-00013750: 2020 2020 2020 7265 6c61 7469 6f6e 3d27        relation='
-00013760: 3e27 290a 2020 2020 2020 2020 696e 7374  >').        inst
-00013770: 616e 6365 2e5f 6469 6666 5f63 6f6c 756d  ance._diff_colum
-00013780: 6e5f 6e61 6d65 203d 2027 6123 270a 2020  n_name = 'a#'.  
-00013790: 2020 2020 2020 696e 7374 616e 6365 2e5f        instance._
-000137a0: 6973 5f64 6174 6574 696d 6520 3d20 5472  is_datetime = Tr
-000137b0: 7565 0a0a 2020 2020 2020 2020 2320 5275  ue..        # Ru
-000137c0: 6e0a 2020 2020 2020 2020 7461 626c 655f  n.        table_
-000137d0: 6461 7461 203d 2070 642e 4461 7461 4672  data = pd.DataFr
-000137e0: 616d 6528 7b0a 2020 2020 2020 2020 2020  ame({.          
-000137f0: 2020 2761 273a 2070 642e 746f 5f64 6174    'a': pd.to_dat
-00013800: 6574 696d 6528 5b27 3230 3230 2d30 312d  etime(['2020-01-
-00013810: 3031 5430 303a 3030 3a30 3127 2c20 2732  01T00:00:01', '2
-00013820: 3032 302d 3031 2d30 3154 3030 3a30 303a  020-01-01T00:00:
-00013830: 3031 275d 292c 0a20 2020 2020 2020 2020  01']),.         
-00013840: 2020 2027 6327 3a20 5b31 2c20 325d 2c0a     'c': [1, 2],.
-00013850: 2020 2020 2020 2020 7d29 0a20 2020 2020          }).     
-00013860: 2020 206f 7574 203d 2069 6e73 7461 6e63     out = instanc
-00013870: 652e 5f74 7261 6e73 666f 726d 2874 6162  e._transform(tab
-00013880: 6c65 5f64 6174 6129 0a0a 2020 2020 2020  le_data)..      
-00013890: 2020 2320 4173 7365 7274 0a20 2020 2020    # Assert.     
-000138a0: 2020 2065 7870 6563 7465 645f 6f75 7420     expected_out 
-000138b0: 3d20 7064 2e44 6174 6146 7261 6d65 287b  = pd.DataFrame({
-000138c0: 0a20 2020 2020 2020 2020 2020 2027 6327  .            'c'
-000138d0: 3a20 5b31 2c20 325d 2c0a 2020 2020 2020  : [1, 2],.      
-000138e0: 2020 2020 2020 2761 2327 3a20 5b6e 702e        'a#': [np.
-000138f0: 6c6f 6728 315f 3030 305f 3030 305f 3030  log(1_000_000_00
-00013900: 3129 2c20 6e70 2e6c 6f67 2831 5f30 3030  1), np.log(1_000
-00013910: 5f30 3030 5f30 3031 295d 2c0a 2020 2020  _000_001)],.    
-00013920: 2020 2020 7d29 0a20 2020 2020 2020 2070      }).        p
-00013930: 642e 7465 7374 696e 672e 6173 7365 7274  d.testing.assert
-00013940: 5f66 7261 6d65 5f65 7175 616c 286f 7574  _frame_equal(out
-00013950: 2c20 6578 7065 6374 6564 5f6f 7574 290a  , expected_out).
-00013960: 0a20 2020 2064 6566 2074 6573 745f 7265  .    def test_re
-00013970: 7665 7273 655f 7472 616e 7366 6f72 6d28  verse_transform(
-00013980: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
-00013990: 2222 5465 7374 2074 6865 2060 6053 6361  ""Test the ``Sca
-000139a0: 6c61 7249 6e65 7175 616c 6974 792e 7265  larInequality.re
-000139b0: 7665 7273 655f 7472 616e 7366 6f72 6d60  verse_transform`
-000139c0: 6020 6d65 7468 6f64 2e0a 0a20 2020 2020  ` method...     
-000139d0: 2020 2054 6865 206d 6574 686f 6420 6973     The method is
-000139e0: 2065 7870 6563 7465 6420 746f 3a0a 2020   expected to:.  
-000139f0: 2020 2020 2020 2020 2020 2d20 6170 706c            - appl
-00013a00: 7920 616e 2065 7870 6f6e 656e 7469 616c  y an exponential
-00013a10: 2074 6f20 7468 6520 696e 7075 740a 2020   to the input.  
-00013a20: 2020 2020 2020 2020 2020 2d20 7375 6274            - subt
-00013a30: 7261 6374 2031 0a20 2020 2020 2020 2020  ract 1.         
-00013a40: 2020 202d 2061 6464 2074 6865 2060 6063     - add the ``c
-00013a50: 6f6c 756d 6e5f 6e61 6d65 6060 0a20 2020  olumn_name``.   
-00013a60: 2020 2020 2020 2020 202d 2063 6f6e 7665           - conve
-00013a70: 7274 2074 6865 206f 7574 7075 7420 746f  rt the output to
-00013a80: 2069 6e74 6567 6572 730a 2020 2020 2020   integers.      
-00013a90: 2020 2020 2020 2d20 6164 6420 6261 636b        - add back
-00013aa0: 2074 6865 2064 726f 7070 6564 2063 6f6c   the dropped col
-00013ab0: 756d 6e0a 0a20 2020 2020 2020 2053 6574  umn..        Set
-00013ac0: 7570 3a0a 2020 2020 2020 2020 2d20 6060  up:.        - ``
-00013ad0: 5f64 6966 665f 636f 6c75 6d6e 5f6e 616d  _diff_column_nam
-00013ae0: 6520 3d20 2761 2327 6060 0a20 2020 2020  e = 'a#'``.     
-00013af0: 2020 202d 2060 605f 6474 7970 6560 6020     - ``_dtype`` 
-00013b00: 6173 2069 6e74 6567 6572 0a20 2020 2020  as integer.     
-00013b10: 2020 2049 6e70 7574 3a0a 2020 2020 2020     Input:.      
-00013b20: 2020 2d20 5461 626c 6520 7769 7468 2061    - Table with a
-00013b30: 2064 6966 6620 636f 6c75 6d6e 2074 6861   diff column tha
-00013b40: 7420 636f 6e74 6169 6e73 2074 6865 2063  t contains the c
-00013b50: 6f6e 7374 616e 7420 6e70 2e6c 6f67 2834  onstant np.log(4
-00013b60: 292e 0a20 2020 2020 2020 204f 7574 7075  )..        Outpu
-00013b70: 743a 0a20 2020 2020 2020 202d 2053 616d  t:.        - Sam
-00013b80: 6520 7461 626c 6520 7769 7468 2074 6865  e table with the
-00013b90: 2068 6967 6820 636f 6c75 6d6e 2072 6570   high column rep
-00013ba0: 6c61 6365 6420 6279 2074 6865 206c 6f77  laced by the low
-00013bb0: 206f 6e65 202b 2033 2c20 6173 2069 6e74   one + 3, as int
-00013bc0: 0a20 2020 2020 2020 2061 6e64 2074 6865  .        and the
-00013bd0: 2064 6966 6620 636f 6c75 6d6e 2064 726f   diff column dro
-00013be0: 7070 6564 2e0a 2020 2020 2020 2020 2222  pped..        ""
-00013bf0: 220a 2020 2020 2020 2020 2320 5365 7475  ".        # Setu
-00013c00: 700a 2020 2020 2020 2020 696e 7374 616e  p.        instan
-00013c10: 6365 203d 2053 6361 6c61 7249 6e65 7175  ce = ScalarInequ
-00013c20: 616c 6974 7928 636f 6c75 6d6e 5f6e 616d  ality(column_nam
-00013c30: 653d 2761 272c 2076 616c 7565 3d31 2c20  e='a', value=1, 
-00013c40: 7265 6c61 7469 6f6e 3d27 3e3d 2729 0a20  relation='>='). 
-00013c50: 2020 2020 2020 2069 6e73 7461 6e63 652e         instance.
-00013c60: 5f64 7479 7065 203d 2070 642e 5365 7269  _dtype = pd.Seri
-00013c70: 6573 285b 315d 292e 6474 7970 6520 2023  es([1]).dtype  #
-00013c80: 2065 7861 6374 2064 7479 7065 2028 3332   exact dtype (32
-00013c90: 206f 7220 3634 2920 6465 7065 6e64 7320   or 64) depends 
-00013ca0: 6f6e 204f 530a 2020 2020 2020 2020 696e  on OS.        in
-00013cb0: 7374 616e 6365 2e5f 6469 6666 5f63 6f6c  stance._diff_col
-00013cc0: 756d 6e5f 6e61 6d65 203d 2027 6123 270a  umn_name = 'a#'.
-00013cd0: 0a20 2020 2020 2020 2023 2052 756e 0a20  .        # Run. 
-00013ce0: 2020 2020 2020 2074 7261 6e73 666f 726d         transform
-00013cf0: 6564 203d 2070 642e 4461 7461 4672 616d  ed = pd.DataFram
-00013d00: 6528 7b0a 2020 2020 2020 2020 2020 2020  e({.            
-00013d10: 2761 2327 3a20 5b6e 702e 6c6f 6728 3129  'a#': [np.log(1)
-00013d20: 2c20 6e70 2e6c 6f67 2832 292c 206e 702e  , np.log(2), np.
-00013d30: 6c6f 6728 3329 5d2c 0a20 2020 2020 2020  log(3)],.       
-00013d40: 2020 2020 2027 6327 3a20 5b37 2c20 382c       'c': [7, 8,
-00013d50: 2039 5d2c 0a20 2020 2020 2020 207d 290a   9],.        }).
-00013d60: 2020 2020 2020 2020 6f75 7420 3d20 696e          out = in
-00013d70: 7374 616e 6365 2e72 6576 6572 7365 5f74  stance.reverse_t
-00013d80: 7261 6e73 666f 726d 2874 7261 6e73 666f  ransform(transfo
-00013d90: 726d 6564 290a 0a20 2020 2020 2020 2023  rmed)..        #
-00013da0: 2041 7373 6572 740a 2020 2020 2020 2020   Assert.        
-00013db0: 6578 7065 6374 6564 5f6f 7574 203d 2070  expected_out = p
-00013dc0: 642e 4461 7461 4672 616d 6528 7b0a 2020  d.DataFrame({.  
-00013dd0: 2020 2020 2020 2020 2020 2763 273a 205b            'c': [
-00013de0: 372c 2038 2c20 395d 2c0a 2020 2020 2020  7, 8, 9],.      
-00013df0: 2020 2020 2020 2761 273a 205b 312c 2032        'a': [1, 2
-00013e00: 2c20 335d 2c0a 2020 2020 2020 2020 7d29  , 3],.        })
-00013e10: 0a20 2020 2020 2020 2070 642e 7465 7374  .        pd.test
-00013e20: 696e 672e 6173 7365 7274 5f66 7261 6d65  ing.assert_frame
-00013e30: 5f65 7175 616c 286f 7574 2c20 6578 7065  _equal(out, expe
-00013e40: 6374 6564 5f6f 7574 290a 0a20 2020 2064  cted_out)..    d
-00013e50: 6566 2074 6573 745f 7265 7665 7273 655f  ef test_reverse_
-00013e60: 7472 616e 7366 6f72 6d5f 666c 6f61 7473  transform_floats
-00013e70: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00013e80: 2222 2254 6573 7420 7468 6520 6060 5363  """Test the ``Sc
-00013e90: 616c 6172 496e 6571 7561 6c69 7479 2e72  alarInequality.r
-00013ea0: 6576 6572 7365 5f74 7261 6e73 666f 726d  everse_transform
-00013eb0: 6060 206d 6574 686f 642e 0a0a 2020 2020  `` method...    
-00013ec0: 2020 2020 5468 6520 6d65 7468 6f64 2069      The method i
-00013ed0: 7320 6578 7065 6374 6564 2074 6f3a 0a20  s expected to:. 
-00013ee0: 2020 2020 2020 2020 2020 202d 2061 7070             - app
-00013ef0: 6c79 2061 6e20 6578 706f 6e65 6e74 6961  ly an exponentia
-00013f00: 6c20 746f 2074 6865 2069 6e70 7574 0a20  l to the input. 
-00013f10: 2020 2020 2020 2020 2020 202d 2073 7562             - sub
-00013f20: 7472 6163 7420 310a 2020 2020 2020 2020  tract 1.        
-00013f30: 2020 2020 2d20 6164 6420 7468 6520 6060      - add the ``
-00013f40: 7661 6c75 6560 600a 2020 2020 2020 2020  value``.        
-00013f50: 2020 2020 2d20 636f 6e76 6572 7420 7468      - convert th
-00013f60: 6520 6f75 7470 7574 2074 6f20 666c 6f61  e output to floa
-00013f70: 740a 2020 2020 2020 2020 2020 2020 2d20  t.            - 
-00013f80: 6164 6420 6261 636b 2074 6865 2064 726f  add back the dro
-00013f90: 7070 6564 2063 6f6c 756d 6e0a 0a20 2020  pped column..   
-00013fa0: 2020 2020 2053 6574 7570 3a0a 2020 2020       Setup:.    
-00013fb0: 2020 2020 2d20 6060 5f64 6966 665f 636f      - ``_diff_co
-00013fc0: 6c75 6d6e 5f6e 616d 6520 3d20 2761 2327  lumn_name = 'a#'
-00013fd0: 6060 0a20 2020 2020 2020 202d 2060 605f  ``.        - ``_
-00013fe0: 6474 7970 6560 6020 6173 2066 6c6f 6174  dtype`` as float
-00013ff0: 0a20 2020 2020 2020 2049 6e70 7574 3a0a  .        Input:.
-00014000: 2020 2020 2020 2020 2d20 5461 626c 6520          - Table 
-00014010: 7769 7468 2061 2064 6966 6620 636f 6c75  with a diff colu
-00014020: 6d6e 2074 6861 7420 636f 6e74 6169 6e73  mn that contains
-00014030: 2074 6865 2063 6f6e 7374 616e 7420 6e70   the constant np
-00014040: 2e6c 6f67 2834 292e 0a20 2020 2020 2020  .log(4)..       
-00014050: 204f 7574 7075 743a 0a20 2020 2020 2020   Output:.       
-00014060: 202d 2053 616d 6520 7461 626c 6520 7769   - Same table wi
-00014070: 7468 2074 6865 2068 6967 6820 636f 6c75  th the high colu
-00014080: 6d6e 2072 6570 6c61 6365 6420 6279 2074  mn replaced by t
-00014090: 6865 206c 6f77 206f 6e65 202b 2031 2c20  he low one + 1, 
-000140a0: 6173 2066 6c6f 6174 0a20 2020 2020 2020  as float.       
-000140b0: 2061 6e64 2074 6865 2064 6966 6620 636f   and the diff co
-000140c0: 6c75 6d6e 2064 726f 7070 6564 2e0a 2020  lumn dropped..  
-000140d0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-000140e0: 2020 2320 5365 7475 700a 2020 2020 2020    # Setup.      
-000140f0: 2020 696e 7374 616e 6365 203d 2053 6361    instance = Sca
-00014100: 6c61 7249 6e65 7175 616c 6974 7928 636f  larInequality(co
-00014110: 6c75 6d6e 5f6e 616d 653d 2761 272c 2076  lumn_name='a', v
-00014120: 616c 7565 3d31 2c20 7265 6c61 7469 6f6e  alue=1, relation
-00014130: 3d27 3e3d 2729 0a20 2020 2020 2020 2069  ='>=').        i
-00014140: 6e73 7461 6e63 652e 5f64 7479 7065 203d  nstance._dtype =
-00014150: 206e 702e 6474 7970 6528 2766 6c6f 6174   np.dtype('float
-00014160: 2729 0a20 2020 2020 2020 2069 6e73 7461  ').        insta
-00014170: 6e63 652e 5f64 6966 665f 636f 6c75 6d6e  nce._diff_column
-00014180: 5f6e 616d 6520 3d20 2761 2327 0a0a 2020  _name = 'a#'..  
-00014190: 2020 2020 2020 2320 5275 6e0a 2020 2020        # Run.    
-000141a0: 2020 2020 7472 616e 7366 6f72 6d65 6420      transformed 
-000141b0: 3d20 7064 2e44 6174 6146 7261 6d65 287b  = pd.DataFrame({
-000141c0: 0a20 2020 2020 2020 2020 2020 2027 6123  .            'a#
-000141d0: 273a 205b 6e70 2e6c 6f67 2831 2e31 292c  ': [np.log(1.1),
-000141e0: 206e 702e 6c6f 6728 322e 3129 2c20 6e70   np.log(2.1), np
-000141f0: 2e6c 6f67 2833 2e33 295d 2c0a 2020 2020  .log(3.3)],.    
-00014200: 2020 2020 2020 2020 2763 273a 205b 372c          'c': [7,
-00014210: 2038 2c20 395d 2c0a 2020 2020 2020 2020   8, 9],.        
-00014220: 7d29 0a20 2020 2020 2020 206f 7574 203d  }).        out =
-00014230: 2069 6e73 7461 6e63 652e 7265 7665 7273   instance.revers
-00014240: 655f 7472 616e 7366 6f72 6d28 7472 616e  e_transform(tran
-00014250: 7366 6f72 6d65 6429 0a0a 2020 2020 2020  sformed)..      
-00014260: 2020 2320 4173 7365 7274 0a20 2020 2020    # Assert.     
-00014270: 2020 2065 7870 6563 7465 645f 6f75 7420     expected_out 
-00014280: 3d20 7064 2e44 6174 6146 7261 6d65 287b  = pd.DataFrame({
-00014290: 0a20 2020 2020 2020 2020 2020 2027 6327  .            'c'
-000142a0: 3a20 5b37 2c20 382c 2039 5d2c 0a20 2020  : [7, 8, 9],.   
-000142b0: 2020 2020 2020 2020 2027 6127 3a20 5b31           'a': [1
-000142c0: 2e31 2c20 322e 312c 2033 2e33 5d2c 0a20  .1, 2.1, 3.3],. 
-000142d0: 2020 2020 2020 207d 290a 2020 2020 2020         }).      
-000142e0: 2020 7064 2e74 6573 7469 6e67 2e61 7373    pd.testing.ass
-000142f0: 6572 745f 6672 616d 655f 6571 7561 6c28  ert_frame_equal(
-00014300: 6f75 742c 2065 7870 6563 7465 645f 6f75  out, expected_ou
-00014310: 7429 0a0a 2020 2020 6465 6620 7465 7374  t)..    def test
-00014320: 5f72 6576 6572 7365 5f74 7261 6e73 666f  _reverse_transfo
-00014330: 726d 5f64 6174 6574 696d 6528 7365 6c66  rm_datetime(self
-00014340: 293a 0a20 2020 2020 2020 2022 2222 5465  ):.        """Te
-00014350: 7374 2074 6865 2060 6053 6361 6c61 7249  st the ``ScalarI
-00014360: 6e65 7175 616c 6974 792e 7265 7665 7273  nequality.revers
-00014370: 655f 7472 616e 7366 6f72 6d60 6020 6d65  e_transform`` me
-00014380: 7468 6f64 2e0a 0a20 2020 2020 2020 2054  thod...        T
-00014390: 6865 206d 6574 686f 6420 6973 2065 7870  he method is exp
-000143a0: 6563 7465 6420 746f 3a0a 2020 2020 2020  ected to:.      
-000143b0: 2020 2020 2020 2d20 6170 706c 7920 616e        - apply an
-000143c0: 2065 7870 6f6e 656e 7469 616c 2074 6f20   exponential to 
-000143d0: 7468 6520 696e 7075 740a 2020 2020 2020  the input.      
-000143e0: 2020 2020 2020 2d20 7375 6274 7261 6374        - subtract
-000143f0: 2031 0a20 2020 2020 2020 2020 2020 202d   1.            -
-00014400: 2061 6464 2074 6865 2060 6063 6f6c 756d   add the ``colum
-00014410: 6e5f 6e61 6d65 6060 0a20 2020 2020 2020  n_name``.       
-00014420: 2020 2020 202d 2063 6f6e 7665 7274 2074       - convert t
-00014430: 6865 206f 7574 7075 7420 746f 2064 6174  he output to dat
-00014440: 6574 696d 650a 2020 2020 2020 2020 2020  etime.          
-00014450: 2020 2d20 6164 6420 6261 636b 2074 6865    - add back the
-00014460: 2064 726f 7070 6564 2063 6f6c 756d 6e0a   dropped column.
-00014470: 0a20 2020 2020 2020 2053 6574 7570 3a0a  .        Setup:.
-00014480: 2020 2020 2020 2020 2d20 6060 5f64 6966          - ``_dif
-00014490: 665f 636f 6c75 6d6e 5f6e 616d 6520 3d20  f_column_name = 
-000144a0: 2761 2327 6060 0a20 2020 2020 2020 202d  'a#'``.        -
-000144b0: 2060 605f 6474 7970 6560 6020 6173 2064   ``_dtype`` as d
-000144c0: 6174 6574 696d 650a 2020 2020 2020 2020  atetime.        
-000144d0: 496e 7075 743a 0a20 2020 2020 2020 202d  Input:.        -
-000144e0: 2054 6162 6c65 2077 6974 6820 6120 6469   Table with a di
-000144f0: 6666 2063 6f6c 756d 6e20 7468 6174 2063  ff column that c
-00014500: 6f6e 7461 696e 7320 7468 6520 636f 6e73  ontains the cons
-00014510: 7461 6e74 206e 702e 6c6f 6728 3429 2e0a  tant np.log(4)..
-00014520: 2020 2020 2020 2020 4f75 7470 7574 3a0a          Output:.
-00014530: 2020 2020 2020 2020 2d20 5361 6d65 2074          - Same t
-00014540: 6162 6c65 2077 6974 6820 7468 6520 6869  able with the hi
-00014550: 6768 2063 6f6c 756d 6e20 7265 706c 6163  gh column replac
-00014560: 6564 2062 7920 7468 6520 6c6f 7720 6f6e  ed by the low on
-00014570: 6520 2b20 332c 2061 7320 6461 7465 7469  e + 3, as dateti
-00014580: 6d65 0a20 2020 2020 2020 2061 6e64 2074  me.        and t
-00014590: 6865 2064 6966 6620 636f 6c75 6d6e 2064  he diff column d
-000145a0: 726f 7070 6564 2e0a 2020 2020 2020 2020  ropped..        
-000145b0: 2222 220a 2020 2020 2020 2020 2320 5365  """.        # Se
-000145c0: 7475 700a 2020 2020 2020 2020 696e 7374  tup.        inst
-000145d0: 616e 6365 203d 2053 6361 6c61 7249 6e65  ance = ScalarIne
-000145e0: 7175 616c 6974 7928 0a20 2020 2020 2020  quality(.       
-000145f0: 2020 2020 2063 6f6c 756d 6e5f 6e61 6d65       column_name
-00014600: 3d27 6127 2c0a 2020 2020 2020 2020 2020  ='a',.          
-00014610: 2020 7661 6c75 653d 2732 3032 302d 3031    value='2020-01
-00014620: 2d30 3154 3030 3a30 303a 3030 272c 0a20  -01T00:00:00',. 
-00014630: 2020 2020 2020 2020 2020 2072 656c 6174             relat
-00014640: 696f 6e3d 273e 3d27 290a 2020 2020 2020  ion='>=').      
-00014650: 2020 696e 7374 616e 6365 2e5f 6474 7970    instance._dtyp
-00014660: 6520 3d20 6e70 2e64 7479 7065 2827 3c4d  e = np.dtype('<M
-00014670: 385b 6e73 5d27 290a 2020 2020 2020 2020  8[ns]').        
-00014680: 696e 7374 616e 6365 2e5f 6469 6666 5f63  instance._diff_c
-00014690: 6f6c 756d 6e5f 6e61 6d65 203d 2027 6123  olumn_name = 'a#
-000146a0: 270a 2020 2020 2020 2020 696e 7374 616e  '.        instan
-000146b0: 6365 2e5f 6973 5f64 6174 6574 696d 6520  ce._is_datetime 
-000146c0: 3d20 5472 7565 0a0a 2020 2020 2020 2020  = True..        
-000146d0: 2320 5275 6e0a 2020 2020 2020 2020 7472  # Run.        tr
-000146e0: 616e 7366 6f72 6d65 6420 3d20 7064 2e44  ansformed = pd.D
-000146f0: 6174 6146 7261 6d65 287b 0a20 2020 2020  ataFrame({.     
-00014700: 2020 2020 2020 2027 6123 273a 205b 6e70         'a#': [np
-00014710: 2e6c 6f67 2831 5f30 3030 5f30 3030 5f30  .log(1_000_000_0
-00014720: 3031 292c 206e 702e 6c6f 6728 315f 3030  01), np.log(1_00
-00014730: 305f 3030 305f 3030 3129 5d2c 0a20 2020  0_000_001)],.   
-00014740: 2020 2020 2020 2020 2027 6327 3a20 5b31           'c': [1
-00014750: 2c20 325d 2c0a 2020 2020 2020 2020 7d29  , 2],.        })
-00014760: 0a20 2020 2020 2020 206f 7574 203d 2069  .        out = i
-00014770: 6e73 7461 6e63 652e 7265 7665 7273 655f  nstance.reverse_
-00014780: 7472 616e 7366 6f72 6d28 7472 616e 7366  transform(transf
-00014790: 6f72 6d65 6429 0a0a 2020 2020 2020 2020  ormed)..        
-000147a0: 2320 4173 7365 7274 0a20 2020 2020 2020  # Assert.       
-000147b0: 2065 7870 6563 7465 645f 6f75 7420 3d20   expected_out = 
-000147c0: 7064 2e44 6174 6146 7261 6d65 287b 0a20  pd.DataFrame({. 
-000147d0: 2020 2020 2020 2020 2020 2027 6327 3a20             'c': 
-000147e0: 5b31 2c20 325d 2c0a 2020 2020 2020 2020  [1, 2],.        
-000147f0: 2020 2020 2761 273a 2070 642e 746f 5f64      'a': pd.to_d
-00014800: 6174 6574 696d 6528 5b27 3230 3230 2d30  atetime(['2020-0
-00014810: 312d 3031 5430 303a 3030 3a30 3127 2c20  1-01T00:00:01', 
-00014820: 2732 3032 302d 3031 2d30 3154 3030 3a30  '2020-01-01T00:0
-00014830: 303a 3031 275d 292c 0a20 2020 2020 2020  0:01']),.       
-00014840: 207d 290a 2020 2020 2020 2020 7064 2e74   }).        pd.t
-00014850: 6573 7469 6e67 2e61 7373 6572 745f 6672  esting.assert_fr
-00014860: 616d 655f 6571 7561 6c28 6f75 742c 2065  ame_equal(out, e
-00014870: 7870 6563 7465 645f 6f75 7429 0a0a 2020  xpected_out)..  
-00014880: 2020 6465 6620 7465 7374 5f72 6576 6572    def test_rever
-00014890: 7365 5f74 7261 6e73 666f 726d 5f6f 7065  se_transform_ope
-000148a0: 7261 746f 725f 6c65 7373 2873 656c 6629  rator_less(self)
-000148b0: 3a0a 2020 2020 2020 2020 2222 2254 6573  :.        """Tes
-000148c0: 7420 7468 6520 6060 5363 616c 6172 496e  t the ``ScalarIn
-000148d0: 6571 7561 6c69 7479 2e72 6576 6572 7365  equality.reverse
-000148e0: 5f74 7261 6e73 666f 726d 6060 206d 6574  _transform`` met
-000148f0: 686f 6420 7768 656e 206f 7065 7261 746f  hod when operato
-00014900: 7220 6973 2060 606e 702e 6c65 7373 6060  r is ``np.less``
-00014910: 2e22 2222 0a20 2020 2020 2020 2023 2053  .""".        # S
-00014920: 6574 7570 0a20 2020 2020 2020 2069 6e73  etup.        ins
-00014930: 7461 6e63 6520 3d20 5363 616c 6172 496e  tance = ScalarIn
-00014940: 6571 7561 6c69 7479 2863 6f6c 756d 6e5f  equality(column_
-00014950: 6e61 6d65 3d27 6127 2c20 7661 6c75 653d  name='a', value=
-00014960: 312c 2072 656c 6174 696f 6e3d 273c 2729  1, relation='<')
-00014970: 0a20 2020 2020 2020 2069 6e73 7461 6e63  .        instanc
-00014980: 652e 5f64 7479 7065 203d 206e 702e 6474  e._dtype = np.dt
-00014990: 7970 6528 2766 6c6f 6174 2729 0a20 2020  ype('float').   
-000149a0: 2020 2020 2069 6e73 7461 6e63 652e 5f64       instance._d
-000149b0: 6966 665f 636f 6c75 6d6e 5f6e 616d 6520  iff_column_name 
-000149c0: 3d20 2761 2327 0a0a 2020 2020 2020 2020  = 'a#'..        
-000149d0: 2320 5275 6e0a 2020 2020 2020 2020 7472  # Run.        tr
-000149e0: 616e 7366 6f72 6d65 6420 3d20 7064 2e44  ansformed = pd.D
-000149f0: 6174 6146 7261 6d65 287b 0a20 2020 2020  ataFrame({.     
-00014a00: 2020 2020 2020 2027 6123 273a 205b 6e70         'a#': [np
-00014a10: 2e6c 6f67 2831 2e31 292c 206e 702e 6c6f  .log(1.1), np.lo
-00014a20: 6728 322e 3129 2c20 6e70 2e6c 6f67 2833  g(2.1), np.log(3
-00014a30: 2e33 295d 2c0a 2020 2020 2020 2020 2020  .3)],.          
-00014a40: 2020 2763 273a 205b 372c 2038 2c20 395d    'c': [7, 8, 9]
-00014a50: 2c0a 2020 2020 2020 2020 7d29 0a20 2020  ,.        }).   
-00014a60: 2020 2020 206f 7574 203d 2069 6e73 7461       out = insta
-00014a70: 6e63 652e 7265 7665 7273 655f 7472 616e  nce.reverse_tran
-00014a80: 7366 6f72 6d28 7472 616e 7366 6f72 6d65  sform(transforme
-00014a90: 6429 0a0a 2020 2020 2020 2020 2320 4173  d)..        # As
-00014aa0: 7365 7274 0a20 2020 2020 2020 2065 7870  sert.        exp
-00014ab0: 6563 7465 645f 6f75 7420 3d20 7064 2e44  ected_out = pd.D
-00014ac0: 6174 6146 7261 6d65 287b 0a20 2020 2020  ataFrame({.     
-00014ad0: 2020 2020 2020 2027 6327 3a20 5b37 2c20         'c': [7, 
-00014ae0: 382c 2039 5d2c 0a20 2020 2020 2020 2020  8, 9],.         
-00014af0: 2020 2027 6127 3a20 5b30 2e39 2c20 2d30     'a': [0.9, -0
-00014b00: 2e31 2c20 2d31 2e33 5d2c 0a20 2020 2020  .1, -1.3],.     
-00014b10: 2020 207d 290a 2020 2020 2020 2020 7064     }).        pd
-00014b20: 2e74 6573 7469 6e67 2e61 7373 6572 745f  .testing.assert_
-00014b30: 6672 616d 655f 6571 7561 6c28 6f75 742c  frame_equal(out,
-00014b40: 2065 7870 6563 7465 645f 6f75 7429 0a0a   expected_out)..
-00014b50: 0a63 6c61 7373 2054 6573 7450 6f73 6974  .class TestPosit
-00014b60: 6976 6528 293a 0a0a 2020 2020 6465 6620  ive():..    def 
-00014b70: 7465 7374 5f5f 7661 6c69 6461 7465 5f69  test__validate_i
-00014b80: 6e70 7574 7328 7365 6c66 293a 0a20 2020  nputs(self):.   
-00014b90: 2020 2020 2022 2222 5465 7374 2074 6865       """Test the
-00014ba0: 2060 6050 6f73 6974 6976 652e 5f76 616c   ``Positive._val
-00014bb0: 6964 6174 655f 696e 7075 7473 6060 206d  idate_inputs`` m
-00014bc0: 6574 686f 642e 0a0a 2020 2020 2020 2020  ethod...        
-00014bd0: 496e 7075 743a 0a20 2020 2020 2020 202d  Input:.        -
-00014be0: 2020 496e 636f 7272 6563 7420 7061 7261    Incorrect para
-00014bf0: 6d65 7465 7273 2066 6f72 2074 6865 206d  meters for the m
-00014c00: 6574 686f 640a 2020 2020 2020 2020 5261  ethod.        Ra
-00014c10: 6973 6573 3a0a 2020 2020 2020 2020 2d20  ises:.        - 
-00014c20: 4c69 7374 206f 6620 5661 6c75 6545 7272  List of ValueErr
-00014c30: 6f72 730a 2020 2020 2020 2020 2222 220a  ors.        """.
-00014c40: 2020 2020 2020 2020 2320 5275 6e20 2f20          # Run / 
-00014c50: 4173 7365 7274 0a20 2020 2020 2020 2077  Assert.        w
-00014c60: 6974 6820 7079 7465 7374 2e72 6169 7365  ith pytest.raise
-00014c70: 7328 4167 6772 6567 6174 6543 6f6e 7374  s(AggregateConst
-00014c80: 7261 696e 7473 4572 726f 7229 2061 7320  raintsError) as 
-00014c90: 6572 726f 723a 0a20 2020 2020 2020 2020  error:.         
-00014ca0: 2020 2050 6f73 6974 6976 652e 5f76 616c     Positive._val
-00014cb0: 6964 6174 655f 696e 7075 7473 286e 6f74  idate_inputs(not
-00014cc0: 5f63 6f6c 756d 6e5f 6e61 6d65 3d4e 6f6e  _column_name=Non
-00014cd0: 652c 2073 6f6d 6574 6869 6e67 5f65 6c73  e, something_els
-00014ce0: 653d 4e6f 6e65 290a 0a20 2020 2020 2020  e=None)..       
-00014cf0: 2065 7272 5f6d 7367 203d 2028 0a20 2020   err_msg = (.   
-00014d00: 2020 2020 2020 2020 2072 274d 6973 7369           r'Missi
-00014d10: 6e67 2072 6571 7569 7265 6420 7661 6c75  ng required valu
-00014d20: 6573 207b 282e 2a29 7d20 696e 2061 2050  es {(.*)} in a P
-00014d30: 6f73 6974 6976 6520 636f 6e73 7472 6169  ositive constrai
-00014d40: 6e74 2e27 0a20 2020 2020 2020 2020 2020  nt.'.           
-00014d50: 2072 275c 6e5c 6e49 6e76 616c 6964 2076   r'\n\nInvalid v
-00014d60: 616c 7565 7320 7b28 2e2a 297d 2061 7265  alues {(.*)} are
-00014d70: 2070 7265 7365 6e74 2069 6e20 6120 506f   present in a Po
-00014d80: 7369 7469 7665 2063 6f6e 7374 7261 696e  sitive constrain
-00014d90: 742e 270a 2020 2020 2020 2020 290a 2020  t.'.        ).  
-00014da0: 2020 2020 2020 6772 6f75 7073 203d 2072        groups = r
-00014db0: 652e 7365 6172 6368 2865 7272 5f6d 7367  e.search(err_msg
-00014dc0: 2c20 7374 7228 6572 726f 722e 7661 6c75  , str(error.valu
-00014dd0: 6529 290a 2020 2020 2020 2020 6173 7365  e)).        asse
-00014de0: 7274 2067 726f 7570 7320 6973 206e 6f74  rt groups is not
-00014df0: 204e 6f6e 650a 2020 2020 2020 2020 6173   None.        as
-00014e00: 7365 7274 2073 7472 2865 7661 6c28 6772  sert str(eval(gr
-00014e10: 6f75 7073 2e67 726f 7570 2831 2929 2920  oups.group(1))) 
-00014e20: 3d3d 2027 636f 6c75 6d6e 5f6e 616d 6527  == 'column_name'
-00014e30: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-00014e40: 7365 7428 6576 616c 2867 726f 7570 732e  set(eval(groups.
-00014e50: 6772 6f75 7028 3229 2929 203d 3d20 7b27  group(2))) == {'
-00014e60: 736f 6d65 7468 696e 675f 656c 7365 272c  something_else',
-00014e70: 2027 6e6f 745f 636f 6c75 6d6e 5f6e 616d   'not_column_nam
-00014e80: 6527 7d0a 0a20 2020 2064 6566 2074 6573  e'}..    def tes
-00014e90: 745f 5f76 616c 6964 6174 655f 6d65 7461  t__validate_meta
-00014ea0: 6461 7461 5f63 6f6c 756d 6e73 2873 656c  data_columns(sel
-00014eb0: 6629 3a0a 2020 2020 2020 2020 2222 2254  f):.        """T
-00014ec0: 6573 7420 7468 6520 6060 5f76 616c 6964  est the ``_valid
-00014ed0: 6174 655f 6d65 7461 6461 7461 5f63 6f6c  ate_metadata_col
-00014ee0: 756d 6e73 6060 206d 6574 686f 642e 0a0a  umns`` method...
-00014ef0: 2020 2020 2020 2020 5468 6520 636f 6c75          The colu
-00014f00: 6d6e 2070 6173 7365 6420 696e 2063 6f6c  mn passed in col
-00014f10: 756d 6e5f 6e61 6d65 2073 686f 756c 6420  umn_name should 
-00014f20: 6265 2069 6e20 7468 6520 6d65 7461 6461  be in the metada
-00014f30: 7461 2e0a 0a20 2020 2020 2020 2049 6e70  ta...        Inp
-00014f40: 7574 3a0a 2020 2020 2020 2020 2020 2020  ut:.            
-00014f50: 2d20 636f 6c75 6d6e 5f6e 616d 6520 7468  - column_name th
-00014f60: 6174 2069 7320 696e 2074 6865 206d 6574  at is in the met
-00014f70: 6164 6174 612e 0a0a 2020 2020 2020 2020  adata...        
-00014f80: 5369 6465 2065 6666 6563 743a 0a20 2020  Side effect:.   
-00014f90: 2020 2020 2020 2020 202d 204e 6f20 6572           - No er
-00014fa0: 726f 7220 7368 6f75 6c64 2062 6520 7261  ror should be ra
-00014fb0: 6973 6564 2e0a 2020 2020 2020 2020 2222  ised..        ""
-00014fc0: 220a 2020 2020 2020 2020 2320 5365 7475  ".        # Setu
-00014fd0: 700a 2020 2020 2020 2020 6d65 7461 6461  p.        metada
-00014fe0: 7461 203d 204d 6f63 6b28 290a 2020 2020  ta = Mock().    
-00014ff0: 2020 2020 6d65 7461 6461 7461 2e63 6f6c      metadata.col
-00015000: 756d 6e73 203d 207b 2761 273a 2031 2c20  umns = {'a': 1, 
-00015010: 2762 273a 2032 7d0a 0a20 2020 2020 2020  'b': 2}..       
-00015020: 2023 2052 756e 0a20 2020 2020 2020 2050   # Run.        P
-00015030: 6f73 6974 6976 652e 5f76 616c 6964 6174  ositive._validat
-00015040: 655f 6d65 7461 6461 7461 5f63 6f6c 756d  e_metadata_colum
-00015050: 6e73 286d 6574 6164 6174 612c 2063 6f6c  ns(metadata, col
-00015060: 756d 6e5f 6e61 6d65 3d27 6127 290a 0a20  umn_name='a').. 
-00015070: 2020 2064 6566 2074 6573 745f 5f76 616c     def test__val
-00015080: 6964 6174 655f 6d65 7461 6461 7461 5f63  idate_metadata_c
-00015090: 6f6c 756d 6e73 5f72 6169 7365 735f 6572  olumns_raises_er
-000150a0: 726f 7228 7365 6c66 293a 0a20 2020 2020  ror(self):.     
-000150b0: 2020 2022 2222 5465 7374 2074 6865 2060     """Test the `
-000150c0: 605f 7661 6c69 6461 7465 5f6d 6574 6164  `_validate_metad
-000150d0: 6174 615f 636f 6c75 6d6e 7360 6020 6d65  ata_columns`` me
-000150e0: 7468 6f64 2773 2065 7272 6f72 2063 6f6e  thod's error con
-000150f0: 6469 7469 6f6e 2e0a 0a20 2020 2020 2020  dition...       
-00015100: 2049 6620 636f 6c75 6d6e 5f6e 616d 6520   If column_name 
-00015110: 6973 206e 6f74 2069 6e20 7468 6520 6d65  is not in the me
-00015120: 7461 6461 7461 2c20 616e 2065 7272 6f72  tadata, an error
-00015130: 2073 686f 756c 6420 6265 2072 6169 7365   should be raise
-00015140: 642e 0a0a 2020 2020 2020 2020 496e 7075  d...        Inpu
-00015150: 743a 0a20 2020 2020 2020 2020 2020 202d  t:.            -
-00015160: 2063 6f6c 756d 6e5f 6e61 6d65 2074 6861   column_name tha
-00015170: 7420 6973 206e 6f74 2069 6e20 7468 6520  t is not in the 
-00015180: 6d65 7461 6461 7461 2e0a 0a20 2020 2020  metadata...     
-00015190: 2020 2053 6964 6520 6566 6665 6374 3a0a     Side effect:.
-000151a0: 2020 2020 2020 2020 2020 2020 2d20 436f              - Co
-000151b0: 6e73 7472 6169 6e74 4d65 7461 6461 7461  nstraintMetadata
-000151c0: 4572 726f 7220 7368 6f75 6c64 2062 6520  Error should be 
-000151d0: 7261 6973 6564 2e0a 2020 2020 2020 2020  raised..        
-000151e0: 2222 220a 2020 2020 2020 2020 2320 5365  """.        # Se
-000151f0: 7475 700a 2020 2020 2020 2020 6d65 7461  tup.        meta
-00015200: 6461 7461 203d 204d 6f63 6b28 290a 2020  data = Mock().  
-00015210: 2020 2020 2020 6d65 7461 6461 7461 2e63        metadata.c
-00015220: 6f6c 756d 6e73 203d 207b 2761 273a 2031  olumns = {'a': 1
-00015230: 2c20 2762 273a 2032 7d0a 0a20 2020 2020  , 'b': 2}..     
-00015240: 2020 2023 2052 756e 0a20 2020 2020 2020     # Run.       
-00015250: 2065 7272 6f72 5f6d 6573 7361 6765 203d   error_message =
-00015260: 2072 652e 6573 6361 7065 280a 2020 2020   re.escape(.    
-00015270: 2020 2020 2020 2020 2741 2050 6f73 6974          'A Posit
-00015280: 6976 6520 636f 6e73 7472 6169 6e74 2069  ive constraint i
-00015290: 7320 6265 696e 6720 6170 706c 6965 6420  s being applied 
-000152a0: 746f 2069 6e76 616c 6964 2063 6f6c 756d  to invalid colum
-000152b0: 6e20 6e61 6d65 7320 270a 2020 2020 2020  n names '.      
-000152c0: 2020 2020 2020 227b 2763 277d 2e20 5468        "{'c'}. Th
-000152d0: 6520 636f 6c75 6d6e 7320 6d75 7374 2065  e columns must e
-000152e0: 7869 7374 2069 6e20 7468 6520 7461 626c  xist in the tabl
-000152f0: 652e 220a 2020 2020 2020 2020 290a 2020  e.".        ).  
-00015300: 2020 2020 2020 7769 7468 2070 7974 6573        with pytes
-00015310: 742e 7261 6973 6573 2843 6f6e 7374 7261  t.raises(Constra
-00015320: 696e 744d 6574 6164 6174 6145 7272 6f72  intMetadataError
-00015330: 2c20 6d61 7463 683d 6572 726f 725f 6d65  , match=error_me
-00015340: 7373 6167 6529 3a0a 2020 2020 2020 2020  ssage):.        
-00015350: 2020 2020 506f 7369 7469 7665 2e5f 7661      Positive._va
-00015360: 6c69 6461 7465 5f6d 6574 6164 6174 615f  lidate_metadata_
-00015370: 636f 6c75 6d6e 7328 6d65 7461 6461 7461  columns(metadata
-00015380: 2c20 636f 6c75 6d6e 5f6e 616d 653d 2763  , column_name='c
-00015390: 2729 0a0a 2020 2020 6465 6620 7465 7374  ')..    def test
-000153a0: 5f5f 7661 6c69 6461 7465 5f6d 6574 6164  __validate_metad
-000153b0: 6174 615f 7370 6563 6966 6963 5f74 6f5f  ata_specific_to_
-000153c0: 636f 6e73 7472 6169 6e74 2873 656c 6629  constraint(self)
-000153d0: 3a0a 2020 2020 2020 2020 2222 2220 5465  :.        """ Te
-000153e0: 7374 2074 6865 2060 605f 7661 6c69 6461  st the ``_valida
-000153f0: 7465 5f6d 6574 6164 6174 615f 7370 6563  te_metadata_spec
-00015400: 6966 6963 5f74 6f5f 636f 6e73 7472 6169  ific_to_constrai
-00015410: 6e74 6060 206d 6574 686f 642e 0a0a 2020  nt`` method...  
-00015420: 2020 2020 2020 4966 2074 6865 2063 6f6c        If the col
-00015430: 756d 6e20 6e61 6d65 2070 726f 7669 6465  umn name provide
-00015440: 6420 6861 7320 616e 2073 6474 7970 6520  d has an sdtype 
-00015450: 6f66 206e 756d 6572 6963 616c 2c20 7468  of numerical, th
-00015460: 656e 206e 6f20 6572 726f 7220 7368 6f75  en no error shou
-00015470: 6c64 0a20 2020 2020 2020 2062 6520 7261  ld.        be ra
-00015480: 6973 6564 2e0a 0a20 2020 2020 2020 2049  ised...        I
-00015490: 6e70 7574 3a0a 2020 2020 2020 2020 2020  nput:.          
-000154a0: 2020 2d20 4d65 7461 6461 7461 2077 6974    - Metadata wit
-000154b0: 6820 7468 6520 636f 6c75 6d6e 2773 2073  h the column's s
-000154c0: 6474 7970 6520 7365 7420 746f 206e 756d  dtype set to num
-000154d0: 6572 6963 616c 2e0a 2020 2020 2020 2020  erical..        
-000154e0: 2222 220a 2020 2020 2020 2020 2320 5365  """.        # Se
-000154f0: 7475 700a 2020 2020 2020 2020 6d65 7461  tup.        meta
-00015500: 6461 7461 203d 204d 6f63 6b28 290a 2020  data = Mock().  
-00015510: 2020 2020 2020 6d65 7461 6461 7461 2e63        metadata.c
-00015520: 6f6c 756d 6e73 203d 207b 0a20 2020 2020  olumns = {.     
-00015530: 2020 2020 2020 2027 6127 3a20 7b27 7364         'a': {'sd
-00015540: 7479 7065 273a 2027 6e75 6d65 7269 6361  type': 'numerica
-00015550: 6c27 7d0a 2020 2020 2020 2020 7d0a 0a20  l'}.        }.. 
-00015560: 2020 2020 2020 2023 2052 756e 0a20 2020         # Run.   
-00015570: 2020 2020 2050 6f73 6974 6976 652e 5f76       Positive._v
-00015580: 616c 6964 6174 655f 6d65 7461 6461 7461  alidate_metadata
-00015590: 5f73 7065 6369 6669 635f 746f 5f63 6f6e  _specific_to_con
-000155a0: 7374 7261 696e 7428 0a20 2020 2020 2020  straint(.       
-000155b0: 2020 2020 206d 6574 6164 6174 612c 0a20       metadata,. 
-000155c0: 2020 2020 2020 2020 2020 2063 6f6c 756d             colum
-000155d0: 6e5f 6e61 6d65 3d27 6127 0a20 2020 2020  n_name='a'.     
-000155e0: 2020 2029 0a0a 2020 2020 6465 6620 7465     )..    def te
-000155f0: 7374 5f5f 7661 6c69 6461 7465 5f6d 6574  st__validate_met
-00015600: 6164 6174 615f 7370 6563 6966 6963 5f74  adata_specific_t
-00015610: 6f5f 636f 6e73 7472 6169 6e74 5f65 7272  o_constraint_err
-00015620: 6f72 2873 656c 6629 3a0a 2020 2020 2020  or(self):.      
-00015630: 2020 2222 2220 5465 7374 2074 6865 2060    """ Test the `
-00015640: 605f 7661 6c69 6461 7465 5f6d 6574 6164  `_validate_metad
-00015650: 6174 615f 7370 6563 6966 6963 5f74 6f5f  ata_specific_to_
-00015660: 636f 6e73 7472 6169 6e74 6060 206d 6574  constraint`` met
-00015670: 686f 642e 0a0a 2020 2020 2020 2020 4966  hod...        If
-00015680: 2074 6865 2063 6f6c 756d 6e20 6e61 6d65   the column name
-00015690: 2070 726f 7669 6465 6420 646f 6573 206e   provided does n
-000156a0: 6f74 2068 6176 6520 616e 2073 6474 7970  ot have an sdtyp
-000156b0: 6520 6f66 206e 756d 6572 6963 616c 2c20  e of numerical, 
-000156c0: 7468 656e 2061 6e20 6572 726f 7220 7368  then an error sh
-000156d0: 6f75 6c64 0a20 2020 2020 2020 2062 6520  ould.        be 
-000156e0: 7261 6973 6564 2e0a 0a20 2020 2020 2020  raised...       
-000156f0: 2049 6e70 7574 3a0a 2020 2020 2020 2020   Input:.        
-00015700: 2020 2020 2d20 4d65 7461 6461 7461 2077      - Metadata w
-00015710: 6974 6820 7468 6520 636f 6c75 6d6e 2773  ith the column's
-00015720: 2073 6474 7970 6520 7365 7420 746f 2064   sdtype set to d
-00015730: 6174 6574 696d 652e 0a0a 2020 2020 2020  atetime...      
-00015740: 2020 5369 6465 2065 6666 6563 743a 0a20    Side effect:. 
-00015750: 2020 2020 2020 2020 2020 202d 2052 6169             - Rai
-00015760: 7365 7320 436f 6e73 7472 6169 6e74 4d65  ses ConstraintMe
-00015770: 7461 6461 7461 4572 726f 720a 2020 2020  tadataError.    
-00015780: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00015790: 2320 5365 7475 700a 2020 2020 2020 2020  # Setup.        
-000157a0: 6d65 7461 6461 7461 203d 204d 6f63 6b28  metadata = Mock(
-000157b0: 290a 2020 2020 2020 2020 6d65 7461 6461  ).        metada
-000157c0: 7461 2e63 6f6c 756d 6e73 203d 207b 0a20  ta.columns = {. 
-000157d0: 2020 2020 2020 2020 2020 2027 6127 3a20             'a': 
-000157e0: 7b27 7364 7479 7065 273a 2027 6461 7465  {'sdtype': 'date
-000157f0: 7469 6d65 277d 0a20 2020 2020 2020 207d  time'}.        }
-00015800: 0a0a 2020 2020 2020 2020 2320 5275 6e0a  ..        # Run.
-00015810: 2020 2020 2020 2020 6572 726f 725f 6d65          error_me
-00015820: 7373 6167 6520 3d20 280a 2020 2020 2020  ssage = (.      
-00015830: 2020 2020 2020 2741 2050 6f73 6974 6976        'A Positiv
-00015840: 6520 636f 6e73 7472 6169 6e74 2069 7320  e constraint is 
-00015850: 6265 696e 6720 6170 706c 6965 6420 746f  being applied to
-00015860: 2061 6e20 696e 7661 6c69 6420 636f 6c75   an invalid colu
-00015870: 6d6e 2027 0a20 2020 2020 2020 2020 2020  mn '.           
-00015880: 2022 2761 272e 2054 6869 7320 636f 6e73   "'a'. This cons
-00015890: 7472 6169 6e74 2069 7320 6f6e 6c79 2064  traint is only d
-000158a0: 6566 696e 6564 2066 6f72 206e 756d 6572  efined for numer
-000158b0: 6963 616c 2063 6f6c 756d 6e73 2e22 0a20  ical columns.". 
-000158c0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-000158d0: 2077 6974 6820 7079 7465 7374 2e72 6169   with pytest.rai
-000158e0: 7365 7328 436f 6e73 7472 6169 6e74 4d65  ses(ConstraintMe
-000158f0: 7461 6461 7461 4572 726f 722c 206d 6174  tadataError, mat
-00015900: 6368 3d65 7272 6f72 5f6d 6573 7361 6765  ch=error_message
-00015910: 293a 0a20 2020 2020 2020 2020 2020 2050  ):.            P
-00015920: 6f73 6974 6976 652e 5f76 616c 6964 6174  ositive._validat
-00015930: 655f 6d65 7461 6461 7461 5f73 7065 6369  e_metadata_speci
-00015940: 6669 635f 746f 5f63 6f6e 7374 7261 696e  fic_to_constrain
-00015950: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
-00015960: 2020 206d 6574 6164 6174 612c 0a20 2020     metadata,.   
-00015970: 2020 2020 2020 2020 2020 2020 2063 6f6c               col
-00015980: 756d 6e5f 6e61 6d65 3d27 6127 0a20 2020  umn_name='a'.   
-00015990: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-000159a0: 6465 6620 7465 7374 5f5f 696e 6974 5f5f  def test__init__
-000159b0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-000159c0: 2222 2254 6573 7420 7468 6520 6060 506f  """Test the ``Po
-000159d0: 7369 7469 7665 2e5f 5f69 6e69 745f 5f60  sitive.__init__`
-000159e0: 6020 6d65 7468 6f64 2e0a 0a20 2020 2020  ` method...     
-000159f0: 2020 2045 6e73 7572 6520 7468 6520 6174     Ensure the at
-00015a00: 7472 6962 7574 6573 2061 7265 2063 6f72  tributes are cor
-00015a10: 7265 6374 6c79 2073 6574 2e0a 2020 2020  rectly set..    
-00015a20: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00015a30: 2320 5275 6e0a 2020 2020 2020 2020 696e  # Run.        in
-00015a40: 7374 616e 6365 203d 2050 6f73 6974 6976  stance = Positiv
-00015a50: 6528 636f 6c75 6d6e 5f6e 616d 653d 2761  e(column_name='a
-00015a60: 6263 2729 0a0a 2020 2020 2020 2020 2320  bc')..        # 
-00015a70: 4173 7365 7274 730a 2020 2020 2020 2020  Asserts.        
-00015a80: 6173 7365 7274 2069 6e73 7461 6e63 652e  assert instance.
-00015a90: 5f76 616c 7565 203d 3d20 300a 2020 2020  _value == 0.    
-00015aa0: 2020 2020 6173 7365 7274 2069 6e73 7461      assert insta
-00015ab0: 6e63 652e 5f63 6f6c 756d 6e5f 6e61 6d65  nce._column_name
-00015ac0: 203d 3d20 2761 6263 270a 2020 2020 2020   == 'abc'.      
-00015ad0: 2020 6173 7365 7274 2069 6e73 7461 6e63    assert instanc
-00015ae0: 652e 5f6f 7065 7261 746f 7220 3d3d 206e  e._operator == n
-00015af0: 702e 6772 6561 7465 725f 6571 7561 6c0a  p.greater_equal.
-00015b00: 0a20 2020 2064 6566 2074 6573 745f 5f69  .    def test__i
-00015b10: 6e69 745f 5f73 7472 6963 745f 7472 7565  nit__strict_true
-00015b20: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00015b30: 2222 2254 6573 7420 7468 6520 6060 506f  """Test the ``Po
-00015b40: 7369 7469 7665 2e5f 5f69 6e69 745f 5f60  sitive.__init__`
-00015b50: 6020 6d65 7468 6f64 2e0a 0a20 2020 2020  ` method...     
-00015b60: 2020 2045 6e73 7572 6520 7468 6520 6174     Ensure the at
-00015b70: 7472 6962 7574 6573 2061 7265 2063 6f72  tributes are cor
-00015b80: 7265 6374 6c79 2073 6574 2077 6865 6e20  rectly set when 
-00015b90: 6060 7374 7269 6374 5f62 6f75 6e64 6172  ``strict_boundar
-00015ba0: 6965 7360 6020 6973 2054 7275 652e 0a20  ies`` is True.. 
-00015bb0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00015bc0: 2020 2023 2052 756e 0a20 2020 2020 2020     # Run.       
-00015bd0: 2069 6e73 7461 6e63 6520 3d20 506f 7369   instance = Posi
-00015be0: 7469 7665 2863 6f6c 756d 6e5f 6e61 6d65  tive(column_name
-00015bf0: 3d27 6162 6327 2c20 7374 7269 6374 5f62  ='abc', strict_b
-00015c00: 6f75 6e64 6172 6965 733d 5472 7565 290a  oundaries=True).
-00015c10: 0a20 2020 2020 2020 2023 2041 7373 6572  .        # Asser
-00015c20: 7473 0a20 2020 2020 2020 2061 7373 6572  ts.        asser
-00015c30: 7420 696e 7374 616e 6365 2e5f 7661 6c75  t instance._valu
-00015c40: 6520 3d3d 2030 0a20 2020 2020 2020 2061  e == 0.        a
-00015c50: 7373 6572 7420 696e 7374 616e 6365 2e5f  ssert instance._
-00015c60: 636f 6c75 6d6e 5f6e 616d 6520 3d3d 2027  column_name == '
-00015c70: 6162 6327 0a20 2020 2020 2020 2061 7373  abc'.        ass
-00015c80: 6572 7420 696e 7374 616e 6365 2e5f 6f70  ert instance._op
-00015c90: 6572 6174 6f72 203d 3d20 6e70 2e67 7265  erator == np.gre
-00015ca0: 6174 6572 0a0a 0a63 6c61 7373 2054 6573  ater...class Tes
-00015cb0: 744e 6567 6174 6976 6528 293a 0a0a 2020  tNegative():..  
-00015cc0: 2020 6465 6620 7465 7374 5f5f 7661 6c69    def test__vali
-00015cd0: 6461 7465 5f69 6e70 7574 7328 7365 6c66  date_inputs(self
-00015ce0: 293a 0a20 2020 2020 2020 2022 2222 5465  ):.        """Te
-00015cf0: 7374 2074 6865 2060 604e 6567 6174 6976  st the ``Negativ
-00015d00: 652e 5f76 616c 6964 6174 655f 696e 7075  e._validate_inpu
-00015d10: 7473 6060 206d 6574 686f 642e 0a0a 2020  ts`` method...  
-00015d20: 2020 2020 2020 496e 7075 743a 0a20 2020        Input:.   
-00015d30: 2020 2020 202d 2020 496e 636f 7272 6563       -  Incorrec
-00015d40: 7420 7061 7261 6d65 7465 7273 2066 6f72  t parameters for
-00015d50: 2074 6865 206d 6574 686f 640a 2020 2020   the method.    
-00015d60: 2020 2020 5261 6973 6573 3a0a 2020 2020      Raises:.    
-00015d70: 2020 2020 2d20 4c69 7374 206f 6620 5661      - List of Va
-00015d80: 6c75 6545 7272 6f72 730a 2020 2020 2020  lueErrors.      
-00015d90: 2020 2222 220a 2020 2020 2020 2020 2320    """.        # 
-00015da0: 5275 6e20 2f20 4173 7365 7274 0a20 2020  Run / Assert.   
-00015db0: 2020 2020 2077 6974 6820 7079 7465 7374       with pytest
-00015dc0: 2e72 6169 7365 7328 4167 6772 6567 6174  .raises(Aggregat
-00015dd0: 6543 6f6e 7374 7261 696e 7473 4572 726f  eConstraintsErro
-00015de0: 7229 2061 7320 6572 726f 723a 0a20 2020  r) as error:.   
-00015df0: 2020 2020 2020 2020 204e 6567 6174 6976           Negativ
-00015e00: 652e 5f76 616c 6964 6174 655f 696e 7075  e._validate_inpu
-00015e10: 7473 286e 6f74 5f63 6f6c 756d 6e5f 6e61  ts(not_column_na
-00015e20: 6d65 3d4e 6f6e 652c 2073 6f6d 6574 6869  me=None, somethi
-00015e30: 6e67 5f65 6c73 653d 4e6f 6e65 290a 0a20  ng_else=None).. 
-00015e40: 2020 2020 2020 2065 7272 5f6d 7367 203d         err_msg =
-00015e50: 2028 0a20 2020 2020 2020 2020 2020 2072   (.            r
-00015e60: 274d 6973 7369 6e67 2072 6571 7569 7265  'Missing require
-00015e70: 6420 7661 6c75 6573 207b 282e 2a29 7d20  d values {(.*)} 
-00015e80: 696e 2061 204e 6567 6174 6976 6520 636f  in a Negative co
-00015e90: 6e73 7472 6169 6e74 2e27 0a20 2020 2020  nstraint.'.     
-00015ea0: 2020 2020 2020 2072 275c 6e5c 6e49 6e76         r'\n\nInv
-00015eb0: 616c 6964 2076 616c 7565 7320 7b28 2e2a  alid values {(.*
-00015ec0: 297d 2061 7265 2070 7265 7365 6e74 2069  )} are present i
-00015ed0: 6e20 6120 4e65 6761 7469 7665 2063 6f6e  n a Negative con
-00015ee0: 7374 7261 696e 742e 270a 2020 2020 2020  straint.'.      
-00015ef0: 2020 290a 2020 2020 2020 2020 6772 6f75    ).        grou
-00015f00: 7073 203d 2072 652e 7365 6172 6368 2865  ps = re.search(e
-00015f10: 7272 5f6d 7367 2c20 7374 7228 6572 726f  rr_msg, str(erro
-00015f20: 722e 7661 6c75 6529 290a 2020 2020 2020  r.value)).      
-00015f30: 2020 6173 7365 7274 2067 726f 7570 7320    assert groups 
-00015f40: 6973 206e 6f74 204e 6f6e 650a 2020 2020  is not None.    
-00015f50: 2020 2020 6173 7365 7274 2073 7472 2865      assert str(e
-00015f60: 7661 6c28 6772 6f75 7073 2e67 726f 7570  val(groups.group
-00015f70: 2831 2929 2920 3d3d 2027 636f 6c75 6d6e  (1))) == 'column
-00015f80: 5f6e 616d 6527 0a20 2020 2020 2020 2061  _name'.        a
-00015f90: 7373 6572 7420 7365 7428 6576 616c 2867  ssert set(eval(g
-00015fa0: 726f 7570 732e 6772 6f75 7028 3229 2929  roups.group(2)))
-00015fb0: 203d 3d20 7b27 736f 6d65 7468 696e 675f   == {'something_
-00015fc0: 656c 7365 272c 2027 6e6f 745f 636f 6c75  else', 'not_colu
-00015fd0: 6d6e 5f6e 616d 6527 7d0a 0a20 2020 2064  mn_name'}..    d
-00015fe0: 6566 2074 6573 745f 5f76 616c 6964 6174  ef test__validat
-00015ff0: 655f 6d65 7461 6461 7461 5f63 6f6c 756d  e_metadata_colum
-00016000: 6e73 2873 656c 6629 3a0a 2020 2020 2020  ns(self):.      
-00016010: 2020 2222 2254 6573 7420 7468 6520 6060    """Test the ``
-00016020: 5f76 616c 6964 6174 655f 6d65 7461 6461  _validate_metada
-00016030: 7461 5f63 6f6c 756d 6e73 6060 206d 6574  ta_columns`` met
-00016040: 686f 642e 0a0a 2020 2020 2020 2020 5468  hod...        Th
-00016050: 6520 636f 6c75 6d6e 2070 6173 7365 6420  e column passed 
-00016060: 696e 2063 6f6c 756d 6e5f 6e61 6d65 2073  in column_name s
-00016070: 686f 756c 6420 6265 2069 6e20 7468 6520  hould be in the 
-00016080: 6d65 7461 6461 7461 2e0a 0a20 2020 2020  metadata...     
-00016090: 2020 2049 6e70 7574 3a0a 2020 2020 2020     Input:.      
-000160a0: 2020 2020 2020 2d20 636f 6c75 6d6e 5f6e        - column_n
-000160b0: 616d 6520 7468 6174 2069 7320 696e 2074  ame that is in t
-000160c0: 6865 206d 6574 6164 6174 612e 0a0a 2020  he metadata...  
-000160d0: 2020 2020 2020 5369 6465 2065 6666 6563        Side effec
-000160e0: 743a 0a20 2020 2020 2020 2020 2020 202d  t:.            -
-000160f0: 204e 6f20 6572 726f 7220 7368 6f75 6c64   No error should
-00016100: 2062 6520 7261 6973 6564 2e0a 2020 2020   be raised..    
-00016110: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00016120: 2320 5365 7475 700a 2020 2020 2020 2020  # Setup.        
-00016130: 6d65 7461 6461 7461 203d 204d 6f63 6b28  metadata = Mock(
-00016140: 290a 2020 2020 2020 2020 6d65 7461 6461  ).        metada
-00016150: 7461 2e63 6f6c 756d 6e73 203d 207b 2761  ta.columns = {'a
-00016160: 273a 2031 2c20 2762 273a 2032 7d0a 0a20  ': 1, 'b': 2}.. 
-00016170: 2020 2020 2020 2023 2052 756e 0a20 2020         # Run.   
-00016180: 2020 2020 204e 6567 6174 6976 652e 5f76       Negative._v
-00016190: 616c 6964 6174 655f 6d65 7461 6461 7461  alidate_metadata
-000161a0: 5f63 6f6c 756d 6e73 286d 6574 6164 6174  _columns(metadat
-000161b0: 612c 2063 6f6c 756d 6e5f 6e61 6d65 3d27  a, column_name='
-000161c0: 6127 290a 0a20 2020 2064 6566 2074 6573  a')..    def tes
-000161d0: 745f 5f76 616c 6964 6174 655f 6d65 7461  t__validate_meta
-000161e0: 6461 7461 5f63 6f6c 756d 6e73 5f72 6169  data_columns_rai
-000161f0: 7365 735f 6572 726f 7228 7365 6c66 293a  ses_error(self):
-00016200: 0a20 2020 2020 2020 2022 2222 5465 7374  .        """Test
-00016210: 2074 6865 2060 605f 7661 6c69 6461 7465   the ``_validate
-00016220: 5f6d 6574 6164 6174 615f 636f 6c75 6d6e  _metadata_column
-00016230: 7360 6020 6d65 7468 6f64 2773 2065 7272  s`` method's err
-00016240: 6f72 2063 6f6e 6469 7469 6f6e 2e0a 0a20  or condition... 
-00016250: 2020 2020 2020 2049 6620 636f 6c75 6d6e         If column
-00016260: 5f6e 616d 6520 6973 206e 6f74 2069 6e20  _name is not in 
-00016270: 7468 6520 6d65 7461 6461 7461 2c20 616e  the metadata, an
-00016280: 2065 7272 6f72 2073 686f 756c 6420 6265   error should be
-00016290: 2072 6169 7365 642e 0a0a 2020 2020 2020   raised...      
-000162a0: 2020 496e 7075 743a 0a20 2020 2020 2020    Input:.       
-000162b0: 2020 2020 202d 2063 6f6c 756d 6e5f 6e61       - column_na
-000162c0: 6d65 2074 6861 7420 6973 206e 6f74 2069  me that is not i
-000162d0: 6e20 7468 6520 6d65 7461 6461 7461 2e0a  n the metadata..
-000162e0: 0a20 2020 2020 2020 2053 6964 6520 6566  .        Side ef
-000162f0: 6665 6374 3a0a 2020 2020 2020 2020 2020  fect:.          
-00016300: 2020 2d20 436f 6e73 7472 6169 6e74 4d65    - ConstraintMe
-00016310: 7461 6461 7461 4572 726f 7220 7368 6f75  tadataError shou
-00016320: 6c64 2062 6520 7261 6973 6564 2e0a 2020  ld be raised..  
-00016330: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00016340: 2020 2320 5365 7475 700a 2020 2020 2020    # Setup.      
-00016350: 2020 6d65 7461 6461 7461 203d 204d 6f63    metadata = Moc
-00016360: 6b28 290a 2020 2020 2020 2020 6d65 7461  k().        meta
-00016370: 6461 7461 2e63 6f6c 756d 6e73 203d 207b  data.columns = {
-00016380: 2761 273a 2031 2c20 2762 273a 2032 7d0a  'a': 1, 'b': 2}.
-00016390: 0a20 2020 2020 2020 2023 2052 756e 0a20  .        # Run. 
-000163a0: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
-000163b0: 7361 6765 203d 2072 652e 6573 6361 7065  sage = re.escape
-000163c0: 280a 2020 2020 2020 2020 2020 2020 2741  (.            'A
-000163d0: 204e 6567 6174 6976 6520 636f 6e73 7472   Negative constr
-000163e0: 6169 6e74 2069 7320 6265 696e 6720 6170  aint is being ap
-000163f0: 706c 6965 6420 746f 2069 6e76 616c 6964  plied to invalid
-00016400: 2063 6f6c 756d 6e20 6e61 6d65 7320 270a   column names '.
-00016410: 2020 2020 2020 2020 2020 2020 227b 2763              "{'c
-00016420: 277d 2e20 5468 6520 636f 6c75 6d6e 7320  '}. The columns 
-00016430: 6d75 7374 2065 7869 7374 2069 6e20 7468  must exist in th
-00016440: 6520 7461 626c 652e 220a 2020 2020 2020  e table.".      
-00016450: 2020 290a 2020 2020 2020 2020 7769 7468    ).        with
-00016460: 2070 7974 6573 742e 7261 6973 6573 2843   pytest.raises(C
-00016470: 6f6e 7374 7261 696e 744d 6574 6164 6174  onstraintMetadat
-00016480: 6145 7272 6f72 2c20 6d61 7463 683d 6572  aError, match=er
-00016490: 726f 725f 6d65 7373 6167 6529 3a0a 2020  ror_message):.  
-000164a0: 2020 2020 2020 2020 2020 4e65 6761 7469            Negati
-000164b0: 7665 2e5f 7661 6c69 6461 7465 5f6d 6574  ve._validate_met
-000164c0: 6164 6174 615f 636f 6c75 6d6e 7328 6d65  adata_columns(me
-000164d0: 7461 6461 7461 2c20 636f 6c75 6d6e 5f6e  tadata, column_n
-000164e0: 616d 653d 2763 2729 0a0a 2020 2020 6465  ame='c')..    de
-000164f0: 6620 7465 7374 5f5f 7661 6c69 6461 7465  f test__validate
-00016500: 5f6d 6574 6164 6174 615f 7370 6563 6966  _metadata_specif
-00016510: 6963 5f74 6f5f 636f 6e73 7472 6169 6e74  ic_to_constraint
-00016520: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00016530: 2222 2220 5465 7374 2074 6865 2060 605f  """ Test the ``_
-00016540: 7661 6c69 6461 7465 5f6d 6574 6164 6174  validate_metadat
-00016550: 615f 7370 6563 6966 6963 5f74 6f5f 636f  a_specific_to_co
-00016560: 6e73 7472 6169 6e74 6060 206d 6574 686f  nstraint`` metho
-00016570: 642e 0a0a 2020 2020 2020 2020 4966 2074  d...        If t
-00016580: 6865 2063 6f6c 756d 6e20 6e61 6d65 2070  he column name p
-00016590: 726f 7669 6465 6420 6861 7320 616e 2073  rovided has an s
-000165a0: 6474 7970 6520 6f66 206e 756d 6572 6963  dtype of numeric
-000165b0: 616c 2c20 7468 656e 206e 6f20 6572 726f  al, then no erro
-000165c0: 7220 7368 6f75 6c64 0a20 2020 2020 2020  r should.       
-000165d0: 2062 6520 7261 6973 6564 2e0a 0a20 2020   be raised...   
-000165e0: 2020 2020 2049 6e70 7574 3a0a 2020 2020       Input:.    
-000165f0: 2020 2020 2020 2020 2d20 4d65 7461 6461          - Metada
-00016600: 7461 2077 6974 6820 7468 6520 636f 6c75  ta with the colu
-00016610: 6d6e 2773 2073 6474 7970 6520 7365 7420  mn's sdtype set 
-00016620: 746f 206e 756d 6572 6963 616c 2e0a 2020  to numerical..  
-00016630: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00016640: 2020 2320 5365 7475 700a 2020 2020 2020    # Setup.      
-00016650: 2020 6d65 7461 6461 7461 203d 204d 6f63    metadata = Moc
-00016660: 6b28 290a 2020 2020 2020 2020 6d65 7461  k().        meta
-00016670: 6461 7461 2e63 6f6c 756d 6e73 203d 207b  data.columns = {
-00016680: 0a20 2020 2020 2020 2020 2020 2027 6127  .            'a'
-00016690: 3a20 7b27 7364 7479 7065 273a 2027 6e75  : {'sdtype': 'nu
-000166a0: 6d65 7269 6361 6c27 7d0a 2020 2020 2020  merical'}.      
-000166b0: 2020 7d0a 0a20 2020 2020 2020 2023 2052    }..        # R
-000166c0: 756e 0a20 2020 2020 2020 2050 6f73 6974  un.        Posit
-000166d0: 6976 652e 5f76 616c 6964 6174 655f 6d65  ive._validate_me
-000166e0: 7461 6461 7461 5f73 7065 6369 6669 635f  tadata_specific_
-000166f0: 746f 5f63 6f6e 7374 7261 696e 7428 0a20  to_constraint(. 
-00016700: 2020 2020 2020 2020 2020 206d 6574 6164             metad
-00016710: 6174 612c 0a20 2020 2020 2020 2020 2020  ata,.           
-00016720: 2063 6f6c 756d 6e5f 6e61 6d65 3d27 6127   column_name='a'
-00016730: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-00016740: 6465 6620 7465 7374 5f5f 7661 6c69 6461  def test__valida
-00016750: 7465 5f6d 6574 6164 6174 615f 7370 6563  te_metadata_spec
-00016760: 6966 6963 5f74 6f5f 636f 6e73 7472 6169  ific_to_constrai
-00016770: 6e74 5f65 7272 6f72 2873 656c 6629 3a0a  nt_error(self):.
-00016780: 2020 2020 2020 2020 2222 2220 5465 7374          """ Test
-00016790: 2074 6865 2060 605f 7661 6c69 6461 7465   the ``_validate
-000167a0: 5f6d 6574 6164 6174 615f 7370 6563 6966  _metadata_specif
-000167b0: 6963 5f74 6f5f 636f 6e73 7472 6169 6e74  ic_to_constraint
-000167c0: 6060 206d 6574 686f 642e 0a0a 2020 2020  `` method...    
-000167d0: 2020 2020 4966 2074 6865 2063 6f6c 756d      If the colum
-000167e0: 6e20 6e61 6d65 2070 726f 7669 6465 6420  n name provided 
-000167f0: 646f 6573 206e 6f74 2068 6176 6520 616e  does not have an
-00016800: 2073 6474 7970 6520 6f66 206e 756d 6572   sdtype of numer
-00016810: 6963 616c 2c20 7468 656e 2061 6e20 6572  ical, then an er
-00016820: 726f 7220 7368 6f75 6c64 0a20 2020 2020  ror should.     
-00016830: 2020 2062 6520 7261 6973 6564 2e0a 0a20     be raised... 
-00016840: 2020 2020 2020 2049 6e70 7574 3a0a 2020         Input:.  
-00016850: 2020 2020 2020 2020 2020 2d20 4d65 7461            - Meta
-00016860: 6461 7461 2077 6974 6820 7468 6520 636f  data with the co
-00016870: 6c75 6d6e 2773 2073 6474 7970 6520 7365  lumn's sdtype se
-00016880: 7420 746f 2064 6174 6574 696d 652e 0a0a  t to datetime...
-00016890: 2020 2020 2020 2020 5369 6465 2065 6666          Side eff
-000168a0: 6563 743a 0a20 2020 2020 2020 2020 2020  ect:.           
-000168b0: 202d 2052 6169 7365 7320 436f 6e73 7472   - Raises Constr
-000168c0: 6169 6e74 4d65 7461 6461 7461 4572 726f  aintMetadataErro
-000168d0: 720a 2020 2020 2020 2020 2222 220a 2020  r.        """.  
-000168e0: 2020 2020 2020 2320 5365 7475 700a 2020        # Setup.  
-000168f0: 2020 2020 2020 6d65 7461 6461 7461 203d        metadata =
-00016900: 204d 6f63 6b28 290a 2020 2020 2020 2020   Mock().        
-00016910: 6d65 7461 6461 7461 2e63 6f6c 756d 6e73  metadata.columns
-00016920: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
-00016930: 2027 6127 3a20 7b27 7364 7479 7065 273a   'a': {'sdtype':
-00016940: 2027 6461 7465 7469 6d65 277d 0a20 2020   'datetime'}.   
-00016950: 2020 2020 207d 0a0a 2020 2020 2020 2020       }..        
-00016960: 2320 5275 6e0a 2020 2020 2020 2020 6572  # Run.        er
-00016970: 726f 725f 6d65 7373 6167 6520 3d20 280a  ror_message = (.
-00016980: 2020 2020 2020 2020 2020 2020 2741 204e              'A N
-00016990: 6567 6174 6976 6520 636f 6e73 7472 6169  egative constrai
-000169a0: 6e74 2069 7320 6265 696e 6720 6170 706c  nt is being appl
-000169b0: 6965 6420 746f 2061 6e20 696e 7661 6c69  ied to an invali
-000169c0: 6420 636f 6c75 6d6e 2027 0a20 2020 2020  d column '.     
-000169d0: 2020 2020 2020 2022 2761 272e 2054 6869         "'a'. Thi
-000169e0: 7320 636f 6e73 7472 6169 6e74 2069 7320  s constraint is 
-000169f0: 6f6e 6c79 2064 6566 696e 6564 2066 6f72  only defined for
-00016a00: 206e 756d 6572 6963 616c 2063 6f6c 756d   numerical colum
-00016a10: 6e73 2e22 0a20 2020 2020 2020 2029 0a20  ns.".        ). 
-00016a20: 2020 2020 2020 2077 6974 6820 7079 7465         with pyte
-00016a30: 7374 2e72 6169 7365 7328 436f 6e73 7472  st.raises(Constr
-00016a40: 6169 6e74 4d65 7461 6461 7461 4572 726f  aintMetadataErro
-00016a50: 722c 206d 6174 6368 3d65 7272 6f72 5f6d  r, match=error_m
-00016a60: 6573 7361 6765 293a 0a20 2020 2020 2020  essage):.       
-00016a70: 2020 2020 204e 6567 6174 6976 652e 5f76       Negative._v
-00016a80: 616c 6964 6174 655f 6d65 7461 6461 7461  alidate_metadata
-00016a90: 5f73 7065 6369 6669 635f 746f 5f63 6f6e  _specific_to_con
-00016aa0: 7374 7261 696e 7428 0a20 2020 2020 2020  straint(.       
-00016ab0: 2020 2020 2020 2020 206d 6574 6164 6174           metadat
-00016ac0: 612c 0a20 2020 2020 2020 2020 2020 2020  a,.             
-00016ad0: 2020 2063 6f6c 756d 6e5f 6e61 6d65 3d27     column_name='
-00016ae0: 6127 0a20 2020 2020 2020 2020 2020 2029  a'.            )
-00016af0: 0a0a 2020 2020 6465 6620 7465 7374 5f5f  ..    def test__
-00016b00: 696e 6974 5f5f 2873 656c 6629 3a0a 2020  init__(self):.  
-00016b10: 2020 2020 2020 2222 2254 6573 7420 7468        """Test th
-00016b20: 6520 6060 4e65 6761 7469 7665 2e5f 5f69  e ``Negative.__i
-00016b30: 6e69 745f 5f60 6020 6d65 7468 6f64 2e0a  nit__`` method..
-00016b40: 0a20 2020 2020 2020 2045 6e73 7572 6520  .        Ensure 
-00016b50: 7468 6520 6174 7472 6962 7574 6573 2061  the attributes a
-00016b60: 7265 2063 6f72 7265 6374 6c79 2073 6574  re correctly set
-00016b70: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00016b80: 2020 2020 2020 2320 5275 6e0a 2020 2020        # Run.    
-00016b90: 2020 2020 696e 7374 616e 6365 203d 204e      instance = N
-00016ba0: 6567 6174 6976 6528 636f 6c75 6d6e 5f6e  egative(column_n
-00016bb0: 616d 653d 2761 6263 2729 0a0a 2020 2020  ame='abc')..    
-00016bc0: 2020 2020 2320 4173 7365 7274 730a 2020      # Asserts.  
-00016bd0: 2020 2020 2020 6173 7365 7274 2069 6e73        assert ins
-00016be0: 7461 6e63 652e 5f76 616c 7565 203d 3d20  tance._value == 
-00016bf0: 300a 2020 2020 2020 2020 6173 7365 7274  0.        assert
-00016c00: 2069 6e73 7461 6e63 652e 5f63 6f6c 756d   instance._colum
-00016c10: 6e5f 6e61 6d65 203d 3d20 2761 6263 270a  n_name == 'abc'.
-00016c20: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
-00016c30: 6e73 7461 6e63 652e 5f6f 7065 7261 746f  nstance._operato
-00016c40: 7220 3d3d 206e 702e 6c65 7373 5f65 7175  r == np.less_equ
-00016c50: 616c 0a0a 2020 2020 6465 6620 7465 7374  al..    def test
-00016c60: 5f5f 696e 6974 5f5f 7374 7269 6374 5f74  __init__strict_t
-00016c70: 7275 6528 7365 6c66 293a 0a20 2020 2020  rue(self):.     
-00016c80: 2020 2022 2222 5465 7374 2074 6865 2060     """Test the `
-00016c90: 604e 6567 6174 6976 652e 5f5f 696e 6974  `Negative.__init
-00016ca0: 5f5f 6060 206d 6574 686f 642e 0a0a 2020  __`` method...  
-00016cb0: 2020 2020 2020 456e 7375 7265 2074 6865        Ensure the
-00016cc0: 2061 7474 7269 6275 7465 7320 6172 6520   attributes are 
-00016cd0: 636f 7272 6563 746c 7920 7365 7420 7768  correctly set wh
-00016ce0: 656e 2060 6073 7472 6963 745f 626f 756e  en ``strict_boun
-00016cf0: 6461 7269 6573 6060 2069 7320 5472 7565  daries`` is True
-00016d00: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00016d10: 2020 2020 2020 2320 5275 6e0a 2020 2020        # Run.    
-00016d20: 2020 2020 696e 7374 616e 6365 203d 204e      instance = N
-00016d30: 6567 6174 6976 6528 636f 6c75 6d6e 5f6e  egative(column_n
-00016d40: 616d 653d 2761 6263 272c 2073 7472 6963  ame='abc', stric
-00016d50: 745f 626f 756e 6461 7269 6573 3d54 7275  t_boundaries=Tru
-00016d60: 6529 0a0a 2020 2020 2020 2020 2320 4173  e)..        # As
-00016d70: 7365 7274 730a 2020 2020 2020 2020 6173  serts.        as
-00016d80: 7365 7274 2069 6e73 7461 6e63 652e 5f76  sert instance._v
-00016d90: 616c 7565 203d 3d20 300a 2020 2020 2020  alue == 0.      
-00016da0: 2020 6173 7365 7274 2069 6e73 7461 6e63    assert instanc
-00016db0: 652e 5f63 6f6c 756d 6e5f 6e61 6d65 203d  e._column_name =
-00016dc0: 3d20 2761 6263 270a 2020 2020 2020 2020  = 'abc'.        
-00016dd0: 6173 7365 7274 2069 6e73 7461 6e63 652e  assert instance.
-00016de0: 5f6f 7065 7261 746f 7220 3d3d 206e 702e  _operator == np.
-00016df0: 6c65 7373 0a0a 0a63 6c61 7373 2054 6573  less...class Tes
-00016e00: 7452 616e 6765 2829 3a0a 0a20 2020 2064  tRange():..    d
-00016e10: 6566 2074 6573 745f 5f76 616c 6964 6174  ef test__validat
-00016e20: 655f 696e 7075 7473 2873 656c 6629 3a0a  e_inputs(self):.
-00016e30: 2020 2020 2020 2020 2222 2254 6573 7420          """Test 
-00016e40: 7468 6520 6060 5261 6e67 652e 5f76 616c  the ``Range._val
-00016e50: 6964 6174 655f 696e 7075 7473 6060 206d  idate_inputs`` m
-00016e60: 6574 686f 642e 0a0a 2020 2020 2020 2020  ethod...        
-00016e70: 496e 7075 743a 0a20 2020 2020 2020 202d  Input:.        -
-00016e80: 2020 496e 636f 7272 6563 7420 7061 7261    Incorrect para
-00016e90: 6d65 7465 7273 2066 6f72 2074 6865 206d  meters for the m
-00016ea0: 6574 686f 640a 2020 2020 2020 2020 5261  ethod.        Ra
-00016eb0: 6973 6573 3a0a 2020 2020 2020 2020 2d20  ises:.        - 
-00016ec0: 4c69 7374 206f 6620 5661 6c75 6545 7272  List of ValueErr
-00016ed0: 6f72 730a 2020 2020 2020 2020 2222 220a  ors.        """.
-00016ee0: 2020 2020 2020 2020 2320 5275 6e20 2f20          # Run / 
-00016ef0: 4173 7365 7274 0a20 2020 2020 2020 2077  Assert.        w
-00016f00: 6974 6820 7079 7465 7374 2e72 6169 7365  ith pytest.raise
-00016f10: 7328 4167 6772 6567 6174 6543 6f6e 7374  s(AggregateConst
-00016f20: 7261 696e 7473 4572 726f 7229 2061 7320  raintsError) as 
-00016f30: 6572 726f 723a 0a20 2020 2020 2020 2020  error:.         
-00016f40: 2020 2052 616e 6765 2e5f 7661 6c69 6461     Range._valida
-00016f50: 7465 5f69 6e70 7574 7328 6e6f 745f 6869  te_inputs(not_hi
-00016f60: 6768 5f63 6f6c 756d 6e3d 4e6f 6e65 2c20  gh_column=None, 
-00016f70: 6e6f 745f 6c6f 775f 636f 6c75 6d6e 3d4e  not_low_column=N
-00016f80: 6f6e 6529 0a0a 2020 2020 2020 2020 6572  one)..        er
-00016f90: 725f 6d73 6720 3d20 280a 2020 2020 2020  r_msg = (.      
-00016fa0: 2020 2020 2020 7227 4d69 7373 696e 6720        r'Missing 
-00016fb0: 7265 7175 6972 6564 2076 616c 7565 7320  required values 
-00016fc0: 7b28 2e2a 297d 2069 6e20 6120 5261 6e67  {(.*)} in a Rang
-00016fd0: 6520 636f 6e73 7472 6169 6e74 2e27 0a20  e constraint.'. 
-00016fe0: 2020 2020 2020 2020 2020 2072 275c 6e5c             r'\n\
-00016ff0: 6e49 6e76 616c 6964 2076 616c 7565 7320  nInvalid values 
-00017000: 7b28 2e2a 297d 2061 7265 2070 7265 7365  {(.*)} are prese
-00017010: 6e74 2069 6e20 6120 5261 6e67 6520 636f  nt in a Range co
-00017020: 6e73 7472 6169 6e74 2e27 0a20 2020 2020  nstraint.'.     
-00017030: 2020 2029 0a20 2020 2020 2020 2067 726f     ).        gro
-00017040: 7570 7320 3d20 7265 2e73 6561 7263 6828  ups = re.search(
-00017050: 6572 725f 6d73 672c 2073 7472 2865 7272  err_msg, str(err
-00017060: 6f72 2e76 616c 7565 2929 0a20 2020 2020  or.value)).     
-00017070: 2020 2061 7373 6572 7420 6772 6f75 7073     assert groups
-00017080: 2069 7320 6e6f 7420 4e6f 6e65 0a20 2020   is not None.   
-00017090: 2020 2020 2061 7373 6572 7420 7365 7428       assert set(
-000170a0: 6576 616c 2867 726f 7570 732e 6772 6f75  eval(groups.grou
-000170b0: 7028 3129 2929 203d 3d20 7b0a 2020 2020  p(1))) == {.    
-000170c0: 2020 2020 2020 2020 276d 6964 646c 655f          'middle_
-000170d0: 636f 6c75 6d6e 5f6e 616d 6527 2c20 2768  column_name', 'h
-000170e0: 6967 685f 636f 6c75 6d6e 5f6e 616d 6527  igh_column_name'
-000170f0: 2c20 276c 6f77 5f63 6f6c 756d 6e5f 6e61  , 'low_column_na
-00017100: 6d65 270a 2020 2020 2020 2020 7d0a 2020  me'.        }.  
-00017110: 2020 2020 2020 6173 7365 7274 2073 6574        assert set
-00017120: 2865 7661 6c28 6772 6f75 7073 2e67 726f  (eval(groups.gro
-00017130: 7570 2832 2929 2920 3d3d 207b 276e 6f74  up(2))) == {'not
-00017140: 5f68 6967 685f 636f 6c75 6d6e 272c 2027  _high_column', '
-00017150: 6e6f 745f 6c6f 775f 636f 6c75 6d6e 277d  not_low_column'}
-00017160: 0a0a 2020 2020 6465 6620 7465 7374 5f5f  ..    def test__
-00017170: 7661 6c69 6461 7465 5f6d 6574 6164 6174  validate_metadat
-00017180: 615f 636f 6c75 6d6e 7328 7365 6c66 293a  a_columns(self):
-00017190: 0a20 2020 2020 2020 2022 2222 5465 7374  .        """Test
-000171a0: 2074 6865 2060 605f 7661 6c69 6461 7465   the ``_validate
-000171b0: 5f6d 6574 6164 6174 615f 636f 6c75 6d6e  _metadata_column
-000171c0: 7360 6020 6d65 7468 6f64 2e0a 0a20 2020  s`` method...   
-000171d0: 2020 2020 2041 6c6c 206f 6620 7468 6520       All of the 
-000171e0: 636f 6c75 6d6e 7320 7061 7373 6564 2073  columns passed s
-000171f0: 686f 756c 6420 6265 2069 6e20 7468 6520  hould be in the 
-00017200: 6d65 7461 6461 7461 2e0a 0a20 2020 2020  metadata...     
-00017210: 2020 2049 6e70 7574 3a0a 2020 2020 2020     Input:.      
-00017220: 2020 2020 2020 2d20 6869 6768 5f63 6f6c        - high_col
-00017230: 756d 6e5f 6e61 6d65 2c20 6c6f 775f 636f  umn_name, low_co
-00017240: 6c75 6d6e 5f6e 616d 6520 616e 6420 6d69  lumn_name and mi
-00017250: 6464 6c65 5f63 6f6c 756d 6e5f 6e61 6d65  ddle_column_name
-00017260: 2074 6861 7420 6172 6520 616c 6c20 696e   that are all in
-00017270: 2074 6865 0a20 2020 2020 2020 2020 2020   the.           
-00017280: 206d 6574 6164 6174 612e 0a0a 2020 2020   metadata...    
-00017290: 2020 2020 5369 6465 2065 6666 6563 743a      Side effect:
-000172a0: 0a20 2020 2020 2020 2020 2020 202d 204e  .            - N
-000172b0: 6f20 6572 726f 7220 7368 6f75 6c64 2062  o error should b
-000172c0: 6520 7261 6973 6564 2e0a 2020 2020 2020  e raised..      
-000172d0: 2020 2222 220a 2020 2020 2020 2020 2320    """.        # 
-000172e0: 5365 7475 700a 2020 2020 2020 2020 6d65  Setup.        me
-000172f0: 7461 6461 7461 203d 204d 6f63 6b28 290a  tadata = Mock().
-00017300: 2020 2020 2020 2020 6d65 7461 6461 7461          metadata
-00017310: 2e63 6f6c 756d 6e73 203d 207b 2761 273a  .columns = {'a':
-00017320: 2031 2c20 2762 273a 2032 2c20 2763 273a   1, 'b': 2, 'c':
-00017330: 2033 7d0a 0a20 2020 2020 2020 2023 2052   3}..        # R
-00017340: 756e 0a20 2020 2020 2020 2052 616e 6765  un.        Range
-00017350: 2e5f 7661 6c69 6461 7465 5f6d 6574 6164  ._validate_metad
-00017360: 6174 615f 636f 6c75 6d6e 7328 0a20 2020  ata_columns(.   
-00017370: 2020 2020 2020 2020 206d 6574 6164 6174           metadat
-00017380: 612c 0a20 2020 2020 2020 2020 2020 2068  a,.            h
-00017390: 6967 685f 636f 6c75 6d6e 5f6e 616d 653d  igh_column_name=
-000173a0: 2761 272c 0a20 2020 2020 2020 2020 2020  'a',.           
-000173b0: 206c 6f77 5f63 6f6c 756d 6e5f 6e61 6d65   low_column_name
-000173c0: 3d27 6227 2c0a 2020 2020 2020 2020 2020  ='b',.          
-000173d0: 2020 6d69 6464 6c65 5f63 6f6c 756d 6e5f    middle_column_
-000173e0: 6e61 6d65 3d27 6327 0a20 2020 2020 2020  name='c'.       
-000173f0: 2029 0a0a 2020 2020 6465 6620 7465 7374   )..    def test
-00017400: 5f5f 7661 6c69 6461 7465 5f6d 6574 6164  __validate_metad
-00017410: 6174 615f 636f 6c75 6d6e 735f 7261 6973  ata_columns_rais
-00017420: 6573 5f65 7272 6f72 2873 656c 6629 3a0a  es_error(self):.
-00017430: 2020 2020 2020 2020 2222 2254 6573 7420          """Test 
-00017440: 7468 6520 6060 5f76 616c 6964 6174 655f  the ``_validate_
-00017450: 6d65 7461 6461 7461 5f63 6f6c 756d 6e73  metadata_columns
-00017460: 6060 206d 6574 686f 6427 7320 6572 726f  `` method's erro
-00017470: 7220 636f 6e64 6974 696f 6e2e 0a0a 2020  r condition...  
-00017480: 2020 2020 2020 4966 2061 6e79 2063 6f6c        If any col
-00017490: 756d 6e73 2070 6173 7365 6420 6172 6520  umns passed are 
-000174a0: 6e6f 7420 696e 2074 6865 206d 6574 6164  not in the metad
-000174b0: 6174 612c 2061 6e20 6572 726f 7220 7368  ata, an error sh
-000174c0: 6f75 6c64 2062 6520 7261 6973 6564 2e0a  ould be raised..
-000174d0: 0a20 2020 2020 2020 2049 6e70 7574 3a0a  .        Input:.
-000174e0: 2020 2020 2020 2020 2020 2020 2d20 6c6f              - lo
-000174f0: 775f 636f 6c75 6d6e 5f6e 616d 6520 7468  w_column_name th
-00017500: 6174 2069 7320 6e6f 7420 696e 2074 6865  at is not in the
-00017510: 206d 6574 6164 6174 612e 0a0a 2020 2020   metadata...    
-00017520: 2020 2020 5369 6465 2065 6666 6563 743a      Side effect:
-00017530: 0a20 2020 2020 2020 2020 2020 202d 2043  .            - C
-00017540: 6f6e 7374 7261 696e 744d 6574 6164 6174  onstraintMetadat
-00017550: 6145 7272 6f72 2073 686f 756c 6420 6265  aError should be
-00017560: 2072 6169 7365 642e 0a20 2020 2020 2020   raised..       
-00017570: 2022 2222 0a20 2020 2020 2020 2023 2053   """.        # S
-00017580: 6574 7570 0a20 2020 2020 2020 206d 6574  etup.        met
-00017590: 6164 6174 6120 3d20 4d6f 636b 2829 0a20  adata = Mock(). 
-000175a0: 2020 2020 2020 206d 6574 6164 6174 612e         metadata.
-000175b0: 636f 6c75 6d6e 7320 3d20 7b27 6127 3a20  columns = {'a': 
-000175c0: 312c 2027 6227 3a20 327d 0a0a 2020 2020  1, 'b': 2}..    
-000175d0: 2020 2020 2320 5275 6e0a 2020 2020 2020      # Run.      
-000175e0: 2020 6572 726f 725f 6d65 7373 6167 6520    error_message 
-000175f0: 3d20 7265 2e65 7363 6170 6528 0a20 2020  = re.escape(.   
-00017600: 2020 2020 2020 2020 2027 4120 5261 6e67           'A Rang
-00017610: 6520 636f 6e73 7472 6169 6e74 2069 7320  e constraint is 
-00017620: 6265 696e 6720 6170 706c 6965 6420 746f  being applied to
-00017630: 2069 6e76 616c 6964 2063 6f6c 756d 6e20   invalid column 
-00017640: 6e61 6d65 7320 270a 2020 2020 2020 2020  names '.        
-00017650: 2020 2020 227b 2763 277d 2e20 5468 6520      "{'c'}. The 
-00017660: 636f 6c75 6d6e 7320 6d75 7374 2065 7869  columns must exi
-00017670: 7374 2069 6e20 7468 6520 7461 626c 652e  st in the table.
-00017680: 220a 2020 2020 2020 2020 290a 2020 2020  ".        ).    
-00017690: 2020 2020 7769 7468 2070 7974 6573 742e      with pytest.
-000176a0: 7261 6973 6573 2843 6f6e 7374 7261 696e  raises(Constrain
-000176b0: 744d 6574 6164 6174 6145 7272 6f72 2c20  tMetadataError, 
-000176c0: 6d61 7463 683d 6572 726f 725f 6d65 7373  match=error_mess
-000176d0: 6167 6529 3a0a 2020 2020 2020 2020 2020  age):.          
-000176e0: 2020 5261 6e67 652e 5f76 616c 6964 6174    Range._validat
-000176f0: 655f 6d65 7461 6461 7461 5f63 6f6c 756d  e_metadata_colum
-00017700: 6e73 280a 2020 2020 2020 2020 2020 2020  ns(.            
-00017710: 2020 2020 6d65 7461 6461 7461 2c0a 2020      metadata,.  
-00017720: 2020 2020 2020 2020 2020 2020 2020 6869                hi
-00017730: 6768 5f63 6f6c 756d 6e5f 6e61 6d65 3d27  gh_column_name='
-00017740: 6127 2c0a 2020 2020 2020 2020 2020 2020  a',.            
-00017750: 2020 2020 6c6f 775f 636f 6c75 6d6e 5f6e      low_column_n
-00017760: 616d 653d 2762 272c 0a20 2020 2020 2020  ame='b',.       
-00017770: 2020 2020 2020 2020 206d 6964 646c 655f           middle_
-00017780: 636f 6c75 6d6e 5f6e 616d 653d 2763 270a  column_name='c'.
-00017790: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-000177a0: 2020 2064 6566 2074 6573 745f 5f76 616c     def test__val
-000177b0: 6964 6174 655f 6d65 7461 6461 7461 5f73  idate_metadata_s
-000177c0: 7065 6369 6669 635f 746f 5f63 6f6e 7374  pecific_to_const
-000177d0: 7261 696e 745f 6461 7465 7469 6d65 2873  raint_datetime(s
-000177e0: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-000177f0: 2254 6573 7420 7468 6520 6060 5f76 616c  "Test the ``_val
-00017800: 6964 6174 655f 6d65 7461 6461 7461 5f73  idate_metadata_s
-00017810: 7065 6369 6669 635f 746f 5f63 6f6e 7374  pecific_to_const
-00017820: 7261 696e 7460 6020 7769 7468 2064 6174  raint`` with dat
-00017830: 6574 696d 6573 2e0a 0a20 2020 2020 2020  etimes...       
-00017840: 2049 6620 7468 6520 6060 6869 6768 5f63   If the ``high_c
-00017850: 6f6c 756d 6e5f 6e61 6d65 6060 2c20 6060  olumn_name``, ``
-00017860: 6d69 6464 6c65 5f63 6f6c 756d 6e5f 6e61  middle_column_na
-00017870: 6d65 6060 2061 6e64 2060 606c 6f77 5f63  me`` and ``low_c
-00017880: 6f6c 756d 6e5f 6e61 6d65 6060 0a20 2020  olumn_name``.   
-00017890: 2020 2020 2061 7265 2064 6174 6574 696d       are datetim
-000178a0: 6573 2c20 7468 656e 2074 6865 2076 616c  es, then the val
-000178b0: 6964 6174 696f 6e20 7368 6f75 6c64 206e  idation should n
-000178c0: 6f74 2072 6169 7365 2061 6e20 6572 726f  ot raise an erro
-000178d0: 722e 0a0a 2020 2020 2020 2020 496e 7075  r...        Inpu
-000178e0: 743a 0a20 2020 2020 2020 2020 2020 202d  t:.            -
-000178f0: 204d 6574 6164 6174 6120 7769 7468 2073   Metadata with s
-00017900: 6474 7970 6573 2073 6574 2074 6f20 6461  dtypes set to da
-00017910: 7465 7469 6d65 2066 6f72 2074 6865 2068  tetime for the h
-00017920: 6967 682c 206d 6964 646c 6520 616e 6420  igh, middle and 
-00017930: 6c6f 7720 636f 6c75 6d6e 2e0a 2020 2020  low column..    
-00017940: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00017950: 2320 5365 7475 700a 2020 2020 2020 2020  # Setup.        
-00017960: 6d65 7461 6461 7461 203d 204d 6f63 6b28  metadata = Mock(
-00017970: 290a 2020 2020 2020 2020 6d65 7461 6461  ).        metada
-00017980: 7461 2e63 6f6c 756d 6e73 203d 207b 0a20  ta.columns = {. 
-00017990: 2020 2020 2020 2020 2020 2027 6127 3a20             'a': 
-000179a0: 7b27 7364 7479 7065 273a 2027 6461 7465  {'sdtype': 'date
-000179b0: 7469 6d65 277d 2c0a 2020 2020 2020 2020  time'},.        
-000179c0: 2020 2020 2762 273a 207b 2773 6474 7970      'b': {'sdtyp
-000179d0: 6527 3a20 2764 6174 6574 696d 6527 7d2c  e': 'datetime'},
-000179e0: 0a20 2020 2020 2020 2020 2020 2027 6327  .            'c'
-000179f0: 3a20 7b27 7364 7479 7065 273a 2027 6461  : {'sdtype': 'da
-00017a00: 7465 7469 6d65 277d 0a20 2020 2020 2020  tetime'}.       
-00017a10: 207d 0a0a 2020 2020 2020 2020 2320 5275   }..        # Ru
-00017a20: 6e0a 2020 2020 2020 2020 5261 6e67 652e  n.        Range.
-00017a30: 5f76 616c 6964 6174 655f 6d65 7461 6461  _validate_metada
-00017a40: 7461 5f73 7065 6369 6669 635f 746f 5f63  ta_specific_to_c
-00017a50: 6f6e 7374 7261 696e 7428 0a20 2020 2020  onstraint(.     
-00017a60: 2020 2020 2020 206d 6574 6164 6174 612c         metadata,
-00017a70: 0a20 2020 2020 2020 2020 2020 2068 6967  .            hig
-00017a80: 685f 636f 6c75 6d6e 5f6e 616d 653d 2761  h_column_name='a
-00017a90: 272c 0a20 2020 2020 2020 2020 2020 206c  ',.            l
-00017aa0: 6f77 5f63 6f6c 756d 6e5f 6e61 6d65 3d27  ow_column_name='
-00017ab0: 6227 2c0a 2020 2020 2020 2020 2020 2020  b',.            
-00017ac0: 6d69 6464 6c65 5f63 6f6c 756d 6e5f 6e61  middle_column_na
-00017ad0: 6d65 3d27 6327 0a20 2020 2020 2020 2029  me='c'.        )
-00017ae0: 0a0a 2020 2020 6465 6620 7465 7374 5f5f  ..    def test__
-00017af0: 7661 6c69 6461 7465 5f6d 6574 6164 6174  validate_metadat
-00017b00: 615f 7370 6563 6966 6963 5f74 6f5f 636f  a_specific_to_co
-00017b10: 6e73 7472 6169 6e74 5f64 6174 6574 696d  nstraint_datetim
-00017b20: 655f 6572 726f 7228 7365 6c66 293a 0a20  e_error(self):. 
-00017b30: 2020 2020 2020 2022 2222 5465 7374 2074         """Test t
-00017b40: 6865 2060 605f 7661 6c69 6461 7465 5f6d  he ``_validate_m
-00017b50: 6574 6164 6174 615f 7370 6563 6966 6963  etadata_specific
-00017b60: 5f74 6f5f 636f 6e73 7472 6169 6e74 6060  _to_constraint``
-00017b70: 2077 6974 6820 6461 7465 7469 6d65 732e   with datetimes.
-00017b80: 0a0a 2020 2020 2020 2020 4966 2074 6865  ..        If the
-00017b90: 2060 6068 6967 685f 636f 6c75 6d6e 5f6e   ``high_column_n
-00017ba0: 616d 6560 602c 2060 606d 6964 646c 655f  ame``, ``middle_
-00017bb0: 636f 6c75 6d6e 5f6e 616d 6560 6020 616e  column_name`` an
-00017bc0: 6420 6060 6c6f 775f 636f 6c75 6d6e 5f6e  d ``low_column_n
-00017bd0: 616d 6560 600a 2020 2020 2020 2020 6172  ame``.        ar
-00017be0: 6520 6e6f 7420 616c 6c20 6461 7465 7469  e not all dateti
-00017bf0: 6d65 732c 2074 6865 6e20 7468 6520 7661  mes, then the va
-00017c00: 6c69 6461 7469 6f6e 2073 686f 756c 6420  lidation should 
-00017c10: 7261 6973 6520 616e 2065 7272 6f72 2e0a  raise an error..
-00017c20: 0a20 2020 2020 2020 2049 6e70 7574 3a0a  .        Input:.
-00017c30: 2020 2020 2020 2020 2020 2020 2d20 4d65              - Me
-00017c40: 7461 6461 7461 2077 6974 6820 7364 7479  tadata with sdty
-00017c50: 7065 7320 7365 7420 746f 2064 6174 6574  pes set to datet
-00017c60: 696d 6520 666f 7220 7468 6520 6869 6768  ime for the high
-00017c70: 2061 6e64 206c 6f77 2063 6f6c 756d 6e0a   and low column.
-00017c80: 2020 2020 2020 2020 2020 2020 6275 7420              but 
-00017c90: 6e6f 7420 7468 6520 6d69 6464 6c65 2e0a  not the middle..
-00017ca0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00017cb0: 2020 2020 2320 5365 7475 700a 2020 2020      # Setup.    
-00017cc0: 2020 2020 6d65 7461 6461 7461 203d 204d      metadata = M
-00017cd0: 6f63 6b28 290a 2020 2020 2020 2020 6d65  ock().        me
-00017ce0: 7461 6461 7461 2e63 6f6c 756d 6e73 203d  tadata.columns =
-00017cf0: 207b 0a20 2020 2020 2020 2020 2020 2027   {.            '
-00017d00: 6127 3a20 7b27 7364 7479 7065 273a 2027  a': {'sdtype': '
-00017d10: 6461 7465 7469 6d65 277d 2c0a 2020 2020  datetime'},.    
-00017d20: 2020 2020 2020 2020 2762 273a 207b 2773          'b': {'s
-00017d30: 6474 7970 6527 3a20 2764 6174 6574 696d  dtype': 'datetim
-00017d40: 6527 7d2c 0a20 2020 2020 2020 2020 2020  e'},.           
-00017d50: 2027 6327 3a20 7b27 7364 7479 7065 273a   'c': {'sdtype':
-00017d60: 2027 6e75 6d65 7269 6361 6c27 7d0a 2020   'numerical'}.  
-00017d70: 2020 2020 2020 7d0a 0a20 2020 2020 2020        }..       
-00017d80: 2023 2052 756e 0a20 2020 2020 2020 2065   # Run.        e
-00017d90: 7272 6f72 5f6d 6573 7361 6765 203d 2072  rror_message = r
-00017da0: 652e 6573 6361 7065 280a 2020 2020 2020  e.escape(.      
-00017db0: 2020 2020 2020 2741 2052 616e 6765 2063        'A Range c
-00017dc0: 6f6e 7374 7261 696e 7420 6973 2062 6569  onstraint is bei
-00017dd0: 6e67 2061 7070 6c69 6564 2074 6f20 636f  ng applied to co
-00017de0: 6c75 6d6e 7320 7769 7468 206d 6973 6d61  lumns with misma
-00017df0: 7463 6865 6420 7364 7479 7065 7320 270a  tched sdtypes '.
-00017e00: 2020 2020 2020 2020 2020 2020 225b 2761              "['a
-00017e10: 272c 2027 6327 2c20 2762 275d 2e20 416c  ', 'c', 'b']. Al
-00017e20: 6c20 636f 6c75 6d6e 7320 6d75 7374 2062  l columns must b
-00017e30: 6520 6569 7468 6572 206e 756d 6572 6963  e either numeric
-00017e40: 616c 206f 7220 6461 7465 7469 6d65 2e22  al or datetime."
-00017e50: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-00017e60: 2020 2077 6974 6820 7079 7465 7374 2e72     with pytest.r
-00017e70: 6169 7365 7328 436f 6e73 7472 6169 6e74  aises(Constraint
-00017e80: 4d65 7461 6461 7461 4572 726f 722c 206d  MetadataError, m
-00017e90: 6174 6368 3d65 7272 6f72 5f6d 6573 7361  atch=error_messa
-00017ea0: 6765 293a 0a20 2020 2020 2020 2020 2020  ge):.           
-00017eb0: 2052 616e 6765 2e5f 7661 6c69 6461 7465   Range._validate
-00017ec0: 5f6d 6574 6164 6174 615f 7370 6563 6966  _metadata_specif
-00017ed0: 6963 5f74 6f5f 636f 6e73 7472 6169 6e74  ic_to_constraint
-00017ee0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00017ef0: 2020 6d65 7461 6461 7461 2c0a 2020 2020    metadata,.    
-00017f00: 2020 2020 2020 2020 2020 2020 6869 6768              high
-00017f10: 5f63 6f6c 756d 6e5f 6e61 6d65 3d27 6127  _column_name='a'
-00017f20: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00017f30: 2020 6c6f 775f 636f 6c75 6d6e 5f6e 616d    low_column_nam
-00017f40: 653d 2762 272c 0a20 2020 2020 2020 2020  e='b',.         
-00017f50: 2020 2020 2020 206d 6964 646c 655f 636f         middle_co
-00017f60: 6c75 6d6e 5f6e 616d 653d 2763 270a 2020  lumn_name='c'.  
-00017f70: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-00017f80: 2064 6566 2074 6573 745f 5f76 616c 6964   def test__valid
-00017f90: 6174 655f 6d65 7461 6461 7461 5f73 7065  ate_metadata_spe
-00017fa0: 6369 6669 635f 746f 5f63 6f6e 7374 7261  cific_to_constra
-00017fb0: 696e 745f 6e75 6d65 7269 6361 6c28 7365  int_numerical(se
-00017fc0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-00017fd0: 5465 7374 2074 6865 2060 605f 7661 6c69  Test the ``_vali
-00017fe0: 6461 7465 5f6d 6574 6164 6174 615f 7370  date_metadata_sp
-00017ff0: 6563 6966 6963 5f74 6f5f 636f 6e73 7472  ecific_to_constr
-00018000: 6169 6e74 6060 2077 6974 6820 6e75 6d65  aint`` with nume
-00018010: 7269 6361 6c2e 0a0a 2020 2020 2020 2020  rical...        
-00018020: 4966 2074 6865 2060 6068 6967 685f 636f  If the ``high_co
-00018030: 6c75 6d6e 5f6e 616d 6560 602c 2060 606d  lumn_name``, ``m
-00018040: 6964 646c 655f 636f 6c75 6d6e 5f6e 616d  iddle_column_nam
-00018050: 6560 6020 616e 6420 6060 6c6f 775f 636f  e`` and ``low_co
-00018060: 6c75 6d6e 5f6e 616d 6560 600a 2020 2020  lumn_name``.    
-00018070: 2020 2020 6172 6520 6e75 6d65 7269 6361      are numerica
-00018080: 6c2c 2074 6865 6e20 7468 6520 7661 6c69  l, then the vali
-00018090: 6461 7469 6f6e 2073 686f 756c 6420 6e6f  dation should no
-000180a0: 7420 7261 6973 6520 616e 2065 7272 6f72  t raise an error
-000180b0: 2e0a 0a20 2020 2020 2020 2049 6e70 7574  ...        Input
-000180c0: 3a0a 2020 2020 2020 2020 2020 2020 2d20  :.            - 
-000180d0: 4d65 7461 6461 7461 2077 6974 6820 7364  Metadata with sd
-000180e0: 7479 7065 7320 7365 7420 746f 206e 756d  types set to num
-000180f0: 6572 6963 616c 2066 6f72 2074 6865 2068  erical for the h
-00018100: 6967 682c 206d 6964 646c 6520 616e 6420  igh, middle and 
-00018110: 6c6f 7720 636f 6c75 6d6e 2e0a 2020 2020  low column..    
-00018120: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00018130: 2320 5365 7475 700a 2020 2020 2020 2020  # Setup.        
-00018140: 6d65 7461 6461 7461 203d 204d 6f63 6b28  metadata = Mock(
-00018150: 290a 2020 2020 2020 2020 6d65 7461 6461  ).        metada
-00018160: 7461 2e63 6f6c 756d 6e73 203d 207b 0a20  ta.columns = {. 
-00018170: 2020 2020 2020 2020 2020 2027 6127 3a20             'a': 
-00018180: 7b27 7364 7479 7065 273a 2027 6e75 6d65  {'sdtype': 'nume
-00018190: 7269 6361 6c27 7d2c 0a20 2020 2020 2020  rical'},.       
-000181a0: 2020 2020 2027 6227 3a20 7b27 7364 7479       'b': {'sdty
-000181b0: 7065 273a 2027 6e75 6d65 7269 6361 6c27  pe': 'numerical'
-000181c0: 7d2c 0a20 2020 2020 2020 2020 2020 2027  },.            '
-000181d0: 6327 3a20 7b27 7364 7479 7065 273a 2027  c': {'sdtype': '
-000181e0: 6e75 6d65 7269 6361 6c27 7d0a 2020 2020  numerical'}.    
-000181f0: 2020 2020 7d0a 0a20 2020 2020 2020 2023      }..        #
-00018200: 2052 756e 0a20 2020 2020 2020 2052 616e   Run.        Ran
-00018210: 6765 2e5f 7661 6c69 6461 7465 5f6d 6574  ge._validate_met
-00018220: 6164 6174 615f 7370 6563 6966 6963 5f74  adata_specific_t
-00018230: 6f5f 636f 6e73 7472 6169 6e74 280a 2020  o_constraint(.  
-00018240: 2020 2020 2020 2020 2020 6d65 7461 6461            metada
-00018250: 7461 2c0a 2020 2020 2020 2020 2020 2020  ta,.            
-00018260: 6869 6768 5f63 6f6c 756d 6e5f 6e61 6d65  high_column_name
-00018270: 3d27 6127 2c0a 2020 2020 2020 2020 2020  ='a',.          
-00018280: 2020 6c6f 775f 636f 6c75 6d6e 5f6e 616d    low_column_nam
-00018290: 653d 2762 272c 0a20 2020 2020 2020 2020  e='b',.         
-000182a0: 2020 206d 6964 646c 655f 636f 6c75 6d6e     middle_column
-000182b0: 5f6e 616d 653d 2763 270a 2020 2020 2020  _name='c'.      
-000182c0: 2020 290a 0a20 2020 2064 6566 2074 6573    )..    def tes
-000182d0: 745f 5f76 616c 6964 6174 655f 6d65 7461  t__validate_meta
-000182e0: 6461 7461 5f73 7065 6369 6669 635f 746f  data_specific_to
-000182f0: 5f63 6f6e 7374 7261 696e 745f 6e75 6d65  _constraint_nume
-00018300: 7269 6361 6c5f 6572 726f 7228 7365 6c66  rical_error(self
-00018310: 293a 0a20 2020 2020 2020 2022 2222 5465  ):.        """Te
-00018320: 7374 2074 6865 2060 605f 7661 6c69 6461  st the ``_valida
-00018330: 7465 5f6d 6574 6164 6174 615f 7370 6563  te_metadata_spec
-00018340: 6966 6963 5f74 6f5f 636f 6e73 7472 6169  ific_to_constrai
-00018350: 6e74 6060 2077 6974 6820 6e75 6d65 7269  nt`` with numeri
-00018360: 6361 6c2e 0a0a 2020 2020 2020 2020 4966  cal...        If
-00018370: 2074 6865 2060 6068 6967 685f 636f 6c75   the ``high_colu
-00018380: 6d6e 5f6e 616d 6560 602c 2060 606d 6964  mn_name``, ``mid
-00018390: 646c 655f 636f 6c75 6d6e 5f6e 616d 6560  dle_column_name`
-000183a0: 6020 616e 6420 6060 6c6f 775f 636f 6c75  ` and ``low_colu
-000183b0: 6d6e 5f6e 616d 6560 600a 2020 2020 2020  mn_name``.      
-000183c0: 2020 6172 6520 6e6f 7420 616c 6c20 6e75    are not all nu
-000183d0: 6d65 7269 6361 6c2c 2074 6865 6e20 7468  merical, then th
-000183e0: 6520 7661 6c69 6461 7469 6f6e 2073 686f  e validation sho
-000183f0: 756c 6420 7261 6973 6520 616e 2065 7272  uld raise an err
-00018400: 6f72 2e0a 0a20 2020 2020 2020 2049 6e70  or...        Inp
-00018410: 7574 3a0a 2020 2020 2020 2020 2020 2020  ut:.            
-00018420: 2d20 4d65 7461 6461 7461 2077 6974 6820  - Metadata with 
-00018430: 7364 7479 7065 7320 7365 7420 746f 206e  sdtypes set to n
-00018440: 756d 6572 6963 616c 2066 6f72 2074 6865  umerical for the
-00018450: 2068 6967 6820 616e 6420 6c6f 7720 636f   high and low co
-00018460: 6c75 6d6e 0a20 2020 2020 2020 2020 2020  lumn.           
-00018470: 2062 7574 206e 6f74 2074 6865 206d 6964   but not the mid
-00018480: 646c 652e 0a20 2020 2020 2020 2022 2222  dle..        """
-00018490: 0a20 2020 2020 2020 2023 2053 6574 7570  .        # Setup
-000184a0: 0a20 2020 2020 2020 206d 6574 6164 6174  .        metadat
-000184b0: 6120 3d20 4d6f 636b 2829 0a20 2020 2020  a = Mock().     
-000184c0: 2020 206d 6574 6164 6174 612e 636f 6c75     metadata.colu
-000184d0: 6d6e 7320 3d20 7b0a 2020 2020 2020 2020  mns = {.        
-000184e0: 2020 2020 2761 273a 207b 2773 6474 7970      'a': {'sdtyp
-000184f0: 6527 3a20 276e 756d 6572 6963 616c 277d  e': 'numerical'}
-00018500: 2c0a 2020 2020 2020 2020 2020 2020 2762  ,.            'b
-00018510: 273a 207b 2773 6474 7970 6527 3a20 276e  ': {'sdtype': 'n
-00018520: 756d 6572 6963 616c 277d 2c0a 2020 2020  umerical'},.    
-00018530: 2020 2020 2020 2020 2763 273a 207b 2773          'c': {'s
-00018540: 6474 7970 6527 3a20 2764 6174 6574 696d  dtype': 'datetim
-00018550: 6527 7d0a 2020 2020 2020 2020 7d0a 0a20  e'}.        }.. 
-00018560: 2020 2020 2020 2023 2052 756e 0a20 2020         # Run.   
-00018570: 2020 2020 2065 7272 6f72 5f6d 6573 7361       error_messa
-00018580: 6765 203d 2072 652e 6573 6361 7065 280a  ge = re.escape(.
-00018590: 2020 2020 2020 2020 2020 2020 2741 2052              'A R
-000185a0: 616e 6765 2063 6f6e 7374 7261 696e 7420  ange constraint 
-000185b0: 6973 2062 6569 6e67 2061 7070 6c69 6564  is being applied
-000185c0: 2074 6f20 636f 6c75 6d6e 7320 7769 7468   to columns with
-000185d0: 206d 6973 6d61 7463 6865 6420 7364 7479   mismatched sdty
-000185e0: 7065 7320 270a 2020 2020 2020 2020 2020  pes '.          
-000185f0: 2020 225b 2761 272c 2027 6327 2c20 2762    "['a', 'c', 'b
-00018600: 275d 2e20 416c 6c20 636f 6c75 6d6e 7320  ']. All columns 
-00018610: 6d75 7374 2062 6520 6569 7468 6572 206e  must be either n
-00018620: 756d 6572 6963 616c 206f 7220 6461 7465  umerical or date
-00018630: 7469 6d65 2e22 0a20 2020 2020 2020 2029  time.".        )
-00018640: 0a20 2020 2020 2020 2077 6974 6820 7079  .        with py
-00018650: 7465 7374 2e72 6169 7365 7328 436f 6e73  test.raises(Cons
-00018660: 7472 6169 6e74 4d65 7461 6461 7461 4572  traintMetadataEr
-00018670: 726f 722c 206d 6174 6368 3d65 7272 6f72  ror, match=error
-00018680: 5f6d 6573 7361 6765 293a 0a20 2020 2020  _message):.     
-00018690: 2020 2020 2020 2052 616e 6765 2e5f 7661         Range._va
-000186a0: 6c69 6461 7465 5f6d 6574 6164 6174 615f  lidate_metadata_
-000186b0: 7370 6563 6966 6963 5f74 6f5f 636f 6e73  specific_to_cons
-000186c0: 7472 6169 6e74 280a 2020 2020 2020 2020  traint(.        
-000186d0: 2020 2020 2020 2020 6d65 7461 6461 7461          metadata
-000186e0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000186f0: 2020 6869 6768 5f63 6f6c 756d 6e5f 6e61    high_column_na
-00018700: 6d65 3d27 6127 2c0a 2020 2020 2020 2020  me='a',.        
-00018710: 2020 2020 2020 2020 6c6f 775f 636f 6c75          low_colu
-00018720: 6d6e 5f6e 616d 653d 2762 272c 0a20 2020  mn_name='b',.   
-00018730: 2020 2020 2020 2020 2020 2020 206d 6964               mid
-00018740: 646c 655f 636f 6c75 6d6e 5f6e 616d 653d  dle_column_name=
-00018750: 2763 270a 2020 2020 2020 2020 2020 2020  'c'.            
-00018760: 290a 0a20 2020 2064 6566 2074 6573 745f  )..    def test_
-00018770: 5f5f 696e 6974 5f5f 2873 656c 6629 3a0a  __init__(self):.
-00018780: 2020 2020 2020 2020 2222 2254 6573 7420          """Test 
-00018790: 7468 6520 6060 5261 6e67 652e 5f5f 696e  the ``Range.__in
-000187a0: 6974 5f5f 6060 206d 6574 686f 642e 0a0a  it__`` method...
-000187b0: 2020 2020 2020 2020 5468 6520 696e 7374          The inst
-000187c0: 616e 6365 2073 686f 756c 6420 636f 6e74  ance should cont
-000187d0: 6169 6e20 7468 6520 6e61 6d65 206f 6620  ain the name of 
-000187e0: 7468 6520 7468 7265 6520 7061 7373 6564  the three passed
-000187f0: 2063 6f6c 756d 6e73 2061 6e64 2061 6c73   columns and als
-00018800: 6f0a 2020 2020 2020 2020 7573 6520 616e  o.        use an
-00018810: 206f 7065 7261 746f 7220 6060 3c60 6020   operator ``<`` 
-00018820: 6966 2060 6073 7472 6963 745f 626f 756e  if ``strict_boun
-00018830: 6461 7269 6573 6060 2069 7320 6060 5472  daries`` is ``Tr
-00018840: 7565 6060 2062 7920 6465 6661 756c 742e  ue`` by default.
-00018850: 0a20 2020 2020 2020 2049 6e70 7574 3a0a  .        Input:.
-00018860: 2020 2020 2020 2020 2020 2020 2d20 5468              - Th
-00018870: 7265 6520 636f 6c75 6d6e 206e 616d 6573  ree column names
-00018880: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00018890: 2020 2020 2020 2320 5275 6e0a 2020 2020        # Run.    
-000188a0: 2020 2020 696e 7374 616e 6365 203d 2052      instance = R
-000188b0: 616e 6765 2827 6167 655f 7768 656e 5f6a  ange('age_when_j
-000188c0: 6f69 6e65 6427 2c20 2763 7572 7265 6e74  oined', 'current
-000188d0: 5f61 6765 272c 2027 7265 7469 7265 6d65  _age', 'retireme
-000188e0: 6e74 5f61 6765 2729 0a0a 2020 2020 2020  nt_age')..      
-000188f0: 2020 2320 4173 7365 7274 0a20 2020 2020    # Assert.     
-00018900: 2020 2061 7373 6572 7420 696e 7374 616e     assert instan
-00018910: 6365 2e6c 6f77 5f63 6f6c 756d 6e5f 6e61  ce.low_column_na
-00018920: 6d65 203d 3d20 2761 6765 5f77 6865 6e5f  me == 'age_when_
-00018930: 6a6f 696e 6564 270a 2020 2020 2020 2020  joined'.        
-00018940: 6173 7365 7274 2069 6e73 7461 6e63 652e  assert instance.
-00018950: 6d69 6464 6c65 5f63 6f6c 756d 6e5f 6e61  middle_column_na
-00018960: 6d65 203d 3d20 2763 7572 7265 6e74 5f61  me == 'current_a
-00018970: 6765 270a 2020 2020 2020 2020 6173 7365  ge'.        asse
-00018980: 7274 2069 6e73 7461 6e63 652e 6869 6768  rt instance.high
-00018990: 5f63 6f6c 756d 6e5f 6e61 6d65 203d 3d20  _column_name == 
-000189a0: 2772 6574 6972 656d 656e 745f 6167 6527  'retirement_age'
-000189b0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-000189c0: 696e 7374 616e 6365 2e5f 6f70 6572 6174  instance._operat
-000189d0: 6f72 203d 3d20 6f70 6572 6174 6f72 2e6c  or == operator.l
-000189e0: 740a 0a20 2020 2064 6566 2074 6573 745f  t..    def test_
-000189f0: 5f5f 696e 6974 5f5f 7374 7269 6374 5f62  __init__strict_b
-00018a00: 6f75 6e64 6172 6965 735f 6661 6c73 6528  oundaries_false(
-00018a10: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
-00018a20: 2222 5465 7374 2074 6865 2060 6052 616e  ""Test the ``Ran
-00018a30: 6765 2e5f 5f69 6e69 745f 5f60 6020 6d65  ge.__init__`` me
-00018a40: 7468 6f64 2e0a 0a20 2020 2020 2020 2054  thod...        T
-00018a50: 6573 7420 7468 6520 6060 5f5f 696e 6974  est the ``__init
-00018a60: 5f5f 6060 206d 6574 686f 6420 7768 656e  __`` method when
-00018a70: 2060 6073 7472 6963 745f 626f 756e 6461   ``strict_bounda
-00018a80: 7269 6573 6060 2069 7320 6060 4661 6c73  ries`` is ``Fals
-00018a90: 6560 602e 0a0a 2020 2020 2020 2020 496e  e``...        In
-00018aa0: 7075 743a 0a20 2020 2020 2020 2020 2020  put:.           
-00018ab0: 202d 2054 6872 6565 2063 6f6c 756d 6e20   - Three column 
-00018ac0: 6e61 6d65 732e 0a20 2020 2020 2020 2020  names..         
-00018ad0: 2020 202d 2060 6073 7472 6963 745f 626f     - ``strict_bo
-00018ae0: 756e 6461 7269 6573 3d46 616c 7365 6060  undaries=False``
-00018af0: 2e0a 0a20 2020 2020 2020 2053 6964 6520  ...        Side 
-00018b00: 4566 6665 6374 3a0a 2020 2020 2020 2020  Effect:.        
-00018b10: 2020 2020 2d20 6060 696e 7374 616e 6365      - ``instance
-00018b20: 2e5f 6f70 6572 6174 6f72 6060 2073 686f  ._operator`` sho
-00018b30: 756c 6420 6265 2060 606f 7065 7261 746f  uld be ``operato
-00018b40: 722e 6c65 6060 0a20 2020 2020 2020 2022  r.le``.        "
-00018b50: 2222 0a20 2020 2020 2020 2023 2052 756e  "".        # Run
-00018b60: 0a20 2020 2020 2020 2069 6e73 7461 6e63  .        instanc
-00018b70: 6520 3d20 5261 6e67 6528 0a20 2020 2020  e = Range(.     
-00018b80: 2020 2020 2020 2027 6167 655f 7768 656e         'age_when
-00018b90: 5f6a 6f69 6e65 6427 2c0a 2020 2020 2020  _joined',.      
-00018ba0: 2020 2020 2020 2763 7572 7265 6e74 5f61        'current_a
-00018bb0: 6765 272c 0a20 2020 2020 2020 2020 2020  ge',.           
-00018bc0: 2027 7265 7469 7265 6d65 6e74 5f61 6765   'retirement_age
-00018bd0: 272c 0a20 2020 2020 2020 2020 2020 2073  ',.            s
-00018be0: 7472 6963 745f 626f 756e 6461 7269 6573  trict_boundaries
-00018bf0: 3d46 616c 7365 0a20 2020 2020 2020 2029  =False.        )
-00018c00: 0a0a 2020 2020 2020 2020 2320 4173 7365  ..        # Asse
-00018c10: 7274 0a20 2020 2020 2020 2061 7373 6572  rt.        asser
-00018c20: 7420 696e 7374 616e 6365 2e6c 6f77 5f63  t instance.low_c
-00018c30: 6f6c 756d 6e5f 6e61 6d65 203d 3d20 2761  olumn_name == 'a
-00018c40: 6765 5f77 6865 6e5f 6a6f 696e 6564 270a  ge_when_joined'.
-00018c50: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
-00018c60: 6e73 7461 6e63 652e 6d69 6464 6c65 5f63  nstance.middle_c
-00018c70: 6f6c 756d 6e5f 6e61 6d65 203d 3d20 2763  olumn_name == 'c
-00018c80: 7572 7265 6e74 5f61 6765 270a 2020 2020  urrent_age'.    
-00018c90: 2020 2020 6173 7365 7274 2069 6e73 7461      assert insta
-00018ca0: 6e63 652e 6869 6768 5f63 6f6c 756d 6e5f  nce.high_column_
-00018cb0: 6e61 6d65 203d 3d20 2772 6574 6972 656d  name == 'retirem
-00018cc0: 656e 745f 6167 6527 0a20 2020 2020 2020  ent_age'.       
-00018cd0: 2061 7373 6572 7420 696e 7374 616e 6365   assert instance
-00018ce0: 2e5f 6f70 6572 6174 6f72 203d 3d20 6f70  ._operator == op
-00018cf0: 6572 6174 6f72 2e6c 650a 0a20 2020 2064  erator.le..    d
-00018d00: 6566 2074 6573 745f 5f67 6574 5f64 6966  ef test__get_dif
-00018d10: 665f 636f 6c75 6d6e 5f6e 616d 6528 7365  f_column_name(se
-00018d20: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-00018d30: 5465 7374 2074 6865 2060 6052 616e 6765  Test the ``Range
-00018d40: 2e5f 6765 745f 6469 6666 5f63 6f6c 756d  ._get_diff_colum
-00018d50: 6e5f 6e61 6d65 6060 206d 6574 686f 642e  n_name`` method.
-00018d60: 0a0a 2020 2020 2020 2020 5468 6973 206d  ..        This m
-00018d70: 6574 686f 6420 7368 6f75 6c64 2072 6574  ethod should ret
-00018d80: 7572 6e20 7468 6520 6e61 6d65 2066 6f72  urn the name for
-00018d90: 2074 6865 206e 6577 2060 6074 7261 6e73   the new ``trans
-00018da0: 666f 726d 5f63 6f6c 756d 6e60 602e 0a0a  form_column``...
-00018db0: 2020 2020 2020 2020 5365 7475 703a 0a20          Setup:. 
-00018dc0: 2020 2020 2020 2020 2020 202d 2043 7265             - Cre
-00018dd0: 6174 6520 6120 7064 2e44 6174 6146 7261  ate a pd.DataFra
-00018de0: 6d65 2077 6974 6820 7468 7265 6520 636f  me with three co
-00018df0: 6c75 6d6e 732e 0a20 2020 2020 2020 2020  lumns..         
-00018e00: 2020 202d 2049 6e73 7461 6e63 6520 6f66     - Instance of
-00018e10: 2060 6052 616e 6765 6060 2063 6f6e 7374   ``Range`` const
-00018e20: 7261 696e 7420 7769 7468 2074 686f 7365  raint with those
-00018e30: 2074 6872 6565 2063 6f6c 756d 6e20 6e61   three column na
-00018e40: 6d65 732e 0a0a 2020 2020 2020 2020 496e  mes...        In
-00018e50: 7075 743a 0a20 2020 2020 2020 2020 2020  put:.           
-00018e60: 202d 2070 642e 4461 7461 4672 616d 6520   - pd.DataFrame 
-00018e70: 7769 7468 2060 6061 6765 5f77 6865 6e5f  with ``age_when_
-00018e80: 6a6f 696e 6564 6060 2c20 6060 6375 7272  joined``, ``curr
-00018e90: 656e 745f 6167 6560 602c 2060 6072 6574  ent_age``, ``ret
-00018ea0: 6972 656d 656e 745f 6167 6560 6020 636f  irement_age`` co
-00018eb0: 6c75 6d6e 732e 0a0a 2020 2020 2020 2020  lumns...        
-00018ec0: 4f75 7470 7574 3a0a 2020 2020 2020 2020  Output:.        
-00018ed0: 2020 2020 2d20 5468 6520 636f 6c75 6d6e      - The column
-00018ee0: 206e 616d 6573 2063 6f6e 6361 7465 6e61   names concatena
-00018ef0: 7465 6420 7769 7468 2060 6023 6060 2077  ted with ``#`` w
-00018f00: 6865 7265 2074 6865 206f 7264 6572 2069  here the order i
-00018f10: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
-00018f20: 7468 6520 6060 6d69 6464 6c65 5f63 6f6c  the ``middle_col
-00018f30: 756d 6e5f 6e61 6d65 6060 2066 6f6c 6c6f  umn_name`` follo
-00018f40: 7765 6420 6279 2060 606c 6f77 6572 5f63  wed by ``lower_c
-00018f50: 6f6c 756d 6e5f 6e61 6d65 6060 2061 6e64  olumn_name`` and
-00018f60: 2065 6e64 7320 7769 7468 2074 6865 0a20   ends with the. 
-00018f70: 2020 2020 2020 2020 2020 2020 2060 6068               ``h
-00018f80: 6967 6865 725f 636f 6c75 6d6e 5f6e 616d  igher_column_nam
-00018f90: 6560 602e 0a20 2020 2020 2020 2022 2222  e``..        """
-00018fa0: 0a20 2020 2020 2020 2023 2053 6574 7570  .        # Setup
-00018fb0: 0a20 2020 2020 2020 2074 6162 6c65 5f64  .        table_d
-00018fc0: 6174 6120 3d20 7064 2e44 6174 6146 7261  ata = pd.DataFra
-00018fd0: 6d65 287b 0a20 2020 2020 2020 2020 2020  me({.           
-00018fe0: 2027 6167 655f 7768 656e 5f6a 6f69 6e65   'age_when_joine
-00018ff0: 6427 3a20 5b31 382c 2031 392c 2032 305d  d': [18, 19, 20]
-00019000: 2c0a 2020 2020 2020 2020 2020 2020 2763  ,.            'c
-00019010: 7572 7265 6e74 5f61 6765 273a 205b 3231  urrent_age': [21
-00019020: 2c20 3232 2c20 3235 5d2c 0a20 2020 2020  , 22, 25],.     
-00019030: 2020 2020 2020 2027 7265 7469 7265 6d65         'retireme
-00019040: 6e74 5f61 6765 273a 205b 3635 2c20 3638  nt_age': [65, 68
-00019050: 2c20 3735 5d0a 2020 2020 2020 2020 7d29  , 75].        })
-00019060: 0a20 2020 2020 2020 2069 6e73 7461 6e63  .        instanc
-00019070: 6520 3d20 5261 6e67 6528 2761 6765 5f77  e = Range('age_w
-00019080: 6865 6e5f 6a6f 696e 6564 272c 2027 6375  hen_joined', 'cu
-00019090: 7272 656e 745f 6167 6527 2c20 2772 6574  rrent_age', 'ret
-000190a0: 6972 656d 656e 745f 6167 6527 290a 0a20  irement_age').. 
-000190b0: 2020 2020 2020 2023 2052 756e 0a20 2020         # Run.   
-000190c0: 2020 2020 2074 7261 6e73 666f 726d 6564       transformed
-000190d0: 5f63 6f6c 756d 6e5f 6e61 6d65 203d 2069  _column_name = i
-000190e0: 6e73 7461 6e63 652e 5f67 6574 5f64 6966  nstance._get_dif
-000190f0: 665f 636f 6c75 6d6e 5f6e 616d 6528 7461  f_column_name(ta
-00019100: 626c 655f 6461 7461 290a 0a20 2020 2020  ble_data)..     
-00019110: 2020 2023 2041 7373 6572 740a 2020 2020     # Assert.    
-00019120: 2020 2020 6173 7365 7274 2074 7261 6e73      assert trans
-00019130: 666f 726d 6564 5f63 6f6c 756d 6e5f 6e61  formed_column_na
-00019140: 6d65 203d 3d20 2763 7572 7265 6e74 5f61  me == 'current_a
-00019150: 6765 2361 6765 5f77 6865 6e5f 6a6f 696e  ge#age_when_join
-00019160: 6564 2372 6574 6972 656d 656e 745f 6167  ed#retirement_ag
-00019170: 6527 0a0a 2020 2020 6465 6620 7465 7374  e'..    def test
-00019180: 5f5f 6765 745f 6973 5f64 6174 6574 696d  __get_is_datetim
-00019190: 6528 7365 6c66 293a 0a20 2020 2020 2020  e(self):.       
-000191a0: 2022 2222 5465 7374 2074 6861 7420 7468   """Test that th
-000191b0: 6520 6d65 7468 6f64 2064 6574 6563 7473  e method detects
-000191c0: 2077 6865 7468 6572 206f 7220 6e6f 7420   whether or not 
-000191d0: 7468 6520 6060 6461 7461 6060 2069 7320  the ``data`` is 
-000191e0: 6060 6461 7465 7469 6d65 6060 2e0a 0a20  ``datetime``... 
-000191f0: 2020 2020 2020 2054 6869 7320 6d65 7468         This meth
-00019200: 6f64 2073 686f 756c 6420 6465 7465 6374  od should detect
-00019210: 2077 6865 7468 6572 206f 7220 6e6f 7420   whether or not 
-00019220: 7468 6520 6461 7461 2069 7320 6060 6461  the data is ``da
-00019230: 7465 7469 6d65 6060 2061 6e64 2069 6620  tetime`` and if 
-00019240: 696e 2063 6173 6520 736f 6d65 2069 730a  in case some is.
-00019250: 2020 2020 2020 2020 6275 7420 6f74 6865          but othe
-00019260: 7220 6973 206e 6f74 2c20 7261 6973 6573  r is not, raises
-00019270: 2061 6e20 6572 726f 722e 0a0a 2020 2020   an error...    
-00019280: 2020 2020 5365 7475 703a 0a20 2020 2020      Setup:.     
-00019290: 2020 2020 2020 202d 2043 7265 6174 6520         - Create 
-000192a0: 6120 7064 2e44 6174 6146 7261 6d65 2077  a pd.DataFrame w
-000192b0: 6974 6820 7468 7265 6520 636f 6c75 6d6e  ith three column
-000192c0: 7320 7468 6174 2061 7265 2064 6174 6574  s that are datet
-000192d0: 696d 6520 6461 7461 2e0a 2020 2020 2020  ime data..      
-000192e0: 2020 2020 2020 2d20 496e 7374 616e 6365        - Instance
-000192f0: 206f 6620 6060 5261 6e67 6560 6020 636f   of ``Range`` co
-00019300: 6e73 7472 6169 6e74 2077 6974 6820 7468  nstraint with th
-00019310: 6f73 6520 7468 7265 6520 636f 6c75 6d6e  ose three column
-00019320: 206e 616d 6573 2e0a 0a20 2020 2020 2020   names...       
-00019330: 2049 6e70 7574 3a0a 2020 2020 2020 2020   Input:.        
-00019340: 2020 2020 2d20 7064 2e44 6174 6146 7261      - pd.DataFra
-00019350: 6d65 2077 6974 6820 6060 6a6f 696e 5f64  me with ``join_d
-00019360: 6174 6560 602c 2060 6070 726f 6d6f 7469  ate``, ``promoti
-00019370: 6f6e 5f64 6174 6560 602c 2060 6072 6574  on_date``, ``ret
-00019380: 6972 656d 656e 745f 6461 7465 6060 2063  irement_date`` c
-00019390: 6f6c 756d 6e73 2e0a 0a20 2020 2020 2020  olumns...       
-000193a0: 204f 7574 7075 743a 0a20 2020 2020 2020   Output:.       
-000193b0: 2020 2020 202d 2054 6865 206f 7574 7075       - The outpu
-000193c0: 7420 7368 6f75 6c64 2062 6520 5472 7565  t should be True
-000193d0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-000193e0: 2020 2020 2020 2320 5365 7475 700a 2020        # Setup.  
-000193f0: 2020 2020 2020 7461 626c 655f 6461 7461        table_data
-00019400: 203d 2070 642e 4461 7461 4672 616d 6528   = pd.DataFrame(
-00019410: 7b0a 2020 2020 2020 2020 2020 2020 276a  {.            'j
-00019420: 6f69 6e5f 6461 7465 273a 2070 642e 746f  oin_date': pd.to
-00019430: 5f64 6174 6574 696d 6528 5b27 3230 3231  _datetime(['2021
-00019440: 2d30 322d 3130 272c 2027 3230 3231 2d30  -02-10', '2021-0
-00019450: 352d 3130 272c 2027 3230 3231 2d30 382d  5-10', '2021-08-
-00019460: 3131 275d 292c 0a20 2020 2020 2020 2020  11']),.         
-00019470: 2020 2027 7072 6f6d 6f74 696f 6e5f 6461     'promotion_da
-00019480: 7465 273a 2070 642e 746f 5f64 6174 6574  te': pd.to_datet
-00019490: 696d 6528 5b27 3230 3232 2d30 352d 3130  ime(['2022-05-10
-000194a0: 272c 2027 3230 3232 2d30 362d 3130 272c  ', '2022-06-10',
-000194b0: 2027 3230 3232 2d31 312d 3137 275d 292c   '2022-11-17']),
-000194c0: 0a20 2020 2020 2020 2020 2020 2027 7265  .            're
-000194d0: 7469 7265 6d65 6e74 5f64 6174 6527 3a20  tirement_date': 
-000194e0: 7064 2e74 6f5f 6461 7465 7469 6d65 285b  pd.to_datetime([
-000194f0: 2732 3035 302d 3130 2d31 3127 2c20 2732  '2050-10-11', '2
-00019500: 3035 382d 3130 2d30 3427 2c20 2732 3037  058-10-04', '207
-00019510: 352d 3131 2d31 3427 5d29 0a20 2020 2020  5-11-14']).     
-00019520: 2020 207d 290a 2020 2020 2020 2020 696e     }).        in
-00019530: 7374 616e 6365 203d 2052 616e 6765 2827  stance = Range('
-00019540: 6a6f 696e 5f64 6174 6527 2c20 2770 726f  join_date', 'pro
-00019550: 6d6f 7469 6f6e 5f64 6174 6527 2c20 2772  motion_date', 'r
-00019560: 6574 6972 656d 656e 745f 6461 7465 2729  etirement_date')
-00019570: 0a0a 2020 2020 2020 2020 2320 5275 6e0a  ..        # Run.
-00019580: 2020 2020 2020 2020 6973 5f64 6174 6574          is_datet
-00019590: 696d 6520 3d20 696e 7374 616e 6365 2e5f  ime = instance._
-000195a0: 6765 745f 6973 5f64 6174 6574 696d 6528  get_is_datetime(
-000195b0: 7461 626c 655f 6461 7461 290a 0a20 2020  table_data)..   
-000195c0: 2020 2020 2023 2041 7373 6572 740a 2020       # Assert.  
-000195d0: 2020 2020 2020 6173 7365 7274 2069 735f        assert is_
-000195e0: 6461 7465 7469 6d65 0a0a 2020 2020 6465  datetime..    de
-000195f0: 6620 7465 7374 5f5f 6765 745f 6973 5f64  f test__get_is_d
-00019600: 6174 6574 696d 655f 6e6f 5f64 6174 6574  atetime_no_datet
-00019610: 696d 6573 2873 656c 6629 3a0a 2020 2020  imes(self):.    
-00019620: 2020 2020 2222 2254 6573 7420 7468 6174      """Test that
-00019630: 2074 6865 206d 6574 686f 6420 6465 7465   the method dete
-00019640: 6374 7320 7768 6574 6865 7220 6f72 206e  cts whether or n
-00019650: 6f74 2074 6865 2060 6064 6174 6160 6020  ot the ``data`` 
-00019660: 6973 2060 6064 6174 6574 696d 6560 602e  is ``datetime``.
-00019670: 0a0a 2020 2020 2020 2020 5468 6973 206d  ..        This m
-00019680: 6574 686f 6420 7368 6f75 6c64 2064 6574  ethod should det
-00019690: 6563 7420 7768 6574 6865 7220 6f72 206e  ect whether or n
-000196a0: 6f74 2074 6865 2064 6174 6120 6973 2060  ot the data is `
-000196b0: 6064 6174 6574 696d 6560 6020 616e 6420  `datetime`` and 
-000196c0: 6966 2069 6e20 6361 7365 2073 6f6d 6520  if in case some 
-000196d0: 6973 0a20 2020 2020 2020 2062 7574 206f  is.        but o
-000196e0: 7468 6572 2069 7320 6e6f 742c 2072 6169  ther is not, rai
-000196f0: 7365 7320 616e 2065 7272 6f72 2e0a 0a20  ses an error... 
-00019700: 2020 2020 2020 2053 6574 7570 3a0a 2020         Setup:.  
-00019710: 2020 2020 2020 2020 2020 2d20 4372 6561            - Crea
-00019720: 7465 2061 2070 642e 4461 7461 4672 616d  te a pd.DataFram
-00019730: 6520 7769 7468 2074 6872 6565 2063 6f6c  e with three col
-00019740: 756d 6e73 2074 6861 7420 646f 206e 6f74  umns that do not
-00019750: 2063 6f6e 7461 696e 2064 6174 6574 696d   contain datetim
-00019760: 6520 6461 7461 2e0a 2020 2020 2020 2020  e data..        
-00019770: 2020 2020 2d20 496e 7374 616e 6365 206f      - Instance o
-00019780: 6620 6060 5261 6e67 6560 6020 636f 6e73  f ``Range`` cons
-00019790: 7472 6169 6e74 2077 6974 6820 7468 6f73  traint with thos
-000197a0: 6520 7468 7265 6520 636f 6c75 6d6e 206e  e three column n
-000197b0: 616d 6573 2e0a 0a20 2020 2020 2020 2049  ames...        I
-000197c0: 6e70 7574 3a0a 2020 2020 2020 2020 2020  nput:.          
-000197d0: 2020 2d20 7064 2e44 6174 6146 7261 6d65    - pd.DataFrame
-000197e0: 2077 6974 6820 6060 6167 655f 7768 656e   with ``age_when
-000197f0: 5f6a 6f69 6e65 6460 602c 2060 6063 7572  _joined``, ``cur
-00019800: 7265 6e74 5f61 6765 6060 2c20 6060 7265  rent_age``, ``re
-00019810: 7469 7265 6d65 6e74 5f61 6765 6060 2063  tirement_age`` c
-00019820: 6f6c 756d 6e73 2e0a 0a20 2020 2020 2020  olumns...       
-00019830: 204f 7574 7075 743a 0a20 2020 2020 2020   Output:.       
-00019840: 2020 2020 202d 2054 6865 206f 7574 7075       - The outpu
-00019850: 7420 7368 6f75 6c64 2062 6520 6661 6c73  t should be fals
-00019860: 6520 7369 6e63 6520 616c 6c20 7468 6520  e since all the 
-00019870: 6461 7461 2069 7320 6060 696e 7460 602e  data is ``int``.
-00019880: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00019890: 2020 2020 2023 2053 6574 7570 0a20 2020       # Setup.   
-000198a0: 2020 2020 2074 6162 6c65 5f64 6174 6120       table_data 
-000198b0: 3d20 7064 2e44 6174 6146 7261 6d65 287b  = pd.DataFrame({
-000198c0: 0a20 2020 2020 2020 2020 2020 2027 6167  .            'ag
-000198d0: 655f 7768 656e 5f6a 6f69 6e65 6427 3a20  e_when_joined': 
-000198e0: 5b31 382c 2031 392c 2032 305d 2c0a 2020  [18, 19, 20],.  
-000198f0: 2020 2020 2020 2020 2020 2763 7572 7265            'curre
-00019900: 6e74 5f61 6765 273a 205b 3231 2c20 3232  nt_age': [21, 22
-00019910: 2c20 3235 5d2c 0a20 2020 2020 2020 2020  , 25],.         
-00019920: 2020 2027 7265 7469 7265 6d65 6e74 5f61     'retirement_a
-00019930: 6765 273a 205b 3635 2c20 3638 2c20 3735  ge': [65, 68, 75
-00019940: 5d0a 2020 2020 2020 2020 7d29 0a20 2020  ].        }).   
-00019950: 2020 2020 2069 6e73 7461 6e63 6520 3d20       instance = 
-00019960: 5261 6e67 6528 2761 6765 5f77 6865 6e5f  Range('age_when_
-00019970: 6a6f 696e 6564 272c 2027 6375 7272 656e  joined', 'curren
-00019980: 745f 6167 6527 2c20 2772 6574 6972 656d  t_age', 'retirem
-00019990: 656e 745f 6167 6527 290a 0a20 2020 2020  ent_age')..     
-000199a0: 2020 2023 2052 756e 0a20 2020 2020 2020     # Run.       
-000199b0: 2069 735f 6461 7465 7469 6d65 203d 2069   is_datetime = i
-000199c0: 6e73 7461 6e63 652e 5f67 6574 5f69 735f  nstance._get_is_
-000199d0: 6461 7465 7469 6d65 2874 6162 6c65 5f64  datetime(table_d
-000199e0: 6174 6129 0a0a 2020 2020 2020 2020 2320  ata)..        # 
-000199f0: 4173 7365 7274 0a20 2020 2020 2020 2061  Assert.        a
-00019a00: 7373 6572 7420 6e6f 7420 6973 5f64 6174  ssert not is_dat
-00019a10: 6574 696d 650a 0a20 2020 2064 6566 2074  etime..    def t
-00019a20: 6573 745f 5f67 6574 5f69 735f 6461 7465  est__get_is_date
-00019a30: 7469 6d65 5f72 6169 7365 735f 616e 5f65  time_raises_an_e
-00019a40: 7272 6f72 2873 656c 6629 3a0a 2020 2020  rror(self):.    
-00019a50: 2020 2020 2222 2254 6573 7420 7468 6174      """Test that
-00019a60: 2074 6865 206d 6574 686f 6420 6465 7465   the method dete
-00019a70: 6374 7320 7768 6574 6865 7220 6f72 206e  cts whether or n
-00019a80: 6f74 2074 6865 2060 6064 6174 6160 6020  ot the ``data`` 
-00019a90: 6973 2060 6064 6174 6574 696d 6560 602e  is ``datetime``.
-00019aa0: 0a0a 2020 2020 2020 2020 5468 6973 206d  ..        This m
-00019ab0: 6574 686f 6420 7368 6f75 6c64 2064 6574  ethod should det
-00019ac0: 6563 7420 7768 6574 6865 7220 6f72 206e  ect whether or n
-00019ad0: 6f74 2074 6865 2064 6174 6120 6973 2060  ot the data is `
-00019ae0: 6064 6174 6574 696d 6560 6020 616e 6420  `datetime`` and 
-00019af0: 6966 2069 6e20 6361 7365 2073 6f6d 6520  if in case some 
-00019b00: 6973 0a20 2020 2020 2020 2062 7574 206f  is.        but o
-00019b10: 7468 6572 2069 7320 6e6f 742c 2072 6169  ther is not, rai
-00019b20: 7365 7320 616e 2065 7272 6f72 2e0a 0a20  ses an error... 
-00019b30: 2020 2020 2020 2053 6574 7570 3a0a 2020         Setup:.  
-00019b40: 2020 2020 2020 2020 2020 2d20 4372 6561            - Crea
-00019b50: 7465 2061 2070 642e 4461 7461 4672 616d  te a pd.DataFram
-00019b60: 6520 7769 7468 2074 6872 6565 2063 6f6c  e with three col
-00019b70: 756d 6e73 2074 6861 7420 636f 6e74 6169  umns that contai
-00019b80: 6e20 626f 7468 2064 6174 6574 696d 6520  n both datetime 
-00019b90: 616e 6420 6e6f 6e0a 2020 2020 2020 2020  and non.        
-00019ba0: 2020 2020 2020 6461 7465 7469 6d65 2064        datetime d
-00019bb0: 6174 612e 0a20 2020 2020 2020 2020 2020  ata..           
-00019bc0: 202d 2049 6e73 7461 6e63 6520 6f66 2060   - Instance of `
-00019bd0: 6052 616e 6765 6060 2063 6f6e 7374 7261  `Range`` constra
-00019be0: 696e 7420 7769 7468 2074 686f 7365 2074  int with those t
-00019bf0: 6872 6565 2063 6f6c 756d 6e20 6e61 6d65  hree column name
-00019c00: 732e 0a0a 2020 2020 2020 2020 496e 7075  s...        Inpu
-00019c10: 743a 0a20 2020 2020 2020 2020 2020 202d  t:.            -
-00019c20: 2070 642e 4461 7461 4672 616d 6520 7769   pd.DataFrame wi
-00019c30: 7468 2060 606a 6f69 6e5f 6461 7465 6060  th ``join_date``
-00019c40: 2c20 6060 7072 6f6d 6f74 696f 6e5f 6461  , ``promotion_da
-00019c50: 7465 6060 2c20 6060 6375 7272 656e 745f  te``, ``current_
-00019c60: 6167 6560 6020 636f 6c75 6d6e 732e 0a0a  age`` columns...
-00019c70: 2020 2020 2020 2020 5369 6465 2045 6666          Side Eff
-00019c80: 6563 743a 0a20 2020 2020 2020 2020 2020  ect:.           
-00019c90: 202d 2056 616c 7565 2065 7272 6f72 2077   - Value error w
-00019ca0: 6974 6820 7468 6520 6578 7065 6374 6564  ith the expected
-00019cb0: 206d 6573 7361 6765 2073 686f 756c 6420   message should 
-00019cc0: 6265 2072 6169 7365 642e 0a20 2020 2020  be raised..     
-00019cd0: 2020 2022 2222 0a20 2020 2020 2020 2023     """.        #
-00019ce0: 2053 6574 7570 0a20 2020 2020 2020 2074   Setup.        t
-00019cf0: 6162 6c65 5f64 6174 6120 3d20 7064 2e44  able_data = pd.D
-00019d00: 6174 6146 7261 6d65 287b 0a20 2020 2020  ataFrame({.     
-00019d10: 2020 2020 2020 2027 6a6f 696e 5f64 6174         'join_dat
-00019d20: 6527 3a20 7064 2e74 6f5f 6461 7465 7469  e': pd.to_dateti
-00019d30: 6d65 285b 2732 3032 312d 3032 2d31 3027  me(['2021-02-10'
-00019d40: 2c20 2732 3032 312d 3035 2d31 3027 2c20  , '2021-05-10', 
-00019d50: 2732 3032 312d 3038 2d31 3127 5d29 2c0a  '2021-08-11']),.
-00019d60: 2020 2020 2020 2020 2020 2020 2770 726f              'pro
-00019d70: 6d6f 7469 6f6e 5f64 6174 6527 3a20 7064  motion_date': pd
-00019d80: 2e74 6f5f 6461 7465 7469 6d65 285b 2732  .to_datetime(['2
-00019d90: 3032 322d 3035 2d31 3027 2c20 2732 3032  022-05-10', '202
-00019da0: 322d 3036 2d31 3027 2c20 2732 3032 322d  2-06-10', '2022-
-00019db0: 3131 2d31 3727 5d29 2c0a 2020 2020 2020  11-17']),.      
-00019dc0: 2020 2020 2020 2763 7572 7265 6e74 5f61        'current_a
-00019dd0: 6765 273a 205b 3231 2c20 3232 2c20 3235  ge': [21, 22, 25
-00019de0: 5d2c 0a20 2020 2020 2020 207d 290a 2020  ],.        }).  
-00019df0: 2020 2020 2020 696e 7374 616e 6365 203d        instance =
-00019e00: 2052 616e 6765 2827 6a6f 696e 5f64 6174   Range('join_dat
-00019e10: 6527 2c20 2770 726f 6d6f 7469 6f6e 5f64  e', 'promotion_d
-00019e20: 6174 6527 2c20 2763 7572 7265 6e74 5f61  ate', 'current_a
-00019e30: 6765 2729 0a20 2020 2020 2020 2065 7870  ge').        exp
-00019e40: 6563 7465 645f 7465 7874 203d 2027 5468  ected_text = 'Th
-00019e50: 6520 636f 6e73 7472 6169 6e74 2063 6f6c  e constraint col
-00019e60: 756d 6e20 616e 6420 626f 756e 6473 206d  umn and bounds m
-00019e70: 7573 7420 616c 6c20 6265 2064 6174 6574  ust all be datet
-00019e80: 696d 652e 270a 0a20 2020 2020 2020 2023  ime.'..        #
-00019e90: 2052 756e 0a20 2020 2020 2020 2077 6974   Run.        wit
-00019ea0: 6820 7079 7465 7374 2e72 6169 7365 7328  h pytest.raises(
-00019eb0: 5661 6c75 6545 7272 6f72 2c20 6d61 7463  ValueError, matc
-00019ec0: 683d 6578 7065 6374 6564 5f74 6578 7429  h=expected_text)
-00019ed0: 3a0a 2020 2020 2020 2020 2020 2020 696e  :.            in
-00019ee0: 7374 616e 6365 2e5f 6765 745f 6973 5f64  stance._get_is_d
-00019ef0: 6174 6574 696d 6528 7461 626c 655f 6461  atetime(table_da
-00019f00: 7461 290a 0a20 2020 2064 6566 2074 6573  ta)..    def tes
-00019f10: 745f 5f66 6974 2873 656c 6629 3a0a 2020  t__fit(self):.  
-00019f20: 2020 2020 2020 2222 2254 6573 7420 7468        """Test th
-00019f30: 6520 6060 5f66 6974 6060 206d 6574 686f  e ``_fit`` metho
-00019f40: 6420 6f66 2060 6052 616e 6765 6060 2e0a  d of ``Range``..
-00019f50: 0a20 2020 2020 2020 2054 6573 7420 7468  .        Test th
-00019f60: 6174 2074 6865 2060 605f 6669 7460 6020  at the ``_fit`` 
-00019f70: 6d65 7468 6f64 2073 746f 7265 7320 7468  method stores th
-00019f80: 6520 7072 6f70 6572 2074 7261 6e73 666f  e proper transfo
-00019f90: 726d 6174 696f 6e20 636f 6c75 6d6e 206e  rmation column n
-00019fa0: 616d 6520 616e 640a 2020 2020 2020 2020  ame and.        
-00019fb0: 6c65 6172 6e73 2077 6865 7468 6572 2074  learns whether t
-00019fc0: 6865 2064 6174 6120 6973 2060 6064 6174  he data is ``dat
-00019fd0: 6574 696d 6560 606f 7220 6e6f 7420 616e  etime``or not an
-00019fe0: 6420 6974 2773 2060 6064 7479 7065 6060  d it's ``dtype``
-00019ff0: 2e0a 0a20 2020 2020 2020 2053 6574 7570  ...        Setup
-0001a000: 3a0a 2020 2020 2020 2020 2020 2020 2d20  :.            - 
-0001a010: 4372 6561 7465 2061 2070 642e 4461 7461  Create a pd.Data
-0001a020: 4672 616d 6520 7769 7468 2074 6872 6565  Frame with three
-0001a030: 2063 6f6c 756d 6e73 2e0a 2020 2020 2020   columns..      
-0001a040: 2020 2020 2020 2d20 496e 7374 616e 6365        - Instance
-0001a050: 206f 6620 6060 5261 6e67 6560 6020 636f   of ``Range`` co
-0001a060: 6e73 7472 6169 6e74 2077 6974 6820 7468  nstraint with th
-0001a070: 6f73 6520 7468 7265 6520 636f 6c75 6d6e  ose three column
-0001a080: 206e 616d 6573 2e0a 0a20 2020 2020 2020   names...       
-0001a090: 2049 6e70 7574 3a0a 2020 2020 2020 2020   Input:.        
-0001a0a0: 2020 2020 2d20 7064 2e44 6174 6146 7261      - pd.DataFra
-0001a0b0: 6d65 2077 6974 6820 6060 6a6f 696e 5f64  me with ``join_d
-0001a0c0: 6174 6560 602c 2060 6070 726f 6d6f 7469  ate``, ``promoti
-0001a0d0: 6f6e 5f64 6174 6560 602c 2060 6063 7572  on_date``, ``cur
-0001a0e0: 7265 6e74 5f61 6765 6060 2063 6f6c 756d  rent_age`` colum
-0001a0f0: 6e73 2e0a 0a20 2020 2020 2020 2053 6964  ns...        Sid
-0001a100: 6520 4566 6665 6374 3a0a 2020 2020 2020  e Effect:.      
-0001a110: 2020 2020 2020 2d20 696e 7374 616e 6365        - instance
-0001a120: 2068 6173 2060 605f 7472 616e 7366 6f72   has ``_transfor
-0001a130: 6d65 645f 636f 6c75 6d6e 6060 2061 6e64  med_column`` and
-0001a140: 2060 605f 6973 5f64 6174 6574 696d 6560   ``_is_datetime`
-0001a150: 6020 616e 6420 6060 5f64 7479 7065 6060  ` and ``_dtype``
-0001a160: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-0001a170: 2020 2020 2020 2320 5365 7475 700a 2020        # Setup.  
-0001a180: 2020 2020 2020 7461 626c 655f 6461 7461        table_data
-0001a190: 203d 2070 642e 4461 7461 4672 616d 6528   = pd.DataFrame(
-0001a1a0: 7b0a 2020 2020 2020 2020 2020 2020 2761  {.            'a
-0001a1b0: 6765 5f77 6865 6e5f 6a6f 696e 6564 273a  ge_when_joined':
-0001a1c0: 205b 3138 2c20 3139 2c20 3230 5d2c 0a20   [18, 19, 20],. 
-0001a1d0: 2020 2020 2020 2020 2020 2027 6375 7272             'curr
-0001a1e0: 656e 745f 6167 6527 3a20 5b32 312c 2032  ent_age': [21, 2
-0001a1f0: 322c 2032 355d 2c0a 2020 2020 2020 2020  2, 25],.        
-0001a200: 2020 2020 2772 6574 6972 656d 656e 745f      'retirement_
-0001a210: 6167 6527 3a20 5b36 352c 2036 382c 2037  age': [65, 68, 7
-0001a220: 355d 2c0a 2020 2020 2020 2020 2020 2020  5],.            
-0001a230: 2763 7572 7265 6e74 5f61 6765 2361 6765  'current_age#age
-0001a240: 5f77 6865 6e5f 6a6f 696e 6564 2372 6574  _when_joined#ret
-0001a250: 6972 656d 656e 745f 6167 6527 3a20 5b31  irement_age': [1
-0001a260: 2c20 322c 2033 5d0a 2020 2020 2020 2020  , 2, 3].        
-0001a270: 7d2c 2064 7479 7065 3d6e 702e 696e 7436  }, dtype=np.int6
-0001a280: 3429 0a20 2020 2020 2020 2069 6e73 7461  4).        insta
-0001a290: 6e63 6520 3d20 5261 6e67 6528 2761 6765  nce = Range('age
-0001a2a0: 5f77 6865 6e5f 6a6f 696e 6564 272c 2027  _when_joined', '
-0001a2b0: 6375 7272 656e 745f 6167 6527 2c20 2772  current_age', 'r
-0001a2c0: 6574 6972 656d 656e 745f 6167 6527 290a  etirement_age').
-0001a2d0: 0a20 2020 2020 2020 2023 2052 756e 0a20  .        # Run. 
-0001a2e0: 2020 2020 2020 2069 6e73 7461 6e63 652e         instance.
-0001a2f0: 5f66 6974 2874 6162 6c65 5f64 6174 6129  _fit(table_data)
-0001a300: 0a0a 2020 2020 2020 2020 2320 4173 7365  ..        # Asse
-0001a310: 7274 0a20 2020 2020 2020 2061 7373 6572  rt.        asser
-0001a320: 7420 696e 7374 616e 6365 2e5f 7472 616e  t instance._tran
-0001a330: 7366 6f72 6d65 645f 636f 6c75 6d6e 203d  sformed_column =
-0001a340: 3d20 2763 7572 7265 6e74 5f61 6765 2323  = 'current_age##
-0001a350: 6167 655f 7768 656e 5f6a 6f69 6e65 6423  age_when_joined#
-0001a360: 2372 6574 6972 656d 656e 745f 6167 6527  #retirement_age'
-0001a370: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-0001a380: 696e 7374 616e 6365 2e5f 6474 7970 6520  instance._dtype 
-0001a390: 3d3d 206e 702e 696e 7436 340a 2020 2020  == np.int64.    
-0001a3a0: 2020 2020 6173 7365 7274 206e 6f74 2069      assert not i
-0001a3b0: 6e73 7461 6e63 652e 5f69 735f 6461 7465  nstance._is_date
-0001a3c0: 7469 6d65 0a0a 2020 2020 6465 6620 7465  time..    def te
-0001a3d0: 7374 5f69 735f 7661 6c69 645f 6c74 2873  st_is_valid_lt(s
-0001a3e0: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-0001a3f0: 2254 6573 7420 7468 6520 6060 5261 6e67  "Test the ``Rang
-0001a400: 652e 6973 5f76 616c 6964 6060 2e0a 0a20  e.is_valid``... 
-0001a410: 2020 2020 2020 2054 6869 7320 7465 7374         This test
-0001a420: 2065 6e73 7572 6573 2074 6861 7420 7468   ensures that th
-0001a430: 6520 6060 6973 5f76 616c 6964 6060 206d  e ``is_valid`` m
-0001a440: 6574 686f 6420 776f 726b 7320 7769 7468  ethod works with
-0001a450: 2074 6865 206f 7065 7261 746f 7220 6060   the operator ``
-0001a460: 3c60 600a 2020 2020 2020 2020 2860 603c  <``.        (``<
-0001a470: 6060 2920 616e 6420 7661 6c69 6461 7465  ``) and validate
-0001a480: 7320 7468 6174 2074 6865 2060 606d 6964  s that the ``mid
-0001a490: 646c 655f 636f 6c75 6d6e 5f6e 616d 6560  dle_column_name`
-0001a4a0: 6020 6973 2062 6574 7765 656e 2060 606c  ` is between ``l
-0001a4b0: 6f77 5f63 6f6c 756d 6e5f 6e61 6d65 6060  ow_column_name``
-0001a4c0: 2061 6e64 0a20 2020 2020 2020 2060 6068   and.        ``h
-0001a4d0: 6967 685f 636f 6c75 6d6e 5f6e 616d 6560  igh_column_name`
-0001a4e0: 602e 0a0a 2020 2020 2020 2020 5365 7475  `...        Setu
-0001a4f0: 703a 0a20 2020 2020 2020 2020 2020 202d  p:.            -
-0001a500: 2043 7265 6174 6520 6120 7064 2e44 6174   Create a pd.Dat
-0001a510: 6146 7261 6d65 2077 6974 6820 7468 7265  aFrame with thre
-0001a520: 6520 636f 6c75 6d6e 732e 0a20 2020 2020  e columns..     
-0001a530: 2020 2020 2020 202d 2049 6e73 7461 6e63         - Instanc
-0001a540: 6520 6f66 2060 6052 616e 6765 6060 2063  e of ``Range`` c
-0001a550: 6f6e 7374 7261 696e 7420 7769 7468 2074  onstraint with t
-0001a560: 686f 7365 2074 6872 6565 2063 6f6c 756d  hose three colum
-0001a570: 6e20 6e61 6d65 732e 0a0a 2020 2020 2020  n names...      
-0001a580: 2020 496e 7075 743a 0a20 2020 2020 2020    Input:.       
-0001a590: 2020 2020 202d 2070 642e 4461 7461 4672       - pd.DataFr
-0001a5a0: 616d 6520 7769 7468 2060 6061 6765 5f77  ame with ``age_w
-0001a5b0: 6865 6e5f 6a6f 696e 6564 6060 2c20 6060  hen_joined``, ``
-0001a5c0: 6375 7272 656e 745f 6167 6560 602c 2060  current_age``, `
-0001a5d0: 6072 6574 6972 656d 656e 745f 6167 6560  `retirement_age`
-0001a5e0: 6020 636f 6c75 6d6e 732e 0a20 2020 2020  ` columns..     
-0001a5f0: 2020 2022 2222 0a20 2020 2020 2020 2023     """.        #
-0001a600: 2053 6574 7570 0a20 2020 2020 2020 2074   Setup.        t
-0001a610: 6162 6c65 5f64 6174 6120 3d20 7064 2e44  able_data = pd.D
-0001a620: 6174 6146 7261 6d65 287b 0a20 2020 2020  ataFrame({.     
-0001a630: 2020 2020 2020 2027 6167 655f 7768 656e         'age_when
-0001a640: 5f6a 6f69 6e65 6427 3a20 5b31 382c 2031  _joined': [18, 1
-0001a650: 392c 2032 305d 2c0a 2020 2020 2020 2020  9, 20],.        
-0001a660: 2020 2020 2763 7572 7265 6e74 5f61 6765      'current_age
-0001a670: 273a 205b 3231 2c20 3232 2c20 3235 5d2c  ': [21, 22, 25],
-0001a680: 0a20 2020 2020 2020 2020 2020 2027 7265  .            're
-0001a690: 7469 7265 6d65 6e74 5f61 6765 273a 205b  tirement_age': [
-0001a6a0: 3635 2c20 3638 2c20 3735 5d0a 2020 2020  65, 68, 75].    
-0001a6b0: 2020 2020 7d29 0a20 2020 2020 2020 2069      }).        i
-0001a6c0: 6e73 7461 6e63 6520 3d20 5261 6e67 6528  nstance = Range(
-0001a6d0: 2761 6765 5f77 6865 6e5f 6a6f 696e 6564  'age_when_joined
-0001a6e0: 272c 2027 6375 7272 656e 745f 6167 6527  ', 'current_age'
-0001a6f0: 2c20 2772 6574 6972 656d 656e 745f 6167  , 'retirement_ag
-0001a700: 6527 290a 0a20 2020 2020 2020 2023 2052  e')..        # R
-0001a710: 756e 0a20 2020 2020 2020 2072 6573 756c  un.        resul
-0001a720: 7420 3d20 696e 7374 616e 6365 2e69 735f  t = instance.is_
-0001a730: 7661 6c69 6428 7461 626c 655f 6461 7461  valid(table_data
-0001a740: 290a 0a20 2020 2020 2020 2023 2041 7373  )..        # Ass
-0001a750: 6572 740a 2020 2020 2020 2020 6173 7365  ert.        asse
-0001a760: 7274 2061 6c6c 2872 6573 756c 7429 0a0a  rt all(result)..
-0001a770: 2020 2020 6465 6620 7465 7374 5f69 735f      def test_is_
-0001a780: 7661 6c69 645f 6c65 2873 656c 6629 3a0a  valid_le(self):.
-0001a790: 2020 2020 2020 2020 2222 2254 6573 7420          """Test 
-0001a7a0: 7468 6520 6060 5261 6e67 652e 6973 5f76  the ``Range.is_v
-0001a7b0: 616c 6964 6060 2e0a 0a20 2020 2020 2020  alid``...       
-0001a7c0: 2054 6869 7320 7465 7374 2065 6e73 7572   This test ensur
-0001a7d0: 6573 2074 6861 7420 7468 6520 6060 6973  es that the ``is
-0001a7e0: 5f76 616c 6964 6060 206d 6574 686f 6420  _valid`` method 
-0001a7f0: 776f 726b 7320 7769 7468 2074 6865 206f  works with the o
-0001a800: 7065 7261 746f 720a 2020 2020 2020 2020  perator.        
-0001a810: 6060 3c3d 6060 2061 6e64 2076 616c 6964  ``<=`` and valid
-0001a820: 6174 6573 2074 6861 7420 7468 6520 6060  ates that the ``
-0001a830: 6d69 6464 6c65 5f63 6f6c 756d 6e5f 6e61  middle_column_na
-0001a840: 6d65 6060 2069 730a 2020 2020 2020 2020  me`` is.        
-0001a850: 6265 7477 6565 6e20 6060 6c6f 775f 636f  between ``low_co
-0001a860: 6c75 6d6e 5f6e 616d 6560 6020 616e 6420  lumn_name`` and 
-0001a870: 6060 6869 6768 5f63 6f6c 756d 6e5f 6e61  ``high_column_na
-0001a880: 6d65 6060 2e0a 0a20 2020 2020 2020 2053  me``...        S
-0001a890: 6574 7570 3a0a 2020 2020 2020 2020 2020  etup:.          
-0001a8a0: 2020 2d20 4372 6561 7465 2061 2070 642e    - Create a pd.
-0001a8b0: 4461 7461 4672 616d 6520 7769 7468 2074  DataFrame with t
-0001a8c0: 6872 6565 2063 6f6c 756d 6e73 2e0a 2020  hree columns..  
-0001a8d0: 2020 2020 2020 2020 2020 2d20 496e 7374            - Inst
-0001a8e0: 616e 6365 206f 6620 6060 5261 6e67 6560  ance of ``Range`
-0001a8f0: 6020 636f 6e73 7472 6169 6e74 2077 6974  ` constraint wit
-0001a900: 6820 7468 6f73 6520 7468 7265 6520 636f  h those three co
-0001a910: 6c75 6d6e 206e 616d 6573 2e0a 0a20 2020  lumn names...   
-0001a920: 2020 2020 2049 6e70 7574 3a0a 2020 2020       Input:.    
-0001a930: 2020 2020 2020 2020 2d20 7064 2e44 6174          - pd.Dat
-0001a940: 6146 7261 6d65 2077 6974 6820 6060 6167  aFrame with ``ag
-0001a950: 655f 7768 656e 5f6a 6f69 6e65 6460 602c  e_when_joined``,
-0001a960: 2060 6063 7572 7265 6e74 5f61 6765 6060   ``current_age``
-0001a970: 2c20 6060 7265 7469 7265 6d65 6e74 5f61  , ``retirement_a
-0001a980: 6765 6060 2063 6f6c 756d 6e73 2e0a 2020  ge`` columns..  
-0001a990: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0001a9a0: 2020 2320 5365 7475 700a 2020 2020 2020    # Setup.      
-0001a9b0: 2020 7461 626c 655f 6461 7461 203d 2070    table_data = p
-0001a9c0: 642e 4461 7461 4672 616d 6528 7b0a 2020  d.DataFrame({.  
-0001a9d0: 2020 2020 2020 2020 2020 2761 6765 5f77            'age_w
-0001a9e0: 6865 6e5f 6a6f 696e 6564 273a 205b 3231  hen_joined': [21
-0001a9f0: 2c20 3139 2c20 3230 5d2c 0a20 2020 2020  , 19, 20],.     
-0001aa00: 2020 2020 2020 2027 6375 7272 656e 745f         'current_
-0001aa10: 6167 6527 3a20 5b32 312c 2032 322c 2032  age': [21, 22, 2
-0001aa20: 355d 2c0a 2020 2020 2020 2020 2020 2020  5],.            
-0001aa30: 2772 6574 6972 656d 656e 745f 6167 6527  'retirement_age'
-0001aa40: 3a20 5b36 352c 2036 382c 2037 355d 0a20  : [65, 68, 75]. 
-0001aa50: 2020 2020 2020 207d 290a 2020 2020 2020         }).      
-0001aa60: 2020 696e 7374 616e 6365 203d 2052 616e    instance = Ran
-0001aa70: 6765 280a 2020 2020 2020 2020 2020 2020  ge(.            
-0001aa80: 2761 6765 5f77 6865 6e5f 6a6f 696e 6564  'age_when_joined
-0001aa90: 272c 0a20 2020 2020 2020 2020 2020 2027  ',.            '
-0001aaa0: 6375 7272 656e 745f 6167 6527 2c0a 2020  current_age',.  
-0001aab0: 2020 2020 2020 2020 2020 2772 6574 6972            'retir
-0001aac0: 656d 656e 745f 6167 6527 2c0a 2020 2020  ement_age',.    
-0001aad0: 2020 2020 2020 2020 7374 7269 6374 5f62          strict_b
-0001aae0: 6f75 6e64 6172 6965 733d 4661 6c73 650a  oundaries=False.
-0001aaf0: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-0001ab00: 2020 2023 2052 756e 0a20 2020 2020 2020     # Run.       
-0001ab10: 2072 6573 756c 7420 3d20 696e 7374 616e   result = instan
-0001ab20: 6365 2e69 735f 7661 6c69 6428 7461 626c  ce.is_valid(tabl
-0001ab30: 655f 6461 7461 290a 0a20 2020 2020 2020  e_data)..       
-0001ab40: 2023 2041 7373 6572 740a 2020 2020 2020   # Assert.      
-0001ab50: 2020 6173 7365 7274 2061 6c6c 2872 6573    assert all(res
-0001ab60: 756c 7429 0a0a 2020 2020 6465 6620 7465  ult)..    def te
-0001ab70: 7374 5f69 735f 7661 6c69 645f 696e 7661  st_is_valid_inva
-0001ab80: 6c69 6428 7365 6c66 293a 0a20 2020 2020  lid(self):.     
-0001ab90: 2020 2022 2222 5465 7374 2074 6865 2060     """Test the `
-0001aba0: 6052 616e 6765 2e69 735f 7661 6c69 6460  `Range.is_valid`
-0001abb0: 602e 0a0a 2020 2020 2020 2020 5468 6973  `...        This
-0001abc0: 2074 6573 7420 656e 7375 7265 7320 7468   test ensures th
-0001abd0: 6174 2074 6865 2060 6069 735f 7661 6c69  at the ``is_vali
-0001abe0: 6460 6020 6661 696c 7320 7768 656e 2074  d`` fails when t
-0001abf0: 6865 2064 6174 6120 6973 206e 6f74 2069  he data is not i
-0001ac00: 6e20 7468 6520 7261 6e67 652e 0a0a 2020  n the range...  
-0001ac10: 2020 2020 2020 5365 7475 703a 0a20 2020        Setup:.   
-0001ac20: 2020 2020 2020 2020 202d 2043 7265 6174           - Creat
-0001ac30: 6520 6120 7064 2e44 6174 6146 7261 6d65  e a pd.DataFrame
-0001ac40: 2077 6974 6820 7468 7265 6520 636f 6c75   with three colu
-0001ac50: 6d6e 732e 0a20 2020 2020 2020 2020 2020  mns..           
-0001ac60: 202d 2049 6e73 7461 6e63 6520 6f66 2060   - Instance of `
-0001ac70: 6052 616e 6765 6060 2063 6f6e 7374 7261  `Range`` constra
-0001ac80: 696e 7420 7769 7468 2074 686f 7365 2074  int with those t
-0001ac90: 6872 6565 2063 6f6c 756d 6e20 6e61 6d65  hree column name
-0001aca0: 732e 0a0a 2020 2020 2020 2020 496e 7075  s...        Inpu
-0001acb0: 743a 0a20 2020 2020 2020 2020 2020 202d  t:.            -
-0001acc0: 2070 642e 4461 7461 4672 616d 6520 7769   pd.DataFrame wi
-0001acd0: 7468 2060 6061 6765 5f77 6865 6e5f 6a6f  th ``age_when_jo
-0001ace0: 696e 6564 6060 2c20 6060 6375 7272 656e  ined``, ``curren
-0001acf0: 745f 6167 6560 602c 2060 6072 6574 6972  t_age``, ``retir
-0001ad00: 656d 656e 745f 6167 6560 6020 636f 6c75  ement_age`` colu
-0001ad10: 6d6e 732e 0a20 2020 2020 2020 2022 2222  mns..        """
-0001ad20: 0a20 2020 2020 2020 2023 2053 6574 7570  .        # Setup
-0001ad30: 0a20 2020 2020 2020 2074 6162 6c65 5f64  .        table_d
-0001ad40: 6174 6120 3d20 7064 2e44 6174 6146 7261  ata = pd.DataFra
-0001ad50: 6d65 287b 0a20 2020 2020 2020 2020 2020  me({.           
-0001ad60: 2027 6167 655f 7768 656e 5f6a 6f69 6e65   'age_when_joine
-0001ad70: 6427 3a20 5b37 302c 2031 392c 2032 305d  d': [70, 19, 20]
-0001ad80: 2c0a 2020 2020 2020 2020 2020 2020 2763  ,.            'c
-0001ad90: 7572 7265 6e74 5f61 6765 273a 205b 3231  urrent_age': [21
-0001ada0: 2c20 3232 2c20 3235 5d2c 0a20 2020 2020  , 22, 25],.     
-0001adb0: 2020 2020 2020 2027 7265 7469 7265 6d65         'retireme
-0001adc0: 6e74 5f61 6765 273a 205b 3635 2c20 3638  nt_age': [65, 68
-0001add0: 2c20 3735 5d0a 2020 2020 2020 2020 7d29  , 75].        })
-0001ade0: 0a20 2020 2020 2020 2069 6e73 7461 6e63  .        instanc
-0001adf0: 6520 3d20 5261 6e67 6528 0a20 2020 2020  e = Range(.     
-0001ae00: 2020 2020 2020 2027 6167 655f 7768 656e         'age_when
-0001ae10: 5f6a 6f69 6e65 6427 2c0a 2020 2020 2020  _joined',.      
-0001ae20: 2020 2020 2020 2763 7572 7265 6e74 5f61        'current_a
-0001ae30: 6765 272c 0a20 2020 2020 2020 2020 2020  ge',.           
-0001ae40: 2027 7265 7469 7265 6d65 6e74 5f61 6765   'retirement_age
-0001ae50: 272c 0a20 2020 2020 2020 2020 2020 2073  ',.            s
-0001ae60: 7472 6963 745f 626f 756e 6461 7269 6573  trict_boundaries
-0001ae70: 3d46 616c 7365 0a20 2020 2020 2020 2029  =False.        )
-0001ae80: 0a0a 2020 2020 2020 2020 2320 5275 6e0a  ..        # Run.
-0001ae90: 2020 2020 2020 2020 7265 7375 6c74 203d          result =
-0001aea0: 2069 6e73 7461 6e63 652e 6973 5f76 616c   instance.is_val
-0001aeb0: 6964 2874 6162 6c65 5f64 6174 6129 0a0a  id(table_data)..
-0001aec0: 2020 2020 2020 2020 2320 4173 7365 7274          # Assert
-0001aed0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-0001aee0: 6e6f 7420 616c 6c28 7265 7375 6c74 290a  not all(result).
-0001aef0: 0a20 2020 2040 7061 7463 6828 2773 6476  .    @patch('sdv
-0001af00: 2e63 6f6e 7374 7261 696e 7473 2e74 6162  .constraints.tab
-0001af10: 756c 6172 2e6c 6f67 6974 2729 0a20 2020  ular.logit').   
-0001af20: 2064 6566 2074 6573 745f 5f74 7261 6e73   def test__trans
-0001af30: 666f 726d 2873 656c 662c 206d 6f63 6b5f  form(self, mock_
-0001af40: 6c6f 6769 7429 3a0a 2020 2020 2020 2020  logit):.        
-0001af50: 2222 2254 6573 7420 7468 6520 6060 5261  """Test the ``Ra
-0001af60: 6e67 652e 5f74 7261 6e73 666f 726d 6060  nge._transform``
-0001af70: 206d 6574 686f 642e 0a0a 2020 2020 2020   method...      
-0001af80: 2020 4974 2069 7320 6578 7065 6374 6564    It is expected
-0001af90: 2074 6f20 6372 6561 7465 2061 206e 6577   to create a new
-0001afa0: 2063 6f6c 756d 6e20 7369 6d69 6c61 7220   column similar 
-0001afb0: 746f 2074 6865 2063 6f6e 7374 7261 696e  to the constrain
-0001afc0: 7420 6060 636f 6c75 6d6e 6060 2c20 616e  t ``column``, an
-0001afd0: 6420 7468 656e 0a20 2020 2020 2020 2073  d then.        s
-0001afe0: 6361 6c65 2061 6e64 2061 7070 6c79 2061  cale and apply a
-0001aff0: 206c 6f67 6974 2066 756e 6374 696f 6e20   logit function 
-0001b000: 746f 2074 6861 7420 636f 6c75 6d6e 2e0a  to that column..
-0001b010: 0a20 2020 2020 2020 204d 6f63 6b3a 0a20  .        Mock:. 
-0001b020: 2020 2020 2020 2020 2020 202d 204d 6f63             - Moc
-0001b030: 6b20 7468 6520 6060 6c6f 6769 7460 6020  k the ``logit`` 
-0001b040: 6675 6e63 7469 6f6e 2e0a 2020 2020 2020  function..      
-0001b050: 2020 496e 7075 743a 0a20 2020 2020 2020    Input:.       
-0001b060: 2020 2020 202d 2070 642e 4461 7461 4672       - pd.DataFr
-0001b070: 616d 6520 7769 7468 2060 6061 6765 5f77  ame with ``age_w
-0001b080: 6865 6e5f 6a6f 696e 6564 6060 2c20 6060  hen_joined``, ``
-0001b090: 6375 7272 656e 745f 6167 6560 602c 2060  current_age``, `
-0001b0a0: 6072 6574 6972 656d 656e 745f 6167 6560  `retirement_age`
-0001b0b0: 6020 636f 6c75 6d6e 732e 0a0a 2020 2020  ` columns...    
-0001b0c0: 2020 2020 4f75 7470 7574 3a0a 2020 2020      Output:.    
-0001b0d0: 2020 2020 2020 2020 2d20 7064 2e44 6174          - pd.Dat
-0001b0e0: 6146 7261 6d65 2077 6974 6820 616e 2065  aFrame with an e
-0001b0f0: 7874 7261 2063 6f6c 756d 6e20 636f 6e74  xtra column cont
-0001b100: 6169 6e69 6e67 2074 6865 2074 7261 6e73  aining the trans
-0001b110: 666f 726d 6564 2060 6063 6f6c 756d 6e60  formed ``column`
-0001b120: 602e 0a20 2020 2020 2020 2022 2222 0a20  `..        """. 
-0001b130: 2020 2020 2020 2023 2053 6574 7570 0a20         # Setup. 
-0001b140: 2020 2020 2020 2074 6162 6c65 5f64 6174         table_dat
-0001b150: 6120 3d20 7064 2e44 6174 6146 7261 6d65  a = pd.DataFrame
-0001b160: 287b 0a20 2020 2020 2020 2020 2020 2027  ({.            '
-0001b170: 6167 655f 7768 656e 5f6a 6f69 6e65 6427  age_when_joined'
-0001b180: 3a20 5b31 382c 2031 392c 2032 305d 2c0a  : [18, 19, 20],.
-0001b190: 2020 2020 2020 2020 2020 2020 2763 7572              'cur
-0001b1a0: 7265 6e74 5f61 6765 273a 205b 3231 2c20  rent_age': [21, 
-0001b1b0: 3232 2c20 3235 5d2c 0a20 2020 2020 2020  22, 25],.       
-0001b1c0: 2020 2020 2027 7265 7469 7265 6d65 6e74       'retirement
-0001b1d0: 5f61 6765 273a 205b 3635 2c20 3638 2c20  _age': [65, 68, 
-0001b1e0: 3735 5d0a 2020 2020 2020 2020 7d29 0a20  75].        }). 
-0001b1f0: 2020 2020 2020 206d 6f63 6b5f 6c6f 6769         mock_logi
-0001b200: 742e 7265 7475 726e 5f76 616c 7565 203d  t.return_value =
-0001b210: 205b 312c 2032 2c20 335d 0a20 2020 2020   [1, 2, 3].     
-0001b220: 2020 2069 6e73 7461 6e63 6520 3d20 5261     instance = Ra
-0001b230: 6e67 6528 2761 6765 5f77 6865 6e5f 6a6f  nge('age_when_jo
-0001b240: 696e 6564 272c 2027 6375 7272 656e 745f  ined', 'current_
-0001b250: 6167 6527 2c20 2772 6574 6972 656d 656e  age', 'retiremen
-0001b260: 745f 6167 6527 290a 0a20 2020 2020 2020  t_age')..       
-0001b270: 2023 2052 756e 0a20 2020 2020 2020 2069   # Run.        i
-0001b280: 6e73 7461 6e63 652e 6669 7428 7461 626c  nstance.fit(tabl
-0001b290: 655f 6461 7461 290a 2020 2020 2020 2020  e_data).        
-0001b2a0: 6f75 7420 3d20 696e 7374 616e 6365 2e5f  out = instance._
-0001b2b0: 7472 616e 7366 6f72 6d28 7461 626c 655f  transform(table_
-0001b2c0: 6461 7461 290a 0a20 2020 2020 2020 2023  data)..        #
-0001b2d0: 2041 7373 6572 740a 2020 2020 2020 2020   Assert.        
-0001b2e0: 6578 7065 6374 6564 5f6f 7574 203d 2070  expected_out = p
-0001b2f0: 642e 4461 7461 4672 616d 6528 7b0a 2020  d.DataFrame({.  
-0001b300: 2020 2020 2020 2020 2020 2761 6765 5f77            'age_w
-0001b310: 6865 6e5f 6a6f 696e 6564 273a 205b 3138  hen_joined': [18
-0001b320: 2c20 3139 2c20 3230 5d2c 0a20 2020 2020  , 19, 20],.     
-0001b330: 2020 2020 2020 2027 7265 7469 7265 6d65         'retireme
-0001b340: 6e74 5f61 6765 273a 205b 3635 2c20 3638  nt_age': [65, 68
-0001b350: 2c20 3735 5d2c 0a20 2020 2020 2020 2020  , 75],.         
-0001b360: 2020 2027 6375 7272 656e 745f 6167 6523     'current_age#
-0001b370: 6167 655f 7768 656e 5f6a 6f69 6e65 6423  age_when_joined#
-0001b380: 7265 7469 7265 6d65 6e74 5f61 6765 273a  retirement_age':
-0001b390: 205b 312c 2032 2c20 335d 0a20 2020 2020   [1, 2, 3].     
-0001b3a0: 2020 207d 290a 2020 2020 2020 2020 6d6f     }).        mo
-0001b3b0: 636b 5f6c 6f67 6974 2e61 7373 6572 745f  ck_logit.assert_
-0001b3c0: 6361 6c6c 6564 5f6f 6e63 6528 290a 2020  called_once().  
-0001b3d0: 2020 2020 2020 7064 2e74 6573 7469 6e67        pd.testing
-0001b3e0: 2e61 7373 6572 745f 6672 616d 655f 6571  .assert_frame_eq
-0001b3f0: 7561 6c28 6578 7065 6374 6564 5f6f 7574  ual(expected_out
-0001b400: 2c20 6f75 7429 0a0a 2020 2020 4070 6174  , out)..    @pat
-0001b410: 6368 2827 7364 762e 636f 6e73 7472 6169  ch('sdv.constrai
-0001b420: 6e74 732e 7461 6275 6c61 722e 7369 676d  nts.tabular.sigm
-0001b430: 6f69 6427 290a 2020 2020 6465 6620 7465  oid').    def te
-0001b440: 7374 5f72 6576 6572 7365 5f74 7261 6e73  st_reverse_trans
-0001b450: 666f 726d 2873 656c 662c 206d 6f63 6b5f  form(self, mock_
-0001b460: 7369 676d 6f69 6429 3a0a 2020 2020 2020  sigmoid):.      
-0001b470: 2020 2222 2254 6573 7420 7468 6520 6060    """Test the ``
-0001b480: 7265 7665 7273 655f 7472 616e 7366 6f72  reverse_transfor
-0001b490: 6d60 6020 6d65 7468 6f64 2066 6f72 2060  m`` method for `
-0001b4a0: 6052 616e 6765 6060 2e0a 0a20 2020 2020  `Range``...     
-0001b4b0: 2020 2049 7420 6973 2065 7870 6563 7465     It is expecte
-0001b4c0: 6420 746f 2072 6563 6f76 6572 2074 6865  d to recover the
-0001b4d0: 206f 7269 6769 6e61 6c20 7461 626c 6520   original table 
-0001b4e0: 7768 6963 6820 7761 7320 7472 616e 7366  which was transf
-0001b4f0: 6f72 6d65 642c 2062 7574 2077 6974 6820  ormed, but with 
-0001b500: 6469 6666 6572 656e 740a 2020 2020 2020  different.      
-0001b510: 2020 636f 6c75 6d6e 206f 7264 6572 2e20    column order. 
-0001b520: 4974 2064 6f65 7320 736f 2062 7920 6170  It does so by ap
-0001b530: 706c 7969 6e67 2061 2073 6967 6d6f 6964  plying a sigmoid
-0001b540: 2074 6f20 7468 6520 7472 616e 7366 6f72   to the transfor
-0001b550: 6d65 6420 636f 6c75 6d6e 2061 6e64 2074  med column and t
-0001b560: 6865 6e0a 2020 2020 2020 2020 7363 616c  hen.        scal
-0001b570: 696e 6720 6974 2062 6163 6b20 746f 2074  ing it back to t
-0001b580: 6865 206f 7269 6769 6e61 6c20 7370 6163  he original spac
-0001b590: 652e 2049 7420 616c 736f 2072 6570 6c61  e. It also repla
-0001b5a0: 6365 7320 7468 6520 7472 616e 7366 6f72  ces the transfor
-0001b5b0: 6d65 6420 636f 6c75 6d6e 2077 6974 680a  med column with.
-0001b5c0: 2020 2020 2020 2020 616e 2065 7175 616c          an equal
-0001b5d0: 2063 6f6c 756d 6e20 6275 7420 7769 7468   column but with
-0001b5e0: 2074 6865 206f 7269 6769 6e61 6c20 6e61   the original na
-0001b5f0: 6d65 2e0a 0a20 2020 2020 2020 204d 6f63  me...        Moc
-0001b600: 6b3a 0a20 2020 2020 2020 2020 2020 202d  k:.            -
-0001b610: 204d 6f63 6b20 7468 6520 7369 676f 6d69   Mock the sigomi
-0001b620: 6420 6675 6e63 7469 6f6e 2e0a 2020 2020  d function..    
-0001b630: 2020 2020 5365 7475 703a 0a20 2020 2020      Setup:.     
-0001b640: 2020 2020 2020 202d 204f 7269 6769 6e61         - Origina
-0001b650: 6c20 7461 626c 6520 6461 7461 2e0a 2020  l table data..  
-0001b660: 2020 2020 2020 2020 2020 2d20 416e 2065            - An e
-0001b670: 7870 6563 7465 6420 7472 616e 7366 6f72  xpected transfor
-0001b680: 6d65 6420 6461 7461 2077 6974 6820 7468  med data with th
-0001b690: 6520 6578 7065 6374 6564 2063 6f6c 756d  e expected colum
-0001b6a0: 6e20 6e61 6d65 2e0a 2020 2020 2020 2020  n name..        
-0001b6b0: 2020 2020 2d20 496e 7374 616e 6365 206f      - Instance o
-0001b6c0: 6620 5261 6e67 6520 636f 6e73 7472 6169  f Range constrai
-0001b6d0: 6e74 2e0a 0a20 2020 2020 2020 204f 7574  nt...        Out
-0001b6e0: 7075 743a 0a20 2020 2020 2020 2020 2020  put:.           
-0001b6f0: 202d 2041 2070 642e 4461 7461 4672 616d   - A pd.DataFram
-0001b700: 6520 636f 6e74 6169 6e69 6e67 2074 6865  e containing the
-0001b710: 206f 7269 6769 6e61 6c20 6461 7461 2e0a   original data..
-0001b720: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0001b730: 2020 2020 2320 5365 7475 700a 2020 2020      # Setup.    
-0001b740: 2020 2020 7461 626c 655f 6461 7461 203d      table_data =
-0001b750: 2070 642e 4461 7461 4672 616d 6528 7b0a   pd.DataFrame({.
-0001b760: 2020 2020 2020 2020 2020 2020 2761 6765              'age
-0001b770: 5f77 6865 6e5f 6a6f 696e 6564 273a 205b  _when_joined': [
-0001b780: 3138 2c20 3139 2c20 3230 5d2c 0a20 2020  18, 19, 20],.   
-0001b790: 2020 2020 2020 2020 2027 7265 7469 7265           'retire
-0001b7a0: 6d65 6e74 5f61 6765 273a 205b 3635 2c20  ment_age': [65, 
-0001b7b0: 3638 2c20 3735 5d2c 0a20 2020 2020 2020  68, 75],.       
-0001b7c0: 2020 2020 2027 6375 7272 656e 745f 6167       'current_ag
-0001b7d0: 6527 3a20 5b32 312c 2032 322c 2032 355d  e': [21, 22, 25]
-0001b7e0: 2c0a 2020 2020 2020 2020 7d29 0a20 2020  ,.        }).   
-0001b7f0: 2020 2020 206d 6f63 6b5f 7369 676d 6f69       mock_sigmoi
-0001b800: 642e 7265 7475 726e 5f76 616c 7565 203d  d.return_value =
-0001b810: 2070 642e 5365 7269 6573 285b 3231 2c20   pd.Series([21, 
-0001b820: 3232 2c20 3235 5d29 0a20 2020 2020 2020  22, 25]).       
-0001b830: 2074 7261 6e73 666f 726d 6564 5f64 6174   transformed_dat
-0001b840: 6120 3d20 7064 2e44 6174 6146 7261 6d65  a = pd.DataFrame
-0001b850: 287b 0a20 2020 2020 2020 2020 2020 2027  ({.            '
-0001b860: 6167 655f 7768 656e 5f6a 6f69 6e65 6427  age_when_joined'
-0001b870: 3a20 5b31 382c 2031 392c 2032 305d 2c0a  : [18, 19, 20],.
-0001b880: 2020 2020 2020 2020 2020 2020 2772 6574              'ret
-0001b890: 6972 656d 656e 745f 6167 6527 3a20 5b36  irement_age': [6
-0001b8a0: 352c 2036 382c 2037 355d 2c0a 2020 2020  5, 68, 75],.    
-0001b8b0: 2020 2020 2020 2020 2763 7572 7265 6e74          'current
-0001b8c0: 5f61 6765 2361 6765 5f77 6865 6e5f 6a6f  _age#age_when_jo
-0001b8d0: 696e 6564 2372 6574 6972 656d 656e 745f  ined#retirement_
-0001b8e0: 6167 6527 3a20 5b31 2c20 322c 2033 5d0a  age': [1, 2, 3].
-0001b8f0: 2020 2020 2020 2020 7d29 0a20 2020 2020          }).     
-0001b900: 2020 2069 6e73 7461 6e63 6520 3d20 5261     instance = Ra
-0001b910: 6e67 6528 2761 6765 5f77 6865 6e5f 6a6f  nge('age_when_jo
-0001b920: 696e 6564 272c 2027 6375 7272 656e 745f  ined', 'current_
-0001b930: 6167 6527 2c20 2772 6574 6972 656d 656e  age', 'retiremen
-0001b940: 745f 6167 6527 290a 0a20 2020 2020 2020  t_age')..       
-0001b950: 2023 2052 756e 0a20 2020 2020 2020 2069   # Run.        i
-0001b960: 6e73 7461 6e63 652e 6669 7428 7461 626c  nstance.fit(tabl
-0001b970: 655f 6461 7461 290a 2020 2020 2020 2020  e_data).        
-0001b980: 6f75 7420 3d20 696e 7374 616e 6365 2e72  out = instance.r
-0001b990: 6576 6572 7365 5f74 7261 6e73 666f 726d  everse_transform
-0001b9a0: 2874 7261 6e73 666f 726d 6564 5f64 6174  (transformed_dat
-0001b9b0: 6129 0a0a 2020 2020 2020 2020 2320 4173  a)..        # As
-0001b9c0: 7365 7274 0a20 2020 2020 2020 206d 6f63  sert.        moc
-0001b9d0: 6b5f 7369 676d 6f69 642e 6173 7365 7274  k_sigmoid.assert
-0001b9e0: 5f63 616c 6c65 645f 6f6e 6365 2829 0a20  _called_once(). 
-0001b9f0: 2020 2020 2020 2070 642e 7465 7374 696e         pd.testin
-0001ba00: 672e 6173 7365 7274 5f66 7261 6d65 5f65  g.assert_frame_e
-0001ba10: 7175 616c 2874 6162 6c65 5f64 6174 612c  qual(table_data,
-0001ba20: 206f 7574 290a 0a20 2020 2040 7061 7463   out)..    @patc
-0001ba30: 6828 2773 6476 2e63 6f6e 7374 7261 696e  h('sdv.constrain
-0001ba40: 7473 2e74 6162 756c 6172 2e70 6427 290a  ts.tabular.pd').
-0001ba50: 2020 2020 4070 6174 6368 2827 7364 762e      @patch('sdv.
-0001ba60: 636f 6e73 7472 6169 6e74 732e 7461 6275  constraints.tabu
-0001ba70: 6c61 722e 7369 676d 6f69 6427 290a 2020  lar.sigmoid').  
-0001ba80: 2020 6465 6620 7465 7374 5f72 6576 6572    def test_rever
-0001ba90: 7365 5f74 7261 6e73 666f 726d 5f69 735f  se_transform_is_
-0001baa0: 6461 7465 7469 6d65 2873 656c 662c 206d  datetime(self, m
-0001bab0: 6f63 6b5f 7369 676d 6f69 642c 206d 6f63  ock_sigmoid, moc
-0001bac0: 6b5f 7064 293a 0a20 2020 2020 2020 2022  k_pd):.        "
-0001bad0: 2222 5465 7374 2074 6865 2060 6072 6576  ""Test the ``rev
-0001bae0: 6572 7365 5f74 7261 6e73 666f 726d 6060  erse_transform``
-0001baf0: 206d 6574 686f 6420 666f 7220 6060 5261   method for ``Ra
-0001bb00: 6e67 6560 602e 0a0a 2020 2020 2020 2020  nge``...        
-0001bb10: 5768 656e 2060 6069 6e73 7461 6e63 652e  When ``instance.
-0001bb20: 5f69 735f 6461 7465 7469 6d65 6060 2069  _is_datetime`` i
-0001bb30: 7320 6060 5472 7565 6060 2c20 7468 6520  s ``True``, the 
-0001bb40: 6461 7461 2073 686f 756c 6420 6265 2063  data should be c
-0001bb50: 6f6e 7665 7274 6564 0a20 2020 2020 2020  onverted.       
-0001bb60: 2074 6f20 6060 7061 6e64 6173 2e74 6f5f   to ``pandas.to_
-0001bb70: 6461 7465 7469 6d65 6060 2e0a 0a20 2020  datetime``...   
-0001bb80: 2020 2020 204d 6f63 6b3a 0a20 2020 2020       Mock:.     
-0001bb90: 2020 2020 2020 202d 204d 6f63 6b20 7468         - Mock th
-0001bba0: 6520 7369 676d 6f69 6420 6675 6e63 7469  e sigmoid functi
-0001bbb0: 6f6e 2e0a 2020 2020 2020 2020 2020 2020  on..            
-0001bbc0: 2d20 4d6f 636b 2070 616e 6461 732e 0a0a  - Mock pandas...
-0001bbd0: 2020 2020 2020 2020 5365 7475 703a 0a20          Setup:. 
-0001bbe0: 2020 2020 2020 2020 2020 202d 204f 7269             - Ori
-0001bbf0: 6769 6e61 6c20 7461 626c 6520 6461 7461  ginal table data
-0001bc00: 2e0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
-0001bc10: 416e 2065 7870 6563 7465 6420 7472 616e  An expected tran
-0001bc20: 7366 6f72 6d65 6420 6461 7461 2e0a 2020  sformed data..  
-0001bc30: 2020 2020 2020 2020 2020 2d20 496e 7374            - Inst
-0001bc40: 616e 6365 206f 6620 5363 616c 6172 5261  ance of ScalarRa
-0001bc50: 6e67 6520 636f 6e73 7472 6169 6e74 2e0a  nge constraint..
-0001bc60: 0a20 2020 2020 2020 204f 7574 7075 743a  .        Output:
-0001bc70: 0a20 2020 2020 2020 2020 2020 202d 2041  .            - A
-0001bc80: 2070 642e 4461 7461 4672 616d 6520 636f   pd.DataFrame co
-0001bc90: 6e74 6169 6e69 6e67 2074 6865 206f 7269  ntaining the ori
-0001bca0: 6769 6e61 6c20 6461 7461 2e0a 0a20 2020  ginal data...   
-0001bcb0: 2020 2020 2053 6964 6520 4566 6665 6374       Side Effect
-0001bcc0: 733a 0a20 2020 2020 2020 2020 2020 202d  s:.            -
-0001bcd0: 2060 606d 6f63 6b5f 7064 6060 2068 6173   ``mock_pd`` has
-0001bce0: 2074 6f20 6265 2063 616c 6c65 6420 6f6e   to be called on
-0001bcf0: 6365 2e0a 2020 2020 2020 2020 2222 220a  ce..        """.
-0001bd00: 2020 2020 2020 2020 2320 5365 7475 700a          # Setup.
-0001bd10: 2020 2020 2020 2020 7461 626c 655f 6461          table_da
-0001bd20: 7461 203d 2070 642e 4461 7461 4672 616d  ta = pd.DataFram
-0001bd30: 6528 7b0a 2020 2020 2020 2020 2020 2020  e({.            
-0001bd40: 2761 6765 5f77 6865 6e5f 6a6f 696e 6564  'age_when_joined
-0001bd50: 273a 205b 3138 2c20 3139 2c20 3230 5d2c  ': [18, 19, 20],
-0001bd60: 0a20 2020 2020 2020 2020 2020 2027 7265  .            're
-0001bd70: 7469 7265 6d65 6e74 5f61 6765 273a 205b  tirement_age': [
-0001bd80: 3635 2c20 3638 2c20 3735 5d2c 0a20 2020  65, 68, 75],.   
-0001bd90: 2020 2020 2020 2020 2027 6375 7272 656e           'curren
-0001bda0: 745f 6167 6527 3a20 5b32 312c 2032 322c  t_age': [21, 22,
-0001bdb0: 2032 355d 2c0a 2020 2020 2020 2020 7d29   25],.        })
-0001bdc0: 0a20 2020 2020 2020 206d 6f63 6b5f 7369  .        mock_si
-0001bdd0: 676d 6f69 642e 7265 7475 726e 5f76 616c  gmoid.return_val
-0001bde0: 7565 203d 2070 642e 5365 7269 6573 285b  ue = pd.Series([
-0001bdf0: 3231 2c20 3232 2c20 3235 5d29 0a20 2020  21, 22, 25]).   
-0001be00: 2020 2020 2074 7261 6e73 666f 726d 6564       transformed
-0001be10: 5f64 6174 6120 3d20 7064 2e44 6174 6146  _data = pd.DataF
-0001be20: 7261 6d65 287b 0a20 2020 2020 2020 2020  rame({.         
-0001be30: 2020 2027 6167 655f 7768 656e 5f6a 6f69     'age_when_joi
-0001be40: 6e65 6427 3a20 5b31 382c 2031 392c 2032  ned': [18, 19, 2
-0001be50: 305d 2c0a 2020 2020 2020 2020 2020 2020  0],.            
-0001be60: 2772 6574 6972 656d 656e 745f 6167 6527  'retirement_age'
-0001be70: 3a20 5b36 352c 2036 382c 2037 355d 2c0a  : [65, 68, 75],.
-0001be80: 2020 2020 2020 2020 2020 2020 2763 7572              'cur
-0001be90: 7265 6e74 5f61 6765 2361 6765 5f77 6865  rent_age#age_whe
-0001bea0: 6e5f 6a6f 696e 6564 2372 6574 6972 656d  n_joined#retirem
-0001beb0: 656e 745f 6167 6527 3a20 5b31 2c20 322c  ent_age': [1, 2,
-0001bec0: 2033 5d0a 2020 2020 2020 2020 7d29 0a20   3].        }). 
-0001bed0: 2020 2020 2020 206d 6f63 6b5f 7064 2e74         mock_pd.t
-0001bee0: 6f5f 6461 7465 7469 6d65 2e73 6964 655f  o_datetime.side_
-0001bef0: 6566 6665 6374 203d 206c 616d 6264 6120  effect = lambda 
-0001bf00: 783a 2078 0a0a 2020 2020 2020 2020 696e  x: x..        in
-0001bf10: 7374 616e 6365 203d 2052 616e 6765 2827  stance = Range('
-0001bf20: 6167 655f 7768 656e 5f6a 6f69 6e65 6427  age_when_joined'
-0001bf30: 2c20 2763 7572 7265 6e74 5f61 6765 272c  , 'current_age',
-0001bf40: 2027 7265 7469 7265 6d65 6e74 5f61 6765   'retirement_age
-0001bf50: 2729 0a20 2020 2020 2020 2069 6e73 7461  ').        insta
-0001bf60: 6e63 652e 5f74 7261 6e73 666f 726d 6564  nce._transformed
-0001bf70: 5f63 6f6c 756d 6e20 3d20 2763 7572 7265  _column = 'curre
-0001bf80: 6e74 5f61 6765 2361 6765 5f77 6865 6e5f  nt_age#age_when_
-0001bf90: 6a6f 696e 6564 2372 6574 6972 656d 656e  joined#retiremen
-0001bfa0: 745f 6167 6527 0a20 2020 2020 2020 2069  t_age'.        i
-0001bfb0: 6e73 7461 6e63 652e 5f69 735f 6461 7465  nstance._is_date
-0001bfc0: 7469 6d65 203d 2054 7275 650a 0a20 2020  time = True..   
-0001bfd0: 2020 2020 2023 2052 756e 0a20 2020 2020       # Run.     
-0001bfe0: 2020 206f 7574 203d 2069 6e73 7461 6e63     out = instanc
-0001bff0: 652e 7265 7665 7273 655f 7472 616e 7366  e.reverse_transf
-0001c000: 6f72 6d28 7472 616e 7366 6f72 6d65 645f  orm(transformed_
-0001c010: 6461 7461 290a 0a20 2020 2020 2020 2023  data)..        #
-0001c020: 2041 7373 6572 740a 2020 2020 2020 2020   Assert.        
-0001c030: 7064 2e74 6573 7469 6e67 2e61 7373 6572  pd.testing.asser
-0001c040: 745f 6672 616d 655f 6571 7561 6c28 7461  t_frame_equal(ta
-0001c050: 626c 655f 6461 7461 2c20 6f75 7429 0a20  ble_data, out). 
-0001c060: 2020 2020 2020 206d 6f63 6b5f 7369 676d         mock_sigm
-0001c070: 6f69 642e 6173 7365 7274 5f63 616c 6c65  oid.assert_calle
-0001c080: 645f 6f6e 6365 2829 0a20 2020 2020 2020  d_once().       
-0001c090: 206d 6f63 6b5f 7064 2e74 6f5f 6461 7465   mock_pd.to_date
-0001c0a0: 7469 6d65 2e61 7373 6572 745f 6361 6c6c  time.assert_call
-0001c0b0: 6564 5f6f 6e63 6528 290a 0a0a 636c 6173  ed_once()...clas
-0001c0c0: 7320 5465 7374 5363 616c 6172 5261 6e67  s TestScalarRang
-0001c0d0: 6528 293a 0a0a 2020 2020 6465 6620 7465  e():..    def te
-0001c0e0: 7374 5f5f 7661 6c69 6461 7465 5f69 6e70  st__validate_inp
-0001c0f0: 7574 7328 7365 6c66 293a 0a20 2020 2020  uts(self):.     
-0001c100: 2020 2022 2222 5465 7374 2074 6865 2060     """Test the `
-0001c110: 6053 6361 6c61 7252 616e 6765 2e5f 7661  `ScalarRange._va
-0001c120: 6c69 6461 7465 5f69 6e70 7574 7360 6020  lidate_inputs`` 
-0001c130: 6d65 7468 6f64 2e0a 0a20 2020 2020 2020  method...       
-0001c140: 2049 6e70 7574 3a0a 2020 2020 2020 2020   Input:.        
-0001c150: 2d20 2049 6e63 6f72 7265 6374 2070 6172  -  Incorrect par
-0001c160: 616d 6574 6572 7320 666f 7220 7468 6520  ameters for the 
-0001c170: 6d65 7468 6f64 0a20 2020 2020 2020 2052  method.        R
-0001c180: 6169 7365 733a 0a20 2020 2020 2020 202d  aises:.        -
-0001c190: 204c 6973 7420 6f66 2056 616c 7565 4572   List of ValueEr
-0001c1a0: 726f 7273 0a20 2020 2020 2020 2022 2222  rors.        """
-0001c1b0: 0a20 2020 2020 2020 2023 2052 756e 202f  .        # Run /
-0001c1c0: 2041 7373 6572 740a 2020 2020 2020 2020   Assert.        
-0001c1d0: 7769 7468 2070 7974 6573 742e 7261 6973  with pytest.rais
-0001c1e0: 6573 2841 6767 7265 6761 7465 436f 6e73  es(AggregateCons
-0001c1f0: 7472 6169 6e74 7345 7272 6f72 2920 6173  traintsError) as
-0001c200: 2065 7272 6f72 3a0a 2020 2020 2020 2020   error:.        
-0001c210: 2020 2020 5363 616c 6172 5261 6e67 652e      ScalarRange.
-0001c220: 5f76 616c 6964 6174 655f 696e 7075 7473  _validate_inputs
-0001c230: 286e 6f74 5f68 6967 685f 636f 6c75 6d6e  (not_high_column
-0001c240: 3d4e 6f6e 652c 206e 6f74 5f6c 6f77 5f63  =None, not_low_c
-0001c250: 6f6c 756d 6e3d 4e6f 6e65 290a 0a20 2020  olumn=None)..   
-0001c260: 2020 2020 2065 7272 5f6d 7367 203d 2028       err_msg = (
-0001c270: 0a20 2020 2020 2020 2020 2020 2072 274d  .            r'M
-0001c280: 6973 7369 6e67 2072 6571 7569 7265 6420  issing required 
-0001c290: 7661 6c75 6573 207b 282e 2a29 7d20 696e  values {(.*)} in
-0001c2a0: 2061 2053 6361 6c61 7252 616e 6765 2063   a ScalarRange c
-0001c2b0: 6f6e 7374 7261 696e 742e 270a 2020 2020  onstraint.'.    
-0001c2c0: 2020 2020 2020 2020 7227 5c6e 5c6e 496e          r'\n\nIn
-0001c2d0: 7661 6c69 6420 7661 6c75 6573 207b 282e  valid values {(.
-0001c2e0: 2a29 7d20 6172 6520 7072 6573 656e 7420  *)} are present 
-0001c2f0: 696e 2061 2053 6361 6c61 7252 616e 6765  in a ScalarRange
-0001c300: 2063 6f6e 7374 7261 696e 742e 270a 2020   constraint.'.  
-0001c310: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0001c320: 6772 6f75 7073 203d 2072 652e 7365 6172  groups = re.sear
-0001c330: 6368 2865 7272 5f6d 7367 2c20 7374 7228  ch(err_msg, str(
-0001c340: 6572 726f 722e 7661 6c75 6529 290a 2020  error.value)).  
-0001c350: 2020 2020 2020 6173 7365 7274 2067 726f        assert gro
-0001c360: 7570 7320 6973 206e 6f74 204e 6f6e 650a  ups is not None.
-0001c370: 2020 2020 2020 2020 6173 7365 7274 2073          assert s
-0001c380: 6574 2865 7661 6c28 6772 6f75 7073 2e67  et(eval(groups.g
-0001c390: 726f 7570 2831 2929 2920 3d3d 207b 276c  roup(1))) == {'l
-0001c3a0: 6f77 5f76 616c 7565 272c 2027 6869 6768  ow_value', 'high
-0001c3b0: 5f76 616c 7565 272c 2027 636f 6c75 6d6e  _value', 'column
-0001c3c0: 5f6e 616d 6527 7d0a 2020 2020 2020 2020  _name'}.        
-0001c3d0: 6173 7365 7274 2073 6574 2865 7661 6c28  assert set(eval(
-0001c3e0: 6772 6f75 7073 2e67 726f 7570 2832 2929  groups.group(2))
-0001c3f0: 2920 3d3d 207b 276e 6f74 5f68 6967 685f  ) == {'not_high_
-0001c400: 636f 6c75 6d6e 272c 2027 6e6f 745f 6c6f  column', 'not_lo
-0001c410: 775f 636f 6c75 6d6e 277d 0a0a 2020 2020  w_column'}..    
-0001c420: 6465 6620 7465 7374 5f5f 7661 6c69 6461  def test__valida
-0001c430: 7465 5f6d 6574 6164 6174 615f 636f 6c75  te_metadata_colu
-0001c440: 6d6e 7328 7365 6c66 293a 0a20 2020 2020  mns(self):.     
-0001c450: 2020 2022 2222 5465 7374 2074 6865 2060     """Test the `
-0001c460: 605f 7661 6c69 6461 7465 5f6d 6574 6164  `_validate_metad
-0001c470: 6174 615f 636f 6c75 6d6e 7360 6020 6d65  ata_columns`` me
-0001c480: 7468 6f64 2e0a 0a20 2020 2020 2020 2054  thod...        T
-0001c490: 6865 2063 6f6c 756d 6e20 7061 7373 6564  he column passed
-0001c4a0: 2069 6e20 636f 6c75 6d6e 5f6e 616d 6520   in column_name 
-0001c4b0: 7368 6f75 6c64 2062 6520 696e 2074 6865  should be in the
-0001c4c0: 206d 6574 6164 6174 612e 0a0a 2020 2020   metadata...    
-0001c4d0: 2020 2020 496e 7075 743a 0a20 2020 2020      Input:.     
-0001c4e0: 2020 2020 2020 202d 2063 6f6c 756d 6e5f         - column_
-0001c4f0: 6e61 6d65 2074 6861 7420 6973 2069 6e20  name that is in 
-0001c500: 7468 6520 6d65 7461 6461 7461 2e0a 0a20  the metadata... 
-0001c510: 2020 2020 2020 2053 6964 6520 6566 6665         Side effe
-0001c520: 6374 3a0a 2020 2020 2020 2020 2020 2020  ct:.            
-0001c530: 2d20 4e6f 2065 7272 6f72 2073 686f 756c  - No error shoul
-0001c540: 6420 6265 2072 6169 7365 642e 0a20 2020  d be raised..   
-0001c550: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0001c560: 2023 2053 6574 7570 0a20 2020 2020 2020   # Setup.       
-0001c570: 206d 6574 6164 6174 6120 3d20 4d6f 636b   metadata = Mock
-0001c580: 2829 0a20 2020 2020 2020 206d 6574 6164  ().        metad
-0001c590: 6174 612e 636f 6c75 6d6e 7320 3d20 7b27  ata.columns = {'
-0001c5a0: 6127 3a20 312c 2027 6227 3a20 327d 0a0a  a': 1, 'b': 2}..
-0001c5b0: 2020 2020 2020 2020 2320 5275 6e0a 2020          # Run.  
-0001c5c0: 2020 2020 2020 5363 616c 6172 5261 6e67        ScalarRang
-0001c5d0: 652e 5f76 616c 6964 6174 655f 6d65 7461  e._validate_meta
-0001c5e0: 6461 7461 5f63 6f6c 756d 6e73 286d 6574  data_columns(met
-0001c5f0: 6164 6174 612c 2063 6f6c 756d 6e5f 6e61  adata, column_na
-0001c600: 6d65 3d27 6127 290a 0a20 2020 2064 6566  me='a')..    def
-0001c610: 2074 6573 745f 5f76 616c 6964 6174 655f   test__validate_
-0001c620: 6d65 7461 6461 7461 5f63 6f6c 756d 6e73  metadata_columns
-0001c630: 5f72 6169 7365 735f 6572 726f 7228 7365  _raises_error(se
-0001c640: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-0001c650: 5465 7374 2074 6865 2060 605f 7661 6c69  Test the ``_vali
-0001c660: 6461 7465 5f6d 6574 6164 6174 615f 636f  date_metadata_co
-0001c670: 6c75 6d6e 7360 6020 6d65 7468 6f64 2773  lumns`` method's
-0001c680: 2065 7272 6f72 2063 6f6e 6469 7469 6f6e   error condition
-0001c690: 2e0a 0a20 2020 2020 2020 2049 6620 636f  ...        If co
-0001c6a0: 6c75 6d6e 5f6e 616d 6520 6973 206e 6f74  lumn_name is not
-0001c6b0: 2069 6e20 7468 6520 6d65 7461 6461 7461   in the metadata
-0001c6c0: 2c20 616e 2065 7272 6f72 2073 686f 756c  , an error shoul
-0001c6d0: 6420 6265 2072 6169 7365 642e 0a0a 2020  d be raised...  
-0001c6e0: 2020 2020 2020 496e 7075 743a 0a20 2020        Input:.   
-0001c6f0: 2020 2020 2020 2020 202d 2063 6f6c 756d           - colum
-0001c700: 6e5f 6e61 6d65 2074 6861 7420 6973 206e  n_name that is n
-0001c710: 6f74 2069 6e20 7468 6520 6d65 7461 6461  ot in the metada
-0001c720: 7461 2e0a 0a20 2020 2020 2020 2053 6964  ta...        Sid
-0001c730: 6520 6566 6665 6374 3a0a 2020 2020 2020  e effect:.      
-0001c740: 2020 2020 2020 2d20 436f 6e73 7472 6169        - Constrai
-0001c750: 6e74 4d65 7461 6461 7461 4572 726f 7220  ntMetadataError 
-0001c760: 7368 6f75 6c64 2062 6520 7261 6973 6564  should be raised
-0001c770: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-0001c780: 2020 2020 2020 2320 5365 7475 700a 2020        # Setup.  
-0001c790: 2020 2020 2020 6d65 7461 6461 7461 203d        metadata =
-0001c7a0: 204d 6f63 6b28 290a 2020 2020 2020 2020   Mock().        
-0001c7b0: 6d65 7461 6461 7461 2e63 6f6c 756d 6e73  metadata.columns
-0001c7c0: 203d 207b 2761 273a 2031 2c20 2762 273a   = {'a': 1, 'b':
-0001c7d0: 2032 7d0a 0a20 2020 2020 2020 2023 2052   2}..        # R
-0001c7e0: 756e 0a20 2020 2020 2020 2065 7272 6f72  un.        error
-0001c7f0: 5f6d 6573 7361 6765 203d 2072 652e 6573  _message = re.es
-0001c800: 6361 7065 280a 2020 2020 2020 2020 2020  cape(.          
-0001c810: 2020 2741 2053 6361 6c61 7252 616e 6765    'A ScalarRange
-0001c820: 2063 6f6e 7374 7261 696e 7420 6973 2062   constraint is b
-0001c830: 6569 6e67 2061 7070 6c69 6564 2074 6f20  eing applied to 
-0001c840: 696e 7661 6c69 6420 636f 6c75 6d6e 206e  invalid column n
-0001c850: 616d 6573 2027 0a20 2020 2020 2020 2020  ames '.         
-0001c860: 2020 2022 7b27 6327 7d2e 2054 6865 2063     "{'c'}. The c
-0001c870: 6f6c 756d 6e73 206d 7573 7420 6578 6973  olumns must exis
-0001c880: 7420 696e 2074 6865 2074 6162 6c65 2e22  t in the table."
-0001c890: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-0001c8a0: 2020 2077 6974 6820 7079 7465 7374 2e72     with pytest.r
-0001c8b0: 6169 7365 7328 436f 6e73 7472 6169 6e74  aises(Constraint
-0001c8c0: 4d65 7461 6461 7461 4572 726f 722c 206d  MetadataError, m
-0001c8d0: 6174 6368 3d65 7272 6f72 5f6d 6573 7361  atch=error_messa
-0001c8e0: 6765 293a 0a20 2020 2020 2020 2020 2020  ge):.           
-0001c8f0: 2053 6361 6c61 7252 616e 6765 2e5f 7661   ScalarRange._va
-0001c900: 6c69 6461 7465 5f6d 6574 6164 6174 615f  lidate_metadata_
-0001c910: 636f 6c75 6d6e 7328 6d65 7461 6461 7461  columns(metadata
-0001c920: 2c20 636f 6c75 6d6e 5f6e 616d 653d 2763  , column_name='c
-0001c930: 2729 0a0a 2020 2020 6465 6620 7465 7374  ')..    def test
-0001c940: 5f5f 7661 6c69 6461 7465 5f6d 6574 6164  __validate_metad
-0001c950: 6174 615f 7370 6563 6966 6963 5f74 6f5f  ata_specific_to_
-0001c960: 636f 6e73 7472 6169 6e74 5f6e 756d 6572  constraint_numer
-0001c970: 6963 616c 2873 656c 6629 3a0a 2020 2020  ical(self):.    
-0001c980: 2020 2020 2222 2254 6573 7420 7468 6520      """Test the 
-0001c990: 6060 5f76 616c 6964 6174 655f 6d65 7461  ``_validate_meta
-0001c9a0: 6461 7461 5f73 7065 6369 6669 635f 746f  data_specific_to
-0001c9b0: 5f63 6f6e 7374 7261 696e 7460 6020 6d65  _constraint`` me
-0001c9c0: 7468 6f64 2e0a 0a20 2020 2020 2020 2049  thod...        I
-0001c9d0: 6620 7468 6520 636f 6c75 6d6e 5f6e 616d  f the column_nam
-0001c9e0: 6520 6861 7320 616e 2073 6474 7970 6520  e has an sdtype 
-0001c9f0: 6f66 206e 756d 6572 6963 616c 2c20 616e  of numerical, an
-0001ca00: 6420 7468 6520 6869 6768 5f76 616c 7565  d the high_value
-0001ca10: 0a20 2020 2020 2020 2061 6e64 206c 6f77  .        and low
-0001ca20: 5f76 616c 7565 2061 7265 2069 6e74 7320  _value are ints 
-0001ca30: 6f72 2066 6c6f 6174 732c 2074 6865 6e20  or floats, then 
-0001ca40: 6e6f 2065 7272 6f72 2073 686f 756c 6420  no error should 
-0001ca50: 6265 2072 6169 7365 642e 0a0a 2020 2020  be raised...    
-0001ca60: 2020 2020 5365 7475 703a 0a20 2020 2020      Setup:.     
-0001ca70: 2020 2020 2020 202d 204d 6574 6164 6174         - Metadat
-0001ca80: 6120 7769 7468 2074 6865 2073 6474 7970  a with the sdtyp
-0001ca90: 6520 7365 7420 746f 206e 756d 6572 6963  e set to numeric
-0001caa0: 616c 2e0a 0a20 2020 2020 2020 2049 6e70  al...        Inp
-0001cab0: 7574 3a0a 2020 2020 2020 2020 2020 2020  ut:.            
-0001cac0: 2d20 5468 6520 636f 6c75 6d6e 206e 616d  - The column nam
-0001cad0: 6520 616e 6420 626f 7468 2068 6967 685f  e and both high_
-0001cae0: 7661 6c75 6520 616e 6420 6c6f 775f 7661  value and low_va
-0001caf0: 6c75 6520 7365 7420 746f 2061 206e 756d  lue set to a num
-0001cb00: 6265 722e 0a20 2020 2020 2020 2022 2222  ber..        """
-0001cb10: 0a20 2020 2020 2020 2023 2053 6574 7570  .        # Setup
-0001cb20: 0a20 2020 2020 2020 206d 6574 6164 6174  .        metadat
-0001cb30: 6120 3d20 4d6f 636b 2829 0a20 2020 2020  a = Mock().     
-0001cb40: 2020 206d 6574 6164 6174 612e 636f 6c75     metadata.colu
-0001cb50: 6d6e 7320 3d20 7b27 6127 3a20 7b27 7364  mns = {'a': {'sd
-0001cb60: 7479 7065 273a 2027 6e75 6d65 7269 6361  type': 'numerica
-0001cb70: 6c27 7d7d 0a0a 2020 2020 2020 2020 2320  l'}}..        # 
-0001cb80: 5275 6e0a 2020 2020 2020 2020 5363 616c  Run.        Scal
-0001cb90: 6172 5261 6e67 652e 5f76 616c 6964 6174  arRange._validat
-0001cba0: 655f 6d65 7461 6461 7461 5f73 7065 6369  e_metadata_speci
-0001cbb0: 6669 635f 746f 5f63 6f6e 7374 7261 696e  fic_to_constrain
-0001cbc0: 7428 0a20 2020 2020 2020 2020 2020 206d  t(.            m
-0001cbd0: 6574 6164 6174 612c 0a20 2020 2020 2020  etadata,.       
-0001cbe0: 2020 2020 2063 6f6c 756d 6e5f 6e61 6d65       column_name
-0001cbf0: 3d27 6127 2c0a 2020 2020 2020 2020 2020  ='a',.          
-0001cc00: 2020 6869 6768 5f76 616c 7565 3d31 302c    high_value=10,
-0001cc10: 0a20 2020 2020 2020 2020 2020 206c 6f77  .            low
-0001cc20: 5f76 616c 7565 3d35 0a20 2020 2020 2020  _value=5.       
-0001cc30: 2029 0a0a 2020 2020 6465 6620 7465 7374   )..    def test
-0001cc40: 5f5f 7661 6c69 6461 7465 5f6d 6574 6164  __validate_metad
-0001cc50: 6174 615f 7370 6563 6966 6963 5f74 6f5f  ata_specific_to_
-0001cc60: 636f 6e73 7472 6169 6e74 5f6e 756d 6572  constraint_numer
-0001cc70: 6963 616c 5f68 6967 685f 6e6f 745f 6e75  ical_high_not_nu
-0001cc80: 6d65 7269 6361 6c5f 6572 726f 7228 7365  merical_error(se
-0001cc90: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-0001cca0: 5465 7374 2074 6865 2060 605f 7661 6c69  Test the ``_vali
-0001ccb0: 6461 7465 5f6d 6574 6164 6174 615f 7370  date_metadata_sp
-0001ccc0: 6563 6966 6963 5f74 6f5f 636f 6e73 7472  ecific_to_constr
-0001ccd0: 6169 6e74 6060 206d 6574 686f 642e 0a0a  aint`` method...
-0001cce0: 2020 2020 2020 2020 4966 2074 6865 2063          If the c
-0001ccf0: 6f6c 756d 6e5f 6e61 6d65 2068 6173 2061  olumn_name has a
-0001cd00: 6e20 7364 7479 7065 206f 6620 6e75 6d65  n sdtype of nume
-0001cd10: 7269 6361 6c2c 2061 6e64 2074 6865 2068  rical, and the h
-0001cd20: 6967 685f 7661 6c75 650a 2020 2020 2020  igh_value.      
-0001cd30: 2020 6973 206e 6f74 2061 6e20 696e 7420    is not an int 
-0001cd40: 6f72 2066 6c6f 6174 2c20 7468 656e 2061  or float, then a
-0001cd50: 6e20 6572 726f 7220 7368 6f75 6c64 2062  n error should b
-0001cd60: 6520 7261 6973 6564 2e0a 0a20 2020 2020  e raised...     
-0001cd70: 2020 2053 6574 7570 3a0a 2020 2020 2020     Setup:.      
-0001cd80: 2020 2020 2020 2d20 4d65 7461 6461 7461        - Metadata
-0001cd90: 2077 6974 6820 7468 6520 7364 7479 7065   with the sdtype
-0001cda0: 2073 6574 2074 6f20 6e75 6d65 7269 6361   set to numerica
-0001cdb0: 6c2e 0a0a 2020 2020 2020 2020 496e 7075  l...        Inpu
-0001cdc0: 743a 0a20 2020 2020 2020 2020 2020 202d  t:.            -
-0001cdd0: 2054 6865 2063 6f6c 756d 6e20 6e61 6d65   The column name
-0001cde0: 2c20 6c6f 775f 7661 6c75 6520 7365 7420  , low_value set 
-0001cdf0: 746f 2061 206e 756d 6265 7220 616e 6420  to a number and 
-0001ce00: 6869 6768 5f76 616c 7565 2073 6574 2074  high_value set t
-0001ce10: 6f20 6120 7374 7269 6e67 2e0a 2020 2020  o a string..    
-0001ce20: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0001ce30: 2320 5365 7475 700a 2020 2020 2020 2020  # Setup.        
-0001ce40: 6d65 7461 6461 7461 203d 204d 6f63 6b28  metadata = Mock(
-0001ce50: 290a 2020 2020 2020 2020 6d65 7461 6461  ).        metada
-0001ce60: 7461 2e63 6f6c 756d 6e73 203d 207b 2761  ta.columns = {'a
-0001ce70: 273a 207b 2773 6474 7970 6527 3a20 276e  ': {'sdtype': 'n
-0001ce80: 756d 6572 6963 616c 277d 7d0a 0a20 2020  umerical'}}..   
-0001ce90: 2020 2020 2023 2052 756e 0a20 2020 2020       # Run.     
-0001cea0: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
-0001ceb0: 203d 2022 426f 7468 2027 6869 6768 5f76   = "Both 'high_v
-0001cec0: 616c 7565 2720 616e 6420 276c 6f77 5f76  alue' and 'low_v
-0001ced0: 616c 7565 2720 6d75 7374 2062 6520 696e  alue' must be in
-0001cee0: 7473 206f 7220 666c 6f61 7473 220a 2020  ts or floats".  
-0001cef0: 2020 2020 2020 7769 7468 2070 7974 6573        with pytes
-0001cf00: 742e 7261 6973 6573 2843 6f6e 7374 7261  t.raises(Constra
-0001cf10: 696e 744d 6574 6164 6174 6145 7272 6f72  intMetadataError
-0001cf20: 2c20 6d61 7463 683d 6572 726f 725f 6d65  , match=error_me
-0001cf30: 7373 6167 6529 3a0a 2020 2020 2020 2020  ssage):.        
-0001cf40: 2020 2020 5363 616c 6172 5261 6e67 652e      ScalarRange.
-0001cf50: 5f76 616c 6964 6174 655f 6d65 7461 6461  _validate_metada
-0001cf60: 7461 5f73 7065 6369 6669 635f 746f 5f63  ta_specific_to_c
-0001cf70: 6f6e 7374 7261 696e 7428 0a20 2020 2020  onstraint(.     
-0001cf80: 2020 2020 2020 2020 2020 206d 6574 6164             metad
-0001cf90: 6174 612c 0a20 2020 2020 2020 2020 2020  ata,.           
-0001cfa0: 2020 2020 2063 6f6c 756d 6e5f 6e61 6d65       column_name
-0001cfb0: 3d27 6127 2c0a 2020 2020 2020 2020 2020  ='a',.          
-0001cfc0: 2020 2020 2020 6c6f 775f 7661 6c75 653d        low_value=
-0001cfd0: 352c 0a20 2020 2020 2020 2020 2020 2020  5,.             
-0001cfe0: 2020 2068 6967 685f 7661 6c75 653d 2731     high_value='1
-0001cff0: 3027 0a20 2020 2020 2020 2020 2020 2029  0'.            )
-0001d000: 0a0a 2020 2020 6465 6620 7465 7374 5f5f  ..    def test__
-0001d010: 7661 6c69 6461 7465 5f6d 6574 6164 6174  validate_metadat
-0001d020: 615f 7370 6563 6966 6963 5f74 6f5f 636f  a_specific_to_co
-0001d030: 6e73 7472 6169 6e74 5f6e 756d 6572 6963  nstraint_numeric
-0001d040: 616c 5f6c 6f77 5f6e 6f74 5f6e 756d 6572  al_low_not_numer
-0001d050: 6963 616c 5f65 7272 6f72 2873 656c 6629  ical_error(self)
-0001d060: 3a0a 2020 2020 2020 2020 2222 2254 6573  :.        """Tes
-0001d070: 7420 7468 6520 6060 5f76 616c 6964 6174  t the ``_validat
-0001d080: 655f 6d65 7461 6461 7461 5f73 7065 6369  e_metadata_speci
-0001d090: 6669 635f 746f 5f63 6f6e 7374 7261 696e  fic_to_constrain
-0001d0a0: 7460 6020 6d65 7468 6f64 2e0a 0a20 2020  t`` method...   
-0001d0b0: 2020 2020 2049 6620 7468 6520 636f 6c75       If the colu
-0001d0c0: 6d6e 5f6e 616d 6520 6861 7320 616e 2073  mn_name has an s
-0001d0d0: 6474 7970 6520 6f66 206e 756d 6572 6963  dtype of numeric
-0001d0e0: 616c 2c20 616e 6420 7468 6520 6c6f 775f  al, and the low_
-0001d0f0: 7661 6c75 650a 2020 2020 2020 2020 6973  value.        is
-0001d100: 206e 6f74 2061 6e20 696e 7420 6f72 2066   not an int or f
-0001d110: 6c6f 6174 2c20 7468 656e 2061 6e20 6572  loat, then an er
-0001d120: 726f 7220 7368 6f75 6c64 2062 6520 7261  ror should be ra
-0001d130: 6973 6564 2e0a 0a20 2020 2020 2020 2053  ised...        S
-0001d140: 6574 7570 3a0a 2020 2020 2020 2020 2020  etup:.          
-0001d150: 2020 2d20 4d65 7461 6461 7461 2077 6974    - Metadata wit
-0001d160: 6820 7468 6520 7364 7479 7065 2073 6574  h the sdtype set
-0001d170: 2074 6f20 6e75 6d65 7269 6361 6c2e 0a0a   to numerical...
-0001d180: 2020 2020 2020 2020 496e 7075 743a 0a20          Input:. 
-0001d190: 2020 2020 2020 2020 2020 202d 2054 6865             - The
-0001d1a0: 2063 6f6c 756d 6e20 6e61 6d65 2c20 6869   column name, hi
-0001d1b0: 6768 5f76 616c 7565 2073 6574 2074 6f20  gh_value set to 
-0001d1c0: 6120 6e75 6d62 6572 2061 6e64 206c 6f77  a number and low
-0001d1d0: 5f76 616c 7565 2073 6574 2074 6f20 6120  _value set to a 
-0001d1e0: 7374 7269 6e67 2e0a 2020 2020 2020 2020  string..        
-0001d1f0: 2222 220a 2020 2020 2020 2020 2320 5365  """.        # Se
-0001d200: 7475 700a 2020 2020 2020 2020 6d65 7461  tup.        meta
-0001d210: 6461 7461 203d 204d 6f63 6b28 290a 2020  data = Mock().  
-0001d220: 2020 2020 2020 6d65 7461 6461 7461 2e63        metadata.c
-0001d230: 6f6c 756d 6e73 203d 207b 2761 273a 207b  olumns = {'a': {
-0001d240: 2773 6474 7970 6527 3a20 276e 756d 6572  'sdtype': 'numer
-0001d250: 6963 616c 277d 7d0a 0a20 2020 2020 2020  ical'}}..       
-0001d260: 2023 2052 756e 0a20 2020 2020 2020 2065   # Run.        e
-0001d270: 7272 6f72 5f6d 6573 7361 6765 203d 2022  rror_message = "
-0001d280: 426f 7468 2027 6869 6768 5f76 616c 7565  Both 'high_value
-0001d290: 2720 616e 6420 276c 6f77 5f76 616c 7565  ' and 'low_value
-0001d2a0: 2720 6d75 7374 2062 6520 696e 7473 206f  ' must be ints o
-0001d2b0: 7220 666c 6f61 7473 220a 2020 2020 2020  r floats".      
-0001d2c0: 2020 7769 7468 2070 7974 6573 742e 7261    with pytest.ra
-0001d2d0: 6973 6573 2843 6f6e 7374 7261 696e 744d  ises(ConstraintM
-0001d2e0: 6574 6164 6174 6145 7272 6f72 2c20 6d61  etadataError, ma
-0001d2f0: 7463 683d 6572 726f 725f 6d65 7373 6167  tch=error_messag
-0001d300: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
-0001d310: 5363 616c 6172 5261 6e67 652e 5f76 616c  ScalarRange._val
-0001d320: 6964 6174 655f 6d65 7461 6461 7461 5f73  idate_metadata_s
-0001d330: 7065 6369 6669 635f 746f 5f63 6f6e 7374  pecific_to_const
-0001d340: 7261 696e 7428 0a20 2020 2020 2020 2020  raint(.         
-0001d350: 2020 2020 2020 206d 6574 6164 6174 612c         metadata,
-0001d360: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001d370: 2063 6f6c 756d 6e5f 6e61 6d65 3d27 6127   column_name='a'
-0001d380: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001d390: 2020 6c6f 775f 7661 6c75 653d 2735 272c    low_value='5',
-0001d3a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001d3b0: 2068 6967 685f 7661 6c75 653d 3130 0a20   high_value=10. 
-0001d3c0: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-0001d3d0: 2020 4070 6174 6368 2827 7364 762e 636f    @patch('sdv.co
-0001d3e0: 6e73 7472 6169 6e74 732e 7461 6275 6c61  nstraints.tabula
-0001d3f0: 722e 6d61 7463 6865 735f 6461 7465 7469  r.matches_dateti
-0001d400: 6d65 5f66 6f72 6d61 7427 290a 2020 2020  me_format').    
-0001d410: 6465 6620 7465 7374 5f5f 7661 6c69 6461  def test__valida
-0001d420: 7465 5f6d 6574 6164 6174 615f 7370 6563  te_metadata_spec
-0001d430: 6966 6963 5f74 6f5f 636f 6e73 7472 6169  ific_to_constrai
-0001d440: 6e74 5f64 6174 6574 696d 6528 7365 6c66  nt_datetime(self
-0001d450: 2c20 6461 7465 7469 6d65 5f66 6f72 6d61  , datetime_forma
-0001d460: 745f 6d6f 636b 293a 0a20 2020 2020 2020  t_mock):.       
-0001d470: 2022 2222 5465 7374 2074 6865 2060 605f   """Test the ``_
-0001d480: 7661 6c69 6461 7465 5f6d 6574 6164 6174  validate_metadat
-0001d490: 615f 7370 6563 6966 6963 5f74 6f5f 636f  a_specific_to_co
-0001d4a0: 6e73 7472 6169 6e74 6060 206d 6574 686f  nstraint`` metho
-0001d4b0: 642e 0a0a 2020 2020 2020 2020 4966 2074  d...        If t
-0001d4c0: 6865 2063 6f6c 756d 6e5f 6e61 6d65 2068  he column_name h
-0001d4d0: 6173 2061 6e20 7364 7479 7065 206f 6620  as an sdtype of 
-0001d4e0: 6461 7465 7469 6d65 2c20 616e 6420 626f  datetime, and bo
-0001d4f0: 7468 2074 6865 2068 6967 685f 7661 6c75  th the high_valu
-0001d500: 6520 616e 6420 6c6f 775f 7661 6c75 650a  e and low_value.
-0001d510: 2020 2020 2020 2020 6172 6520 6461 7465          are date
-0001d520: 7469 6d65 2073 7472 696e 6773 2074 6861  time strings tha
-0001d530: 7420 6d61 7463 6820 7468 6520 666f 726d  t match the form
-0001d540: 6174 2c20 7468 656e 206e 6f20 6572 726f  at, then no erro
-0001d550: 7220 7368 6f75 6c64 2062 6520 7261 6973  r should be rais
-0001d560: 6564 2e0a 0a20 2020 2020 2020 2053 6574  ed...        Set
-0001d570: 7570 3a0a 2020 2020 2020 2020 2020 2020  up:.            
-0001d580: 2d20 4d65 7461 6461 7461 2077 6974 6820  - Metadata with 
-0001d590: 7468 6520 7364 7479 7065 2073 6574 2074  the sdtype set t
-0001d5a0: 6f20 6461 7465 7469 6d65 2061 6e64 2061  o datetime and a
-0001d5b0: 2064 6174 6574 696d 655f 666f 726d 6174   datetime_format
-0001d5c0: 2e0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
-0001d5d0: 4d6f 636b 2074 6865 2060 606d 6174 6368  Mock the ``match
-0001d5e0: 6573 5f64 6174 6574 696d 655f 666f 726d  es_datetime_form
-0001d5f0: 6174 6060 2066 756e 6374 696f 6e20 746f  at`` function to
-0001d600: 2072 6574 7572 6e20 5472 7565 2e0a 0a20   return True... 
-0001d610: 2020 2020 2020 2049 6e70 7574 3a0a 2020         Input:.  
-0001d620: 2020 2020 2020 2020 2020 2d20 5468 6520            - The 
-0001d630: 636f 6c75 6d6e 206e 616d 6520 616e 6420  column name and 
-0001d640: 626f 7468 206c 6f77 5f76 616c 7565 2061  both low_value a
-0001d650: 6e64 2068 6967 685f 7661 6c75 6520 7365  nd high_value se
-0001d660: 7420 746f 2061 2064 6174 6574 696d 6520  t to a datetime 
-0001d670: 6f66 2074 6865 0a20 2020 2020 2020 2020  of the.         
-0001d680: 2020 2072 6967 6874 2066 6f72 6d61 742e     right format.
-0001d690: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0001d6a0: 2020 2020 2023 2053 6574 7570 0a20 2020       # Setup.   
-0001d6b0: 2020 2020 206d 6574 6164 6174 6120 3d20       metadata = 
-0001d6c0: 4d6f 636b 2829 0a20 2020 2020 2020 206d  Mock().        m
-0001d6d0: 6574 6164 6174 612e 636f 6c75 6d6e 7320  etadata.columns 
-0001d6e0: 3d20 7b27 6127 3a20 7b27 7364 7479 7065  = {'a': {'sdtype
-0001d6f0: 273a 2027 6461 7465 7469 6d65 272c 2027  ': 'datetime', '
-0001d700: 6461 7465 7469 6d65 5f66 6f72 6d61 7427  datetime_format'
-0001d710: 3a20 276d 2f64 2f79 277d 7d0a 2020 2020  : 'm/d/y'}}.    
-0001d720: 2020 2020 6461 7465 7469 6d65 5f66 6f72      datetime_for
-0001d730: 6d61 745f 6d6f 636b 2e72 6574 7572 6e5f  mat_mock.return_
-0001d740: 7661 6c75 6520 3d20 5472 7565 0a0a 2020  value = True..  
-0001d750: 2020 2020 2020 2320 5275 6e0a 2020 2020        # Run.    
-0001d760: 2020 2020 5363 616c 6172 5261 6e67 652e      ScalarRange.
-0001d770: 5f76 616c 6964 6174 655f 6d65 7461 6461  _validate_metada
-0001d780: 7461 5f73 7065 6369 6669 635f 746f 5f63  ta_specific_to_c
-0001d790: 6f6e 7374 7261 696e 7428 0a20 2020 2020  onstraint(.     
-0001d7a0: 2020 2020 2020 206d 6574 6164 6174 612c         metadata,
-0001d7b0: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
-0001d7c0: 756d 6e5f 6e61 6d65 3d27 6127 2c0a 2020  umn_name='a',.  
-0001d7d0: 2020 2020 2020 2020 2020 6c6f 775f 7661            low_va
-0001d7e0: 6c75 653d 2731 2f31 2f32 3032 3027 2c0a  lue='1/1/2020',.
-0001d7f0: 2020 2020 2020 2020 2020 2020 6869 6768              high
-0001d800: 5f76 616c 7565 3d27 312f 3330 2f32 3032  _value='1/30/202
-0001d810: 3027 0a20 2020 2020 2020 2029 0a0a 2020  0'.        )..  
-0001d820: 2020 4070 6174 6368 2827 7364 762e 636f    @patch('sdv.co
-0001d830: 6e73 7472 6169 6e74 732e 7461 6275 6c61  nstraints.tabula
-0001d840: 722e 6d61 7463 6865 735f 6461 7465 7469  r.matches_dateti
-0001d850: 6d65 5f66 6f72 6d61 7427 290a 2020 2020  me_format').    
-0001d860: 6465 6620 7465 7374 5f5f 7661 6c69 6461  def test__valida
-0001d870: 7465 5f6d 6574 6164 6174 615f 7370 6563  te_metadata_spec
-0001d880: 6966 6963 5f74 6f5f 636f 6e73 7472 6169  ific_to_constrai
-0001d890: 6e74 5f68 6967 685f 6461 7465 7469 6d65  nt_high_datetime
-0001d8a0: 5f65 7272 6f72 280a 2020 2020 2020 2020  _error(.        
-0001d8b0: 2020 2020 7365 6c66 2c20 6461 7465 7469      self, dateti
-0001d8c0: 6d65 5f66 6f72 6d61 745f 6d6f 636b 293a  me_format_mock):
-0001d8d0: 0a20 2020 2020 2020 2022 2222 5465 7374  .        """Test
-0001d8e0: 2074 6865 2060 605f 7661 6c69 6461 7465   the ``_validate
-0001d8f0: 5f6d 6574 6164 6174 615f 7370 6563 6966  _metadata_specif
-0001d900: 6963 5f74 6f5f 636f 6e73 7472 6169 6e74  ic_to_constraint
-0001d910: 6060 206d 6574 686f 642e 0a0a 2020 2020  `` method...    
-0001d920: 2020 2020 4966 2074 6865 2063 6f6c 756d      If the colum
-0001d930: 6e5f 6e61 6d65 2068 6173 2061 6e20 7364  n_name has an sd
-0001d940: 7479 7065 206f 6620 6461 7465 7469 6d65  type of datetime
-0001d950: 2c20 616e 6420 7468 6520 6869 6768 5f76  , and the high_v
-0001d960: 616c 7565 0a20 2020 2020 2020 2069 7320  alue.        is 
-0001d970: 6120 6461 7465 7469 6d65 2073 7472 696e  a datetime strin
-0001d980: 6720 7468 6174 2064 6f65 736e 2774 206d  g that doesn't m
-0001d990: 6174 6368 2074 6865 2066 6f72 6d61 742c  atch the format,
-0001d9a0: 2074 6865 6e20 616e 2065 7272 6f72 2073   then an error s
-0001d9b0: 686f 756c 6420 6265 2072 6169 7365 642e  hould be raised.
-0001d9c0: 0a0a 2020 2020 2020 2020 5365 7475 703a  ..        Setup:
-0001d9d0: 0a20 2020 2020 2020 2020 2020 202d 204d  .            - M
-0001d9e0: 6574 6164 6174 6120 7769 7468 2074 6865  etadata with the
-0001d9f0: 2073 6474 7970 6520 7365 7420 746f 2064   sdtype set to d
-0001da00: 6174 6574 696d 6520 616e 6420 6120 6461  atetime and a da
-0001da10: 7465 7469 6d65 5f66 6f72 6d61 742e 0a20  tetime_format.. 
-0001da20: 2020 2020 2020 2020 2020 202d 204d 6f63             - Moc
-0001da30: 6b20 7468 6520 6060 6d61 7463 6865 735f  k the ``matches_
-0001da40: 6461 7465 7469 6d65 5f66 6f72 6d61 7460  datetime_format`
-0001da50: 6020 6675 6e63 7469 6f6e 2074 6f20 7265  ` function to re
-0001da60: 7475 726e 2046 616c 7365 2c20 7468 656e  turn False, then
-0001da70: 2054 7275 652e 0a0a 2020 2020 2020 2020   True...        
-0001da80: 496e 7075 743a 0a20 2020 2020 2020 2020  Input:.         
-0001da90: 2020 202d 2054 6865 2063 6f6c 756d 6e20     - The column 
-0001daa0: 6e61 6d65 2c20 6120 6c6f 775f 7661 6c75  name, a low_valu
-0001dab0: 6520 7365 7420 746f 2061 2064 6174 6574  e set to a datet
-0001dac0: 696d 6520 6f66 2074 6865 2072 6967 6874  ime of the right
-0001dad0: 2066 6f72 6d61 7420 616e 640a 2020 2020   format and.    
-0001dae0: 2020 2020 2020 2020 6120 6869 6768 5f76          a high_v
-0001daf0: 616c 7565 2073 6574 2074 6f20 6120 6461  alue set to a da
-0001db00: 7465 7469 6d65 206f 6620 7468 6520 7772  tetime of the wr
-0001db10: 6f6e 6720 666f 726d 6174 2e0a 0a20 2020  ong format...   
-0001db20: 2020 2020 2053 6964 6520 6566 6665 6374       Side effect
-0001db30: 3a0a 2020 2020 2020 2020 2020 2020 2d20  :.            - 
-0001db40: 4120 436f 6e73 7472 6169 6e74 4d65 7461  A ConstraintMeta
-0001db50: 6461 7461 4572 726f 7220 7368 6f75 6c64  dataError should
-0001db60: 2062 6520 7261 6973 6564 2e0a 2020 2020   be raised..    
-0001db70: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0001db80: 2320 5365 7475 700a 2020 2020 2020 2020  # Setup.        
-0001db90: 6d65 7461 6461 7461 203d 204d 6f63 6b28  metadata = Mock(
-0001dba0: 290a 2020 2020 2020 2020 6d65 7461 6461  ).        metada
-0001dbb0: 7461 2e63 6f6c 756d 6e73 203d 207b 2761  ta.columns = {'a
-0001dbc0: 273a 207b 2773 6474 7970 6527 3a20 2764  ': {'sdtype': 'd
-0001dbd0: 6174 6574 696d 6527 2c20 2764 6174 6574  atetime', 'datet
-0001dbe0: 696d 655f 666f 726d 6174 273a 2027 6d2f  ime_format': 'm/
-0001dbf0: 642f 7927 7d7d 0a20 2020 2020 2020 2064  d/y'}}.        d
-0001dc00: 6174 6574 696d 655f 666f 726d 6174 5f6d  atetime_format_m
-0001dc10: 6f63 6b2e 7369 6465 5f65 6666 6563 7420  ock.side_effect 
-0001dc20: 3d20 5b46 616c 7365 2c20 5472 7565 5d0a  = [False, True].
-0001dc30: 0a20 2020 2020 2020 2023 2052 756e 0a20  .        # Run. 
-0001dc40: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
-0001dc50: 7361 6765 203d 2028 0a20 2020 2020 2020  sage = (.       
-0001dc60: 2020 2020 2022 426f 7468 2027 6869 6768       "Both 'high
-0001dc70: 5f76 616c 7565 2720 616e 6420 276c 6f77  _value' and 'low
-0001dc80: 5f76 616c 7565 2720 6d75 7374 2062 6520  _value' must be 
-0001dc90: 6120 6461 7465 7469 6d65 2073 7472 696e  a datetime strin
-0001dca0: 6720 6f66 2074 6865 2072 6967 6874 2066  g of the right f
-0001dcb0: 6f72 6d61 7422 0a20 2020 2020 2020 2029  ormat".        )
-0001dcc0: 0a20 2020 2020 2020 2077 6974 6820 7079  .        with py
-0001dcd0: 7465 7374 2e72 6169 7365 7328 436f 6e73  test.raises(Cons
-0001dce0: 7472 6169 6e74 4d65 7461 6461 7461 4572  traintMetadataEr
-0001dcf0: 726f 722c 206d 6174 6368 3d65 7272 6f72  ror, match=error
-0001dd00: 5f6d 6573 7361 6765 293a 0a20 2020 2020  _message):.     
-0001dd10: 2020 2020 2020 2053 6361 6c61 7252 616e         ScalarRan
-0001dd20: 6765 2e5f 7661 6c69 6461 7465 5f6d 6574  ge._validate_met
-0001dd30: 6164 6174 615f 7370 6563 6966 6963 5f74  adata_specific_t
-0001dd40: 6f5f 636f 6e73 7472 6169 6e74 280a 2020  o_constraint(.  
-0001dd50: 2020 2020 2020 2020 2020 2020 2020 6d65                me
-0001dd60: 7461 6461 7461 2c0a 2020 2020 2020 2020  tadata,.        
-0001dd70: 2020 2020 2020 2020 636f 6c75 6d6e 5f6e          column_n
-0001dd80: 616d 653d 2761 272c 0a20 2020 2020 2020  ame='a',.       
-0001dd90: 2020 2020 2020 2020 2068 6967 685f 7661           high_va
-0001dda0: 6c75 653d 2731 2f31 2f32 3031 3927 2c0a  lue='1/1/2019',.
-0001ddb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ddc0: 6c6f 775f 7661 6c75 653d 2731 2d31 2d32  low_value='1-1-2
-0001ddd0: 3032 3027 0a20 2020 2020 2020 2020 2020  020'.           
-0001dde0: 2029 0a0a 2020 2020 4070 6174 6368 2827   )..    @patch('
-0001ddf0: 7364 762e 636f 6e73 7472 6169 6e74 732e  sdv.constraints.
-0001de00: 7461 6275 6c61 722e 6d61 7463 6865 735f  tabular.matches_
-0001de10: 6461 7465 7469 6d65 5f66 6f72 6d61 7427  datetime_format'
-0001de20: 290a 2020 2020 6465 6620 7465 7374 5f5f  ).    def test__
-0001de30: 7661 6c69 6461 7465 5f6d 6574 6164 6174  validate_metadat
-0001de40: 615f 7370 6563 6966 6963 5f74 6f5f 636f  a_specific_to_co
-0001de50: 6e73 7472 6169 6e74 5f6c 6f77 5f64 6174  nstraint_low_dat
-0001de60: 6574 696d 655f 6572 726f 7228 0a20 2020  etime_error(.   
-0001de70: 2020 2020 2020 2020 2073 656c 662c 2064           self, d
-0001de80: 6174 6574 696d 655f 666f 726d 6174 5f6d  atetime_format_m
-0001de90: 6f63 6b29 3a0a 2020 2020 2020 2020 2222  ock):.        ""
-0001dea0: 2254 6573 7420 7468 6520 6060 5f76 616c  "Test the ``_val
-0001deb0: 6964 6174 655f 6d65 7461 6461 7461 5f73  idate_metadata_s
-0001dec0: 7065 6369 6669 635f 746f 5f63 6f6e 7374  pecific_to_const
-0001ded0: 7261 696e 7460 6020 6d65 7468 6f64 2e0a  raint`` method..
-0001dee0: 0a20 2020 2020 2020 2049 6620 7468 6520  .        If the 
-0001def0: 636f 6c75 6d6e 5f6e 616d 6520 6861 7320  column_name has 
-0001df00: 616e 2073 6474 7970 6520 6f66 2064 6174  an sdtype of dat
-0001df10: 6574 696d 652c 2061 6e64 2074 6865 206c  etime, and the l
-0001df20: 6f77 5f76 616c 7565 0a20 2020 2020 2020  ow_value.       
-0001df30: 2069 7320 6120 6461 7465 7469 6d65 2073   is a datetime s
-0001df40: 7472 696e 6720 7468 6174 2064 6f65 736e  tring that doesn
-0001df50: 2774 206d 6174 6368 2074 6865 2066 6f72  't match the for
-0001df60: 6d61 742c 2074 6865 6e20 616e 2065 7272  mat, then an err
-0001df70: 6f72 2073 686f 756c 6420 6265 2072 6169  or should be rai
-0001df80: 7365 642e 0a0a 2020 2020 2020 2020 5365  sed...        Se
-0001df90: 7475 703a 0a20 2020 2020 2020 2020 2020  tup:.           
-0001dfa0: 202d 204d 6574 6164 6174 6120 7769 7468   - Metadata with
-0001dfb0: 2074 6865 2073 6474 7970 6520 7365 7420   the sdtype set 
-0001dfc0: 746f 2064 6174 6574 696d 6520 616e 6420  to datetime and 
-0001dfd0: 6120 6461 7465 7469 6d65 5f66 6f72 6d61  a datetime_forma
-0001dfe0: 742e 0a20 2020 2020 2020 2020 2020 202d  t..            -
-0001dff0: 204d 6f63 6b20 7468 6520 6060 6d61 7463   Mock the ``matc
-0001e000: 6865 735f 6461 7465 7469 6d65 5f66 6f72  hes_datetime_for
-0001e010: 6d61 7460 6020 6675 6e63 7469 6f6e 2074  mat`` function t
-0001e020: 6f20 7265 7475 726e 2054 7275 652c 2074  o return True, t
-0001e030: 6865 6e20 4661 6c73 652e 0a0a 2020 2020  hen False...    
-0001e040: 2020 2020 496e 7075 743a 0a20 2020 2020      Input:.     
-0001e050: 2020 2020 2020 202d 2054 6865 2063 6f6c         - The col
-0001e060: 756d 6e20 6e61 6d65 2c20 6120 6c6f 775f  umn name, a low_
-0001e070: 7661 6c75 6520 7365 7420 746f 2061 2064  value set to a d
-0001e080: 6174 6574 696d 6520 6f66 2074 6865 2077  atetime of the w
-0001e090: 726f 6e67 2066 6f72 6d61 7420 616e 640a  rong format and.
-0001e0a0: 2020 2020 2020 2020 2020 2020 6120 6869              a hi
-0001e0b0: 6768 5f76 616c 7565 2073 6574 2074 6f20  gh_value set to 
-0001e0c0: 6120 6461 7465 7469 6d65 206f 6620 7468  a datetime of th
-0001e0d0: 6520 7269 6768 7420 666f 726d 6174 2e0a  e right format..
-0001e0e0: 0a20 2020 2020 2020 2053 6964 6520 6566  .        Side ef
-0001e0f0: 6665 6374 3a0a 2020 2020 2020 2020 2020  fect:.          
-0001e100: 2020 2d20 4120 436f 6e73 7472 6169 6e74    - A Constraint
-0001e110: 4d65 7461 6461 7461 4572 726f 7220 7368  MetadataError sh
-0001e120: 6f75 6c64 2062 6520 7261 6973 6564 2e0a  ould be raised..
-0001e130: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0001e140: 2020 2020 2320 5365 7475 700a 2020 2020      # Setup.    
-0001e150: 2020 2020 6d65 7461 6461 7461 203d 204d      metadata = M
-0001e160: 6f63 6b28 290a 2020 2020 2020 2020 6d65  ock().        me
-0001e170: 7461 6461 7461 2e63 6f6c 756d 6e73 203d  tadata.columns =
-0001e180: 207b 2761 273a 207b 2773 6474 7970 6527   {'a': {'sdtype'
-0001e190: 3a20 2764 6174 6574 696d 6527 2c20 2764  : 'datetime', 'd
-0001e1a0: 6174 6574 696d 655f 666f 726d 6174 273a  atetime_format':
-0001e1b0: 2027 6d2f 642f 7927 7d7d 0a20 2020 2020   'm/d/y'}}.     
-0001e1c0: 2020 2064 6174 6574 696d 655f 666f 726d     datetime_form
-0001e1d0: 6174 5f6d 6f63 6b2e 7369 6465 5f65 6666  at_mock.side_eff
-0001e1e0: 6563 7420 3d20 5b54 7275 652c 2046 616c  ect = [True, Fal
-0001e1f0: 7365 5d0a 0a20 2020 2020 2020 2023 2052  se]..        # R
-0001e200: 756e 0a20 2020 2020 2020 2065 7272 6f72  un.        error
-0001e210: 5f6d 6573 7361 6765 203d 2028 0a20 2020  _message = (.   
-0001e220: 2020 2020 2020 2020 2022 426f 7468 2027           "Both '
-0001e230: 6869 6768 5f76 616c 7565 2720 616e 6420  high_value' and 
-0001e240: 276c 6f77 5f76 616c 7565 2720 6d75 7374  'low_value' must
-0001e250: 2062 6520 6120 6461 7465 7469 6d65 2073   be a datetime s
-0001e260: 7472 696e 6720 6f66 2074 6865 2072 6967  tring of the rig
-0001e270: 6874 2066 6f72 6d61 7422 0a20 2020 2020  ht format".     
-0001e280: 2020 2029 0a20 2020 2020 2020 2077 6974     ).        wit
-0001e290: 6820 7079 7465 7374 2e72 6169 7365 7328  h pytest.raises(
-0001e2a0: 436f 6e73 7472 6169 6e74 4d65 7461 6461  ConstraintMetada
-0001e2b0: 7461 4572 726f 722c 206d 6174 6368 3d65  taError, match=e
-0001e2c0: 7272 6f72 5f6d 6573 7361 6765 293a 0a20  rror_message):. 
-0001e2d0: 2020 2020 2020 2020 2020 2053 6361 6c61             Scala
-0001e2e0: 7252 616e 6765 2e5f 7661 6c69 6461 7465  rRange._validate
-0001e2f0: 5f6d 6574 6164 6174 615f 7370 6563 6966  _metadata_specif
-0001e300: 6963 5f74 6f5f 636f 6e73 7472 6169 6e74  ic_to_constraint
-0001e310: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0001e320: 2020 6d65 7461 6461 7461 2c0a 2020 2020    metadata,.    
-0001e330: 2020 2020 2020 2020 2020 2020 636f 6c75              colu
-0001e340: 6d6e 5f6e 616d 653d 2761 272c 0a20 2020  mn_name='a',.   
-0001e350: 2020 2020 2020 2020 2020 2020 2068 6967               hig
-0001e360: 685f 7661 6c75 653d 2731 2d31 2d32 3031  h_value='1-1-201
-0001e370: 3927 2c0a 2020 2020 2020 2020 2020 2020  9',.            
-0001e380: 2020 2020 6c6f 775f 7661 6c75 653d 2731      low_value='1
-0001e390: 2f31 2f32 3032 3027 0a20 2020 2020 2020  /1/2020'.       
-0001e3a0: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
-0001e3b0: 7465 7374 5f5f 7661 6c69 6461 7465 5f6d  test__validate_m
-0001e3c0: 6574 6164 6174 615f 7370 6563 6966 6963  etadata_specific
-0001e3d0: 5f74 6f5f 636f 6e73 7472 6169 6e74 5f62  _to_constraint_b
-0001e3e0: 6164 5f74 7970 6528 7365 6c66 293a 0a20  ad_type(self):. 
-0001e3f0: 2020 2020 2020 2022 2222 5465 7374 2074         """Test t
-0001e400: 6865 2060 605f 7661 6c69 6461 7465 5f6d  he ``_validate_m
-0001e410: 6574 6164 6174 615f 7370 6563 6966 6963  etadata_specific
-0001e420: 5f74 6f5f 636f 6e73 7472 6169 6e74 6060  _to_constraint``
-0001e430: 206d 6574 686f 642e 0a0a 2020 2020 2020   method...      
-0001e440: 2020 4966 2074 6865 2063 6f6c 756d 6e5f    If the column_
-0001e450: 6e61 6d65 2068 6173 2061 6e20 7364 7479  name has an sdty
-0001e460: 7065 2074 6861 7420 6973 206e 6f74 2061  pe that is not a
-0001e470: 2064 6174 6574 696d 6520 7374 7269 6e67   datetime string
-0001e480: 2c20 696e 7420 6f72 0a20 2020 2020 2020  , int or.       
-0001e490: 2066 6c6f 6174 2074 6865 6e20 616e 2065   float then an e
-0001e4a0: 7272 6f72 2073 686f 756c 6420 6265 2072  rror should be r
-0001e4b0: 6169 7365 642e 0a0a 2020 2020 2020 2020  aised...        
-0001e4c0: 5365 7475 703a 0a20 2020 2020 2020 2020  Setup:.         
-0001e4d0: 2020 202d 204d 6574 6164 6174 6120 7769     - Metadata wi
-0001e4e0: 7468 2074 6865 2073 6474 7970 6520 7365  th the sdtype se
-0001e4f0: 7420 746f 2063 6174 6567 6f72 6963 616c  t to categorical
-0001e500: 2e0a 0a20 2020 2020 2020 2049 6e70 7574  ...        Input
-0001e510: 3a0a 2020 2020 2020 2020 2020 2020 2d20  :.            - 
-0001e520: 5468 6520 636f 6c75 6d6e 206e 616d 652c  The column name,
-0001e530: 2072 656c 6174 696f 6e20 616e 6420 7661   relation and va
-0001e540: 6c75 652e 0a0a 2020 2020 2020 2020 5369  lue...        Si
-0001e550: 6465 2065 6666 6563 743a 0a20 2020 2020  de effect:.     
-0001e560: 2020 2020 2020 202d 2041 2043 6f6e 7374         - A Const
-0001e570: 7261 696e 744d 6574 6164 6174 6145 7272  raintMetadataErr
-0001e580: 6f72 2073 686f 756c 6420 6265 2072 6169  or should be rai
-0001e590: 7365 642e 0a20 2020 2020 2020 2022 2222  sed..        """
-0001e5a0: 0a20 2020 2020 2020 2023 2053 6574 7570  .        # Setup
-0001e5b0: 0a20 2020 2020 2020 206d 6574 6164 6174  .        metadat
-0001e5c0: 6120 3d20 4d6f 636b 2829 0a20 2020 2020  a = Mock().     
-0001e5d0: 2020 206d 6574 6164 6174 612e 636f 6c75     metadata.colu
-0001e5e0: 6d6e 7320 3d20 7b27 6127 3a20 7b27 7364  mns = {'a': {'sd
-0001e5f0: 7479 7065 273a 2027 6361 7465 676f 7269  type': 'categori
-0001e600: 6361 6c27 7d7d 0a0a 2020 2020 2020 2020  cal'}}..        
-0001e610: 2320 5275 6e0a 2020 2020 2020 2020 6572  # Run.        er
-0001e620: 726f 725f 6d65 7373 6167 6520 3d20 280a  ror_message = (.
-0001e630: 2020 2020 2020 2020 2020 2020 2741 2053              'A S
-0001e640: 6361 6c61 7252 616e 6765 2063 6f6e 7374  calarRange const
-0001e650: 7261 696e 7420 6973 2062 6569 6e67 2061  raint is being a
-0001e660: 7070 6c69 6564 2074 6f20 636f 6c75 6d6e  pplied to column
-0001e670: 7320 7769 7468 206d 6973 6d61 7463 6865  s with mismatche
-0001e680: 6420 7364 7479 7065 732e 2027 0a20 2020  d sdtypes. '.   
-0001e690: 2020 2020 2020 2020 2027 4e75 6d65 7269           'Numeri
-0001e6a0: 6361 6c20 636f 6c75 6d6e 7320 6d75 7374  cal columns must
-0001e6b0: 2062 6520 636f 6d70 6172 6564 2074 6f20   be compared to 
-0001e6c0: 696e 7465 6765 7220 6f72 2066 6c6f 6174  integer or float
-0001e6d0: 2076 616c 7565 732e 2027 0a20 2020 2020   values. '.     
-0001e6e0: 2020 2020 2020 2027 4461 7465 7469 6d65         'Datetime
-0001e6f0: 7320 636f 6c75 6d6e 206d 7573 7420 6265  s column must be
-0001e700: 2063 6f6d 7061 7265 6420 746f 2064 6174   compared to dat
-0001e710: 6574 696d 6520 7374 7269 6e67 732e 270a  etime strings.'.
-0001e720: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0001e730: 2020 7769 7468 2070 7974 6573 742e 7261    with pytest.ra
-0001e740: 6973 6573 2843 6f6e 7374 7261 696e 744d  ises(ConstraintM
-0001e750: 6574 6164 6174 6145 7272 6f72 2c20 6d61  etadataError, ma
-0001e760: 7463 683d 6572 726f 725f 6d65 7373 6167  tch=error_messag
-0001e770: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
-0001e780: 5363 616c 6172 5261 6e67 652e 5f76 616c  ScalarRange._val
-0001e790: 6964 6174 655f 6d65 7461 6461 7461 5f73  idate_metadata_s
-0001e7a0: 7065 6369 6669 635f 746f 5f63 6f6e 7374  pecific_to_const
-0001e7b0: 7261 696e 7428 0a20 2020 2020 2020 2020  raint(.         
-0001e7c0: 2020 2020 2020 206d 6574 6164 6174 612c         metadata,
-0001e7d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001e7e0: 2063 6f6c 756d 6e5f 6e61 6d65 3d27 6127   column_name='a'
-0001e7f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001e800: 2020 6869 6768 5f76 616c 7565 3d27 3130    high_value='10
-0001e810: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
-0001e820: 2020 206c 6f77 5f76 616c 7565 3d27 3727     low_value='7'
-0001e830: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
-0001e840: 2020 2020 6465 6620 7465 7374 5f5f 7661      def test__va
-0001e850: 6c69 6461 7465 5f69 6e69 745f 696e 7075  lidate_init_inpu
-0001e860: 7473 2873 656c 6629 3a0a 2020 2020 2020  ts(self):.      
-0001e870: 2020 2222 2254 6573 7420 7468 6520 6060    """Test the ``
-0001e880: 5f76 616c 6964 6174 655f 696e 6974 5f69  _validate_init_i
-0001e890: 6e70 7574 7360 6020 6d65 7468 6f64 2e0a  nputs`` method..
-0001e8a0: 0a20 2020 2020 2020 2054 6865 206d 6574  .        The met
-0001e8b0: 686f 6420 7368 6f75 6c64 2072 6169 7365  hod should raise
-0001e8c0: 2061 6e20 6572 726f 7220 6966 2074 6865   an error if the
-0001e8d0: 2069 6e70 7574 7320 6172 6520 6e6f 7420   inputs are not 
-0001e8e0: 7661 6c69 642e 0a0a 2020 2020 2020 2020  valid...        
-0001e8f0: 5365 7475 703a 0a20 2020 2020 2020 2020  Setup:.         
-0001e900: 2020 202d 206c 6f77 5f76 616c 7565 2061     - low_value a
-0001e910: 7320 6120 7374 7269 6e67 206e 6f74 2072  s a string not r
-0001e920: 6570 7265 7365 6e74 696e 6720 6120 6461  epresenting a da
-0001e930: 7465 7469 6d65 2e0a 2020 2020 2020 2020  tetime..        
-0001e940: 2020 2020 2d20 6869 6768 5f76 616c 7565      - high_value
-0001e950: 2061 7320 6120 696e 742e 0a0a 2020 2020   as a int...    
-0001e960: 2020 2020 5369 6465 2045 6666 6563 7473      Side Effects
-0001e970: 3a0a 2020 2020 2020 2020 2020 2020 4120  :.            A 
-0001e980: 7661 6c75 6520 6572 726f 7220 7368 6f75  value error shou
-0001e990: 6c64 2062 6520 7261 6973 6564 2e0a 2020  ld be raised..  
-0001e9a0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0001e9b0: 2020 2320 5365 7475 700a 2020 2020 2020    # Setup.      
-0001e9c0: 2020 6c6f 775f 7661 6c75 6520 3d20 2761    low_value = 'a
-0001e9d0: 6263 270a 2020 2020 2020 2020 6869 6768  bc'.        high
-0001e9e0: 5f76 616c 7565 203d 2032 0a0a 2020 2020  _value = 2..    
-0001e9f0: 2020 2020 2320 5275 6e20 2f20 4173 7365      # Run / Asse
-0001ea00: 7274 0a20 2020 2020 2020 2065 7272 6f72  rt.        error
-0001ea10: 5f6d 7367 203d 2028 0a20 2020 2020 2020  _msg = (.       
-0001ea20: 2020 2020 2027 6060 6c6f 775f 7661 6c75       '``low_valu
-0001ea30: 6560 6020 616e 6420 6060 6869 6768 5f76  e`` and ``high_v
-0001ea40: 616c 7565 6060 206d 7573 7420 6265 2061  alue`` must be a
-0001ea50: 206e 756d 6265 7220 6f72 2061 2073 7472   number or a str
-0001ea60: 696e 6720 7468 6174 2027 0a20 2020 2020  ing that '.     
-0001ea70: 2020 2020 2020 2027 7265 7072 6573 656e         'represen
-0001ea80: 7473 2061 2064 6174 6574 696d 652e 270a  ts a datetime.'.
-0001ea90: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0001eaa0: 2020 7769 7468 2070 7974 6573 742e 7261    with pytest.ra
-0001eab0: 6973 6573 2856 616c 7565 4572 726f 722c  ises(ValueError,
-0001eac0: 206d 6174 6368 3d65 7272 6f72 5f6d 7367   match=error_msg
-0001ead0: 293a 0a20 2020 2020 2020 2020 2020 2053  ):.            S
-0001eae0: 6361 6c61 7252 616e 6765 2e5f 7661 6c69  calarRange._vali
-0001eaf0: 6461 7465 5f69 6e69 745f 696e 7075 7473  date_init_inputs
-0001eb00: 286c 6f77 5f76 616c 7565 2c20 6869 6768  (low_value, high
-0001eb10: 5f76 616c 7565 290a 0a20 2020 2064 6566  _value)..    def
-0001eb20: 2074 6573 745f 5f76 616c 6964 6174 655f   test__validate_
-0001eb30: 696e 6974 5f69 6e70 7574 735f 6461 7465  init_inputs_date
-0001eb40: 7469 6d65 735f 6e6f 745f 7374 7269 6e67  times_not_string
-0001eb50: 7328 7365 6c66 293a 0a20 2020 2020 2020  s(self):.       
-0001eb60: 2022 2222 5465 7374 2074 6865 2060 605f   """Test the ``_
-0001eb70: 7661 6c69 6461 7465 5f69 6e69 745f 696e  validate_init_in
-0001eb80: 7075 7473 6060 206d 6574 686f 642e 0a0a  puts`` method...
-0001eb90: 2020 2020 2020 2020 5468 6520 6d65 7468          The meth
-0001eba0: 6f64 2073 686f 756c 6420 7261 6973 6520  od should raise 
-0001ebb0: 616e 2065 7272 6f72 2069 6620 7468 6520  an error if the 
-0001ebc0: 6461 7465 7469 6d65 7320 6172 6520 6e6f  datetimes are no
-0001ebd0: 7420 7265 7072 6573 656e 7465 6420 6173  t represented as
-0001ebe0: 2073 7472 696e 672e 0a0a 2020 2020 2020   string...      
-0001ebf0: 2020 5365 7475 703a 0a20 2020 2020 2020    Setup:.       
-0001ec00: 2020 2020 202d 206c 6f77 5f76 616c 7565       - low_value
-0001ec10: 2061 7320 6060 7064 2e64 6174 6574 696d   as ``pd.datetim
-0001ec20: 6560 600a 2020 2020 2020 2020 2020 2020  e``.            
-0001ec30: 2d20 6869 6768 5f76 616c 7565 2061 7320  - high_value as 
-0001ec40: 6060 7064 2e64 6174 6574 696d 6560 600a  ``pd.datetime``.
-0001ec50: 0a20 2020 2020 2020 2053 6964 6520 4566  .        Side Ef
-0001ec60: 6665 6374 733a 0a20 2020 2020 2020 2020  fects:.         
-0001ec70: 2020 2041 2076 616c 7565 2065 7272 6f72     A value error
-0001ec80: 2073 686f 756c 6420 6265 2072 6169 7365   should be raise
-0001ec90: 642e 0a20 2020 2020 2020 2022 2222 0a20  d..        """. 
-0001eca0: 2020 2020 2020 2023 2053 6574 7570 0a20         # Setup. 
-0001ecb0: 2020 2020 2020 206c 6f77 5f76 616c 7565         low_value
-0001ecc0: 203d 2070 642e 746f 5f64 6174 6574 696d   = pd.to_datetim
-0001ecd0: 6528 2732 3032 312d 3032 2d30 3227 290a  e('2021-02-02').
-0001ece0: 2020 2020 2020 2020 6869 6768 5f76 616c          high_val
-0001ecf0: 7565 203d 2070 642e 746f 5f64 6174 6574  ue = pd.to_datet
-0001ed00: 696d 6528 2732 3032 312d 3032 2d30 3227  ime('2021-02-02'
-0001ed10: 290a 0a20 2020 2020 2020 2023 2052 756e  )..        # Run
-0001ed20: 202f 2041 7373 6572 740a 2020 2020 2020   / Assert.      
-0001ed30: 2020 7769 7468 2070 7974 6573 742e 7261    with pytest.ra
-0001ed40: 6973 6573 2856 616c 7565 4572 726f 722c  ises(ValueError,
-0001ed50: 206d 6174 6368 3d27 4461 7465 7469 6d65   match='Datetime
-0001ed60: 206d 7573 7420 6265 2072 6570 7265 7365   must be represe
-0001ed70: 6e74 6564 2061 7320 6120 7374 7269 6e67  nted as a string
-0001ed80: 2e27 293a 0a20 2020 2020 2020 2020 2020  .'):.           
-0001ed90: 2053 6361 6c61 7252 616e 6765 2e5f 7661   ScalarRange._va
-0001eda0: 6c69 6461 7465 5f69 6e69 745f 696e 7075  lidate_init_inpu
-0001edb0: 7473 286c 6f77 5f76 616c 7565 2c20 6869  ts(low_value, hi
-0001edc0: 6768 5f76 616c 7565 290a 0a20 2020 2064  gh_value)..    d
-0001edd0: 6566 2074 6573 745f 5f5f 696e 6974 5f5f  ef test___init__
-0001ede0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-0001edf0: 2222 2254 6573 7420 7468 6520 6060 5363  """Test the ``Sc
-0001ee00: 616c 6172 5261 6e67 652e 5f5f 696e 6974  alarRange.__init
-0001ee10: 5f5f 6060 206d 6574 686f 642e 0a0a 2020  __`` method...  
-0001ee20: 2020 2020 2020 5468 6520 696e 7374 616e        The instan
-0001ee30: 6365 2073 686f 756c 6420 636f 6e74 6169  ce should contai
-0001ee40: 6e20 7468 6520 6e61 6d65 206f 6620 7468  n the name of th
-0001ee50: 6520 7468 7265 6520 7061 7373 6564 2063  e three passed c
-0001ee60: 6f6c 756d 6e73 2061 6e64 2061 6c73 6f0a  olumns and also.
-0001ee70: 2020 2020 2020 2020 7573 6520 616e 206f          use an o
-0001ee80: 7065 7261 746f 7220 6060 3c60 6020 6966  perator ``<`` if
-0001ee90: 2060 6073 7472 6963 745f 626f 756e 6461   ``strict_bounda
-0001eea0: 7269 6573 6060 2069 7320 6060 5472 7565  ries`` is ``True
-0001eeb0: 6060 2062 7920 6465 6661 756c 742e 0a20  `` by default.. 
-0001eec0: 2020 2020 2020 2049 6e70 7574 3a0a 2020         Input:.  
-0001eed0: 2020 2020 2020 2020 2020 2d20 436f 6c75            - Colu
-0001eee0: 6d6e 206e 616d 652e 0a20 2020 2020 2020  mn name..       
-0001eef0: 2020 2020 202d 204c 6f77 6572 2076 616c       - Lower val
-0001ef00: 7565 2e0a 2020 2020 2020 2020 2020 2020  ue..            
-0001ef10: 2d20 4869 6768 2076 616c 7565 2e0a 2020  - High value..  
-0001ef20: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0001ef30: 2020 2320 5275 6e0a 2020 2020 2020 2020    # Run.        
-0001ef40: 696e 7374 616e 6365 203d 2053 6361 6c61  instance = Scala
-0001ef50: 7252 616e 6765 2863 6f6c 756d 6e5f 6e61  rRange(column_na
-0001ef60: 6d65 3d27 6167 655f 7768 656e 5f6a 6f69  me='age_when_joi
-0001ef70: 6e65 6427 2c20 6c6f 775f 7661 6c75 653d  ned', low_value=
-0001ef80: 3138 2c20 6869 6768 5f76 616c 7565 3d32  18, high_value=2
-0001ef90: 3829 0a0a 2020 2020 2020 2020 2320 4173  8)..        # As
-0001efa0: 7365 7274 0a20 2020 2020 2020 2061 7373  sert.        ass
-0001efb0: 6572 7420 696e 7374 616e 6365 2e5f 636f  ert instance._co
-0001efc0: 6c75 6d6e 5f6e 616d 6520 3d3d 2027 6167  lumn_name == 'ag
-0001efd0: 655f 7768 656e 5f6a 6f69 6e65 6427 0a20  e_when_joined'. 
-0001efe0: 2020 2020 2020 2061 7373 6572 7420 696e         assert in
-0001eff0: 7374 616e 6365 2e5f 6c6f 775f 7661 6c75  stance._low_valu
-0001f000: 6520 3d3d 2031 380a 2020 2020 2020 2020  e == 18.        
-0001f010: 6173 7365 7274 2069 6e73 7461 6e63 652e  assert instance.
-0001f020: 5f68 6967 685f 7661 6c75 6520 3d3d 2032  _high_value == 2
-0001f030: 380a 2020 2020 2020 2020 6173 7365 7274  8.        assert
-0001f040: 2069 6e73 7461 6e63 652e 5f6f 7065 7261   instance._opera
-0001f050: 746f 7220 3d3d 206f 7065 7261 746f 722e  tor == operator.
-0001f060: 6c74 0a0a 2020 2020 6465 6620 7465 7374  lt..    def test
-0001f070: 5f5f 5f69 6e69 745f 5f73 7472 6963 745f  ___init__strict_
-0001f080: 626f 756e 6461 7269 6573 5f66 616c 7365  boundaries_false
-0001f090: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-0001f0a0: 2222 2254 6573 7420 7468 6520 6060 5363  """Test the ``Sc
-0001f0b0: 616c 6172 5261 6e67 652e 5f5f 696e 6974  alarRange.__init
-0001f0c0: 5f5f 6060 206d 6574 686f 642e 0a0a 2020  __`` method...  
-0001f0d0: 2020 2020 2020 5465 7374 2074 6865 2060        Test the `
-0001f0e0: 605f 5f69 6e69 745f 5f60 6020 6d65 7468  `__init__`` meth
-0001f0f0: 6f64 2077 6865 6e20 6060 7374 7269 6374  od when ``strict
-0001f100: 5f62 6f75 6e64 6172 6965 7360 6020 6973  _boundaries`` is
-0001f110: 2060 6046 616c 7365 6060 2e0a 0a20 2020   ``False``...   
-0001f120: 2020 2020 2049 6e70 7574 3a0a 2020 2020       Input:.    
-0001f130: 2020 2020 2020 2020 2d20 5468 7265 6520          - Three 
-0001f140: 636f 6c75 6d6e 206e 616d 6573 2e0a 2020  column names..  
-0001f150: 2020 2020 2020 2020 2020 2d20 6060 7374            - ``st
-0001f160: 7269 6374 5f62 6f75 6e64 6172 6965 733d  rict_boundaries=
-0001f170: 4661 6c73 6560 602e 0a0a 2020 2020 2020  False``...      
-0001f180: 2020 5369 6465 2045 6666 6563 743a 0a20    Side Effect:. 
-0001f190: 2020 2020 2020 2020 2020 202d 2060 6069             - ``i
-0001f1a0: 6e73 7461 6e63 652e 5f6f 7065 7261 746f  nstance._operato
-0001f1b0: 7260 6020 7368 6f75 6c64 2062 6520 6060  r`` should be ``
-0001f1c0: 6f70 6572 6174 6f72 2e6c 6560 600a 2020  operator.le``.  
-0001f1d0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0001f1e0: 2020 2320 5275 6e0a 2020 2020 2020 2020    # Run.        
-0001f1f0: 696e 7374 616e 6365 203d 2053 6361 6c61  instance = Scala
-0001f200: 7252 616e 6765 2827 6167 655f 7768 656e  rRange('age_when
-0001f210: 5f6a 6f69 6e65 6427 2c20 3138 2c20 3238  _joined', 18, 28
-0001f220: 2c20 7374 7269 6374 5f62 6f75 6e64 6172  , strict_boundar
-0001f230: 6965 733d 4661 6c73 6529 0a0a 2020 2020  ies=False)..    
-0001f240: 2020 2020 2320 4173 7365 7274 0a20 2020      # Assert.   
-0001f250: 2020 2020 2061 7373 6572 7420 696e 7374       assert inst
-0001f260: 616e 6365 2e5f 636f 6c75 6d6e 5f6e 616d  ance._column_nam
-0001f270: 6520 3d3d 2027 6167 655f 7768 656e 5f6a  e == 'age_when_j
-0001f280: 6f69 6e65 6427 0a20 2020 2020 2020 2061  oined'.        a
-0001f290: 7373 6572 7420 696e 7374 616e 6365 2e5f  ssert instance._
-0001f2a0: 6c6f 775f 7661 6c75 6520 3d3d 2031 380a  low_value == 18.
-0001f2b0: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
-0001f2c0: 6e73 7461 6e63 652e 5f68 6967 685f 7661  nstance._high_va
-0001f2d0: 6c75 6520 3d3d 2032 380a 2020 2020 2020  lue == 28.      
-0001f2e0: 2020 6173 7365 7274 2069 6e73 7461 6e63    assert instanc
-0001f2f0: 652e 5f6f 7065 7261 746f 7220 3d3d 206f  e._operator == o
-0001f300: 7065 7261 746f 722e 6c65 0a0a 2020 2020  perator.le..    
-0001f310: 6465 6620 7465 7374 5f5f 6765 745f 6973  def test__get_is
-0001f320: 5f64 6174 6574 696d 6528 7365 6c66 293a  _datetime(self):
-0001f330: 0a20 2020 2020 2020 2022 2222 5465 7374  .        """Test
-0001f340: 2074 6861 7420 7468 6520 6d65 7468 6f64   that the method
-0001f350: 2064 6574 6563 7473 2077 6865 7468 6572   detects whether
-0001f360: 206f 7220 6e6f 7420 7468 6520 6060 6461   or not the ``da
-0001f370: 7461 6060 2069 7320 6060 6461 7465 7469  ta`` is ``dateti
-0001f380: 6d65 6060 2e0a 0a20 2020 2020 2020 2054  me``...        T
-0001f390: 6869 7320 6d65 7468 6f64 2073 686f 756c  his method shoul
-0001f3a0: 6420 6465 7465 6374 2077 6865 7468 6572  d detect whether
-0001f3b0: 206f 7220 6e6f 7420 7468 6520 6461 7461   or not the data
-0001f3c0: 2069 7320 6060 6461 7465 7469 6d65 6060   is ``datetime``
-0001f3d0: 2061 6e64 2069 6620 696e 2063 6173 6520   and if in case 
-0001f3e0: 736f 6d65 2069 730a 2020 2020 2020 2020  some is.        
-0001f3f0: 6275 7420 6f74 6865 7220 6973 206e 6f74  but other is not
-0001f400: 2c20 7261 6973 6573 2061 6e20 6572 726f  , raises an erro
-0001f410: 722e 0a0a 2020 2020 2020 2020 5365 7475  r...        Setu
-0001f420: 703a 0a20 2020 2020 2020 2020 2020 202d  p:.            -
-0001f430: 2043 7265 6174 6520 6120 7064 2e44 6174   Create a pd.Dat
-0001f440: 6146 7261 6d65 2077 6974 6820 6120 636f  aFrame with a co
-0001f450: 6c75 6d6e 2074 6861 7420 636f 6e74 6169  lumn that contai
-0001f460: 6e73 2064 6174 6574 696d 6520 6461 7461  ns datetime data
-0001f470: 2e0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
-0001f480: 496e 7374 616e 6365 206f 6620 6060 5363  Instance of ``Sc
-0001f490: 616c 6172 5261 6e67 6560 6020 636f 6e73  alarRange`` cons
-0001f4a0: 7472 6169 6e74 2077 6974 6820 6c6f 7720  traint with low 
-0001f4b0: 616e 6420 6869 6768 2061 7320 6461 7465  and high as date
-0001f4c0: 7469 6d65 2028 7469 6d65 7374 616d 7073  time (timestamps
-0001f4d0: 292e 0a0a 2020 2020 2020 2020 496e 7075  )...        Inpu
-0001f4e0: 743a 0a20 2020 2020 2020 2020 2020 202d  t:.            -
-0001f4f0: 2070 642e 4461 7461 4672 616d 6520 7769   pd.DataFrame wi
-0001f500: 7468 2060 6070 726f 6d6f 7469 6f6e 5f64  th ``promotion_d
-0001f510: 6174 6560 6020 636f 6c75 6d6e 2e0a 0a20  ate`` column... 
-0001f520: 2020 2020 2020 204f 7574 7075 743a 0a20         Output:. 
-0001f530: 2020 2020 2020 2020 2020 202d 2054 6865             - The
-0001f540: 206f 7574 7075 7420 7368 6f75 6c64 2062   output should b
-0001f550: 6520 5472 7565 2e0a 2020 2020 2020 2020  e True..        
-0001f560: 2222 220a 2020 2020 2020 2020 2320 5365  """.        # Se
-0001f570: 7475 700a 2020 2020 2020 2020 7461 626c  tup.        tabl
-0001f580: 655f 6461 7461 203d 2070 642e 4461 7461  e_data = pd.Data
-0001f590: 4672 616d 6528 7b0a 2020 2020 2020 2020  Frame({.        
-0001f5a0: 2020 2020 2770 726f 6d6f 7469 6f6e 5f64      'promotion_d
-0001f5b0: 6174 6527 3a20 7064 2e74 6f5f 6461 7465  ate': pd.to_date
-0001f5c0: 7469 6d65 285b 2732 3032 322d 3035 2d31  time(['2022-05-1
-0001f5d0: 3027 2c20 2732 3032 322d 3036 2d31 3027  0', '2022-06-10'
-0001f5e0: 2c20 2732 3032 322d 3131 2d31 3727 5d29  , '2022-11-17'])
-0001f5f0: 2c0a 2020 2020 2020 2020 7d29 0a20 2020  ,.        }).   
-0001f600: 2020 2020 2069 6e73 7461 6e63 6520 3d20       instance = 
-0001f610: 5363 616c 6172 5261 6e67 6528 2770 726f  ScalarRange('pro
-0001f620: 6d6f 7469 6f6e 5f64 6174 6527 2c20 2732  motion_date', '2
-0001f630: 3032 312d 3032 2d31 3027 2c20 2732 3035  021-02-10', '205
-0001f640: 302d 3130 2d31 3127 290a 0a20 2020 2020  0-10-11')..     
-0001f650: 2020 2023 2052 756e 0a20 2020 2020 2020     # Run.       
-0001f660: 2069 735f 6461 7465 7469 6d65 203d 2069   is_datetime = i
-0001f670: 6e73 7461 6e63 652e 5f67 6574 5f69 735f  nstance._get_is_
-0001f680: 6461 7465 7469 6d65 2874 6162 6c65 5f64  datetime(table_d
-0001f690: 6174 6129 0a0a 2020 2020 2020 2020 2320  ata)..        # 
-0001f6a0: 4173 7365 7274 0a20 2020 2020 2020 2061  Assert.        a
-0001f6b0: 7373 6572 7420 6973 5f64 6174 6574 696d  ssert is_datetim
-0001f6c0: 650a 0a20 2020 2064 6566 2074 6573 745f  e..    def test_
-0001f6d0: 5f67 6574 5f69 735f 6461 7465 7469 6d65  _get_is_datetime
-0001f6e0: 5f6e 6f5f 6461 7465 7469 6d65 7328 7365  _no_datetimes(se
-0001f6f0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-0001f700: 5465 7374 2074 6861 7420 7468 6520 6d65  Test that the me
-0001f710: 7468 6f64 2064 6574 6563 7473 2077 6865  thod detects whe
-0001f720: 7468 6572 206f 7220 6e6f 7420 7468 6520  ther or not the 
-0001f730: 6060 6461 7461 6060 2069 7320 6060 6461  ``data`` is ``da
-0001f740: 7465 7469 6d65 6060 2e0a 0a20 2020 2020  tetime``...     
-0001f750: 2020 2054 6869 7320 6d65 7468 6f64 2073     This method s
-0001f760: 686f 756c 6420 6465 7465 6374 2077 6865  hould detect whe
-0001f770: 7468 6572 206f 7220 6e6f 7420 7468 6520  ther or not the 
-0001f780: 6461 7461 2069 7320 6060 6461 7465 7469  data is ``dateti
-0001f790: 6d65 6060 2061 6e64 2069 6620 696e 2063  me`` and if in c
-0001f7a0: 6173 6520 736f 6d65 2069 730a 2020 2020  ase some is.    
-0001f7b0: 2020 2020 6275 7420 6f74 6865 7220 6973      but other is
-0001f7c0: 206e 6f74 2c20 7261 6973 6573 2061 6e20   not, raises an 
-0001f7d0: 6572 726f 722e 0a0a 2020 2020 2020 2020  error...        
-0001f7e0: 5365 7475 703a 0a20 2020 2020 2020 2020  Setup:.         
-0001f7f0: 2020 202d 2043 7265 6174 6520 6120 7064     - Create a pd
-0001f800: 2e44 6174 6146 7261 6d65 2077 6974 6820  .DataFrame with 
-0001f810: 6120 636f 6c75 6d6e 2074 6861 7420 6973  a column that is
-0001f820: 206e 6f74 2064 6174 6174 696d 652e 0a20   not datatime.. 
-0001f830: 2020 2020 2020 2020 2020 202d 2049 6e73             - Ins
-0001f840: 7461 6e63 6520 6f66 2060 6053 6361 6c61  tance of ``Scala
-0001f850: 7252 616e 6765 6060 2063 6f6e 7374 7261  rRange`` constra
-0001f860: 696e 7420 7769 7468 206c 6f77 2061 6e64  int with low and
-0001f870: 2068 6967 6820 6173 2069 6e74 6567 6572   high as integer
-0001f880: 732e 0a0a 2020 2020 2020 2020 496e 7075  s...        Inpu
-0001f890: 743a 0a20 2020 2020 2020 2020 2020 202d  t:.            -
-0001f8a0: 2070 642e 4461 7461 4672 616d 6520 7769   pd.DataFrame wi
-0001f8b0: 7468 2060 6063 7572 7265 6e74 5f61 6765  th ``current_age
-0001f8c0: 6060 0a0a 2020 2020 2020 2020 4f75 7470  ``..        Outp
-0001f8d0: 7574 3a0a 2020 2020 2020 2020 2020 2020  ut:.            
-0001f8e0: 2d20 5468 6520 6f75 7470 7574 2073 686f  - The output sho
-0001f8f0: 756c 6420 6265 2066 616c 7365 2073 696e  uld be false sin
-0001f900: 6365 2061 6c6c 2074 6865 2064 6174 6120  ce all the data 
-0001f910: 6973 2060 6069 6e74 6060 2e0a 2020 2020  is ``int``..    
-0001f920: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0001f930: 2320 5365 7475 700a 2020 2020 2020 2020  # Setup.        
-0001f940: 7461 626c 655f 6461 7461 203d 2070 642e  table_data = pd.
-0001f950: 4461 7461 4672 616d 6528 7b27 6375 7272  DataFrame({'curr
-0001f960: 656e 745f 6167 6527 3a20 5b32 312c 2032  ent_age': [21, 2
-0001f970: 322c 2032 355d 7d29 0a20 2020 2020 2020  2, 25]}).       
-0001f980: 2069 6e73 7461 6e63 6520 3d20 5363 616c   instance = Scal
-0001f990: 6172 5261 6e67 6528 2763 7572 7265 6e74  arRange('current
-0001f9a0: 5f61 6765 272c 2032 312c 2033 3029 0a0a  _age', 21, 30)..
-0001f9b0: 2020 2020 2020 2020 2320 5275 6e0a 2020          # Run.  
-0001f9c0: 2020 2020 2020 6973 5f64 6174 6574 696d        is_datetim
-0001f9d0: 6520 3d20 696e 7374 616e 6365 2e5f 6765  e = instance._ge
-0001f9e0: 745f 6973 5f64 6174 6574 696d 6528 7461  t_is_datetime(ta
-0001f9f0: 626c 655f 6461 7461 290a 0a20 2020 2020  ble_data)..     
-0001fa00: 2020 2023 2041 7373 6572 740a 2020 2020     # Assert.    
-0001fa10: 2020 2020 6173 7365 7274 206e 6f74 2069      assert not i
-0001fa20: 735f 6461 7465 7469 6d65 0a0a 2020 2020  s_datetime..    
-0001fa30: 6465 6620 7465 7374 5f5f 6765 745f 6973  def test__get_is
-0001fa40: 5f64 6174 6574 696d 655f 7261 6973 6573  _datetime_raises
-0001fa50: 5f61 6e5f 6572 726f 7228 7365 6c66 293a  _an_error(self):
-0001fa60: 0a20 2020 2020 2020 2022 2222 5465 7374  .        """Test
-0001fa70: 2074 6861 7420 7468 6520 6d65 7468 6f64   that the method
-0001fa80: 2064 6574 6563 7473 2077 6865 7468 6572   detects whether
-0001fa90: 206f 7220 6e6f 7420 7468 6520 6060 6461   or not the ``da
-0001faa0: 7461 6060 2069 7320 6060 6461 7465 7469  ta`` is ``dateti
-0001fab0: 6d65 6060 2e0a 0a20 2020 2020 2020 2054  me``...        T
-0001fac0: 6869 7320 6d65 7468 6f64 2073 686f 756c  his method shoul
-0001fad0: 6420 6465 7465 6374 2077 6865 7468 6572  d detect whether
-0001fae0: 206f 7220 6e6f 7420 7468 6520 6461 7461   or not the data
-0001faf0: 2069 7320 6060 6461 7465 7469 6d65 6060   is ``datetime``
-0001fb00: 2061 6e64 2069 6620 696e 2063 6173 6520   and if in case 
-0001fb10: 736f 6d65 2069 730a 2020 2020 2020 2020  some is.        
-0001fb20: 6275 7420 6f74 6865 7220 6973 206e 6f74  but other is not
-0001fb30: 2c20 7261 6973 6573 2061 6e20 6572 726f  , raises an erro
-0001fb40: 722e 0a0a 2020 2020 2020 2020 5365 7475  r...        Setu
-0001fb50: 703a 0a20 2020 2020 2020 2020 2020 202d  p:.            -
-0001fb60: 2043 7265 6174 6520 6120 7064 2e44 6174   Create a pd.Dat
-0001fb70: 6146 7261 6d65 2077 6974 6820 6120 636f  aFrame with a co
-0001fb80: 6c75 6d6e 2074 6861 7420 636f 6e74 6169  lumn that contai
-0001fb90: 6e73 2064 6174 6574 696d 6520 6461 7461  ns datetime data
-0001fba0: 2e0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
-0001fbb0: 496e 7374 616e 6365 206f 6620 6060 5363  Instance of ``Sc
-0001fbc0: 616c 6172 5261 6e67 6560 6020 636f 6e73  alarRange`` cons
-0001fbd0: 7472 6169 6e74 2077 6974 6820 6c6f 7720  traint with low 
-0001fbe0: 616e 6420 6869 6768 2061 7320 696e 7465  and high as inte
-0001fbf0: 6765 7273 2e0a 0a20 2020 2020 2020 2049  gers...        I
-0001fc00: 6e70 7574 3a0a 2020 2020 2020 2020 2020  nput:.          
-0001fc10: 2020 2d20 7064 2e44 6174 6146 7261 6d65    - pd.DataFrame
-0001fc20: 2077 6974 6820 2060 6070 726f 6d6f 7469   with  ``promoti
-0001fc30: 6f6e 5f64 6174 6560 602e 0a0a 2020 2020  on_date``...    
-0001fc40: 2020 2020 4f75 7470 7574 3a0a 2020 2020      Output:.    
-0001fc50: 2020 2020 2020 2020 2d20 5468 6520 6f75          - The ou
-0001fc60: 7470 7574 2073 686f 756c 6420 6265 2066  tput should be f
-0001fc70: 616c 7365 2073 696e 6365 2061 6c6c 2074  alse since all t
-0001fc80: 6865 2064 6174 6120 6973 2060 6069 6e74  he data is ``int
-0001fc90: 6060 2e0a 2020 2020 2020 2020 2222 220a  ``..        """.
-0001fca0: 2020 2020 2020 2020 2320 5365 7475 700a          # Setup.
-0001fcb0: 2020 2020 2020 2020 7461 626c 655f 6461          table_da
-0001fcc0: 7461 203d 2070 642e 4461 7461 4672 616d  ta = pd.DataFram
-0001fcd0: 6528 7b0a 2020 2020 2020 2020 2020 2020  e({.            
-0001fce0: 2770 726f 6d6f 7469 6f6e 5f64 6174 6527  'promotion_date'
-0001fcf0: 3a20 7064 2e74 6f5f 6461 7465 7469 6d65  : pd.to_datetime
-0001fd00: 285b 2732 3032 322d 3035 2d31 3027 2c20  (['2022-05-10', 
-0001fd10: 2732 3032 322d 3036 2d31 3027 2c20 2732  '2022-06-10', '2
-0001fd20: 3032 322d 3131 2d31 3727 5d29 2c0a 2020  022-11-17']),.  
-0001fd30: 2020 2020 2020 7d29 0a20 2020 2020 2020        }).       
-0001fd40: 2069 6e73 7461 6e63 6520 3d20 5363 616c   instance = Scal
-0001fd50: 6172 5261 6e67 6528 2770 726f 6d6f 7469  arRange('promoti
-0001fd60: 6f6e 5f64 6174 6527 2c20 3138 2c20 3235  on_date', 18, 25
-0001fd70: 290a 2020 2020 2020 2020 6578 7065 6374  ).        expect
-0001fd80: 6564 5f74 6578 7420 3d20 2754 6865 2063  ed_text = 'The c
-0001fd90: 6f6e 7374 7261 696e 7420 636f 6c75 6d6e  onstraint column
-0001fda0: 2061 6e64 2062 6f75 6e64 7320 6d75 7374   and bounds must
-0001fdb0: 2061 6c6c 2062 6520 6461 7465 7469 6d65   all be datetime
-0001fdc0: 2e27 0a0a 2020 2020 2020 2020 2320 5275  .'..        # Ru
-0001fdd0: 6e0a 2020 2020 2020 2020 7769 7468 2070  n.        with p
-0001fde0: 7974 6573 742e 7261 6973 6573 2856 616c  ytest.raises(Val
-0001fdf0: 7565 4572 726f 722c 206d 6174 6368 3d65  ueError, match=e
-0001fe00: 7870 6563 7465 645f 7465 7874 293a 0a20  xpected_text):. 
-0001fe10: 2020 2020 2020 2020 2020 2069 6e73 7461             insta
-0001fe20: 6e63 652e 5f67 6574 5f69 735f 6461 7465  nce._get_is_date
-0001fe30: 7469 6d65 2874 6162 6c65 5f64 6174 6129  time(table_data)
-0001fe40: 0a0a 2020 2020 6465 6620 7465 7374 5f5f  ..    def test__
-0001fe50: 6765 745f 6469 6666 5f63 6f6c 756d 6e5f  get_diff_column_
-0001fe60: 6e61 6d65 2873 656c 6629 3a0a 2020 2020  name(self):.    
-0001fe70: 2020 2020 2222 2254 6573 7420 7468 6520      """Test the 
-0001fe80: 6060 5363 616c 6172 5261 6e67 652e 5f67  ``ScalarRange._g
-0001fe90: 6574 5f64 6966 665f 636f 6c75 6d6e 5f6e  et_diff_column_n
-0001fea0: 616d 6560 6020 6d65 7468 6f64 2e0a 0a20  ame`` method... 
-0001feb0: 2020 2020 2020 2054 6869 7320 6d65 7468         This meth
-0001fec0: 6f64 2073 686f 756c 6420 7265 7475 726e  od should return
-0001fed0: 2074 6865 206e 616d 6520 666f 7220 7468   the name for th
-0001fee0: 6520 6e65 7720 6060 7472 616e 7366 6f72  e new ``transfor
-0001fef0: 6d5f 636f 6c75 6d6e 6060 2e0a 0a20 2020  m_column``...   
-0001ff00: 2020 2020 2053 6574 7570 3a0a 2020 2020       Setup:.    
-0001ff10: 2020 2020 2020 2020 2d20 4372 6561 7465          - Create
-0001ff20: 2061 2070 642e 4461 7461 4672 616d 652e   a pd.DataFrame.
-0001ff30: 0a20 2020 2020 2020 2020 2020 202d 2049  .            - I
-0001ff40: 6e73 7461 6e63 6520 6f66 2060 6053 6361  nstance of ``Sca
-0001ff50: 6c61 7252 616e 6765 6060 2063 6f6e 7374  larRange`` const
-0001ff60: 7261 696e 742e 0a0a 2020 2020 2020 2020  raint...        
-0001ff70: 496e 7075 743a 0a20 2020 2020 2020 2020  Input:.         
-0001ff80: 2020 202d 2070 642e 4461 7461 4672 616d     - pd.DataFram
-0001ff90: 6520 7769 7468 2060 6063 7572 7265 6e74  e with ``current
-0001ffa0: 5f61 6765 6060 2063 6f6c 756d 6e2e 0a0a  _age`` column...
-0001ffb0: 2020 2020 2020 2020 4f75 7470 7574 3a0a          Output:.
-0001ffc0: 2020 2020 2020 2020 2020 2020 2d20 5468              - Th
-0001ffd0: 6520 636f 6c75 6d6e 206e 616d 6520 636f  e column name co
-0001ffe0: 6e63 6174 656e 6174 6564 2077 6974 6820  ncatenated with 
-0001fff0: 6060 2360 6020 666f 6c6c 6f77 6564 2062  ``#`` followed b
-00020000: 7920 7468 6520 6060 6c6f 7760 6020 616e  y the ``low`` an
-00020010: 6420 6060 6869 6768 6060 2076 616c 7565  d ``high`` value
-00020020: 732e 0a20 2020 2020 2020 2022 2222 0a20  s..        """. 
-00020030: 2020 2020 2020 2023 2053 6574 7570 0a20         # Setup. 
-00020040: 2020 2020 2020 2074 6162 6c65 5f64 6174         table_dat
-00020050: 6120 3d20 7064 2e44 6174 6146 7261 6d65  a = pd.DataFrame
-00020060: 287b 0a20 2020 2020 2020 2020 2020 2027  ({.            '
-00020070: 6375 7272 656e 745f 6167 6527 3a20 5b32  current_age': [2
-00020080: 312c 2032 322c 2032 355d 2c0a 2020 2020  1, 22, 25],.    
-00020090: 2020 2020 2020 2020 2763 7572 7265 6e74          'current
-000200a0: 5f61 6765 2331 3823 3335 273a 205b 312c  _age#18#35': [1,
-000200b0: 2032 2c20 335d 0a20 2020 2020 2020 207d   2, 3].        }
-000200c0: 290a 2020 2020 2020 2020 696e 7374 616e  ).        instan
-000200d0: 6365 203d 2053 6361 6c61 7252 616e 6765  ce = ScalarRange
-000200e0: 2827 6375 7272 656e 745f 6167 6527 2c20  ('current_age', 
-000200f0: 3138 2c20 3335 290a 0a20 2020 2020 2020  18, 35)..       
-00020100: 2023 2052 756e 0a20 2020 2020 2020 2074   # Run.        t
-00020110: 7261 6e73 666f 726d 6564 5f63 6f6c 756d  ransformed_colum
-00020120: 6e5f 6e61 6d65 203d 2069 6e73 7461 6e63  n_name = instanc
-00020130: 652e 5f67 6574 5f64 6966 665f 636f 6c75  e._get_diff_colu
-00020140: 6d6e 5f6e 616d 6528 7461 626c 655f 6461  mn_name(table_da
-00020150: 7461 290a 0a20 2020 2020 2020 2023 2041  ta)..        # A
-00020160: 7373 6572 740a 2020 2020 2020 2020 6173  ssert.        as
-00020170: 7365 7274 2074 7261 6e73 666f 726d 6564  sert transformed
-00020180: 5f63 6f6c 756d 6e5f 6e61 6d65 203d 3d20  _column_name == 
-00020190: 2763 7572 7265 6e74 5f61 6765 2323 3138  'current_age##18
-000201a0: 2323 3335 270a 0a20 2020 2064 6566 2074  ##35'..    def t
-000201b0: 6573 745f 5f66 6974 2873 656c 6629 3a0a  est__fit(self):.
-000201c0: 2020 2020 2020 2020 2222 2254 6573 7420          """Test 
-000201d0: 7468 6520 6060 5f66 6974 6060 206d 6574  the ``_fit`` met
-000201e0: 686f 6420 6f66 2060 6053 6361 6c61 7252  hod of ``ScalarR
-000201f0: 616e 6765 6060 2e0a 0a20 2020 2020 2020  ange``...       
-00020200: 2054 6573 7420 7468 6174 2074 6865 2060   Test that the `
-00020210: 605f 6669 7460 6020 6d65 7468 6f64 2073  `_fit`` method s
-00020220: 746f 7265 7320 7468 6520 7072 6f70 6572  tores the proper
-00020230: 2074 7261 6e73 666f 726d 6174 696f 6e20   transformation 
-00020240: 636f 6c75 6d6e 206e 616d 6520 616e 640a  column name and.
-00020250: 2020 2020 2020 2020 6c65 6172 6e73 2077          learns w
-00020260: 6865 7468 6572 2074 6865 2064 6174 6120  hether the data 
-00020270: 6973 2060 6064 6174 6574 696d 6560 606f  is ``datetime``o
-00020280: 7220 6e6f 7420 616e 6420 6974 2773 2060  r not and it's `
-00020290: 6064 7479 7065 6060 2e0a 0a20 2020 2020  `dtype``...     
-000202a0: 2020 2053 6574 7570 3a0a 2020 2020 2020     Setup:.      
-000202b0: 2020 2020 2020 2d20 4372 6561 7465 2061        - Create a
-000202c0: 2070 642e 4461 7461 4672 616d 6520 7769   pd.DataFrame wi
-000202d0: 7468 2061 2063 6f6c 756d 6e2e 0a20 2020  th a column..   
-000202e0: 2020 2020 2020 2020 202d 2049 6e73 7461           - Insta
-000202f0: 6e63 6520 6f66 2060 6053 6361 6c61 7252  nce of ``ScalarR
-00020300: 616e 6765 6060 2063 6f6e 7374 7261 696e  ange`` constrain
-00020310: 7420 7769 7468 2074 686f 7365 2074 6872  t with those thr
-00020320: 6565 2063 6f6c 756d 6e20 6e61 6d65 732e  ee column names.
-00020330: 0a0a 2020 2020 2020 2020 496e 7075 743a  ..        Input:
-00020340: 0a20 2020 2020 2020 2020 2020 202d 2070  .            - p
-00020350: 642e 4461 7461 4672 616d 6520 7769 7468  d.DataFrame with
-00020360: 2060 6063 7572 7265 6e74 5f61 6765 6060   ``current_age``
-00020370: 2063 6f6c 756d 6e73 2e0a 0a20 2020 2020   columns...     
-00020380: 2020 2053 6964 6520 4566 6665 6374 3a0a     Side Effect:.
-00020390: 2020 2020 2020 2020 2020 2020 2d20 696e              - in
-000203a0: 7374 616e 6365 2068 6173 2060 605f 7472  stance has ``_tr
-000203b0: 616e 7366 6f72 6d65 645f 636f 6c75 6d6e  ansformed_column
-000203c0: 6060 2061 6e64 2060 605f 6973 5f64 6174  `` and ``_is_dat
-000203d0: 6574 696d 6560 6020 616e 6420 6060 5f64  etime`` and ``_d
-000203e0: 7479 7065 6060 2e0a 2020 2020 2020 2020  type``..        
-000203f0: 2222 220a 2020 2020 2020 2020 2320 5365  """.        # Se
-00020400: 7475 700a 2020 2020 2020 2020 7461 626c  tup.        tabl
-00020410: 655f 6461 7461 203d 2070 642e 4461 7461  e_data = pd.Data
-00020420: 4672 616d 6528 7b27 6375 7272 656e 745f  Frame({'current_
-00020430: 6167 6527 3a20 5b32 312c 2032 322c 2032  age': [21, 22, 2
-00020440: 355d 7d29 0a20 2020 2020 2020 2069 6e73  5]}).        ins
-00020450: 7461 6e63 6520 3d20 5363 616c 6172 5261  tance = ScalarRa
-00020460: 6e67 6528 2763 7572 7265 6e74 5f61 6765  nge('current_age
-00020470: 272c 2031 382c 2032 3029 0a0a 2020 2020  ', 18, 20)..    
-00020480: 2020 2020 2320 5275 6e0a 2020 2020 2020      # Run.      
-00020490: 2020 696e 7374 616e 6365 2e5f 6669 7428    instance._fit(
-000204a0: 7461 626c 655f 6461 7461 290a 0a20 2020  table_data)..   
-000204b0: 2020 2020 2023 2041 7373 6572 740a 2020       # Assert.  
-000204c0: 2020 2020 2020 6173 7365 7274 206e 6f74        assert not
-000204d0: 2069 6e73 7461 6e63 652e 5f69 735f 6461   instance._is_da
-000204e0: 7465 7469 6d65 0a20 2020 2020 2020 2061  tetime.        a
-000204f0: 7373 6572 7420 696e 7374 616e 6365 2e5f  ssert instance._
-00020500: 7472 616e 7366 6f72 6d65 645f 636f 6c75  transformed_colu
-00020510: 6d6e 203d 3d20 2763 7572 7265 6e74 5f61  mn == 'current_a
-00020520: 6765 2331 3823 3230 270a 0a20 2020 2064  ge#18#20'..    d
-00020530: 6566 2074 6573 745f 5f66 6974 5f64 6174  ef test__fit_dat
-00020540: 6574 696d 6528 7365 6c66 293a 0a20 2020  etime(self):.   
-00020550: 2020 2020 2022 2222 5465 7374 2074 6865       """Test the
-00020560: 2060 605f 6669 7460 6020 6d65 7468 6f64   ``_fit`` method
-00020570: 206f 6620 6060 5363 616c 6172 5261 6e67   of ``ScalarRang
-00020580: 6560 6020 7768 656e 2066 6974 7469 6e67  e`` when fitting
-00020590: 2077 6974 6820 6060 6461 7465 7469 6d65   with ``datetime
-000205a0: 6060 2064 6174 612e 0a0a 2020 2020 2020  `` data...      
-000205b0: 2020 5365 7475 703a 0a20 2020 2020 2020    Setup:.       
-000205c0: 2020 2020 202d 2074 6162 6c65 5f64 6174       - table_dat
-000205d0: 6120 7769 7468 2064 6174 6574 696d 6573  a with datetimes
-000205e0: 2e0a 0a20 2020 2020 2020 2053 6964 6520  ...        Side 
-000205f0: 4566 6665 6374 733a 0a20 2020 2020 2020  Effects:.       
-00020600: 2020 2020 202d 2054 6865 2060 6069 6e73       - The ``ins
-00020610: 7461 6e63 652e 5f6c 6f77 5f76 616c 7565  tance._low_value
-00020620: 6060 2061 6e64 2060 60c3 ac6e 7374 616e  `` and ``..nstan
-00020630: 6365 2e5f 6869 6768 5f76 616c 7565 6060  ce._high_value``
-00020640: 2068 6176 6520 6265 656e 2063 6f6e 7665   have been conve
-00020650: 7274 6564 0a20 2020 2020 2020 2020 2020  rted.           
-00020660: 2020 2074 6f20 6060 7064 2e64 6174 6574     to ``pd.datet
-00020670: 696d 6560 600a 2020 2020 2020 2020 2222  ime``.        ""
-00020680: 220a 2020 2020 2020 2020 2320 5365 7475  ".        # Setu
-00020690: 700a 2020 2020 2020 2020 7461 626c 655f  p.        table_
-000206a0: 6461 7461 203d 2070 642e 4461 7461 4672  data = pd.DataFr
-000206b0: 616d 6528 7b0a 2020 2020 2020 2020 2020  ame({.          
-000206c0: 2020 2763 6865 636b 696e 273a 205b 0a20    'checkin': [. 
-000206d0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-000206e0: 642e 746f 5f64 6174 6574 696d 6528 2732  d.to_datetime('2
-000206f0: 3032 322d 3035 2d30 3627 292c 0a20 2020  022-05-06'),.   
-00020700: 2020 2020 2020 2020 2020 2020 2070 642e               pd.
-00020710: 746f 5f64 6174 6574 696d 6528 2732 3032  to_datetime('202
-00020720: 322d 3035 2d30 3727 292c 0a20 2020 2020  2-05-07'),.     
-00020730: 2020 2020 2020 2020 2020 2070 642e 746f             pd.to
-00020740: 5f64 6174 6574 696d 6528 2732 3032 322d  _datetime('2022-
-00020750: 3035 2d30 3827 292c 0a20 2020 2020 2020  05-08'),.       
-00020760: 2020 2020 2020 2020 2070 642e 746f 5f64           pd.to_d
-00020770: 6174 6574 696d 6528 2732 3032 322d 3035  atetime('2022-05
-00020780: 2d30 3927 292c 0a20 2020 2020 2020 2020  -09'),.         
-00020790: 2020 205d 0a20 2020 2020 2020 207d 290a     ].        }).
-000207a0: 2020 2020 2020 2020 696e 7374 616e 6365          instance
-000207b0: 203d 2053 6361 6c61 7252 616e 6765 2827   = ScalarRange('
-000207c0: 6368 6563 6b69 6e27 2c20 2732 3032 322d  checkin', '2022-
-000207d0: 3035 2d30 3527 2c20 2732 3032 322d 3036  05-05', '2022-06
-000207e0: 2d30 3127 290a 0a20 2020 2020 2020 2023  -01')..        #
-000207f0: 2052 756e 0a20 2020 2020 2020 2069 6e73   Run.        ins
-00020800: 7461 6e63 652e 5f66 6974 2874 6162 6c65  tance._fit(table
-00020810: 5f64 6174 6129 0a0a 2020 2020 2020 2020  _data)..        
-00020820: 2320 4173 7365 7274 0a20 2020 2020 2020  # Assert.       
-00020830: 2061 7373 6572 7420 696e 7374 616e 6365   assert instance
-00020840: 2e5f 6973 5f64 6174 6574 696d 650a 2020  ._is_datetime.  
-00020850: 2020 2020 2020 6173 7365 7274 2069 6e73        assert ins
-00020860: 7461 6e63 652e 5f74 7261 6e73 666f 726d  tance._transform
-00020870: 6564 5f63 6f6c 756d 6e20 3d3d 2027 6368  ed_column == 'ch
-00020880: 6563 6b69 6e23 3230 3232 2d30 352d 3035  eckin#2022-05-05
-00020890: 2332 3032 322d 3036 2d30 3127 0a20 2020  #2022-06-01'.   
-000208a0: 2020 2020 2061 7373 6572 7420 696e 7374       assert inst
-000208b0: 616e 6365 2e5f 6c6f 775f 7661 6c75 6520  ance._low_value 
-000208c0: 3d3d 2070 642e 746f 5f64 6174 6574 696d  == pd.to_datetim
-000208d0: 6528 2732 3032 322d 3035 2d30 3527 290a  e('2022-05-05').
-000208e0: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
-000208f0: 6e73 7461 6e63 652e 5f68 6967 685f 7661  nstance._high_va
-00020900: 6c75 6520 3d3d 2070 642e 746f 5f64 6174  lue == pd.to_dat
-00020910: 6574 696d 6528 2732 3032 322d 3036 2d30  etime('2022-06-0
-00020920: 3127 290a 0a20 2020 2064 6566 2074 6573  1')..    def tes
-00020930: 745f 6973 5f76 616c 6964 5f6c 7428 7365  t_is_valid_lt(se
-00020940: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-00020950: 5465 7374 2074 6865 2060 6053 6361 6c61  Test the ``Scala
-00020960: 7252 616e 6765 2e69 735f 7661 6c69 6460  rRange.is_valid`
-00020970: 602e 0a0a 2020 2020 2020 2020 5468 6973  `...        This
-00020980: 2074 6573 7420 656e 7375 7265 7320 7468   test ensures th
-00020990: 6174 2074 6865 2060 6069 735f 7661 6c69  at the ``is_vali
-000209a0: 6460 6020 6d65 7468 6f64 2077 6f72 6b73  d`` method works
-000209b0: 2077 6974 6820 7468 6520 6f70 6572 6174   with the operat
-000209c0: 6f72 2060 603c 6060 0a20 2020 2020 2020  or ``<``.       
-000209d0: 2028 6060 3c60 6029 2061 6e64 2076 616c   (``<``) and val
-000209e0: 6964 6174 6573 2074 6861 7420 7468 6520  idates that the 
-000209f0: 6060 636f 6c75 6d6e 5f6e 616d 6560 6020  ``column_name`` 
-00020a00: 6973 2062 6574 7765 656e 2060 606c 6f77  is between ``low
-00020a10: 5f76 616c 7565 6060 2061 6e64 0a20 2020  _value`` and.   
-00020a20: 2020 2020 2060 6068 6967 685f 7661 6c75       ``high_valu
-00020a30: 6560 602e 0a0a 2020 2020 2020 2020 5365  e``...        Se
-00020a40: 7475 703a 0a20 2020 2020 2020 2020 2020  tup:.           
-00020a50: 202d 2043 7265 6174 6520 6120 7064 2e44   - Create a pd.D
-00020a60: 6174 6146 7261 6d65 2e0a 2020 2020 2020  ataFrame..      
-00020a70: 2020 2020 2020 2d20 496e 7374 616e 6365        - Instance
-00020a80: 206f 6620 6060 5363 616c 6172 5261 6e67   of ``ScalarRang
-00020a90: 6560 6020 636f 6e73 7472 6169 6e74 2077  e`` constraint w
-00020aa0: 6974 6820 6c6f 7720 616e 6420 6869 6768  ith low and high
-00020ab0: 2076 616c 7565 7320 7468 6174 2061 7265   values that are
-00020ac0: 2077 6974 6869 6e20 7468 650a 2020 2020   within the.    
-00020ad0: 2020 2020 2020 2020 2020 6578 7065 6374            expect
-00020ae0: 6564 2072 616e 6765 2e0a 0a20 2020 2020  ed range...     
-00020af0: 2020 2049 6e70 7574 3a0a 2020 2020 2020     Input:.      
-00020b00: 2020 2020 2020 2d20 7064 2e44 6174 6146        - pd.DataF
-00020b10: 7261 6d65 2077 6974 6820 6060 6375 7272  rame with ``curr
-00020b20: 656e 745f 6167 6560 6020 636f 6c75 6d6e  ent_age`` column
-00020b30: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00020b40: 2020 2020 2020 2320 5365 7475 700a 2020        # Setup.  
-00020b50: 2020 2020 2020 7461 626c 655f 6461 7461        table_data
-00020b60: 203d 2070 642e 4461 7461 4672 616d 6528   = pd.DataFrame(
-00020b70: 7b27 6375 7272 656e 745f 6167 6527 3a20  {'current_age': 
-00020b80: 5b32 312c 2032 322c 2032 355d 7d29 0a20  [21, 22, 25]}). 
-00020b90: 2020 2020 2020 2069 6e73 7461 6e63 6520         instance 
-00020ba0: 3d20 5363 616c 6172 5261 6e67 6528 2763  = ScalarRange('c
-00020bb0: 7572 7265 6e74 5f61 6765 272c 2032 302c  urrent_age', 20,
-00020bc0: 2032 3629 0a0a 2020 2020 2020 2020 2320   26)..        # 
-00020bd0: 5275 6e0a 2020 2020 2020 2020 7265 7375  Run.        resu
-00020be0: 6c74 203d 2069 6e73 7461 6e63 652e 6973  lt = instance.is
-00020bf0: 5f76 616c 6964 2874 6162 6c65 5f64 6174  _valid(table_dat
-00020c00: 6129 0a0a 2020 2020 2020 2020 2320 4173  a)..        # As
-00020c10: 7365 7274 0a20 2020 2020 2020 2061 7373  sert.        ass
-00020c20: 6572 7420 616c 6c28 7265 7375 6c74 290a  ert all(result).
-00020c30: 0a20 2020 2064 6566 2074 6573 745f 6973  .    def test_is
-00020c40: 5f76 616c 6964 5f6c 6528 7365 6c66 293a  _valid_le(self):
-00020c50: 0a20 2020 2020 2020 2022 2222 5465 7374  .        """Test
-00020c60: 2074 6865 2060 6053 6361 6c61 7252 616e   the ``ScalarRan
-00020c70: 6765 2e69 735f 7661 6c69 6460 602e 0a0a  ge.is_valid``...
-00020c80: 2020 2020 2020 2020 5468 6973 2074 6573          This tes
-00020c90: 7420 656e 7375 7265 7320 7468 6174 2074  t ensures that t
-00020ca0: 6865 2060 6069 735f 7661 6c69 6460 6020  he ``is_valid`` 
-00020cb0: 6d65 7468 6f64 2077 6f72 6b73 2077 6974  method works wit
-00020cc0: 6820 7468 6520 6f70 6572 6174 6f72 0a20  h the operator. 
-00020cd0: 2020 2020 2020 2060 603c 3d60 6020 616e         ``<=`` an
-00020ce0: 6420 7661 6c69 6461 7465 7320 7468 6174  d validates that
-00020cf0: 2074 6865 2060 6063 6f6c 756d 6e5f 6e61   the ``column_na
-00020d00: 6d65 6060 2069 730a 2020 2020 2020 2020  me`` is.        
-00020d10: 6265 7477 6565 6e20 6060 6c6f 775f 7661  between ``low_va
-00020d20: 6c75 6560 6020 616e 6420 6060 6869 6768  lue`` and ``high
-00020d30: 5f76 616c 7565 6060 2e0a 0a20 2020 2020  _value``...     
-00020d40: 2020 2053 6574 7570 3a0a 2020 2020 2020     Setup:.      
-00020d50: 2020 2020 2020 2d20 4372 6561 7465 2061        - Create a
-00020d60: 2070 642e 4461 7461 4672 616d 652e 0a20   pd.DataFrame.. 
-00020d70: 2020 2020 2020 2020 2020 202d 2049 6e73             - Ins
-00020d80: 7461 6e63 6520 6f66 2060 6053 6361 6c61  tance of ``Scala
-00020d90: 7252 616e 6765 6060 2063 6f6e 7374 7261  rRange`` constra
-00020da0: 696e 7420 7769 7468 206c 6f77 2061 6e64  int with low and
-00020db0: 2068 6967 6820 7661 6c75 6573 2074 6861   high values tha
-00020dc0: 7420 6172 6520 7769 7468 696e 2074 6865  t are within the
-00020dd0: 0a20 2020 2020 2020 2020 2020 2020 2065  .              e
-00020de0: 7870 6563 7465 6420 7261 6e67 6520 616e  xpected range an
-00020df0: 6420 7573 696e 6720 6060 7374 7269 6374  d using ``strict
-00020e00: 5f62 6f75 6e64 6172 6965 7360 6020 6173  _boundaries`` as
-00020e10: 2060 6046 616c 7365 6060 2e0a 0a20 2020   ``False``...   
-00020e20: 2020 2020 2049 6e70 7574 3a0a 2020 2020       Input:.    
-00020e30: 2020 2020 2020 2020 2d20 7064 2e44 6174          - pd.Dat
-00020e40: 6146 7261 6d65 2077 6974 6820 6060 6375  aFrame with ``cu
-00020e50: 7272 656e 745f 6167 6560 6020 636f 6c75  rrent_age`` colu
-00020e60: 6d6e 2e0a 2020 2020 2020 2020 2222 220a  mn..        """.
-00020e70: 2020 2020 2020 2020 2320 5365 7475 700a          # Setup.
-00020e80: 2020 2020 2020 2020 7461 626c 655f 6461          table_da
-00020e90: 7461 203d 2070 642e 4461 7461 4672 616d  ta = pd.DataFram
-00020ea0: 6528 7b27 6375 7272 656e 745f 6167 6527  e({'current_age'
-00020eb0: 3a20 5b32 312c 2032 322c 2032 355d 7d29  : [21, 22, 25]})
-00020ec0: 0a20 2020 2020 2020 2069 6e73 7461 6e63  .        instanc
-00020ed0: 6520 3d20 5363 616c 6172 5261 6e67 6528  e = ScalarRange(
-00020ee0: 2763 7572 7265 6e74 5f61 6765 272c 2032  'current_age', 2
-00020ef0: 312c 2032 352c 2073 7472 6963 745f 626f  1, 25, strict_bo
-00020f00: 756e 6461 7269 6573 3d46 616c 7365 290a  undaries=False).
-00020f10: 0a20 2020 2020 2020 2023 2052 756e 0a20  .        # Run. 
-00020f20: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
-00020f30: 696e 7374 616e 6365 2e69 735f 7661 6c69  instance.is_vali
-00020f40: 6428 7461 626c 655f 6461 7461 290a 0a20  d(table_data).. 
-00020f50: 2020 2020 2020 2023 2041 7373 6572 740a         # Assert.
-00020f60: 2020 2020 2020 2020 6173 7365 7274 2061          assert a
-00020f70: 6c6c 2872 6573 756c 7429 0a0a 2020 2020  ll(result)..    
-00020f80: 6465 6620 7465 7374 5f69 735f 7661 6c69  def test_is_vali
-00020f90: 645f 696e 7661 6c69 6428 7365 6c66 293a  d_invalid(self):
-00020fa0: 0a20 2020 2020 2020 2022 2222 5465 7374  .        """Test
-00020fb0: 2074 6865 2060 6053 6361 6c61 7252 616e   the ``ScalarRan
-00020fc0: 6765 2e69 735f 7661 6c69 6460 602e 0a0a  ge.is_valid``...
-00020fd0: 2020 2020 2020 2020 5468 6973 2074 6573          This tes
-00020fe0: 7420 656e 7375 7265 7320 7468 6174 2074  t ensures that t
-00020ff0: 6865 2060 6069 735f 7661 6c69 6460 6020  he ``is_valid`` 
-00021000: 6661 696c 7320 7768 656e 2074 6865 2064  fails when the d
-00021010: 6174 6120 6973 206e 6f74 2069 6e20 7468  ata is not in th
-00021020: 6520 7261 6e67 652e 0a0a 2020 2020 2020  e range...      
-00021030: 2020 5365 7475 703a 0a20 2020 2020 2020    Setup:.       
-00021040: 2020 2020 202d 2043 7265 6174 6520 6120       - Create a 
-00021050: 7064 2e44 6174 6146 7261 6d65 2077 6974  pd.DataFrame wit
-00021060: 6820 6060 6375 7272 656e 745f 6167 6560  h ``current_age`
-00021070: 6020 636f 6c75 6d6e 2e0a 2020 2020 2020  ` column..      
-00021080: 2020 2020 2020 2d20 496e 7374 616e 6365        - Instance
-00021090: 206f 6620 6060 5363 616c 6172 5261 6e67   of ``ScalarRang
-000210a0: 6560 6020 636f 6e73 7472 6169 6e74 2077  e`` constraint w
-000210b0: 6974 6820 6060 6c6f 775f 7661 6c75 6560  ith ``low_value`
-000210c0: 6020 6869 6768 6572 2074 6861 6e20 7468  ` higher than th
-000210d0: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-000210e0: 6c6f 7720 7661 6c75 6520 696e 2060 6063  low value in ``c
-000210f0: 7572 7265 6e74 5f61 6765 6060 2061 6e64  urrent_age`` and
-00021100: 2068 6967 6820 7661 6c75 6520 6c6f 7765   high value lowe
-00021110: 7220 7468 616e 2074 6865 2068 6967 6865  r than the highe
-00021120: 7220 7661 6c75 6520 696e 2074 6865 0a20  r value in the. 
-00021130: 2020 2020 2020 2020 2020 2020 2060 6063               ``c
-00021140: 7572 7265 6e74 5f61 6765 6060 2e0a 0a20  urrent_age``... 
-00021150: 2020 2020 2020 2049 6e70 7574 3a0a 2020         Input:.  
-00021160: 2020 2020 2020 2020 2020 2d20 7064 2e44            - pd.D
-00021170: 6174 6146 7261 6d65 2077 6974 6820 6060  ataFrame with ``
-00021180: 6375 7272 656e 745f 6167 6560 6020 636f  current_age`` co
-00021190: 6c75 6d6e 2e0a 2020 2020 2020 2020 2222  lumn..        ""
-000211a0: 220a 2020 2020 2020 2020 2320 5365 7475  ".        # Setu
-000211b0: 700a 2020 2020 2020 2020 7461 626c 655f  p.        table_
-000211c0: 6461 7461 203d 2070 642e 4461 7461 4672  data = pd.DataFr
-000211d0: 616d 6528 7b27 6375 7272 656e 745f 6167  ame({'current_ag
-000211e0: 6527 3a20 5b32 312c 2032 322c 2032 355d  e': [21, 22, 25]
-000211f0: 7d29 0a20 2020 2020 2020 2069 6e73 7461  }).        insta
-00021200: 6e63 6520 3d20 5363 616c 6172 5261 6e67  nce = ScalarRang
-00021210: 6528 2763 7572 7265 6e74 5f61 6765 272c  e('current_age',
-00021220: 2032 382c 2031 382c 2073 7472 6963 745f   28, 18, strict_
-00021230: 626f 756e 6461 7269 6573 3d46 616c 7365  boundaries=False
-00021240: 290a 0a20 2020 2020 2020 2023 2052 756e  )..        # Run
-00021250: 0a20 2020 2020 2020 2072 6573 756c 7420  .        result 
-00021260: 3d20 696e 7374 616e 6365 2e69 735f 7661  = instance.is_va
-00021270: 6c69 6428 7461 626c 655f 6461 7461 290a  lid(table_data).
-00021280: 0a20 2020 2020 2020 2023 2041 7373 6572  .        # Asser
-00021290: 740a 2020 2020 2020 2020 6173 7365 7274  t.        assert
-000212a0: 206e 6f74 2061 6c6c 2872 6573 756c 7429   not all(result)
-000212b0: 0a0a 2020 2020 4070 6174 6368 2827 7364  ..    @patch('sd
-000212c0: 762e 636f 6e73 7472 6169 6e74 732e 7461  v.constraints.ta
-000212d0: 6275 6c61 722e 6c6f 6769 7427 290a 2020  bular.logit').  
-000212e0: 2020 6465 6620 7465 7374 5f5f 7472 616e    def test__tran
-000212f0: 7366 6f72 6d28 7365 6c66 2c20 6d6f 636b  sform(self, mock
-00021300: 5f6c 6f67 6974 293a 0a20 2020 2020 2020  _logit):.       
-00021310: 2022 2222 5465 7374 2074 6865 2060 6053   """Test the ``S
-00021320: 6361 6c61 7252 616e 6765 2e5f 7472 616e  calarRange._tran
-00021330: 7366 6f72 6d60 6020 6d65 7468 6f64 2e0a  sform`` method..
-00021340: 0a20 2020 2020 2020 2049 7420 6973 2065  .        It is e
-00021350: 7870 6563 7465 6420 746f 2063 7265 6174  xpected to creat
-00021360: 6520 6120 6e65 7720 636f 6c75 6d6e 2073  e a new column s
-00021370: 696d 696c 6172 2074 6f20 7468 6520 636f  imilar to the co
-00021380: 6e73 7472 6169 6e74 2060 6063 6f6c 756d  nstraint ``colum
-00021390: 6e60 602c 2061 6e64 2074 6865 6e0a 2020  n``, and then.  
-000213a0: 2020 2020 2020 7363 616c 6520 616e 6420        scale and 
-000213b0: 6170 706c 7920 6120 6c6f 6769 7420 6675  apply a logit fu
-000213c0: 6e63 7469 6f6e 2074 6f20 7468 6174 2063  nction to that c
-000213d0: 6f6c 756d 6e2e 0a0a 2020 2020 2020 2020  olumn...        
-000213e0: 4d6f 636b 3a0a 2020 2020 2020 2020 2020  Mock:.          
-000213f0: 2020 2d20 6d6f 636b 2074 6865 206c 6f67    - mock the log
-00021400: 6974 2066 756e 6374 696f 6e2e 0a20 2020  it function..   
-00021410: 2020 2020 2049 6e70 7574 3a0a 2020 2020       Input:.    
-00021420: 2020 2020 2020 2020 2d20 7064 2e44 6174          - pd.Dat
-00021430: 6146 7261 6d65 2077 6974 6820 6060 6375  aFrame with ``cu
-00021440: 7272 656e 745f 6167 6560 6020 636f 6c75  rrent_age`` colu
-00021450: 6d6e 2e0a 0a20 2020 2020 2020 204f 7574  mn...        Out
-00021460: 7075 743a 0a20 2020 2020 2020 2020 2020  put:.           
-00021470: 202d 2070 642e 4461 7461 4672 616d 6520   - pd.DataFrame 
-00021480: 7769 7468 2074 6865 2074 7261 6e73 666f  with the transfo
-00021490: 726d 6564 2060 6063 7572 7265 6e74 5f61  rmed ``current_a
-000214a0: 6765 6060 2e0a 2020 2020 2020 2020 2222  ge``..        ""
-000214b0: 220a 2020 2020 2020 2020 2320 5365 7475  ".        # Setu
-000214c0: 700a 2020 2020 2020 2020 7461 626c 655f  p.        table_
-000214d0: 6461 7461 203d 2070 642e 4461 7461 4672  data = pd.DataFr
-000214e0: 616d 6528 7b27 6375 7272 656e 745f 6167  ame({'current_ag
-000214f0: 6527 3a20 5b32 312c 2032 322c 2032 355d  e': [21, 22, 25]
-00021500: 7d29 0a20 2020 2020 2020 2069 6e73 7461  }).        insta
-00021510: 6e63 6520 3d20 5363 616c 6172 5261 6e67  nce = ScalarRang
-00021520: 6528 2763 7572 7265 6e74 5f61 6765 272c  e('current_age',
-00021530: 2032 302c 2032 3829 0a20 2020 2020 2020   20, 28).       
-00021540: 206d 6f63 6b5f 6c6f 6769 742e 7265 7475   mock_logit.retu
-00021550: 726e 5f76 616c 7565 203d 205b 312c 2032  rn_value = [1, 2
-00021560: 2c20 335d 0a0a 2020 2020 2020 2020 2320  , 3]..        # 
-00021570: 5275 6e0a 2020 2020 2020 2020 696e 7374  Run.        inst
-00021580: 616e 6365 2e66 6974 2874 6162 6c65 5f64  ance.fit(table_d
-00021590: 6174 6129 0a20 2020 2020 2020 206f 7574  ata).        out
-000215a0: 203d 2069 6e73 7461 6e63 652e 5f74 7261   = instance._tra
-000215b0: 6e73 666f 726d 2874 6162 6c65 5f64 6174  nsform(table_dat
-000215c0: 6129 0a0a 2020 2020 2020 2020 2320 4173  a)..        # As
-000215d0: 7365 7274 0a20 2020 2020 2020 2065 7870  sert.        exp
-000215e0: 6563 7465 645f 6f75 7420 3d20 7064 2e44  ected_out = pd.D
-000215f0: 6174 6146 7261 6d65 287b 2763 7572 7265  ataFrame({'curre
-00021600: 6e74 5f61 6765 2332 3023 3238 273a 205b  nt_age#20#28': [
-00021610: 312c 2032 2c20 335d 7d29 0a20 2020 2020  1, 2, 3]}).     
-00021620: 2020 2070 642e 7465 7374 696e 672e 6173     pd.testing.as
-00021630: 7365 7274 5f66 7261 6d65 5f65 7175 616c  sert_frame_equal
-00021640: 2865 7870 6563 7465 645f 6f75 742c 206f  (expected_out, o
-00021650: 7574 290a 0a20 2020 2040 7061 7463 6828  ut)..    @patch(
-00021660: 2773 6476 2e63 6f6e 7374 7261 696e 7473  'sdv.constraints
-00021670: 2e74 6162 756c 6172 2e73 6967 6d6f 6964  .tabular.sigmoid
-00021680: 2729 0a20 2020 2064 6566 2074 6573 745f  ').    def test_
-00021690: 7265 7665 7273 655f 7472 616e 7366 6f72  reverse_transfor
-000216a0: 6d28 7365 6c66 2c20 6d6f 636b 5f73 6967  m(self, mock_sig
-000216b0: 6d6f 6964 293a 0a20 2020 2020 2020 2022  moid):.        "
-000216c0: 2222 5465 7374 2074 6865 2060 6072 6576  ""Test the ``rev
-000216d0: 6572 7365 5f74 7261 6e73 666f 726d 6060  erse_transform``
-000216e0: 206d 6574 686f 6420 666f 7220 6060 5363   method for ``Sc
-000216f0: 616c 6172 5261 6e67 6560 602e 0a0a 2020  alarRange``...  
-00021700: 2020 2020 2020 4974 2069 7320 6578 7065        It is expe
-00021710: 6374 6564 2074 6f20 7265 636f 7665 7220  cted to recover 
-00021720: 7468 6520 6f72 6967 696e 616c 2074 6162  the original tab
-00021730: 6c65 2077 6869 6368 2077 6173 2074 7261  le which was tra
-00021740: 6e73 666f 726d 6564 2c20 6275 7420 7769  nsformed, but wi
-00021750: 7468 2064 6966 6665 7265 6e74 0a20 2020  th different.   
-00021760: 2020 2020 2063 6f6c 756d 6e20 6f72 6465       column orde
-00021770: 722e 2049 7420 646f 6573 2073 6f20 6279  r. It does so by
-00021780: 2061 7070 6c79 696e 6720 6120 7369 676d   applying a sigm
-00021790: 6f69 6420 746f 2074 6865 2074 7261 6e73  oid to the trans
-000217a0: 666f 726d 6564 2063 6f6c 756d 6e20 616e  formed column an
-000217b0: 6420 7468 656e 0a20 2020 2020 2020 2073  d then.        s
-000217c0: 6361 6c69 6e67 2069 7420 6261 636b 2074  caling it back t
-000217d0: 6f20 7468 6520 6f72 6967 696e 616c 2073  o the original s
-000217e0: 7061 6365 2e20 4974 2061 6c73 6f20 7265  pace. It also re
-000217f0: 706c 6163 6573 2074 6865 2074 7261 6e73  places the trans
-00021800: 666f 726d 6564 2063 6f6c 756d 6e20 7769  formed column wi
-00021810: 7468 0a20 2020 2020 2020 2061 6e20 6571  th.        an eq
-00021820: 7561 6c20 636f 6c75 6d6e 2062 7574 2077  ual column but w
-00021830: 6974 6820 7468 6520 6f72 6967 696e 616c  ith the original
-00021840: 206e 616d 652e 0a0a 2020 2020 2020 2020   name...        
-00021850: 4d6f 636b 3a0a 2020 2020 2020 2020 2020  Mock:.          
-00021860: 2020 2d20 4d6f 636b 2074 6865 2073 6967    - Mock the sig
-00021870: 6d6f 6964 2066 756e 6374 696f 6e2e 0a0a  moid function...
-00021880: 2020 2020 2020 2020 5365 7475 703a 0a20          Setup:. 
-00021890: 2020 2020 2020 2020 2020 202d 204f 7269             - Ori
-000218a0: 6769 6e61 6c20 7461 626c 6520 6461 7461  ginal table data
-000218b0: 2e0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
-000218c0: 416e 2065 7870 6563 7465 6420 7472 616e  An expected tran
-000218d0: 7366 6f72 6d65 6420 6461 7461 2e0a 2020  sformed data..  
-000218e0: 2020 2020 2020 2020 2020 2d20 496e 7374            - Inst
-000218f0: 616e 6365 206f 6620 5363 616c 6172 5261  ance of ScalarRa
-00021900: 6e67 6520 636f 6e73 7472 6169 6e74 2e0a  nge constraint..
-00021910: 0a20 2020 2020 2020 204f 7574 7075 743a  .        Output:
-00021920: 0a20 2020 2020 2020 2020 2020 202d 2041  .            - A
-00021930: 2070 642e 4461 7461 4672 616d 6520 636f   pd.DataFrame co
-00021940: 6e74 6169 6e69 6e67 2074 6865 206f 7269  ntaining the ori
-00021950: 6769 6e61 6c20 6461 7461 2e0a 2020 2020  ginal data..    
-00021960: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00021970: 2320 5365 7475 700a 2020 2020 2020 2020  # Setup.        
-00021980: 7461 626c 655f 6461 7461 203d 2070 642e  table_data = pd.
-00021990: 4461 7461 4672 616d 6528 7b27 6375 7272  DataFrame({'curr
-000219a0: 656e 745f 6167 6527 3a20 5b32 312c 2032  ent_age': [21, 2
-000219b0: 322c 2032 355d 7d29 0a20 2020 2020 2020  2, 25]}).       
-000219c0: 2074 7261 6e73 666f 726d 6564 5f64 6174   transformed_dat
-000219d0: 6120 3d20 7064 2e44 6174 6146 7261 6d65  a = pd.DataFrame
-000219e0: 287b 2763 7572 7265 6e74 5f61 6765 2332  ({'current_age#2
-000219f0: 3023 3238 273a 205b 312c 2032 2c20 335d  0#28': [1, 2, 3]
-00021a00: 7d29 0a20 2020 2020 2020 206d 6f63 6b5f  }).        mock_
-00021a10: 7369 676d 6f69 642e 7265 7475 726e 5f76  sigmoid.return_v
-00021a20: 616c 7565 203d 2070 642e 5365 7269 6573  alue = pd.Series
-00021a30: 285b 3231 2c20 3232 2c20 3235 5d29 0a20  ([21, 22, 25]). 
-00021a40: 2020 2020 2020 2069 6e73 7461 6e63 6520         instance 
-00021a50: 3d20 5363 616c 6172 5261 6e67 6528 2763  = ScalarRange('c
-00021a60: 7572 7265 6e74 5f61 6765 272c 2032 302c  urrent_age', 20,
-00021a70: 2032 3829 0a0a 2020 2020 2020 2020 2320   28)..        # 
-00021a80: 5275 6e0a 2020 2020 2020 2020 696e 7374  Run.        inst
-00021a90: 616e 6365 2e66 6974 2874 6162 6c65 5f64  ance.fit(table_d
-00021aa0: 6174 6129 0a20 2020 2020 2020 206f 7574  ata).        out
-00021ab0: 203d 2069 6e73 7461 6e63 652e 7265 7665   = instance.reve
-00021ac0: 7273 655f 7472 616e 7366 6f72 6d28 7472  rse_transform(tr
-00021ad0: 616e 7366 6f72 6d65 645f 6461 7461 290a  ansformed_data).
-00021ae0: 0a20 2020 2020 2020 2023 2041 7373 6572  .        # Asser
-00021af0: 740a 2020 2020 2020 2020 7064 2e74 6573  t.        pd.tes
-00021b00: 7469 6e67 2e61 7373 6572 745f 6672 616d  ting.assert_fram
-00021b10: 655f 6571 7561 6c28 7461 626c 655f 6461  e_equal(table_da
-00021b20: 7461 2c20 6f75 7429 0a20 2020 2020 2020  ta, out).       
-00021b30: 206d 6f63 6b5f 7369 676d 6f69 642e 6173   mock_sigmoid.as
-00021b40: 7365 7274 5f63 616c 6c65 645f 6f6e 6365  sert_called_once
-00021b50: 2829 0a0a 2020 2020 4070 6174 6368 2827  ()..    @patch('
-00021b60: 7364 762e 636f 6e73 7472 6169 6e74 732e  sdv.constraints.
-00021b70: 7461 6275 6c61 722e 7064 2729 0a20 2020  tabular.pd').   
-00021b80: 2040 7061 7463 6828 2773 6476 2e63 6f6e   @patch('sdv.con
-00021b90: 7374 7261 696e 7473 2e74 6162 756c 6172  straints.tabular
-00021ba0: 2e73 6967 6d6f 6964 2729 0a20 2020 2064  .sigmoid').    d
-00021bb0: 6566 2074 6573 745f 7265 7665 7273 655f  ef test_reverse_
-00021bc0: 7472 616e 7366 6f72 6d5f 6973 5f64 6174  transform_is_dat
-00021bd0: 6574 696d 6528 7365 6c66 2c20 6d6f 636b  etime(self, mock
-00021be0: 5f73 6967 6d6f 6964 2c20 6d6f 636b 5f70  _sigmoid, mock_p
-00021bf0: 6429 3a0a 2020 2020 2020 2020 2222 2254  d):.        """T
-00021c00: 6573 7420 7468 6520 6060 7265 7665 7273  est the ``revers
-00021c10: 655f 7472 616e 7366 6f72 6d60 6020 6d65  e_transform`` me
-00021c20: 7468 6f64 2066 6f72 2060 6053 6361 6c61  thod for ``Scala
-00021c30: 7252 616e 6765 6060 2e0a 0a20 2020 2020  rRange``...     
-00021c40: 2020 2057 6865 6e20 6060 696e 7374 616e     When ``instan
-00021c50: 6365 2e5f 6973 5f64 6174 6574 696d 6560  ce._is_datetime`
-00021c60: 6020 6973 2060 6054 7275 6560 602c 2074  ` is ``True``, t
-00021c70: 6865 2064 6174 6120 7368 6f75 6c64 2062  he data should b
-00021c80: 6520 636f 6e76 6572 7465 640a 2020 2020  e converted.    
-00021c90: 2020 2020 746f 2060 6070 616e 6461 732e      to ``pandas.
-00021ca0: 746f 5f64 6174 6574 696d 6560 602e 0a0a  to_datetime``...
-00021cb0: 2020 2020 2020 2020 4d6f 636b 3a0a 2020          Mock:.  
-00021cc0: 2020 2020 2020 2020 2020 2d20 4d6f 636b            - Mock
-00021cd0: 2074 6865 2073 6967 6d6f 6964 2066 756e   the sigmoid fun
-00021ce0: 6374 696f 6e2e 0a20 2020 2020 2020 2020  ction..         
-00021cf0: 2020 202d 204d 6f63 6b20 7061 6e64 6173     - Mock pandas
-00021d00: 2e0a 0a20 2020 2020 2020 2053 6574 7570  ...        Setup
-00021d10: 3a0a 2020 2020 2020 2020 2020 2020 2d20  :.            - 
-00021d20: 4f72 6967 696e 616c 2074 6162 6c65 2064  Original table d
-00021d30: 6174 612e 0a20 2020 2020 2020 2020 2020  ata..           
-00021d40: 202d 2041 6e20 6578 7065 6374 6564 2074   - An expected t
-00021d50: 7261 6e73 666f 726d 6564 2064 6174 612e  ransformed data.
-00021d60: 0a20 2020 2020 2020 2020 2020 202d 2049  .            - I
-00021d70: 6e73 7461 6e63 6520 6f66 2053 6361 6c61  nstance of Scala
-00021d80: 7252 616e 6765 2063 6f6e 7374 7261 696e  rRange constrain
-00021d90: 742e 0a0a 2020 2020 2020 2020 4f75 7470  t...        Outp
-00021da0: 7574 3a0a 2020 2020 2020 2020 2020 2020  ut:.            
-00021db0: 2d20 4120 7064 2e44 6174 6146 7261 6d65  - A pd.DataFrame
-00021dc0: 2063 6f6e 7461 696e 696e 6720 7468 6520   containing the 
-00021dd0: 6f72 6967 696e 616c 2064 6174 612e 0a0a  original data...
-00021de0: 2020 2020 2020 2020 5369 6465 2045 6666          Side Eff
-00021df0: 6563 7473 3a0a 2020 2020 2020 2020 2020  ects:.          
-00021e00: 2020 2d20 6060 6d6f 636b 5f70 6460 6020    - ``mock_pd`` 
-00021e10: 6861 7320 746f 2062 6520 6361 6c6c 6564  has to be called
-00021e20: 206f 6e63 652e 0a20 2020 2020 2020 2022   once..        "
-00021e30: 2222 0a20 2020 2020 2020 2023 2053 6574  "".        # Set
-00021e40: 7570 0a20 2020 2020 2020 2074 7261 6e73  up.        trans
-00021e50: 666f 726d 6564 5f64 6174 6120 3d20 7064  formed_data = pd
-00021e60: 2e44 6174 6146 7261 6d65 287b 2763 7572  .DataFrame({'cur
-00021e70: 7265 6e74 5f61 6765 2332 3023 3238 273a  rent_age#20#28':
-00021e80: 205b 312c 2032 2c20 335d 7d29 0a20 2020   [1, 2, 3]}).   
-00021e90: 2020 2020 206d 6f63 6b5f 7369 676d 6f69       mock_sigmoi
-00021ea0: 642e 7265 7475 726e 5f76 616c 7565 203d  d.return_value =
-00021eb0: 2070 642e 5365 7269 6573 285b 3231 2c20   pd.Series([21, 
-00021ec0: 3232 2c20 3235 5d29 0a20 2020 2020 2020  22, 25]).       
-00021ed0: 2069 6e73 7461 6e63 6520 3d20 5363 616c   instance = Scal
-00021ee0: 6172 5261 6e67 6528 2763 7572 7265 6e74  arRange('current
-00021ef0: 5f61 6765 272c 2032 302c 2032 3829 0a20  _age', 20, 28). 
-00021f00: 2020 2020 2020 2069 6e73 7461 6e63 652e         instance.
-00021f10: 5f74 7261 6e73 666f 726d 6564 5f63 6f6c  _transformed_col
-00021f20: 756d 6e20 3d20 2763 7572 7265 6e74 5f61  umn = 'current_a
-00021f30: 6765 2332 3023 3238 270a 2020 2020 2020  ge#20#28'.      
-00021f40: 2020 696e 7374 616e 6365 2e5f 6973 5f64    instance._is_d
-00021f50: 6174 6574 696d 6520 3d20 5472 7565 0a20  atetime = True. 
-00021f60: 2020 2020 2020 206d 6f63 6b5f 7064 2e74         mock_pd.t
-00021f70: 6f5f 6461 7465 7469 6d65 2e73 6964 655f  o_datetime.side_
-00021f80: 6566 6665 6374 203d 206c 616d 6264 6120  effect = lambda 
-00021f90: 783a 2070 642e 746f 5f64 6174 6574 696d  x: pd.to_datetim
-00021fa0: 6528 2732 3032 312d 3032 2d30 3220 3130  e('2021-02-02 10
-00021fb0: 3a31 303a 3539 2729 0a0a 2020 2020 2020  :10:59')..      
-00021fc0: 2020 2320 5275 6e0a 2020 2020 2020 2020    # Run.        
-00021fd0: 6f75 7470 7574 203d 2069 6e73 7461 6e63  output = instanc
-00021fe0: 652e 7265 7665 7273 655f 7472 616e 7366  e.reverse_transf
-00021ff0: 6f72 6d28 7472 616e 7366 6f72 6d65 645f  orm(transformed_
-00022000: 6461 7461 290a 0a20 2020 2020 2020 2023  data)..        #
-00022010: 2041 7373 6572 740a 2020 2020 2020 2020   Assert.        
-00022020: 6578 7065 6374 6564 5f6f 7574 7075 7420  expected_output 
-00022030: 3d20 7064 2e44 6174 6146 7261 6d65 287b  = pd.DataFrame({
-00022040: 0a20 2020 2020 2020 2020 2020 2027 6375  .            'cu
-00022050: 7272 656e 745f 6167 6527 3a20 5b0a 2020  rrent_age': [.  
-00022060: 2020 2020 2020 2020 2020 2020 2020 7064                pd
-00022070: 2e74 6f5f 6461 7465 7469 6d65 2827 3230  .to_datetime('20
-00022080: 3231 2d30 322d 3032 2031 303a 3130 3a35  21-02-02 10:10:5
-00022090: 3927 292c 0a20 2020 2020 2020 2020 2020  9'),.           
-000220a0: 2020 2020 2070 642e 746f 5f64 6174 6574       pd.to_datet
-000220b0: 696d 6528 2732 3032 312d 3032 2d30 3220  ime('2021-02-02 
-000220c0: 3130 3a31 303a 3539 2729 2c0a 2020 2020  10:10:59'),.    
-000220d0: 2020 2020 2020 2020 2020 2020 7064 2e74              pd.t
-000220e0: 6f5f 6461 7465 7469 6d65 2827 3230 3231  o_datetime('2021
-000220f0: 2d30 322d 3032 2031 303a 3130 3a35 3927  -02-02 10:10:59'
-00022100: 292c 0a20 2020 2020 2020 2020 2020 205d  ),.            ]
-00022110: 0a20 2020 2020 2020 207d 290a 2020 2020  .        }).    
-00022120: 2020 2020 7064 2e74 6573 7469 6e67 2e61      pd.testing.a
-00022130: 7373 6572 745f 6672 616d 655f 6571 7561  ssert_frame_equa
-00022140: 6c28 6578 7065 6374 6564 5f6f 7574 7075  l(expected_outpu
-00022150: 742c 206f 7574 7075 7429 0a20 2020 2020  t, output).     
-00022160: 2020 206d 6f63 6b5f 7369 676d 6f69 642e     mock_sigmoid.
-00022170: 6173 7365 7274 5f63 616c 6c65 645f 6f6e  assert_called_on
-00022180: 6365 2829 0a20 2020 2020 2020 2061 7373  ce().        ass
-00022190: 6572 7420 6d6f 636b 5f70 642e 746f 5f64  ert mock_pd.to_d
-000221a0: 6174 6574 696d 652e 6361 6c6c 5f63 6f75  atetime.call_cou
-000221b0: 6e74 203d 3d20 310a 0a0a 636c 6173 7320  nt == 1...class 
-000221c0: 5465 7374 4f6e 6548 6f74 456e 636f 6469  TestOneHotEncodi
-000221d0: 6e67 2829 3a0a 0a20 2020 2064 6566 2074  ng():..    def t
-000221e0: 6573 745f 5f76 616c 6964 6174 655f 696e  est__validate_in
-000221f0: 7075 7473 2873 656c 6629 3a0a 2020 2020  puts(self):.    
-00022200: 2020 2020 2222 2254 6573 7420 7468 6520      """Test the 
-00022210: 6060 4f6e 6548 6f74 456e 636f 6469 6e67  ``OneHotEncoding
-00022220: 2e5f 7661 6c69 6461 7465 5f69 6e70 7574  ._validate_input
-00022230: 7360 6020 6d65 7468 6f64 2e0a 0a20 2020  s`` method...   
-00022240: 2020 2020 2049 6e70 7574 3a0a 2020 2020       Input:.    
-00022250: 2020 2020 2d20 2049 6e63 6f72 7265 6374      -  Incorrect
-00022260: 2070 6172 616d 6574 6572 7320 666f 7220   parameters for 
-00022270: 7468 6520 6d65 7468 6f64 0a20 2020 2020  the method.     
-00022280: 2020 2052 6169 7365 733a 0a20 2020 2020     Raises:.     
-00022290: 2020 202d 204c 6973 7420 6f66 2056 616c     - List of Val
-000222a0: 7565 4572 726f 7273 0a20 2020 2020 2020  ueErrors.       
-000222b0: 2022 2222 0a20 2020 2020 2020 2023 2052   """.        # R
-000222c0: 756e 202f 2041 7373 6572 740a 2020 2020  un / Assert.    
-000222d0: 2020 2020 7769 7468 2070 7974 6573 742e      with pytest.
-000222e0: 7261 6973 6573 2841 6767 7265 6761 7465  raises(Aggregate
-000222f0: 436f 6e73 7472 6169 6e74 7345 7272 6f72  ConstraintsError
-00022300: 2920 6173 2065 7272 6f72 3a0a 2020 2020  ) as error:.    
-00022310: 2020 2020 2020 2020 4f6e 6548 6f74 456e          OneHotEn
-00022320: 636f 6469 6e67 2e5f 7661 6c69 6461 7465  coding._validate
-00022330: 5f69 6e70 7574 7328 6e6f 745f 636f 6c75  _inputs(not_colu
-00022340: 6d6e 5f6e 616d 6573 3d4e 6f6e 652c 2073  mn_names=None, s
-00022350: 6f6d 6574 6869 6e67 5f65 6c73 653d 4e6f  omething_else=No
-00022360: 6e65 290a 0a20 2020 2020 2020 2065 7272  ne)..        err
-00022370: 5f6d 7367 203d 2028 0a20 2020 2020 2020  _msg = (.       
-00022380: 2020 2020 2072 274d 6973 7369 6e67 2072       r'Missing r
-00022390: 6571 7569 7265 6420 7661 6c75 6573 207b  equired values {
-000223a0: 282e 2a29 7d20 696e 2061 204f 6e65 486f  (.*)} in a OneHo
-000223b0: 7445 6e63 6f64 696e 6720 636f 6e73 7472  tEncoding constr
-000223c0: 6169 6e74 2e27 0a20 2020 2020 2020 2020  aint.'.         
-000223d0: 2020 2072 275c 6e5c 6e49 6e76 616c 6964     r'\n\nInvalid
-000223e0: 2076 616c 7565 7320 7b28 2e2a 297d 2061   values {(.*)} a
-000223f0: 7265 2070 7265 7365 6e74 2069 6e20 6120  re present in a 
-00022400: 4f6e 6548 6f74 456e 636f 6469 6e67 2063  OneHotEncoding c
-00022410: 6f6e 7374 7261 696e 742e 270a 2020 2020  onstraint.'.    
-00022420: 2020 2020 290a 2020 2020 2020 2020 6772      ).        gr
-00022430: 6f75 7073 203d 2072 652e 7365 6172 6368  oups = re.search
-00022440: 2865 7272 5f6d 7367 2c20 7374 7228 6572  (err_msg, str(er
-00022450: 726f 722e 7661 6c75 6529 290a 2020 2020  ror.value)).    
-00022460: 2020 2020 6173 7365 7274 2067 726f 7570      assert group
-00022470: 7320 6973 206e 6f74 204e 6f6e 650a 2020  s is not None.  
-00022480: 2020 2020 2020 6173 7365 7274 2073 7472        assert str
-00022490: 2865 7661 6c28 6772 6f75 7073 2e67 726f  (eval(groups.gro
-000224a0: 7570 2831 2929 2920 3d3d 2027 636f 6c75  up(1))) == 'colu
-000224b0: 6d6e 5f6e 616d 6573 270a 2020 2020 2020  mn_names'.      
-000224c0: 2020 6173 7365 7274 2073 6574 2865 7661    assert set(eva
-000224d0: 6c28 6772 6f75 7073 2e67 726f 7570 2832  l(groups.group(2
-000224e0: 2929 2920 3d3d 207b 276e 6f74 5f63 6f6c  ))) == {'not_col
-000224f0: 756d 6e5f 6e61 6d65 7327 2c20 2773 6f6d  umn_names', 'som
-00022500: 6574 6869 6e67 5f65 6c73 6527 7d0a 0a20  ething_else'}.. 
-00022510: 2020 2064 6566 2074 6573 745f 5f76 616c     def test__val
-00022520: 6964 6174 655f 6d65 7461 6461 7461 5f63  idate_metadata_c
-00022530: 6f6c 756d 6e73 2873 656c 6629 3a0a 2020  olumns(self):.  
-00022540: 2020 2020 2020 2222 2254 6573 7420 7468        """Test th
-00022550: 6520 6060 5f76 616c 6964 6174 655f 6d65  e ``_validate_me
-00022560: 7461 6461 7461 5f63 6f6c 756d 6e73 6060  tadata_columns``
-00022570: 206d 6574 686f 642e 0a0a 2020 2020 2020   method...      
-00022580: 2020 416c 6c20 6f66 2074 6865 2063 6f6c    All of the col
-00022590: 756d 6e73 2070 6173 7365 6420 696e 2063  umns passed in c
-000225a0: 6f6c 756d 6e5f 6e61 6d65 7320 7368 6f75  olumn_names shou
-000225b0: 6c64 2062 6520 696e 2074 6865 206d 6574  ld be in the met
-000225c0: 6164 6174 612e 0a0a 2020 2020 2020 2020  adata...        
-000225d0: 496e 7075 743a 0a20 2020 2020 2020 2020  Input:.         
-000225e0: 2020 202d 2063 6f6c 756d 6e5f 6e61 6d65     - column_name
-000225f0: 7320 7769 7468 2063 6f6c 756d 6e73 2074  s with columns t
-00022600: 6861 7420 6172 6520 616c 6c20 696e 2074  hat are all in t
-00022610: 6865 206d 6574 6164 6174 612e 0a0a 2020  he metadata...  
-00022620: 2020 2020 2020 5369 6465 2065 6666 6563        Side effec
-00022630: 743a 0a20 2020 2020 2020 2020 2020 202d  t:.            -
-00022640: 204e 6f20 6572 726f 7220 7368 6f75 6c64   No error should
-00022650: 2062 6520 7261 6973 6564 2e0a 2020 2020   be raised..    
-00022660: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00022670: 2320 5365 7475 700a 2020 2020 2020 2020  # Setup.        
-00022680: 6d65 7461 6461 7461 203d 204d 6f63 6b28  metadata = Mock(
-00022690: 290a 2020 2020 2020 2020 6d65 7461 6461  ).        metada
-000226a0: 7461 2e63 6f6c 756d 6e73 203d 207b 2761  ta.columns = {'a
-000226b0: 273a 2031 2c20 2762 273a 2032 7d0a 0a20  ': 1, 'b': 2}.. 
-000226c0: 2020 2020 2020 2023 2052 756e 0a20 2020         # Run.   
-000226d0: 2020 2020 204f 6e65 486f 7445 6e63 6f64       OneHotEncod
-000226e0: 696e 672e 5f76 616c 6964 6174 655f 6d65  ing._validate_me
-000226f0: 7461 6461 7461 5f63 6f6c 756d 6e73 286d  tadata_columns(m
-00022700: 6574 6164 6174 612c 2063 6f6c 756d 6e5f  etadata, column_
-00022710: 6e61 6d65 733d 5b27 6127 2c20 2762 275d  names=['a', 'b']
-00022720: 290a 0a20 2020 2064 6566 2074 6573 745f  )..    def test_
-00022730: 5f76 616c 6964 6174 655f 6d65 7461 6461  _validate_metada
-00022740: 7461 5f63 6f6c 756d 6e73 5f72 6169 7365  ta_columns_raise
-00022750: 735f 6572 726f 7228 7365 6c66 293a 0a20  s_error(self):. 
-00022760: 2020 2020 2020 2022 2222 5465 7374 2074         """Test t
-00022770: 6865 2060 605f 7661 6c69 6461 7465 5f6d  he ``_validate_m
-00022780: 6574 6164 6174 615f 636f 6c75 6d6e 7360  etadata_columns`
-00022790: 6020 6d65 7468 6f64 2773 2065 7272 6f72  ` method's error
-000227a0: 2063 6f6e 6469 7469 6f6e 2e0a 0a20 2020   condition...   
-000227b0: 2020 2020 2049 6620 616e 7920 636f 6c75       If any colu
-000227c0: 6d6e 7320 696e 2063 6f6c 756d 6e5f 6e61  mns in column_na
-000227d0: 6d65 7320 6172 6520 6e6f 7420 696e 2074  mes are not in t
-000227e0: 6865 206d 6574 6164 6174 612c 2061 6e20  he metadata, an 
-000227f0: 6572 726f 7220 7368 6f75 6c64 2062 6520  error should be 
-00022800: 7261 6973 6564 2e0a 0a20 2020 2020 2020  raised...       
-00022810: 2049 6e70 7574 3a0a 2020 2020 2020 2020   Input:.        
-00022820: 2020 2020 2d20 636f 6c75 6d6e 5f6e 616d      - column_nam
-00022830: 6573 2074 6861 7420 636f 6e74 6169 6e73  es that contains
-00022840: 2061 2063 6f6c 756d 6e20 6e6f 7420 696e   a column not in
-00022850: 2074 6865 206d 6574 6164 6174 612e 0a0a   the metadata...
-00022860: 2020 2020 2020 2020 5369 6465 2065 6666          Side eff
-00022870: 6563 743a 0a20 2020 2020 2020 2020 2020  ect:.           
-00022880: 202d 2043 6f6e 7374 7261 696e 744d 6574   - ConstraintMet
-00022890: 6164 6174 6145 7272 6f72 2073 686f 756c  adataError shoul
-000228a0: 6420 6265 2072 6169 7365 642e 0a20 2020  d be raised..   
-000228b0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-000228c0: 2023 2053 6574 7570 0a20 2020 2020 2020   # Setup.       
-000228d0: 206d 6574 6164 6174 6120 3d20 4d6f 636b   metadata = Mock
-000228e0: 2829 0a20 2020 2020 2020 206d 6574 6164  ().        metad
-000228f0: 6174 612e 636f 6c75 6d6e 7320 3d20 7b27  ata.columns = {'
-00022900: 6127 3a20 312c 2027 6227 3a20 327d 0a0a  a': 1, 'b': 2}..
-00022910: 2020 2020 2020 2020 2320 5275 6e0a 2020          # Run.  
-00022920: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
-00022930: 6167 6520 3d20 7265 2e65 7363 6170 6528  age = re.escape(
-00022940: 0a20 2020 2020 2020 2020 2020 2027 4120  .            'A 
-00022950: 4f6e 6548 6f74 456e 636f 6469 6e67 2063  OneHotEncoding c
-00022960: 6f6e 7374 7261 696e 7420 6973 2062 6569  onstraint is bei
-00022970: 6e67 2061 7070 6c69 6564 2074 6f20 696e  ng applied to in
-00022980: 7661 6c69 6420 636f 6c75 6d6e 206e 616d  valid column nam
-00022990: 6573 2027 0a20 2020 2020 2020 2020 2020  es '.           
-000229a0: 2022 7b27 6327 7d2e 2054 6865 2063 6f6c   "{'c'}. The col
-000229b0: 756d 6e73 206d 7573 7420 6578 6973 7420  umns must exist 
-000229c0: 696e 2074 6865 2074 6162 6c65 2e22 0a20  in the table.". 
-000229d0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-000229e0: 2077 6974 6820 7079 7465 7374 2e72 6169   with pytest.rai
-000229f0: 7365 7328 436f 6e73 7472 6169 6e74 4d65  ses(ConstraintMe
-00022a00: 7461 6461 7461 4572 726f 722c 206d 6174  tadataError, mat
-00022a10: 6368 3d65 7272 6f72 5f6d 6573 7361 6765  ch=error_message
-00022a20: 293a 0a20 2020 2020 2020 2020 2020 204f  ):.            O
-00022a30: 6e65 486f 7445 6e63 6f64 696e 672e 5f76  neHotEncoding._v
-00022a40: 616c 6964 6174 655f 6d65 7461 6461 7461  alidate_metadata
-00022a50: 5f63 6f6c 756d 6e73 286d 6574 6164 6174  _columns(metadat
-00022a60: 612c 2063 6f6c 756d 6e5f 6e61 6d65 733d  a, column_names=
-00022a70: 5b27 6127 2c20 2763 275d 290a 0a20 2020  ['a', 'c'])..   
-00022a80: 2064 6566 2074 6573 745f 7265 7665 7273   def test_revers
-00022a90: 655f 7472 616e 7366 6f72 6d28 7365 6c66  e_transform(self
-00022aa0: 293a 0a20 2020 2020 2020 2022 2222 5465  ):.        """Te
-00022ab0: 7374 2074 6865 2060 604f 6e65 486f 7445  st the ``OneHotE
-00022ac0: 6e63 6f64 696e 672e 7265 7665 7273 655f  ncoding.reverse_
-00022ad0: 7472 616e 7366 6f72 6d60 6020 6d65 7468  transform`` meth
-00022ae0: 6f64 2e0a 0a20 2020 2020 2020 2049 7420  od...        It 
-00022af0: 6973 2065 7870 6563 7465 6420 746f 2c20  is expected to, 
-00022b00: 666f 7220 6561 6368 206f 6620 7468 6520  for each of the 
-00022b10: 6170 7072 6f70 7269 6174 6520 726f 7773  appropriate rows
-00022b20: 2c20 7365 7420 7468 6520 636f 6c75 6d6e  , set the column
-00022b30: 0a20 2020 2020 2020 2077 6974 6820 7468  .        with th
-00022b40: 6520 6c61 7267 6573 7420 7661 6c75 6520  e largest value 
-00022b50: 746f 206f 6e65 2061 6e64 2073 6574 2061  to one and set a
-00022b60: 6c6c 206f 7468 6572 2063 6f6c 756d 6e73  ll other columns
-00022b70: 2074 6f20 7a65 726f 2e0a 0a20 2020 2020   to zero...     
-00022b80: 2020 2049 6e70 7574 3a0a 2020 2020 2020     Input:.      
-00022b90: 2020 2d20 5461 626c 6520 6461 7461 2077    - Table data w
-00022ba0: 6974 6820 616e 7920 6e75 6d62 6572 7320  ith any numbers 
-00022bb0: 2870 616e 6461 732e 4461 7461 4672 616d  (pandas.DataFram
-00022bc0: 6529 0a20 2020 2020 2020 204f 7574 7075  e).        Outpu
-00022bd0: 743a 0a20 2020 2020 2020 202d 2054 6162  t:.        - Tab
-00022be0: 6c65 2064 6174 6120 7768 6572 6520 7468  le data where th
-00022bf0: 6520 6170 7072 6f70 7269 6174 6520 726f  e appropriate ro
-00022c00: 7773 2061 7265 206f 6e65 2068 6f74 2028  ws are one hot (
-00022c10: 7061 6e64 6173 2e44 6174 6146 7261 6d65  pandas.DataFrame
-00022c20: 290a 2020 2020 2020 2020 2222 220a 2020  ).        """.  
-00022c30: 2020 2020 2020 2320 5365 7475 700a 2020        # Setup.  
-00022c40: 2020 2020 2020 696e 7374 616e 6365 203d        instance =
-00022c50: 204f 6e65 486f 7445 6e63 6f64 696e 6728   OneHotEncoding(
-00022c60: 636f 6c75 6d6e 5f6e 616d 6573 3d5b 2761  column_names=['a
-00022c70: 272c 2027 6227 5d29 0a0a 2020 2020 2020  ', 'b'])..      
-00022c80: 2020 2320 5275 6e0a 2020 2020 2020 2020    # Run.        
-00022c90: 7461 626c 655f 6461 7461 203d 2070 642e  table_data = pd.
-00022ca0: 4461 7461 4672 616d 6528 7b0a 2020 2020  DataFrame({.    
-00022cb0: 2020 2020 2020 2020 2761 273a 205b 302e          'a': [0.
-00022cc0: 312c 2030 2e35 2c20 302e 385d 2c0a 2020  1, 0.5, 0.8],.  
-00022cd0: 2020 2020 2020 2020 2020 2762 273a 205b            'b': [
-00022ce0: 302e 382c 2030 2e31 2c20 302e 395d 2c0a  0.8, 0.1, 0.9],.
-00022cf0: 2020 2020 2020 2020 2020 2020 2763 273a              'c':
-00022d00: 205b 312c 2032 2c20 335d 0a20 2020 2020   [1, 2, 3].     
-00022d10: 2020 207d 290a 2020 2020 2020 2020 6f75     }).        ou
-00022d20: 7420 3d20 696e 7374 616e 6365 2e72 6576  t = instance.rev
-00022d30: 6572 7365 5f74 7261 6e73 666f 726d 2874  erse_transform(t
-00022d40: 6162 6c65 5f64 6174 6129 0a0a 2020 2020  able_data)..    
-00022d50: 2020 2020 2320 4173 7365 7274 0a20 2020      # Assert.   
-00022d60: 2020 2020 2065 7870 6563 7465 645f 6f75       expected_ou
-00022d70: 7420 3d20 7064 2e44 6174 6146 7261 6d65  t = pd.DataFrame
-00022d80: 287b 0a20 2020 2020 2020 2020 2020 2027  ({.            '
-00022d90: 6127 3a20 5b30 2e30 2c20 312e 302c 2030  a': [0.0, 1.0, 0
-00022da0: 2e30 5d2c 0a20 2020 2020 2020 2020 2020  .0],.           
-00022db0: 2027 6227 3a20 5b31 2e30 2c20 302e 302c   'b': [1.0, 0.0,
-00022dc0: 2031 2e30 5d2c 0a20 2020 2020 2020 2020   1.0],.         
-00022dd0: 2020 2027 6327 3a20 5b31 2c20 322c 2033     'c': [1, 2, 3
-00022de0: 5d0a 2020 2020 2020 2020 7d29 0a20 2020  ].        }).   
-00022df0: 2020 2020 2070 642e 7465 7374 696e 672e       pd.testing.
-00022e00: 6173 7365 7274 5f66 7261 6d65 5f65 7175  assert_frame_equ
-00022e10: 616c 2865 7870 6563 7465 645f 6f75 742c  al(expected_out,
-00022e20: 206f 7574 290a 0a20 2020 2064 6566 2074   out)..    def t
-00022e30: 6573 745f 6973 5f76 616c 6964 2873 656c  est_is_valid(sel
-00022e40: 6629 3a0a 2020 2020 2020 2020 2222 2254  f):.        """T
-00022e50: 6573 7420 7468 6520 6060 4f6e 6548 6f74  est the ``OneHot
-00022e60: 456e 636f 6469 6e67 2e69 735f 7661 6c69  Encoding.is_vali
-00022e70: 6460 6020 6d65 7468 6f64 2e0a 0a20 2020  d`` method...   
-00022e80: 2020 2020 2060 6054 7275 6560 6020 7768       ``True`` wh
-00022e90: 656e 2066 6f72 2074 6865 2072 6f77 7320  en for the rows 
-00022ea0: 7768 6572 6520 7468 6520 6461 7461 2069  where the data i
-00022eb0: 7320 6f6e 6520 686f 742c 2060 6046 616c  s one hot, ``Fal
-00022ec0: 7365 6060 206f 7468 6572 7769 7365 2e0a  se`` otherwise..
-00022ed0: 0a20 2020 2020 2020 2049 6e70 7574 3a0a  .        Input:.
-00022ee0: 2020 2020 2020 2020 2d20 5461 626c 6520          - Table 
-00022ef0: 6461 7461 2028 7061 6e64 6173 2e44 6174  data (pandas.Dat
-00022f00: 6146 7261 6d65 2920 636f 6e74 6169 6e69  aFrame) containi
-00022f10: 6e67 206f 6e65 2076 616c 6964 2063 6f6c  ng one valid col
-00022f20: 756d 6e2c 206f 6e65 2063 6f6c 756d 6e20  umn, one column 
-00022f30: 7769 7468 2061 2073 756d 206c 6573 730a  with a sum less.
-00022f40: 2020 2020 2020 2020 7468 616e 2031 2c20          than 1, 
-00022f50: 6f6e 6520 636f 6c75 6d6e 2077 6974 6820  one column with 
-00022f60: 6120 7375 6d20 6772 6561 7465 7220 7468  a sum greater th
-00022f70: 616e 2031 2c20 6f6e 6520 636f 6c75 6d6e  an 1, one column
-00022f80: 2077 6974 6820 6861 6c76 6573 2061 6464   with halves add
-00022f90: 696e 6720 746f 206f 6e65 2061 6e64 206f  ing to one and o
-00022fa0: 6e65 0a20 2020 2020 2020 2063 6f6c 756d  ne.        colum
-00022fb0: 6e20 7769 7468 206e 616e 732e 0a20 2020  n with nans..   
-00022fc0: 2020 2020 204f 7574 7075 743a 0a20 2020       Output:.   
-00022fd0: 2020 2020 202d 2053 6572 6965 7320 6f66       - Series of
-00022fe0: 2060 6054 7275 6560 6020 616e 6420 6060   ``True`` and ``
-00022ff0: 4661 6c73 6560 6020 7661 6c75 6573 2028  False`` values (
-00023000: 7061 6e64 6173 2e53 6572 6965 7329 0a20  pandas.Series). 
-00023010: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00023020: 2020 2023 2053 6574 7570 0a20 2020 2020     # Setup.     
-00023030: 2020 2069 6e73 7461 6e63 6520 3d20 4f6e     instance = On
-00023040: 6548 6f74 456e 636f 6469 6e67 2863 6f6c  eHotEncoding(col
-00023050: 756d 6e5f 6e61 6d65 733d 5b27 6127 2c20  umn_names=['a', 
-00023060: 2762 272c 2027 6327 5d29 0a0a 2020 2020  'b', 'c'])..    
-00023070: 2020 2020 2320 5275 6e0a 2020 2020 2020      # Run.      
-00023080: 2020 7461 626c 655f 6461 7461 203d 2070    table_data = p
-00023090: 642e 4461 7461 4672 616d 6528 7b0a 2020  d.DataFrame({.  
-000230a0: 2020 2020 2020 2020 2020 2761 273a 205b            'a': [
-000230b0: 312e 302c 2031 2e30 2c20 302e 302c 2030  1.0, 1.0, 0.0, 0
-000230c0: 2e35 2c20 312e 305d 2c0a 2020 2020 2020  .5, 1.0],.      
-000230d0: 2020 2020 2020 2762 273a 205b 302e 302c        'b': [0.0,
-000230e0: 2031 2e30 2c20 302e 302c 2030 2e35 2c20   1.0, 0.0, 0.5, 
-000230f0: 302e 305d 2c0a 2020 2020 2020 2020 2020  0.0],.          
-00023100: 2020 2763 273a 205b 302e 302c 2032 2e30    'c': [0.0, 2.0
-00023110: 2c20 302e 302c 2030 2e30 2c20 6e70 2e6e  , 0.0, 0.0, np.n
-00023120: 616e 5d2c 0a20 2020 2020 2020 2020 2020  an],.           
-00023130: 2027 6427 3a20 5b31 2c20 322c 2033 2c20   'd': [1, 2, 3, 
-00023140: 342c 2035 5d0a 2020 2020 2020 2020 7d29  4, 5].        })
-00023150: 0a20 2020 2020 2020 206f 7574 203d 2069  .        out = i
-00023160: 6e73 7461 6e63 652e 6973 5f76 616c 6964  nstance.is_valid
-00023170: 2874 6162 6c65 5f64 6174 6129 0a0a 2020  (table_data)..  
-00023180: 2020 2020 2020 2320 4173 7365 7274 0a20        # Assert. 
-00023190: 2020 2020 2020 2065 7870 6563 7465 645f         expected_
-000231a0: 6f75 7420 3d20 7064 2e53 6572 6965 7328  out = pd.Series(
-000231b0: 5b54 7275 652c 2046 616c 7365 2c20 4661  [True, False, Fa
-000231c0: 6c73 652c 2046 616c 7365 2c20 4661 6c73  lse, False, Fals
-000231d0: 655d 290a 2020 2020 2020 2020 7064 2e74  e]).        pd.t
-000231e0: 6573 7469 6e67 2e61 7373 6572 745f 7365  esting.assert_se
-000231f0: 7269 6573 5f65 7175 616c 2865 7870 6563  ries_equal(expec
-00023200: 7465 645f 6f75 742c 206f 7574 290a 0a0a  ted_out, out)...
-00023210: 636c 6173 7320 5465 7374 556e 6971 7565  class TestUnique
-00023220: 2829 3a0a 0a20 2020 2064 6566 2074 6573  ():..    def tes
-00023230: 745f 5f76 616c 6964 6174 655f 696e 7075  t__validate_inpu
-00023240: 7473 2873 656c 6629 3a0a 2020 2020 2020  ts(self):.      
-00023250: 2020 2222 2254 6573 7420 7468 6520 6060    """Test the ``
-00023260: 556e 6971 7565 2e5f 7661 6c69 6461 7465  Unique._validate
-00023270: 5f69 6e70 7574 7360 6020 6d65 7468 6f64  _inputs`` method
-00023280: 2e0a 0a20 2020 2020 2020 2049 6e70 7574  ...        Input
-00023290: 3a0a 2020 2020 2020 2020 2d20 2049 6e63  :.        -  Inc
-000232a0: 6f72 7265 6374 2061 7267 756d 656e 7473  orrect arguments
-000232b0: 2066 6f72 2074 6865 206d 6574 686f 640a   for the method.
-000232c0: 2020 2020 2020 2020 5261 6973 6573 3a0a          Raises:.
-000232d0: 2020 2020 2020 2020 2d20 4c69 7374 206f          - List o
-000232e0: 6620 5661 6c75 6545 7272 6f72 730a 2020  f ValueErrors.  
-000232f0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00023300: 2020 2320 5275 6e20 2f20 4173 7365 7274    # Run / Assert
-00023310: 0a20 2020 2020 2020 2077 6974 6820 7079  .        with py
-00023320: 7465 7374 2e72 6169 7365 7328 4167 6772  test.raises(Aggr
-00023330: 6567 6174 6543 6f6e 7374 7261 696e 7473  egateConstraints
-00023340: 4572 726f 7229 2061 7320 6572 726f 723a  Error) as error:
-00023350: 0a20 2020 2020 2020 2020 2020 2055 6e69  .            Uni
-00023360: 7175 652e 5f76 616c 6964 6174 655f 696e  que._validate_in
-00023370: 7075 7473 286e 6f74 5f63 6f6c 756d 6e5f  puts(not_column_
-00023380: 6e61 6d65 733d 4e6f 6e65 2c20 736f 6d65  names=None, some
-00023390: 7468 696e 675f 656c 7365 3d4e 6f6e 6529  thing_else=None)
-000233a0: 0a0a 2020 2020 2020 2020 6572 725f 6d73  ..        err_ms
-000233b0: 6720 3d20 280a 2020 2020 2020 2020 2020  g = (.          
-000233c0: 2020 7227 4d69 7373 696e 6720 7265 7175    r'Missing requ
-000233d0: 6972 6564 2076 616c 7565 7320 7b28 2e2a  ired values {(.*
-000233e0: 297d 2069 6e20 6120 556e 6971 7565 2063  )} in a Unique c
-000233f0: 6f6e 7374 7261 696e 742e 270a 2020 2020  onstraint.'.    
-00023400: 2020 2020 2020 2020 7227 5c6e 5c6e 496e          r'\n\nIn
-00023410: 7661 6c69 6420 7661 6c75 6573 207b 282e  valid values {(.
-00023420: 2a29 7d20 6172 6520 7072 6573 656e 7420  *)} are present 
-00023430: 696e 2061 2055 6e69 7175 6520 636f 6e73  in a Unique cons
-00023440: 7472 6169 6e74 2e27 0a20 2020 2020 2020  traint.'.       
-00023450: 2029 0a20 2020 2020 2020 2067 726f 7570   ).        group
-00023460: 7320 3d20 7265 2e73 6561 7263 6828 6572  s = re.search(er
-00023470: 725f 6d73 672c 2073 7472 2865 7272 6f72  r_msg, str(error
-00023480: 2e76 616c 7565 2929 0a20 2020 2020 2020  .value)).       
-00023490: 2061 7373 6572 7420 6772 6f75 7073 2069   assert groups i
-000234a0: 7320 6e6f 7420 4e6f 6e65 0a20 2020 2020  s not None.     
-000234b0: 2020 2061 7373 6572 7420 7374 7228 6576     assert str(ev
-000234c0: 616c 2867 726f 7570 732e 6772 6f75 7028  al(groups.group(
-000234d0: 3129 2929 203d 3d20 2763 6f6c 756d 6e5f  1))) == 'column_
-000234e0: 6e61 6d65 7327 0a20 2020 2020 2020 2061  names'.        a
-000234f0: 7373 6572 7420 7365 7428 6576 616c 2867  ssert set(eval(g
-00023500: 726f 7570 732e 6772 6f75 7028 3229 2929  roups.group(2)))
-00023510: 203d 3d20 7b27 6e6f 745f 636f 6c75 6d6e   == {'not_column
-00023520: 5f6e 616d 6573 272c 2027 736f 6d65 7468  _names', 'someth
-00023530: 696e 675f 656c 7365 277d 0a0a 2020 2020  ing_else'}..    
-00023540: 6465 6620 7465 7374 5f5f 7661 6c69 6461  def test__valida
-00023550: 7465 5f6d 6574 6164 6174 615f 636f 6c75  te_metadata_colu
-00023560: 6d6e 7328 7365 6c66 293a 0a20 2020 2020  mns(self):.     
-00023570: 2020 2022 2222 5465 7374 2074 6865 2060     """Test the `
-00023580: 605f 7661 6c69 6461 7465 5f6d 6574 6164  `_validate_metad
-00023590: 6174 615f 636f 6c75 6d6e 7360 6020 6d65  ata_columns`` me
-000235a0: 7468 6f64 2e0a 0a20 2020 2020 2020 2041  thod...        A
-000235b0: 6c6c 206f 6620 7468 6520 636f 6c75 6d6e  ll of the column
-000235c0: 7320 7061 7373 6564 2069 6e20 636f 6c75  s passed in colu
-000235d0: 6d6e 5f6e 616d 6573 2073 686f 756c 6420  mn_names should 
-000235e0: 6265 2069 6e20 7468 6520 6d65 7461 6461  be in the metada
-000235f0: 7461 2e0a 0a20 2020 2020 2020 2049 6e70  ta...        Inp
-00023600: 7574 3a0a 2020 2020 2020 2020 2020 2020  ut:.            
-00023610: 2d20 636f 6c75 6d6e 5f6e 616d 6573 2077  - column_names w
-00023620: 6974 6820 636f 6c75 6d6e 7320 7468 6174  ith columns that
-00023630: 2061 7265 2061 6c6c 2069 6e20 7468 6520   are all in the 
-00023640: 6d65 7461 6461 7461 2e0a 0a20 2020 2020  metadata...     
-00023650: 2020 2053 6964 6520 6566 6665 6374 3a0a     Side effect:.
-00023660: 2020 2020 2020 2020 2020 2020 2d20 4e6f              - No
-00023670: 2065 7272 6f72 2073 686f 756c 6420 6265   error should be
-00023680: 2072 6169 7365 642e 0a20 2020 2020 2020   raised..       
-00023690: 2022 2222 0a20 2020 2020 2020 2023 2053   """.        # S
-000236a0: 6574 7570 0a20 2020 2020 2020 206d 6574  etup.        met
-000236b0: 6164 6174 6120 3d20 4d6f 636b 2829 0a20  adata = Mock(). 
-000236c0: 2020 2020 2020 206d 6574 6164 6174 612e         metadata.
-000236d0: 636f 6c75 6d6e 7320 3d20 7b27 6127 3a20  columns = {'a': 
-000236e0: 312c 2027 6227 3a20 327d 0a0a 2020 2020  1, 'b': 2}..    
-000236f0: 2020 2020 2320 5275 6e0a 2020 2020 2020      # Run.      
-00023700: 2020 556e 6971 7565 2e5f 7661 6c69 6461    Unique._valida
-00023710: 7465 5f6d 6574 6164 6174 615f 636f 6c75  te_metadata_colu
-00023720: 6d6e 7328 6d65 7461 6461 7461 2c20 636f  mns(metadata, co
-00023730: 6c75 6d6e 5f6e 616d 6573 3d5b 2761 272c  lumn_names=['a',
-00023740: 2027 6227 5d29 0a0a 2020 2020 6465 6620   'b'])..    def 
-00023750: 7465 7374 5f5f 7661 6c69 6461 7465 5f6d  test__validate_m
-00023760: 6574 6164 6174 615f 636f 6c75 6d6e 735f  etadata_columns_
-00023770: 7261 6973 6573 5f65 7272 6f72 2873 656c  raises_error(sel
-00023780: 6629 3a0a 2020 2020 2020 2020 2222 2254  f):.        """T
-00023790: 6573 7420 7468 6520 6060 5f76 616c 6964  est the ``_valid
-000237a0: 6174 655f 6d65 7461 6461 7461 5f63 6f6c  ate_metadata_col
-000237b0: 756d 6e73 6060 206d 6574 686f 6427 7320  umns`` method's 
-000237c0: 6572 726f 7220 636f 6e64 6974 696f 6e2e  error condition.
-000237d0: 0a0a 2020 2020 2020 2020 4966 2061 6e79  ..        If any
-000237e0: 2063 6f6c 756d 6e73 2069 6e20 636f 6c75   columns in colu
-000237f0: 6d6e 5f6e 616d 6573 2061 7265 206e 6f74  mn_names are not
-00023800: 2069 6e20 7468 6520 6d65 7461 6461 7461   in the metadata
-00023810: 2c20 616e 2065 7272 6f72 2073 686f 756c  , an error shoul
-00023820: 6420 6265 2072 6169 7365 642e 0a0a 2020  d be raised...  
-00023830: 2020 2020 2020 496e 7075 743a 0a20 2020        Input:.   
-00023840: 2020 2020 2020 2020 202d 2063 6f6c 756d           - colum
-00023850: 6e5f 6e61 6d65 7320 7468 6174 2063 6f6e  n_names that con
-00023860: 7461 696e 7320 6120 636f 6c75 6d6e 206e  tains a column n
-00023870: 6f74 2069 6e20 7468 6520 6d65 7461 6461  ot in the metada
-00023880: 7461 2e0a 0a20 2020 2020 2020 2053 6964  ta...        Sid
-00023890: 6520 6566 6665 6374 3a0a 2020 2020 2020  e effect:.      
-000238a0: 2020 2020 2020 2d20 436f 6e73 7472 6169        - Constrai
-000238b0: 6e74 4d65 7461 6461 7461 4572 726f 7220  ntMetadataError 
-000238c0: 7368 6f75 6c64 2062 6520 7261 6973 6564  should be raised
-000238d0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-000238e0: 2020 2020 2020 2320 5365 7475 700a 2020        # Setup.  
-000238f0: 2020 2020 2020 6d65 7461 6461 7461 203d        metadata =
-00023900: 204d 6f63 6b28 290a 2020 2020 2020 2020   Mock().        
-00023910: 6d65 7461 6461 7461 2e63 6f6c 756d 6e73  metadata.columns
-00023920: 203d 207b 2761 273a 2031 2c20 2762 273a   = {'a': 1, 'b':
-00023930: 2032 7d0a 0a20 2020 2020 2020 2023 2052   2}..        # R
-00023940: 756e 0a20 2020 2020 2020 2065 7272 6f72  un.        error
-00023950: 5f6d 6573 7361 6765 203d 2072 652e 6573  _message = re.es
-00023960: 6361 7065 280a 2020 2020 2020 2020 2020  cape(.          
-00023970: 2020 2741 2055 6e69 7175 6520 636f 6e73    'A Unique cons
-00023980: 7472 6169 6e74 2069 7320 6265 696e 6720  traint is being 
-00023990: 6170 706c 6965 6420 746f 2069 6e76 616c  applied to inval
-000239a0: 6964 2063 6f6c 756d 6e20 6e61 6d65 7320  id column names 
-000239b0: 270a 2020 2020 2020 2020 2020 2020 227b  '.            "{
-000239c0: 2763 277d 2e20 5468 6520 636f 6c75 6d6e  'c'}. The column
-000239d0: 7320 6d75 7374 2065 7869 7374 2069 6e20  s must exist in 
-000239e0: 7468 6520 7461 626c 652e 220a 2020 2020  the table.".    
-000239f0: 2020 2020 290a 2020 2020 2020 2020 7769      ).        wi
-00023a00: 7468 2070 7974 6573 742e 7261 6973 6573  th pytest.raises
-00023a10: 2843 6f6e 7374 7261 696e 744d 6574 6164  (ConstraintMetad
-00023a20: 6174 6145 7272 6f72 2c20 6d61 7463 683d  ataError, match=
-00023a30: 6572 726f 725f 6d65 7373 6167 6529 3a0a  error_message):.
-00023a40: 2020 2020 2020 2020 2020 2020 556e 6971              Uniq
-00023a50: 7565 2e5f 7661 6c69 6461 7465 5f6d 6574  ue._validate_met
-00023a60: 6164 6174 615f 636f 6c75 6d6e 7328 6d65  adata_columns(me
-00023a70: 7461 6461 7461 2c20 636f 6c75 6d6e 5f6e  tadata, column_n
-00023a80: 616d 6573 3d5b 2761 272c 2027 6327 5d29  ames=['a', 'c'])
-00023a90: 0a0a 2020 2020 6465 6620 7465 7374 5f5f  ..    def test__
-00023aa0: 7661 6c69 6461 7465 5f6d 6574 6164 6174  validate_metadat
-00023ab0: 615f 7370 6563 6966 6963 5f74 6f5f 636f  a_specific_to_co
-00023ac0: 6e73 7472 6169 6e74 2873 656c 6629 3a0a  nstraint(self):.
-00023ad0: 2020 2020 2020 2020 2222 2254 6573 7420          """Test 
-00023ae0: 7468 6520 6060 5f76 616c 6964 6174 655f  the ``_validate_
-00023af0: 6d65 7461 6461 7461 5f73 7065 6369 6669  metadata_specifi
-00023b00: 635f 746f 5f63 6f6e 7374 7261 696e 7460  c_to_constraint`
-00023b10: 602e 0a0a 2020 2020 2020 2020 4966 2061  `...        If a
-00023b20: 7420 6c65 6173 7420 6f6e 6520 6f66 2074  t least one of t
-00023b30: 6865 2063 6f6c 756d 6e73 2069 6e20 6060  he columns in ``
-00023b40: 636f 6c75 6d6e 5f6e 616d 6573 6060 2069  column_names`` i
-00023b50: 7320 6e6f 7420 6120 6b65 792c 206e 6f20  s not a key, no 
-00023b60: 6572 726f 7220 7368 6f75 6c64 0a20 2020  error should.   
-00023b70: 2020 2020 2062 6520 7261 6973 6564 2e0a       be raised..
-00023b80: 0a20 2020 2020 2020 2049 6e70 7574 3a0a  .        Input:.
-00023b90: 2020 2020 2020 2020 2020 2020 2d20 4d65              - Me
-00023ba0: 7461 6461 7461 2077 6974 6820 7072 696d  tadata with prim
-00023bb0: 6172 7920 616e 6420 616c 7465 726e 6174  ary and alternat
-00023bc0: 6520 6b65 7973 2e0a 2020 2020 2020 2020  e keys..        
-00023bd0: 2020 2020 2d20 436f 6c75 6d6e 206e 616d      - Column nam
-00023be0: 6573 2077 6974 6820 6c69 7374 206f 6620  es with list of 
-00023bf0: 636f 6c75 6d6e 7320 6469 6666 6572 656e  columns differen
-00023c00: 7420 6874 616e 2074 6865 2070 7269 6d61  t htan the prima
-00023c10: 7279 206b 6579 2061 6e64 2061 6c74 6572  ry key and alter
-00023c20: 6e61 7465 206b 6579 732e 0a20 2020 2020  nate keys..     
-00023c30: 2020 2022 2222 0a20 2020 2020 2020 2023     """.        #
-00023c40: 2053 6574 7570 0a20 2020 2020 2020 206d   Setup.        m
-00023c50: 6574 6164 6174 6120 3d20 4d6f 636b 2829  etadata = Mock()
-00023c60: 0a20 2020 2020 2020 206d 6574 6164 6174  .        metadat
-00023c70: 612e 7072 696d 6172 795f 6b65 7920 3d20  a.primary_key = 
-00023c80: 2761 270a 2020 2020 2020 2020 6d65 7461  'a'.        meta
-00023c90: 6461 7461 2e61 6c74 6572 6e61 7465 5f6b  data.alternate_k
-00023ca0: 6579 7320 3d20 5b27 6227 2c20 2763 275d  eys = ['b', 'c']
-00023cb0: 0a0a 2020 2020 2020 2020 2320 5275 6e0a  ..        # Run.
-00023cc0: 2020 2020 2020 2020 556e 6971 7565 2e5f          Unique._
-00023cd0: 7661 6c69 6461 7465 5f6d 6574 6164 6174  validate_metadat
-00023ce0: 615f 7370 6563 6966 6963 5f74 6f5f 636f  a_specific_to_co
-00023cf0: 6e73 7472 6169 6e74 280a 2020 2020 2020  nstraint(.      
-00023d00: 2020 2020 2020 6d65 7461 6461 7461 2c0a        metadata,.
-00023d10: 2020 2020 2020 2020 2020 2020 636f 6c75              colu
-00023d20: 6d6e 5f6e 616d 6573 3d5b 2761 272c 2027  mn_names=['a', '
-00023d30: 6227 2c20 2764 275d 0a20 2020 2020 2020  b', 'd'].       
-00023d40: 2029 0a0a 2020 2020 6465 6620 7465 7374   )..    def test
-00023d50: 5f5f 7661 6c69 6461 7465 5f6d 6574 6164  __validate_metad
-00023d60: 6174 615f 7370 6563 6966 6963 5f74 6f5f  ata_specific_to_
-00023d70: 636f 6e73 7472 6169 6e74 5f65 7272 6f72  constraint_error
-00023d80: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00023d90: 2222 2254 6573 7420 7468 6520 6060 5f76  """Test the ``_v
-00023da0: 616c 6964 6174 655f 6d65 7461 6461 7461  alidate_metadata
-00023db0: 5f73 7065 6369 6669 635f 746f 5f63 6f6e  _specific_to_con
-00023dc0: 7374 7261 696e 7460 602e 0a0a 2020 2020  straint``...    
-00023dd0: 2020 2020 4966 2061 6c6c 206f 6620 7468      If all of th
-00023de0: 6520 636f 6c75 6d6e 7320 696e 2060 6063  e columns in ``c
-00023df0: 6f6c 756d 6e5f 6e61 6d65 7360 6020 6172  olumn_names`` ar
-00023e00: 6520 6b65 7973 2c20 616e 2065 7272 6f72  e keys, an error
-00023e10: 2073 686f 756c 640a 2020 2020 2020 2020   should.        
-00023e20: 6265 2072 6169 7365 642e 0a0a 2020 2020  be raised...    
-00023e30: 2020 2020 496e 7075 743a 0a20 2020 2020      Input:.     
-00023e40: 2020 2020 2020 202d 204d 6574 6164 6174         - Metadat
-00023e50: 6120 7769 7468 2070 7269 6d61 7279 2061  a with primary a
-00023e60: 6e64 2061 6c74 6572 6e61 7465 206b 6579  nd alternate key
-00023e70: 732e 0a20 2020 2020 2020 2020 2020 202d  s..            -
-00023e80: 2043 6f6c 756d 6e20 6e61 6d65 7320 7769   Column names wi
-00023e90: 7468 206c 6973 7420 6f66 2063 6f6c 756d  th list of colum
-00023ea0: 6e73 2064 6966 6665 7265 6e74 2068 7461  ns different hta
-00023eb0: 6e20 7468 6520 7072 696d 6172 7920 6b65  n the primary ke
-00023ec0: 7920 616e 6420 616c 7465 726e 6174 6520  y and alternate 
-00023ed0: 6b65 7973 2e0a 2020 2020 2020 2020 2222  keys..        ""
-00023ee0: 220a 2020 2020 2020 2020 2320 5365 7475  ".        # Setu
-00023ef0: 700a 2020 2020 2020 2020 6d65 7461 6461  p.        metada
-00023f00: 7461 203d 204d 6f63 6b28 290a 2020 2020  ta = Mock().    
-00023f10: 2020 2020 6d65 7461 6461 7461 2e70 7269      metadata.pri
-00023f20: 6d61 7279 5f6b 6579 203d 2027 6127 0a20  mary_key = 'a'. 
-00023f30: 2020 2020 2020 206d 6574 6164 6174 612e         metadata.
-00023f40: 616c 7465 726e 6174 655f 6b65 7973 203d  alternate_keys =
-00023f50: 205b 2827 6227 2c20 2763 2729 2c20 2764   [('b', 'c'), 'd
-00023f60: 275d 0a0a 2020 2020 2020 2020 2320 5275  ']..        # Ru
-00023f70: 6e0a 2020 2020 2020 2020 6572 726f 725f  n.        error_
-00023f80: 6d65 7373 6167 6520 3d20 7265 2e65 7363  message = re.esc
-00023f90: 6170 6528 0a20 2020 2020 2020 2020 2020  ape(.           
-00023fa0: 2022 4120 556e 6971 7565 2063 6f6e 7374   "A Unique const
-00023fb0: 7261 696e 7420 6973 2062 6569 6e67 2061  raint is being a
-00023fc0: 7070 6c69 6564 2074 6f20 636f 6c75 6d6e  pplied to column
-00023fd0: 7320 275b 2761 272c 2027 6227 2c20 2763  s '['a', 'b', 'c
-00023fe0: 275d 272e 2022 0a20 2020 2020 2020 2020  ']'. ".         
-00023ff0: 2020 2027 5468 6573 6520 636f 6c75 6d6e     'These column
-00024000: 7320 6172 6520 616c 7265 6164 7920 6120  s are already a 
-00024010: 6b65 7920 666f 7220 7468 6174 2074 6162  key for that tab
-00024020: 6c65 2e27 0a20 2020 2020 2020 2029 0a20  le.'.        ). 
-00024030: 2020 2020 2020 2077 6974 6820 7079 7465         with pyte
-00024040: 7374 2e72 6169 7365 7328 436f 6e73 7472  st.raises(Constr
-00024050: 6169 6e74 4d65 7461 6461 7461 4572 726f  aintMetadataErro
-00024060: 722c 206d 6174 6368 3d65 7272 6f72 5f6d  r, match=error_m
-00024070: 6573 7361 6765 293a 0a20 2020 2020 2020  essage):.       
-00024080: 2020 2020 2055 6e69 7175 652e 5f76 616c       Unique._val
-00024090: 6964 6174 655f 6d65 7461 6461 7461 5f73  idate_metadata_s
-000240a0: 7065 6369 6669 635f 746f 5f63 6f6e 7374  pecific_to_const
-000240b0: 7261 696e 7428 0a20 2020 2020 2020 2020  raint(.         
-000240c0: 2020 2020 2020 206d 6574 6164 6174 612c         metadata,
-000240d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000240e0: 2063 6f6c 756d 6e5f 6e61 6d65 733d 5b27   column_names=['
-000240f0: 6127 2c20 2762 272c 2027 6327 5d0a 2020  a', 'b', 'c'].  
-00024100: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-00024110: 2064 6566 2074 6573 745f 5f5f 696e 6974   def test___init
-00024120: 5f5f 2873 656c 6629 3a0a 2020 2020 2020  __(self):.      
-00024130: 2020 2222 2254 6573 7420 7468 6520 6060    """Test the ``
-00024140: 556e 6971 7565 2e5f 5f69 6e69 745f 5f60  Unique.__init__`
-00024150: 6020 6d65 7468 6f64 2e0a 0a20 2020 2020  ` method...     
-00024160: 2020 2054 6865 2060 6063 6f6c 756d 6e5f     The ``column_
-00024170: 6e61 6d65 7360 6020 7368 6f75 6c64 2062  names`` should b
-00024180: 6520 7365 7420 746f 2074 686f 7365 2070  e set to those p
-00024190: 726f 7669 6465 642e 0a0a 2020 2020 2020  rovided...      
-000241a0: 2020 496e 7075 743a 0a20 2020 2020 2020    Input:.       
-000241b0: 202d 2063 6f6c 756d 6e20 6e61 6d65 7320   - column names 
-000241c0: 746f 206b 6565 7020 756e 6971 7565 2e0a  to keep unique..
-000241d0: 2020 2020 2020 2020 4f75 7470 7574 3a0a          Output:.
-000241e0: 2020 2020 2020 2020 2d20 496e 7374 616e          - Instan
-000241f0: 6365 2077 6974 6820 6060 636f 6c75 6d6e  ce with ``column
-00024200: 5f6e 616d 6573 6060 2073 6574 2e0a 2020  _names`` set..  
-00024210: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00024220: 2020 2320 5275 6e0a 2020 2020 2020 2020    # Run.        
-00024230: 696e 7374 616e 6365 203d 2055 6e69 7175  instance = Uniqu
-00024240: 6528 636f 6c75 6d6e 5f6e 616d 6573 3d5b  e(column_names=[
-00024250: 2761 272c 2027 6227 5d29 0a0a 2020 2020  'a', 'b'])..    
-00024260: 2020 2020 2320 4173 7365 7274 0a20 2020      # Assert.   
-00024270: 2020 2020 2061 7373 6572 7420 696e 7374       assert inst
-00024280: 616e 6365 2e63 6f6c 756d 6e5f 6e61 6d65  ance.column_name
-00024290: 7320 3d3d 205b 2761 272c 2027 6227 5d0a  s == ['a', 'b'].
-000242a0: 0a20 2020 2064 6566 2074 6573 745f 6973  .    def test_is
-000242b0: 5f76 616c 6964 2873 656c 6629 3a0a 2020  _valid(self):.  
-000242c0: 2020 2020 2020 2222 2254 6573 7420 7468        """Test th
-000242d0: 6520 6060 556e 6971 7565 2e69 735f 7661  e ``Unique.is_va
-000242e0: 6c69 6460 6020 6d65 7468 6f64 2e0a 0a20  lid`` method... 
-000242f0: 2020 2020 2020 2054 6869 7320 6d65 7468         This meth
-00024300: 6f64 2073 686f 756c 6420 7265 7475 726e  od should return
-00024310: 2061 2070 642e 5365 7269 6573 2077 6865   a pd.Series whe
-00024320: 7265 2074 6865 2069 6e64 6578 0a20 2020  re the index.   
-00024330: 2020 2020 206f 6620 7468 6520 6669 7273       of the firs
-00024340: 7420 6f63 6375 7265 6e63 6520 6f66 2061  t occurence of a
-00024350: 2075 6e69 7175 6520 636f 6d62 696e 6174   unique combinat
-00024360: 696f 6e20 6f66 2060 6069 6e73 7461 6e63  ion of ``instanc
-00024370: 652e 636f 6c75 6d6e 5f6e 616d 6573 6060  e.column_names``
-00024380: 0a20 2020 2020 2020 2069 7320 7365 7420  .        is set 
-00024390: 746f 2060 6054 7275 6560 602c 2061 6e64  to ``True``, and
-000243a0: 2065 7665 7279 206f 7468 6572 206f 6363   every other occ
-000243b0: 7572 656e 6365 2069 7320 7365 7420 746f  urence is set to
-000243c0: 2060 6046 616c 7365 6060 2e0a 0a20 2020   ``False``...   
-000243d0: 2020 2020 2049 6e70 7574 3a0a 2020 2020       Input:.    
-000243e0: 2020 2020 2d20 4461 7461 4672 616d 6520      - DataFrame 
-000243f0: 7769 7468 206d 756c 7469 706c 6520 6f66  with multiple of
-00024400: 2074 6865 2073 616d 6520 636f 6d62 696e   the same combin
-00024410: 6174 696f 6e73 206f 6620 636f 6c75 6d6e  ations of column
-00024420: 732e 0a20 2020 2020 2020 204f 7574 7075  s..        Outpu
-00024430: 743a 0a20 2020 2020 2020 202d 2053 6572  t:.        - Ser
-00024440: 6965 7320 7769 7468 2074 6865 2069 6e64  ies with the ind
-00024450: 6578 206f 6620 7468 6520 6669 7273 7420  ex of the first 
-00024460: 6f63 6375 7265 6e63 6573 2073 6574 2074  occurences set t
-00024470: 6f20 6060 5472 7565 6060 2e0a 2020 2020  o ``True``..    
-00024480: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00024490: 2320 5365 7475 700a 2020 2020 2020 2020  # Setup.        
-000244a0: 696e 7374 616e 6365 203d 2055 6e69 7175  instance = Uniqu
-000244b0: 6528 636f 6c75 6d6e 5f6e 616d 6573 3d5b  e(column_names=[
-000244c0: 2761 272c 2027 6227 2c20 2763 275d 290a  'a', 'b', 'c']).
-000244d0: 0a20 2020 2020 2020 2023 2052 756e 0a20  .        # Run. 
-000244e0: 2020 2020 2020 2064 6174 6120 3d20 7064         data = pd
-000244f0: 2e44 6174 6146 7261 6d65 287b 0a20 2020  .DataFrame({.   
-00024500: 2020 2020 2020 2020 2027 6127 3a20 5b31           'a': [1
-00024510: 2c20 312c 2032 2c20 322c 2033 2c20 345d  , 1, 2, 2, 3, 4]
-00024520: 2c0a 2020 2020 2020 2020 2020 2020 2762  ,.            'b
-00024530: 273a 205b 352c 2035 2c20 362c 2036 2c20  ': [5, 5, 6, 6, 
-00024540: 372c 2038 5d2c 0a20 2020 2020 2020 2020  7, 8],.         
-00024550: 2020 2027 6327 3a20 5b39 2c20 392c 2031     'c': [9, 9, 1
-00024560: 302c 2031 302c 2031 322c 2031 335d 0a20  0, 10, 12, 13]. 
-00024570: 2020 2020 2020 207d 290a 2020 2020 2020         }).      
-00024580: 2020 7661 6c69 6420 3d20 696e 7374 616e    valid = instan
-00024590: 6365 2e69 735f 7661 6c69 6428 6461 7461  ce.is_valid(data
-000245a0: 290a 0a20 2020 2020 2020 2023 2041 7373  )..        # Ass
-000245b0: 6572 740a 2020 2020 2020 2020 6578 7065  ert.        expe
-000245c0: 6374 6564 203d 2070 642e 5365 7269 6573  cted = pd.Series
-000245d0: 285b 5472 7565 2c20 4661 6c73 652c 2054  ([True, False, T
-000245e0: 7275 652c 2046 616c 7365 2c20 5472 7565  rue, False, True
-000245f0: 2c20 5472 7565 5d29 0a20 2020 2020 2020  , True]).       
-00024600: 2070 642e 7465 7374 696e 672e 6173 7365   pd.testing.asse
-00024610: 7274 5f73 6572 6965 735f 6571 7561 6c28  rt_series_equal(
-00024620: 7661 6c69 642c 2065 7870 6563 7465 6429  valid, expected)
-00024630: 0a0a 2020 2020 6465 6620 7465 7374 5f69  ..    def test_i
-00024640: 735f 7661 6c69 645f 6375 7374 6f6d 5f69  s_valid_custom_i
-00024650: 6e64 6578 5f73 616d 655f 7661 6c75 6573  ndex_same_values
-00024660: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00024670: 2222 2254 6573 7420 7468 6520 6060 556e  """Test the ``Un
-00024680: 6971 7565 2e69 735f 7661 6c69 6460 6020  ique.is_valid`` 
-00024690: 6d65 7468 6f64 2e0a 0a20 2020 2020 2020  method...       
-000246a0: 2054 6869 7320 6d65 7468 6f64 2073 686f   This method sho
-000246b0: 756c 6420 7265 7475 726e 2061 2070 642e  uld return a pd.
-000246c0: 5365 7269 6573 2077 6865 7265 2074 6865  Series where the
-000246d0: 2069 6e64 6578 0a20 2020 2020 2020 206f   index.        o
-000246e0: 6620 7468 6520 6669 7273 7420 6f63 6375  f the first occu
-000246f0: 7265 6e63 6520 6f66 2061 2075 6e69 7175  rence of a uniqu
-00024700: 6520 636f 6d62 696e 6174 696f 6e20 6f66  e combination of
-00024710: 2060 6069 6e73 7461 6e63 652e 636f 6c75   ``instance.colu
-00024720: 6d6e 5f6e 616d 6573 6060 0a20 2020 2020  mn_names``.     
-00024730: 2020 2069 7320 7365 7420 746f 2060 6054     is set to ``T
-00024740: 7275 6560 602c 2061 6e64 2065 7665 7279  rue``, and every
-00024750: 206f 7468 6572 206f 6363 7572 656e 6365   other occurence
-00024760: 2069 7320 7365 7420 746f 2060 6046 616c   is set to ``Fal
-00024770: 7365 6060 2e0a 0a20 2020 2020 2020 2049  se``...        I
-00024780: 6e70 7574 3a0a 2020 2020 2020 2020 2d20  nput:.        - 
-00024790: 4461 7461 4672 616d 6520 7769 7468 206d  DataFrame with m
-000247a0: 756c 7469 706c 6520 6f66 2074 6865 2073  ultiple of the s
-000247b0: 616d 6520 636f 6d62 696e 6174 696f 6e73  ame combinations
-000247c0: 206f 6620 636f 6c75 6d6e 732e 0a20 2020   of columns..   
-000247d0: 2020 2020 202d 2044 6174 6146 7261 6d65       - DataFrame
-000247e0: 2068 6173 2061 2063 7573 746f 6d20 696e   has a custom in
-000247f0: 6465 7820 636f 6c75 6d6e 2077 6869 6368  dex column which
-00024800: 2069 7320 7365 7420 746f 2030 2066 6f72   is set to 0 for
-00024810: 2072 6f77 732e 0a20 2020 2020 2020 204f   rows..        O
-00024820: 7574 7075 743a 0a20 2020 2020 2020 202d  utput:.        -
-00024830: 2053 6572 6965 7320 7769 7468 2074 6865   Series with the
-00024840: 2069 6e64 6578 206f 6620 7468 6520 6669   index of the fi
-00024850: 7273 7420 6f63 6375 7265 6e63 6573 2073  rst occurences s
-00024860: 6574 2074 6f20 6060 5472 7565 6060 2e0a  et to ``True``..
-00024870: 2020 2020 2020 2020 4769 7468 7562 2049          Github I
-00024880: 7373 7565 3a0a 2020 2020 2020 2020 2d20  ssue:.        - 
-00024890: 5072 6f62 6c65 6d20 6973 2064 6573 6372  Problem is descr
-000248a0: 6962 6564 2069 6e3a 2068 7474 7073 3a2f  ibed in: https:/
-000248b0: 2f67 6974 6875 622e 636f 6d2f 7364 762d  /github.com/sdv-
-000248c0: 6465 762f 5344 562f 6973 7375 6573 2f36  dev/SDV/issues/6
-000248d0: 3136 0a20 2020 2020 2020 2022 2222 0a20  16.        """. 
-000248e0: 2020 2020 2020 2023 2053 6574 7570 0a20         # Setup. 
-000248f0: 2020 2020 2020 2069 6e73 7461 6e63 6520         instance 
-00024900: 3d20 556e 6971 7565 2863 6f6c 756d 6e5f  = Unique(column_
-00024910: 6e61 6d65 733d 5b27 6127 2c20 2762 272c  names=['a', 'b',
-00024920: 2027 6327 5d29 0a0a 2020 2020 2020 2020   'c'])..        
-00024930: 2320 5275 6e0a 2020 2020 2020 2020 6461  # Run.        da
-00024940: 7461 203d 2070 642e 4461 7461 4672 616d  ta = pd.DataFram
-00024950: 6528 7b0a 2020 2020 2020 2020 2020 2020  e({.            
-00024960: 2761 273a 205b 312c 2031 2c20 322c 2032  'a': [1, 1, 2, 2
-00024970: 2c20 335d 2c0a 2020 2020 2020 2020 2020  , 3],.          
-00024980: 2020 2762 273a 205b 352c 2035 2c20 362c    'b': [5, 5, 6,
-00024990: 2036 2c20 375d 2c0a 2020 2020 2020 2020   6, 7],.        
-000249a0: 2020 2020 2763 273a 205b 382c 2038 2c20      'c': [8, 8, 
-000249b0: 392c 2039 2c20 3130 5d0a 2020 2020 2020  9, 9, 10].      
-000249c0: 2020 7d2c 2069 6e64 6578 3d5b 302c 2030    }, index=[0, 0
-000249d0: 2c20 302c 2030 2c20 305d 290a 2020 2020  , 0, 0, 0]).    
-000249e0: 2020 2020 7661 6c69 6420 3d20 696e 7374      valid = inst
-000249f0: 616e 6365 2e69 735f 7661 6c69 6428 6461  ance.is_valid(da
-00024a00: 7461 290a 0a20 2020 2020 2020 2023 2041  ta)..        # A
-00024a10: 7373 6572 740a 2020 2020 2020 2020 6578  ssert.        ex
-00024a20: 7065 6374 6564 203d 2070 642e 5365 7269  pected = pd.Seri
-00024a30: 6573 285b 5472 7565 2c20 4661 6c73 652c  es([True, False,
-00024a40: 2054 7275 652c 2046 616c 7365 2c20 5472   True, False, Tr
-00024a50: 7565 5d2c 2069 6e64 6578 3d5b 302c 2030  ue], index=[0, 0
-00024a60: 2c20 302c 2030 2c20 305d 290a 2020 2020  , 0, 0, 0]).    
-00024a70: 2020 2020 7064 2e74 6573 7469 6e67 2e61      pd.testing.a
-00024a80: 7373 6572 745f 7365 7269 6573 5f65 7175  ssert_series_equ
-00024a90: 616c 2876 616c 6964 2c20 6578 7065 6374  al(valid, expect
-00024aa0: 6564 290a 0a20 2020 2064 6566 2074 6573  ed)..    def tes
-00024ab0: 745f 6973 5f76 616c 6964 5f63 7573 746f  t_is_valid_custo
-00024ac0: 6d5f 696e 6465 785f 6e6f 745f 736f 7274  m_index_not_sort
-00024ad0: 6564 2873 656c 6629 3a0a 2020 2020 2020  ed(self):.      
-00024ae0: 2020 2222 2254 6573 7420 7468 6520 6060    """Test the ``
-00024af0: 556e 6971 7565 2e69 735f 7661 6c69 6460  Unique.is_valid`
-00024b00: 6020 6d65 7468 6f64 2e0a 0a20 2020 2020  ` method...     
-00024b10: 2020 2054 6869 7320 6d65 7468 6f64 2073     This method s
-00024b20: 686f 756c 6420 7265 7475 726e 2061 2070  hould return a p
-00024b30: 642e 5365 7269 6573 2077 6865 7265 2074  d.Series where t
-00024b40: 6865 2069 6e64 6578 0a20 2020 2020 2020  he index.       
-00024b50: 206f 6620 7468 6520 6669 7273 7420 6f63   of the first oc
-00024b60: 6375 7265 6e63 6520 6f66 2061 2075 6e69  curence of a uni
-00024b70: 7175 6520 636f 6d62 696e 6174 696f 6e20  que combination 
-00024b80: 6f66 2060 6069 6e73 7461 6e63 652e 636f  of ``instance.co
-00024b90: 6c75 6d6e 5f6e 616d 6573 6060 0a20 2020  lumn_names``.   
-00024ba0: 2020 2020 2069 7320 7365 7420 746f 2060       is set to `
-00024bb0: 6054 7275 6560 602c 2061 6e64 2065 7665  `True``, and eve
-00024bc0: 7279 206f 7468 6572 206f 6363 7572 656e  ry other occuren
-00024bd0: 6365 2069 7320 7365 7420 746f 2060 6046  ce is set to ``F
-00024be0: 616c 7365 6060 2e0a 0a20 2020 2020 2020  alse``...       
-00024bf0: 2049 6e70 7574 3a0a 2020 2020 2020 2020   Input:.        
-00024c00: 2d20 4461 7461 4672 616d 6520 7769 7468  - DataFrame with
-00024c10: 206d 756c 7469 706c 6520 6f66 2074 6865   multiple of the
-00024c20: 2073 616d 6520 636f 6d62 696e 6174 696f   same combinatio
-00024c30: 6e73 206f 6620 636f 6c75 6d6e 732e 0a20  ns of columns.. 
-00024c40: 2020 2020 2020 202d 2044 6174 6146 7261         - DataFra
-00024c50: 6d65 2068 6173 2061 2063 7573 746f 6d20  me has a custom 
-00024c60: 696e 6465 7820 636f 6c75 6d6e 2077 6869  index column whi
-00024c70: 6368 2069 7320 7365 7420 696e 2061 6e20  ch is set in an 
-00024c80: 756e 736f 7274 6564 2077 6179 2e0a 2020  unsorted way..  
-00024c90: 2020 2020 2020 4f75 7470 7574 3a0a 2020        Output:.  
-00024ca0: 2020 2020 2020 2d20 5365 7269 6573 2077        - Series w
-00024cb0: 6974 6820 7468 6520 696e 6465 7820 6f66  ith the index of
-00024cc0: 2074 6865 2066 6972 7374 206f 6363 7572   the first occur
-00024cd0: 656e 6365 7320 7365 7420 746f 2060 6054  ences set to ``T
-00024ce0: 7275 6560 602e 0a20 2020 2020 2020 2047  rue``..        G
-00024cf0: 6974 6875 6220 4973 7375 653a 0a20 2020  ithub Issue:.   
-00024d00: 2020 2020 202d 2050 726f 626c 656d 2069       - Problem i
-00024d10: 7320 6465 7363 7269 6265 6420 696e 3a20  s described in: 
-00024d20: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
-00024d30: 6f6d 2f73 6476 2d64 6576 2f53 4456 2f69  om/sdv-dev/SDV/i
-00024d40: 7373 7565 732f 3631 370a 2020 2020 2020  ssues/617.      
-00024d50: 2020 2222 220a 2020 2020 2020 2020 2320    """.        # 
-00024d60: 5365 7475 700a 2020 2020 2020 2020 696e  Setup.        in
-00024d70: 7374 616e 6365 203d 2055 6e69 7175 6528  stance = Unique(
-00024d80: 636f 6c75 6d6e 5f6e 616d 6573 3d5b 2761  column_names=['a
-00024d90: 272c 2027 6227 2c20 2763 275d 290a 0a20  ', 'b', 'c']).. 
-00024da0: 2020 2020 2020 2023 2052 756e 0a20 2020         # Run.   
-00024db0: 2020 2020 2064 6174 6120 3d20 7064 2e44       data = pd.D
-00024dc0: 6174 6146 7261 6d65 287b 0a20 2020 2020  ataFrame({.     
-00024dd0: 2020 2020 2020 2027 6127 3a20 5b31 2c20         'a': [1, 
-00024de0: 312c 2032 2c20 322c 2033 5d2c 0a20 2020  1, 2, 2, 3],.   
-00024df0: 2020 2020 2020 2020 2027 6227 3a20 5b35           'b': [5
-00024e00: 2c20 352c 2036 2c20 362c 2037 5d2c 0a20  , 5, 6, 6, 7],. 
-00024e10: 2020 2020 2020 2020 2020 2027 6327 3a20             'c': 
-00024e20: 5b38 2c20 382c 2039 2c20 392c 2031 305d  [8, 8, 9, 9, 10]
-00024e30: 0a20 2020 2020 2020 207d 2c20 696e 6465  .        }, inde
-00024e40: 783d 5b32 2c20 312c 2033 2c20 352c 2034  x=[2, 1, 3, 5, 4
-00024e50: 5d29 0a20 2020 2020 2020 2076 616c 6964  ]).        valid
-00024e60: 203d 2069 6e73 7461 6e63 652e 6973 5f76   = instance.is_v
-00024e70: 616c 6964 2864 6174 6129 0a0a 2020 2020  alid(data)..    
-00024e80: 2020 2020 2320 4173 7365 7274 0a20 2020      # Assert.   
-00024e90: 2020 2020 2065 7870 6563 7465 6420 3d20       expected = 
-00024ea0: 7064 2e53 6572 6965 7328 5b54 7275 652c  pd.Series([True,
-00024eb0: 2046 616c 7365 2c20 5472 7565 2c20 4661   False, True, Fa
-00024ec0: 6c73 652c 2054 7275 655d 2c20 696e 6465  lse, True], inde
-00024ed0: 783d 5b32 2c20 312c 2033 2c20 352c 2034  x=[2, 1, 3, 5, 4
-00024ee0: 5d29 0a20 2020 2020 2020 2070 642e 7465  ]).        pd.te
-00024ef0: 7374 696e 672e 6173 7365 7274 5f73 6572  sting.assert_ser
-00024f00: 6965 735f 6571 7561 6c28 7661 6c69 642c  ies_equal(valid,
-00024f10: 2065 7870 6563 7465 6429 0a0a 2020 2020   expected)..    
-00024f20: 6465 6620 7465 7374 5f69 735f 7661 6c69  def test_is_vali
-00024f30: 645f 6f6e 655f 636f 6c75 6d6e 5f63 7573  d_one_column_cus
-00024f40: 746f 6d5f 696e 6465 785f 6e6f 745f 736f  tom_index_not_so
-00024f50: 7274 6564 2873 656c 6629 3a0a 2020 2020  rted(self):.    
-00024f60: 2020 2020 2222 2254 6573 7420 7468 6520      """Test the 
-00024f70: 6060 556e 6971 7565 2e69 735f 7661 6c69  ``Unique.is_vali
-00024f80: 6460 6020 6d65 7468 6f64 2e0a 0a20 2020  d`` method...   
-00024f90: 2020 2020 2054 6869 7320 6d65 7468 6f64       This method
-00024fa0: 2073 686f 756c 6420 7265 7475 726e 2061   should return a
-00024fb0: 2070 642e 5365 7269 6573 2077 6865 7265   pd.Series where
-00024fc0: 2074 6865 2069 6e64 6578 0a20 2020 2020   the index.     
-00024fd0: 2020 206f 6620 7468 6520 6669 7273 7420     of the first 
-00024fe0: 6f63 6375 7265 6e63 6520 6f66 2061 2075  occurence of a u
-00024ff0: 6e69 7175 6520 7661 6c75 6520 6f66 2060  nique value of `
-00025000: 6073 656c 662e 636f 6c75 6d6e 5f6e 616d  `self.column_nam
-00025010: 6573 6060 0a20 2020 2020 2020 2069 7320  es``.        is 
-00025020: 7365 7420 746f 2060 6054 7275 6560 602c  set to ``True``,
-00025030: 2061 6e64 2065 7665 7279 206f 7468 6572   and every other
-00025040: 206f 6363 7572 656e 6365 2069 7320 7365   occurence is se
-00025050: 7420 746f 2060 6046 616c 7365 6060 2e0a  t to ``False``..
-00025060: 0a20 2020 2020 2020 2049 6e70 7574 3a0a  .        Input:.
-00025070: 2020 2020 2020 2020 2d20 4461 7461 4672          - DataFr
-00025080: 616d 6520 7769 7468 206d 756c 7469 706c  ame with multipl
-00025090: 6520 6f63 6375 7265 6e63 6573 206f 6620  e occurences of 
-000250a0: 7468 6520 7361 6d65 2076 616c 7565 206f  the same value o
-000250b0: 6620 7468 650a 2020 2020 2020 2020 6f6e  f the.        on
-000250c0: 6520 636f 6c75 6d6e 2069 6e20 6060 696e  e column in ``in
-000250d0: 7374 616e 6365 2e63 6f6c 756d 6e73 6060  stance.columns``
-000250e0: 2e0a 2020 2020 2020 2020 2d20 4461 7461  ..        - Data
-000250f0: 4672 616d 6520 6861 7320 6120 6375 7374  Frame has a cust
-00025100: 6f6d 2069 6e64 6578 2063 6f6c 756d 6e20  om index column 
-00025110: 7768 6963 6820 6973 2073 6574 2069 6e20  which is set in 
-00025120: 616e 2075 6e73 6f72 7465 6420 7761 792e  an unsorted way.
-00025130: 0a20 2020 2020 2020 204f 7574 7075 743a  .        Output:
-00025140: 0a20 2020 2020 2020 202d 2053 6572 6965  .        - Serie
-00025150: 7320 7769 7468 2074 6865 2069 6e64 6578  s with the index
-00025160: 206f 6620 7468 6520 6669 7273 7420 6f63   of the first oc
-00025170: 6375 7265 6e63 6573 2073 6574 2074 6f20  curences set to 
-00025180: 6060 5472 7565 6060 2e0a 2020 2020 2020  ``True``..      
-00025190: 2020 4769 7468 7562 2049 7373 7565 3a0a    Github Issue:.
-000251a0: 2020 2020 2020 2020 2d20 5072 6f62 6c65          - Proble
-000251b0: 6d20 6973 2064 6573 6372 6962 6564 2069  m is described i
-000251c0: 6e3a 2068 7474 7073 3a2f 2f67 6974 6875  n: https://githu
-000251d0: 622e 636f 6d2f 7364 762d 6465 762f 5344  b.com/sdv-dev/SD
-000251e0: 562f 6973 7375 6573 2f36 3137 0a20 2020  V/issues/617.   
-000251f0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00025200: 2023 2053 6574 7570 0a20 2020 2020 2020   # Setup.       
-00025210: 2069 6e73 7461 6e63 6520 3d20 556e 6971   instance = Uniq
-00025220: 7565 2863 6f6c 756d 6e5f 6e61 6d65 733d  ue(column_names=
-00025230: 2761 2729 0a0a 2020 2020 2020 2020 2320  'a')..        # 
-00025240: 5275 6e0a 2020 2020 2020 2020 6461 7461  Run.        data
-00025250: 203d 2070 642e 4461 7461 4672 616d 6528   = pd.DataFrame(
-00025260: 7b0a 2020 2020 2020 2020 2020 2020 2761  {.            'a
-00025270: 273a 205b 312c 2031 2c20 312c 2032 2c20  ': [1, 1, 1, 2, 
-00025280: 332c 2032 5d2c 0a20 2020 2020 2020 2020  3, 2],.         
-00025290: 2020 2027 6227 3a20 5b31 2c20 322c 2033     'b': [1, 2, 3
-000252a0: 2c20 342c 2035 2c20 365d 2c0a 2020 2020  , 4, 5, 6],.    
-000252b0: 2020 2020 2020 2020 2763 273a 205b 4661          'c': [Fa
-000252c0: 6c73 652c 2046 616c 7365 2c20 5472 7565  lse, False, True
-000252d0: 2c20 4661 6c73 652c 2046 616c 7365 2c20  , False, False, 
-000252e0: 5472 7565 5d0a 2020 2020 2020 2020 7d2c  True].        },
-000252f0: 2069 6e64 6578 3d5b 322c 2031 2c20 332c   index=[2, 1, 3,
-00025300: 2035 2c20 342c 2036 5d29 0a20 2020 2020   5, 4, 6]).     
-00025310: 2020 2076 616c 6964 203d 2069 6e73 7461     valid = insta
-00025320: 6e63 652e 6973 5f76 616c 6964 2864 6174  nce.is_valid(dat
-00025330: 6129 0a0a 2020 2020 2020 2020 2320 4173  a)..        # As
-00025340: 7365 7274 0a20 2020 2020 2020 2065 7870  sert.        exp
-00025350: 6563 7465 6420 3d20 7064 2e53 6572 6965  ected = pd.Serie
-00025360: 7328 5b54 7275 652c 2046 616c 7365 2c20  s([True, False, 
-00025370: 4661 6c73 652c 2054 7275 652c 2054 7275  False, True, Tru
-00025380: 652c 2046 616c 7365 5d2c 2069 6e64 6578  e, False], index
-00025390: 3d5b 322c 2031 2c20 332c 2035 2c20 342c  =[2, 1, 3, 5, 4,
-000253a0: 2036 5d29 0a20 2020 2020 2020 2070 642e   6]).        pd.
-000253b0: 7465 7374 696e 672e 6173 7365 7274 5f73  testing.assert_s
-000253c0: 6572 6965 735f 6571 7561 6c28 7661 6c69  eries_equal(vali
-000253d0: 642c 2065 7870 6563 7465 6429 0a0a 2020  d, expected)..  
-000253e0: 2020 6465 6620 7465 7374 5f69 735f 7661    def test_is_va
-000253f0: 6c69 645f 6f6e 655f 636f 6c75 6d6e 5f63  lid_one_column_c
-00025400: 7573 746f 6d5f 696e 6465 785f 7361 6d65  ustom_index_same
-00025410: 5f76 616c 7565 7328 7365 6c66 293a 0a20  _values(self):. 
-00025420: 2020 2020 2020 2022 2222 5465 7374 2074         """Test t
-00025430: 6865 2060 6055 6e69 7175 652e 6973 5f76  he ``Unique.is_v
-00025440: 616c 6964 6060 206d 6574 686f 642e 0a0a  alid`` method...
-00025450: 2020 2020 2020 2020 5468 6973 206d 6574          This met
-00025460: 686f 6420 7368 6f75 6c64 2072 6574 7572  hod should retur
-00025470: 6e20 6120 7064 2e53 6572 6965 7320 7768  n a pd.Series wh
-00025480: 6572 6520 7468 6520 696e 6465 780a 2020  ere the index.  
-00025490: 2020 2020 2020 6f66 2074 6865 2066 6972        of the fir
-000254a0: 7374 206f 6363 7572 656e 6365 206f 6620  st occurence of 
-000254b0: 6120 756e 6971 7565 2076 616c 7565 206f  a unique value o
-000254c0: 6620 6060 7365 6c66 2e63 6f6c 756d 6e5f  f ``self.column_
-000254d0: 6e61 6d65 7360 600a 2020 2020 2020 2020  names``.        
-000254e0: 6973 2073 6574 2074 6f20 6060 5472 7565  is set to ``True
-000254f0: 6060 2c20 616e 6420 6576 6572 7920 6f74  ``, and every ot
-00025500: 6865 7220 6f63 6375 7265 6e63 6520 6973  her occurence is
-00025510: 2073 6574 2074 6f20 6060 4661 6c73 6560   set to ``False`
-00025520: 602e 0a0a 2020 2020 2020 2020 496e 7075  `...        Inpu
-00025530: 743a 0a20 2020 2020 2020 202d 2044 6174  t:.        - Dat
-00025540: 6146 7261 6d65 2077 6974 6820 6d75 6c74  aFrame with mult
-00025550: 6970 6c65 206f 6363 7572 656e 6365 7320  iple occurences 
-00025560: 6f66 2074 6865 2073 616d 6520 7661 6c75  of the same valu
-00025570: 6520 6f66 2074 6865 0a20 2020 2020 2020  e of the.       
-00025580: 206f 6e65 2063 6f6c 756d 6e20 696e 2060   one column in `
-00025590: 6069 6e73 7461 6e63 652e 636f 6c75 6d6e  `instance.column
-000255a0: 7360 602e 0a20 2020 2020 2020 202d 2044  s``..        - D
-000255b0: 6174 6146 7261 6d65 2068 6173 2061 2063  ataFrame has a c
-000255c0: 7573 746f 6d20 696e 6465 7820 636f 6c75  ustom index colu
-000255d0: 6d6e 2077 6869 6368 2069 7320 7365 7420  mn which is set 
-000255e0: 746f 2030 2066 6f72 2072 6f77 732e 0a20  to 0 for rows.. 
-000255f0: 2020 2020 2020 204f 7574 7075 743a 0a20         Output:. 
-00025600: 2020 2020 2020 202d 2053 6572 6965 7320         - Series 
-00025610: 7769 7468 2074 6865 2069 6e64 6578 206f  with the index o
-00025620: 6620 7468 6520 6669 7273 7420 6f63 6375  f the first occu
-00025630: 7265 6e63 6573 2073 6574 2074 6f20 6060  rences set to ``
-00025640: 5472 7565 6060 2e0a 2020 2020 2020 2020  True``..        
-00025650: 4769 7468 7562 2049 7373 7565 3a0a 2020  Github Issue:.  
-00025660: 2020 2020 2020 2d20 5072 6f62 6c65 6d20        - Problem 
-00025670: 6973 2064 6573 6372 6962 6564 2069 6e3a  is described in:
-00025680: 2068 7474 7073 3a2f 2f67 6974 6875 622e   https://github.
-00025690: 636f 6d2f 7364 762d 6465 762f 5344 562f  com/sdv-dev/SDV/
-000256a0: 6973 7375 6573 2f36 3136 0a20 2020 2020  issues/616.     
-000256b0: 2020 2022 2222 0a20 2020 2020 2020 2023     """.        #
-000256c0: 2053 6574 7570 0a20 2020 2020 2020 2069   Setup.        i
-000256d0: 6e73 7461 6e63 6520 3d20 556e 6971 7565  nstance = Unique
-000256e0: 2863 6f6c 756d 6e5f 6e61 6d65 733d 2761  (column_names='a
-000256f0: 2729 0a0a 2020 2020 2020 2020 2320 5275  ')..        # Ru
-00025700: 6e0a 2020 2020 2020 2020 6461 7461 203d  n.        data =
-00025710: 2070 642e 4461 7461 4672 616d 6528 7b0a   pd.DataFrame({.
-00025720: 2020 2020 2020 2020 2020 2020 2761 273a              'a':
-00025730: 205b 312c 2031 2c20 312c 2032 2c20 332c   [1, 1, 1, 2, 3,
-00025740: 2032 5d2c 0a20 2020 2020 2020 2020 2020   2],.           
-00025750: 2027 6227 3a20 5b31 2c20 322c 2033 2c20   'b': [1, 2, 3, 
-00025760: 342c 2035 2c20 365d 2c0a 2020 2020 2020  4, 5, 6],.      
-00025770: 2020 2020 2020 2763 273a 205b 4661 6c73        'c': [Fals
-00025780: 652c 2046 616c 7365 2c20 5472 7565 2c20  e, False, True, 
-00025790: 4661 6c73 652c 2046 616c 7365 2c20 5472  False, False, Tr
-000257a0: 7565 5d0a 2020 2020 2020 2020 7d2c 2069  ue].        }, i
-000257b0: 6e64 6578 3d5b 302c 2030 2c20 302c 2030  ndex=[0, 0, 0, 0
-000257c0: 2c20 302c 2030 5d29 0a20 2020 2020 2020  , 0, 0]).       
-000257d0: 2076 616c 6964 203d 2069 6e73 7461 6e63   valid = instanc
-000257e0: 652e 6973 5f76 616c 6964 2864 6174 6129  e.is_valid(data)
-000257f0: 0a0a 2020 2020 2020 2020 2320 4173 7365  ..        # Asse
-00025800: 7274 0a20 2020 2020 2020 2065 7870 6563  rt.        expec
-00025810: 7465 6420 3d20 7064 2e53 6572 6965 7328  ted = pd.Series(
-00025820: 5b54 7275 652c 2046 616c 7365 2c20 4661  [True, False, Fa
-00025830: 6c73 652c 2054 7275 652c 2054 7275 652c  lse, True, True,
-00025840: 2046 616c 7365 5d2c 2069 6e64 6578 3d5b   False], index=[
-00025850: 302c 2030 2c20 302c 2030 2c20 302c 2030  0, 0, 0, 0, 0, 0
-00025860: 5d29 0a20 2020 2020 2020 2070 642e 7465  ]).        pd.te
-00025870: 7374 696e 672e 6173 7365 7274 5f73 6572  sting.assert_ser
-00025880: 6965 735f 6571 7561 6c28 7661 6c69 642c  ies_equal(valid,
-00025890: 2065 7870 6563 7465 6429 0a0a 2020 2020   expected)..    
-000258a0: 6465 6620 7465 7374 5f69 735f 7661 6c69  def test_is_vali
-000258b0: 645f 6f6e 655f 636f 6c75 6d6e 2873 656c  d_one_column(sel
-000258c0: 6629 3a0a 2020 2020 2020 2020 2222 2254  f):.        """T
-000258d0: 6573 7420 7468 6520 6060 556e 6971 7565  est the ``Unique
-000258e0: 2e69 735f 7661 6c69 6460 6020 6d65 7468  .is_valid`` meth
-000258f0: 6f64 2e0a 0a20 2020 2020 2020 2054 6869  od...        Thi
-00025900: 7320 6d65 7468 6f64 2073 686f 756c 6420  s method should 
-00025910: 7265 7475 726e 2061 2070 642e 5365 7269  return a pd.Seri
-00025920: 6573 2077 6865 7265 2074 6865 2069 6e64  es where the ind
-00025930: 6578 0a20 2020 2020 2020 206f 6620 7468  ex.        of th
-00025940: 6520 6669 7273 7420 6f63 6375 7265 6e63  e first occurenc
-00025950: 6520 6f66 2061 2075 6e69 7175 6520 7661  e of a unique va
-00025960: 6c75 6520 6f66 2060 6073 656c 662e 636f  lue of ``self.co
-00025970: 6c75 6d6e 5f6e 616d 6573 6060 0a20 2020  lumn_names``.   
-00025980: 2020 2020 2069 7320 7365 7420 746f 2060       is set to `
-00025990: 6054 7275 6560 602c 2061 6e64 2065 7665  `True``, and eve
-000259a0: 7279 206f 7468 6572 206f 6363 7572 656e  ry other occuren
-000259b0: 6365 2069 7320 7365 7420 746f 2060 6046  ce is set to ``F
-000259c0: 616c 7365 6060 2e0a 0a20 2020 2020 2020  alse``...       
-000259d0: 2049 6e70 7574 3a0a 2020 2020 2020 2020   Input:.        
-000259e0: 2d20 4461 7461 4672 616d 6520 7769 7468  - DataFrame with
-000259f0: 206d 756c 7469 706c 6520 6f63 6375 7265   multiple occure
-00025a00: 6e63 6573 206f 6620 7468 6520 7361 6d65  nces of the same
-00025a10: 2076 616c 7565 206f 6620 7468 650a 2020   value of the.  
-00025a20: 2020 2020 2020 6f6e 6520 636f 6c75 6d6e        one column
-00025a30: 2069 6e20 6060 696e 7374 616e 6365 2e63   in ``instance.c
-00025a40: 6f6c 756d 6e73 6060 2e0a 2020 2020 2020  olumns``..      
-00025a50: 2020 4f75 7470 7574 3a0a 2020 2020 2020    Output:.      
-00025a60: 2020 2d20 5365 7269 6573 2077 6974 6820    - Series with 
-00025a70: 7468 6520 696e 6465 7820 6f66 2074 6865  the index of the
-00025a80: 2066 6972 7374 206f 6363 7572 656e 6365   first occurence
-00025a90: 7320 7365 7420 746f 2060 6054 7275 6560  s set to ``True`
-00025aa0: 602e 0a20 2020 2020 2020 2022 2222 0a20  `..        """. 
-00025ab0: 2020 2020 2020 2023 2053 6574 7570 0a20         # Setup. 
-00025ac0: 2020 2020 2020 2069 6e73 7461 6e63 6520         instance 
-00025ad0: 3d20 556e 6971 7565 2863 6f6c 756d 6e5f  = Unique(column_
-00025ae0: 6e61 6d65 733d 2761 2729 0a0a 2020 2020  names='a')..    
-00025af0: 2020 2020 2320 5275 6e0a 2020 2020 2020      # Run.      
-00025b00: 2020 6461 7461 203d 2070 642e 4461 7461    data = pd.Data
-00025b10: 4672 616d 6528 7b0a 2020 2020 2020 2020  Frame({.        
-00025b20: 2020 2020 2761 273a 205b 312c 2031 2c20      'a': [1, 1, 
-00025b30: 312c 2032 2c20 332c 2032 5d2c 0a20 2020  1, 2, 3, 2],.   
-00025b40: 2020 2020 2020 2020 2027 6227 3a20 5b31           'b': [1
-00025b50: 2c20 322c 2033 2c20 342c 2035 2c20 365d  , 2, 3, 4, 5, 6]
-00025b60: 2c0a 2020 2020 2020 2020 2020 2020 2763  ,.            'c
-00025b70: 273a 205b 4661 6c73 652c 2046 616c 7365  ': [False, False
-00025b80: 2c20 5472 7565 2c20 4661 6c73 652c 2046  , True, False, F
-00025b90: 616c 7365 2c20 5472 7565 5d0a 2020 2020  alse, True].    
-00025ba0: 2020 2020 7d29 0a20 2020 2020 2020 2076      }).        v
-00025bb0: 616c 6964 203d 2069 6e73 7461 6e63 652e  alid = instance.
-00025bc0: 6973 5f76 616c 6964 2864 6174 6129 0a0a  is_valid(data)..
-00025bd0: 2020 2020 2020 2020 2320 4173 7365 7274          # Assert
-00025be0: 0a20 2020 2020 2020 2065 7870 6563 7465  .        expecte
-00025bf0: 6420 3d20 7064 2e53 6572 6965 7328 5b54  d = pd.Series([T
-00025c00: 7275 652c 2046 616c 7365 2c20 4661 6c73  rue, False, Fals
-00025c10: 652c 2054 7275 652c 2054 7275 652c 2046  e, True, True, F
-00025c20: 616c 7365 5d29 0a20 2020 2020 2020 2070  alse]).        p
-00025c30: 642e 7465 7374 696e 672e 6173 7365 7274  d.testing.assert
-00025c40: 5f73 6572 6965 735f 6571 7561 6c28 7661  _series_equal(va
-00025c50: 6c69 642c 2065 7870 6563 7465 6429 0a0a  lid, expected)..
-00025c60: 2020 2020 6465 6620 7465 7374 5f69 735f      def test_is_
-00025c70: 7661 6c69 645f 6f6e 655f 636f 6c75 6d6e  valid_one_column
-00025c80: 5f6e 616e 7328 7365 6c66 293a 0a20 2020  _nans(self):.   
-00025c90: 2020 2020 2022 2222 5465 7374 2074 6865       """Test the
-00025ca0: 2060 6055 6e69 7175 652e 6973 5f76 616c   ``Unique.is_val
-00025cb0: 6964 6060 206d 6574 686f 6420 666f 7220  id`` method for 
-00025cc0: 6f6e 6520 636f 6c75 6d6e 2077 6974 6820  one column with 
-00025cd0: 6e61 6e73 2e0a 0a20 2020 2020 2020 2054  nans...        T
-00025ce0: 6869 7320 6d65 7468 6f64 2073 686f 756c  his method shoul
-00025cf0: 6420 7265 7475 726e 2061 2070 642e 5365  d return a pd.Se
-00025d00: 7269 6573 2077 6865 7265 2074 6865 2069  ries where the i
-00025d10: 6e64 6578 0a20 2020 2020 2020 206f 6620  ndex.        of 
-00025d20: 7468 6520 6669 7273 7420 6f63 6375 7265  the first occure
-00025d30: 6e63 6520 6f66 2061 2075 6e69 7175 6520  nce of a unique 
-00025d40: 7661 6c75 6520 6f66 2060 6069 6e73 7461  value of ``insta
-00025d50: 6e63 652e 636f 6c75 6d6e 5f6e 616d 6573  nce.column_names
-00025d60: 6060 0a20 2020 2020 2020 2069 7320 7365  ``.        is se
-00025d70: 7420 746f 2060 6054 7275 6560 602c 2061  t to ``True``, a
-00025d80: 6e64 2065 7665 7279 206f 7468 6572 206f  nd every other o
-00025d90: 6363 7572 656e 6365 2069 7320 7365 7420  ccurence is set 
-00025da0: 746f 2060 6046 616c 7365 6060 2e0a 2020  to ``False``..  
-00025db0: 2020 2020 2020 6060 4e6f 6e65 6060 2c20        ``None``, 
-00025dc0: 6060 6e70 2e6e 616e 6060 2061 6e64 2060  ``np.nan`` and `
-00025dd0: 6066 6c6f 6174 2827 6e61 6e27 2960 6020  `float('nan')`` 
-00025de0: 7368 6f75 6c64 2062 6520 7472 6561 7465  should be treate
-00025df0: 6420 6173 2074 6865 2073 616d 6520 6361  d as the same ca
-00025e00: 7465 676f 7279 2e0a 0a20 2020 2020 2020  tegory...       
-00025e10: 2049 6e70 7574 3a0a 2020 2020 2020 2020   Input:.        
-00025e20: 2d20 4461 7461 4672 616d 6520 7769 7468  - DataFrame with
-00025e30: 2073 6f6d 6520 7265 7065 6174 6564 2076   some repeated v
-00025e40: 616c 7565 732c 2073 6f6d 6520 6f66 2077  alues, some of w
-00025e50: 6869 6368 2061 7265 206e 616e 2773 2e0a  hich are nan's..
-00025e60: 2020 2020 2020 2020 4f75 7470 7574 3a0a          Output:.
-00025e70: 2020 2020 2020 2020 2d20 5365 7269 6573          - Series
-00025e80: 2077 6974 6820 7468 6520 696e 6465 7820   with the index 
-00025e90: 6f66 2074 6865 2066 6972 7374 206f 6363  of the first occ
-00025ea0: 7572 656e 6365 7320 7365 7420 746f 2060  urences set to `
-00025eb0: 6054 7275 6560 602e 0a20 2020 2020 2020  `True``..       
-00025ec0: 2022 2222 0a20 2020 2020 2020 2023 2053   """.        # S
-00025ed0: 6574 7570 0a20 2020 2020 2020 2069 6e73  etup.        ins
-00025ee0: 7461 6e63 6520 3d20 556e 6971 7565 2863  tance = Unique(c
-00025ef0: 6f6c 756d 6e5f 6e61 6d65 733d 5b27 6127  olumn_names=['a'
-00025f00: 5d29 0a0a 2020 2020 2020 2020 2320 5275  ])..        # Ru
-00025f10: 6e0a 2020 2020 2020 2020 6461 7461 203d  n.        data =
-00025f20: 2070 642e 4461 7461 4672 616d 6528 7b0a   pd.DataFrame({.
-00025f30: 2020 2020 2020 2020 2020 2020 2761 273a              'a':
-00025f40: 205b 312c 204e 6f6e 652c 2032 2c20 6e70   [1, None, 2, np
-00025f50: 2e6e 616e 2c20 666c 6f61 7428 276e 616e  .nan, float('nan
-00025f60: 2729 2c20 315d 2c0a 2020 2020 2020 2020  '), 1],.        
-00025f70: 2020 2020 2762 273a 205b 6e70 2e6e 616e      'b': [np.nan
-00025f80: 2c20 312c 204e 6f6e 652c 2066 6c6f 6174  , 1, None, float
-00025f90: 2827 6e61 6e27 292c 2066 6c6f 6174 2827  ('nan'), float('
-00025fa0: 6e61 6e27 292c 2031 5d2c 0a20 2020 2020  nan'), 1],.     
-00025fb0: 2020 207d 290a 2020 2020 2020 2020 7661     }).        va
-00025fc0: 6c69 6420 3d20 696e 7374 616e 6365 2e69  lid = instance.i
-00025fd0: 735f 7661 6c69 6428 6461 7461 290a 0a20  s_valid(data).. 
-00025fe0: 2020 2020 2020 2023 2041 7373 6572 740a         # Assert.
-00025ff0: 2020 2020 2020 2020 6578 7065 6374 6564          expected
-00026000: 203d 2070 642e 5365 7269 6573 285b 5472   = pd.Series([Tr
-00026010: 7565 2c20 5472 7565 2c20 5472 7565 2c20  ue, True, True, 
-00026020: 4661 6c73 652c 2046 616c 7365 2c20 4661  False, False, Fa
-00026030: 6c73 655d 290a 2020 2020 2020 2020 7064  lse]).        pd
-00026040: 2e74 6573 7469 6e67 2e61 7373 6572 745f  .testing.assert_
-00026050: 7365 7269 6573 5f65 7175 616c 2876 616c  series_equal(val
-00026060: 6964 2c20 6578 7065 6374 6564 290a 0a20  id, expected).. 
-00026070: 2020 2064 6566 2074 6573 745f 6973 5f76     def test_is_v
-00026080: 616c 6964 5f6d 756c 7469 706c 655f 636f  alid_multiple_co
-00026090: 6c75 6d6e 735f 6e61 6e73 2873 656c 6629  lumns_nans(self)
-000260a0: 3a0a 2020 2020 2020 2020 2222 2254 6573  :.        """Tes
-000260b0: 7420 7468 6520 6060 556e 6971 7565 2e69  t the ``Unique.i
-000260c0: 735f 7661 6c69 6460 6020 6d65 7468 6f64  s_valid`` method
-000260d0: 2066 6f72 206d 756c 7469 706c 6520 636f   for multiple co
-000260e0: 6c75 6d6e 7320 7769 7468 206e 616e 732e  lumns with nans.
-000260f0: 0a0a 2020 2020 2020 2020 5468 6973 206d  ..        This m
-00026100: 6574 686f 6420 7368 6f75 6c64 2072 6574  ethod should ret
-00026110: 7572 6e20 6120 7064 2e53 6572 6965 7320  urn a pd.Series 
-00026120: 7768 6572 6520 7468 6520 696e 6465 780a  where the index.
-00026130: 2020 2020 2020 2020 6f66 2074 6865 2066          of the f
-00026140: 6972 7374 206f 6363 7572 656e 6365 206f  irst occurence o
-00026150: 6620 6120 756e 6971 7565 2063 6f6d 6269  f a unique combi
-00026160: 6e61 7469 6f6e 206f 6620 6060 696e 7374  nation of ``inst
-00026170: 616e 6365 2e63 6f6c 756d 6e5f 6e61 6d65  ance.column_name
-00026180: 7360 600a 2020 2020 2020 2020 6973 2073  s``.        is s
-00026190: 6574 2074 6f20 6060 5472 7565 6060 2c20  et to ``True``, 
-000261a0: 616e 6420 6576 6572 7920 6f74 6865 7220  and every other 
-000261b0: 6f63 6375 7265 6e63 6520 6973 2073 6574  occurence is set
-000261c0: 2074 6f20 6060 4661 6c73 6560 602e 0a20   to ``False``.. 
-000261d0: 2020 2020 2020 2060 604e 6f6e 6560 602c         ``None``,
-000261e0: 2060 606e 702e 6e61 6e60 6020 616e 6420   ``np.nan`` and 
-000261f0: 6060 666c 6f61 7428 276e 616e 2729 6060  ``float('nan')``
-00026200: 2073 686f 756c 6420 6265 2074 7265 6174   should be treat
-00026210: 6564 2061 7320 7468 6520 7361 6d65 2063  ed as the same c
-00026220: 6174 6567 6f72 792e 0a0a 2020 2020 2020  ategory...      
-00026230: 2020 496e 7075 743a 0a20 2020 2020 2020    Input:.       
-00026240: 202d 2044 6174 6146 7261 6d65 2077 6974   - DataFrame wit
-00026250: 6820 6d75 6c74 6970 6c65 206f 6620 7468  h multiple of th
-00026260: 6520 7361 6d65 2063 6f6d 6269 6e61 7469  e same combinati
-00026270: 6f6e 7320 6f66 2063 6f6c 756d 6e73 2c20  ons of columns, 
-00026280: 736f 6d65 206f 6620 7768 6963 6820 6172  some of which ar
-00026290: 6520 6e61 6e27 732e 0a20 2020 2020 2020  e nan's..       
-000262a0: 204f 7574 7075 743a 0a20 2020 2020 2020   Output:.       
-000262b0: 202d 2053 6572 6965 7320 7769 7468 2074   - Series with t
-000262c0: 6865 2069 6e64 6578 206f 6620 7468 6520  he index of the 
-000262d0: 6669 7273 7420 6f63 6375 7265 6e63 6573  first occurences
-000262e0: 2073 6574 2074 6f20 6060 5472 7565 6060   set to ``True``
-000262f0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00026300: 2020 2020 2020 2320 5365 7475 700a 2020        # Setup.  
-00026310: 2020 2020 2020 696e 7374 616e 6365 203d        instance =
-00026320: 2055 6e69 7175 6528 636f 6c75 6d6e 5f6e   Unique(column_n
-00026330: 616d 6573 3d5b 2761 272c 2027 6227 5d29  ames=['a', 'b'])
-00026340: 0a0a 2020 2020 2020 2020 2320 5275 6e0a  ..        # Run.
-00026350: 2020 2020 2020 2020 6461 7461 203d 2070          data = p
-00026360: 642e 4461 7461 4672 616d 6528 7b0a 2020  d.DataFrame({.  
-00026370: 2020 2020 2020 2020 2020 2761 273a 205b            'a': [
-00026380: 312c 204e 6f6e 652c 2031 2c20 6e70 2e6e  1, None, 1, np.n
-00026390: 616e 2c20 666c 6f61 7428 276e 616e 2729  an, float('nan')
-000263a0: 2c20 315d 2c0a 2020 2020 2020 2020 2020  , 1],.          
-000263b0: 2020 2762 273a 205b 6e70 2e6e 616e 2c20    'b': [np.nan, 
-000263c0: 312c 204e 6f6e 652c 2066 6c6f 6174 2827  1, None, float('
-000263d0: 6e61 6e27 292c 2066 6c6f 6174 2827 6e61  nan'), float('na
-000263e0: 6e27 292c 2031 5d2c 0a20 2020 2020 2020  n'), 1],.       
-000263f0: 207d 290a 2020 2020 2020 2020 7661 6c69   }).        vali
-00026400: 6420 3d20 696e 7374 616e 6365 2e69 735f  d = instance.is_
-00026410: 7661 6c69 6428 6461 7461 290a 0a20 2020  valid(data)..   
-00026420: 2020 2020 2023 2041 7373 6572 740a 2020       # Assert.  
-00026430: 2020 2020 2020 6578 7065 6374 6564 203d        expected =
-00026440: 2070 642e 5365 7269 6573 285b 5472 7565   pd.Series([True
-00026450: 2c20 5472 7565 2c20 4661 6c73 652c 2054  , True, False, T
-00026460: 7275 652c 2046 616c 7365 2c20 5472 7565  rue, False, True
-00026470: 5d29 0a20 2020 2020 2020 2070 642e 7465  ]).        pd.te
-00026480: 7374 696e 672e 6173 7365 7274 5f73 6572  sting.assert_ser
-00026490: 6965 735f 6571 7561 6c28 7661 6c69 642c  ies_equal(valid,
-000264a0: 2065 7870 6563 7465 6429 0a0a 0a63 6c61   expected)...cla
-000264b0: 7373 2054 6573 7446 6978 6564 496e 6372  ss TestFixedIncr
-000264c0: 656d 656e 7473 2829 3a0a 0a20 2020 2064  ements():..    d
-000264d0: 6566 2074 6573 745f 5f76 616c 6964 6174  ef test__validat
-000264e0: 655f 696e 7075 7473 2873 656c 6629 3a0a  e_inputs(self):.
-000264f0: 2020 2020 2020 2020 2222 2254 6573 7420          """Test 
-00026500: 7468 6520 6060 4669 7865 6449 6e63 7265  the ``FixedIncre
-00026510: 6d65 6e74 732e 5f76 616c 6964 6174 655f  ments._validate_
-00026520: 696e 7075 7473 6060 206d 6574 686f 642e  inputs`` method.
-00026530: 0a0a 2020 2020 2020 2020 496e 7075 743a  ..        Input:
-00026540: 0a20 2020 2020 2020 202d 2020 496e 636f  .        -  Inco
-00026550: 7272 6563 7420 7061 7261 6d65 7465 7273  rrect parameters
-00026560: 2066 6f72 2074 6865 206d 6574 686f 640a   for the method.
-00026570: 2020 2020 2020 2020 5261 6973 6573 3a0a          Raises:.
-00026580: 2020 2020 2020 2020 2d20 4c69 7374 206f          - List o
-00026590: 6620 5661 6c75 6545 7272 6f72 730a 2020  f ValueErrors.  
-000265a0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-000265b0: 2020 6572 725f 6d73 6720 3d20 280a 2020    err_msg = (.  
-000265c0: 2020 2020 2020 2020 2020 7227 4d69 7373            r'Miss
-000265d0: 696e 6720 7265 7175 6972 6564 2076 616c  ing required val
-000265e0: 7565 7320 7b28 2e2a 297d 2069 6e20 6120  ues {(.*)} in a 
-000265f0: 4669 7865 6449 6e63 7265 6d65 6e74 7320  FixedIncrements 
-00026600: 636f 6e73 7472 6169 6e74 2e27 0a20 2020  constraint.'.   
-00026610: 2020 2020 2020 2020 2072 275c 6e5c 6e49           r'\n\nI
-00026620: 6e76 616c 6964 2076 616c 7565 7320 7b28  nvalid values {(
-00026630: 2e2a 297d 2061 7265 2070 7265 7365 6e74  .*)} are present
-00026640: 2069 6e20 6120 4669 7865 6449 6e63 7265   in a FixedIncre
-00026650: 6d65 6e74 7320 636f 6e73 7472 6169 6e74  ments constraint
-00026660: 2e27 0a20 2020 2020 2020 2020 2020 2072  .'.            r
-00026670: 275c 6e5c 6e49 6e76 616c 6964 2069 6e63  '\n\nInvalid inc
-00026680: 7265 6d65 6e74 2076 616c 7565 207b 282e  rement value {(.
-00026690: 2a29 7d20 696e 2061 2046 6978 6564 496e  *)} in a FixedIn
-000266a0: 6372 656d 656e 7473 2063 6f6e 7374 7261  crements constra
-000266b0: 696e 742e 270a 2020 2020 2020 2020 2020  int.'.          
-000266c0: 2020 2720 496e 6372 656d 656e 7473 206d    ' Increments m
-000266d0: 7573 7420 6265 2070 6f73 6974 6976 6520  ust be positive 
-000266e0: 696e 7465 6765 7273 2e27 0a20 2020 2020  integers.'.     
-000266f0: 2020 2029 0a20 2020 2020 2020 2023 2052     ).        # R
-00026700: 756e 202f 2041 7373 6572 740a 2020 2020  un / Assert.    
-00026710: 2020 2020 7769 7468 2070 7974 6573 742e      with pytest.
-00026720: 7261 6973 6573 2841 6767 7265 6761 7465  raises(Aggregate
-00026730: 436f 6e73 7472 6169 6e74 7345 7272 6f72  ConstraintsError
-00026740: 2920 6173 2065 7272 6f72 3a0a 2020 2020  ) as error:.    
-00026750: 2020 2020 2020 2020 4669 7865 6449 6e63          FixedInc
-00026760: 7265 6d65 6e74 732e 5f76 616c 6964 6174  rements._validat
-00026770: 655f 696e 7075 7473 280a 2020 2020 2020  e_inputs(.      
-00026780: 2020 2020 2020 2020 2020 6e6f 745f 636f            not_co
-00026790: 6c75 6d6e 5f6e 616d 653d 4e6f 6e65 2c20  lumn_name=None, 
-000267a0: 696e 6372 656d 656e 745f 7661 6c75 653d  increment_value=
-000267b0: 2d31 2c20 736f 6d65 7468 696e 675f 656c  -1, something_el
-000267c0: 7365 3d4e 6f6e 6529 0a0a 2020 2020 2020  se=None)..      
-000267d0: 2020 6772 6f75 7073 203d 2072 652e 7365    groups = re.se
-000267e0: 6172 6368 2865 7272 5f6d 7367 2c20 7374  arch(err_msg, st
-000267f0: 7228 6572 726f 722e 7661 6c75 6529 290a  r(error.value)).
-00026800: 2020 2020 2020 2020 6173 7365 7274 2067          assert g
-00026810: 726f 7570 7320 6973 206e 6f74 204e 6f6e  roups is not Non
-00026820: 650a 2020 2020 2020 2020 6173 7365 7274  e.        assert
-00026830: 2073 7472 2865 7661 6c28 6772 6f75 7073   str(eval(groups
-00026840: 2e67 726f 7570 2831 2929 2920 3d3d 2027  .group(1))) == '
-00026850: 636f 6c75 6d6e 5f6e 616d 6527 0a20 2020  column_name'.   
-00026860: 2020 2020 2061 7373 6572 7420 7365 7428       assert set(
-00026870: 6576 616c 2867 726f 7570 732e 6772 6f75  eval(groups.grou
-00026880: 7028 3229 2929 203d 3d20 7b27 736f 6d65  p(2))) == {'some
-00026890: 7468 696e 675f 656c 7365 272c 2027 6e6f  thing_else', 'no
-000268a0: 745f 636f 6c75 6d6e 5f6e 616d 6527 7d0a  t_column_name'}.
-000268b0: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
-000268c0: 6e74 2865 7661 6c28 6772 6f75 7073 2e67  nt(eval(groups.g
-000268d0: 726f 7570 2833 2929 2920 3d3d 202d 310a  roup(3))) == -1.
-000268e0: 0a20 2020 2064 6566 2074 6573 745f 5f76  .    def test__v
-000268f0: 616c 6964 6174 655f 6d65 7461 6461 7461  alidate_metadata
-00026900: 5f63 6f6c 756d 6e73 2873 656c 6629 3a0a  _columns(self):.
-00026910: 2020 2020 2020 2020 2222 2254 6573 7420          """Test 
-00026920: 7468 6520 6060 5f76 616c 6964 6174 655f  the ``_validate_
-00026930: 6d65 7461 6461 7461 5f63 6f6c 756d 6e73  metadata_columns
-00026940: 6060 206d 6574 686f 642e 0a0a 2020 2020  `` method...    
-00026950: 2020 2020 5468 6520 636f 6c75 6d6e 2070      The column p
-00026960: 6173 7365 6420 696e 2063 6f6c 756d 6e5f  assed in column_
-00026970: 6e61 6d65 2073 686f 756c 6420 6265 2069  name should be i
-00026980: 6e20 7468 6520 6d65 7461 6461 7461 2e0a  n the metadata..
-00026990: 0a20 2020 2020 2020 2049 6e70 7574 3a0a  .        Input:.
-000269a0: 2020 2020 2020 2020 2020 2020 2d20 636f              - co
-000269b0: 6c75 6d6e 5f6e 616d 6520 7468 6174 2069  lumn_name that i
-000269c0: 7320 696e 2074 6865 206d 6574 6164 6174  s in the metadat
-000269d0: 612e 0a0a 2020 2020 2020 2020 5369 6465  a...        Side
-000269e0: 2065 6666 6563 743a 0a20 2020 2020 2020   effect:.       
-000269f0: 2020 2020 202d 204e 6f20 6572 726f 7220       - No error 
-00026a00: 7368 6f75 6c64 2062 6520 7261 6973 6564  should be raised
-00026a10: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00026a20: 2020 2020 2020 2320 5365 7475 700a 2020        # Setup.  
-00026a30: 2020 2020 2020 6d65 7461 6461 7461 203d        metadata =
-00026a40: 204d 6f63 6b28 290a 2020 2020 2020 2020   Mock().        
-00026a50: 6d65 7461 6461 7461 2e63 6f6c 756d 6e73  metadata.columns
-00026a60: 203d 207b 2761 273a 2031 2c20 2762 273a   = {'a': 1, 'b':
-00026a70: 2032 7d0a 0a20 2020 2020 2020 2023 2052   2}..        # R
-00026a80: 756e 0a20 2020 2020 2020 2046 6978 6564  un.        Fixed
-00026a90: 496e 6372 656d 656e 7473 2e5f 7661 6c69  Increments._vali
-00026aa0: 6461 7465 5f6d 6574 6164 6174 615f 636f  date_metadata_co
-00026ab0: 6c75 6d6e 7328 6d65 7461 6461 7461 2c20  lumns(metadata, 
-00026ac0: 636f 6c75 6d6e 5f6e 616d 653d 2761 2729  column_name='a')
-00026ad0: 0a0a 2020 2020 6465 6620 7465 7374 5f5f  ..    def test__
-00026ae0: 7661 6c69 6461 7465 5f6d 6574 6164 6174  validate_metadat
-00026af0: 615f 636f 6c75 6d6e 735f 7261 6973 6573  a_columns_raises
-00026b00: 5f65 7272 6f72 2873 656c 6629 3a0a 2020  _error(self):.  
-00026b10: 2020 2020 2020 2222 2254 6573 7420 7468        """Test th
-00026b20: 6520 6060 5f76 616c 6964 6174 655f 6d65  e ``_validate_me
-00026b30: 7461 6461 7461 5f63 6f6c 756d 6e73 6060  tadata_columns``
-00026b40: 206d 6574 686f 6427 7320 6572 726f 7220   method's error 
-00026b50: 636f 6e64 6974 696f 6e2e 0a0a 2020 2020  condition...    
-00026b60: 2020 2020 4966 2063 6f6c 756d 6e5f 6e61      If column_na
-00026b70: 6d65 2069 7320 6e6f 7420 696e 2074 6865  me is not in the
-00026b80: 206d 6574 6164 6174 612c 2061 6e20 6572   metadata, an er
-00026b90: 726f 7220 7368 6f75 6c64 2062 6520 7261  ror should be ra
-00026ba0: 6973 6564 2e0a 0a20 2020 2020 2020 2049  ised...        I
-00026bb0: 6e70 7574 3a0a 2020 2020 2020 2020 2020  nput:.          
-00026bc0: 2020 2d20 636f 6c75 6d6e 5f6e 616d 6520    - column_name 
-00026bd0: 7468 6174 2069 7320 6e6f 7420 696e 2074  that is not in t
-00026be0: 6865 206d 6574 6164 6174 612e 0a0a 2020  he metadata...  
-00026bf0: 2020 2020 2020 5369 6465 2065 6666 6563        Side effec
-00026c00: 743a 0a20 2020 2020 2020 2020 2020 202d  t:.            -
-00026c10: 2043 6f6e 7374 7261 696e 744d 6574 6164   ConstraintMetad
-00026c20: 6174 6145 7272 6f72 2073 686f 756c 6420  ataError should 
-00026c30: 6265 2072 6169 7365 642e 0a20 2020 2020  be raised..     
-00026c40: 2020 2022 2222 0a20 2020 2020 2020 2023     """.        #
-00026c50: 2053 6574 7570 0a20 2020 2020 2020 206d   Setup.        m
-00026c60: 6574 6164 6174 6120 3d20 4d6f 636b 2829  etadata = Mock()
-00026c70: 0a20 2020 2020 2020 206d 6574 6164 6174  .        metadat
-00026c80: 612e 636f 6c75 6d6e 7320 3d20 7b27 6127  a.columns = {'a'
-00026c90: 3a20 312c 2027 6227 3a20 327d 0a0a 2020  : 1, 'b': 2}..  
-00026ca0: 2020 2020 2020 2320 5275 6e0a 2020 2020        # Run.    
-00026cb0: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
-00026cc0: 6520 3d20 7265 2e65 7363 6170 6528 0a20  e = re.escape(. 
-00026cd0: 2020 2020 2020 2020 2020 2027 4120 4669             'A Fi
-00026ce0: 7865 6449 6e63 7265 6d65 6e74 7320 636f  xedIncrements co
-00026cf0: 6e73 7472 6169 6e74 2069 7320 6265 696e  nstraint is bein
-00026d00: 6720 6170 706c 6965 6420 746f 2069 6e76  g applied to inv
-00026d10: 616c 6964 2063 6f6c 756d 6e20 6e61 6d65  alid column name
-00026d20: 7320 270a 2020 2020 2020 2020 2020 2020  s '.            
-00026d30: 227b 2763 277d 2e20 5468 6520 636f 6c75  "{'c'}. The colu
-00026d40: 6d6e 7320 6d75 7374 2065 7869 7374 2069  mns must exist i
-00026d50: 6e20 7468 6520 7461 626c 652e 220a 2020  n the table.".  
-00026d60: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00026d70: 7769 7468 2070 7974 6573 742e 7261 6973  with pytest.rais
-00026d80: 6573 2843 6f6e 7374 7261 696e 744d 6574  es(ConstraintMet
-00026d90: 6164 6174 6145 7272 6f72 2c20 6d61 7463  adataError, matc
-00026da0: 683d 6572 726f 725f 6d65 7373 6167 6529  h=error_message)
-00026db0: 3a0a 2020 2020 2020 2020 2020 2020 4669  :.            Fi
-00026dc0: 7865 6449 6e63 7265 6d65 6e74 732e 5f76  xedIncrements._v
-00026dd0: 616c 6964 6174 655f 6d65 7461 6461 7461  alidate_metadata
-00026de0: 5f63 6f6c 756d 6e73 286d 6574 6164 6174  _columns(metadat
-00026df0: 612c 2063 6f6c 756d 6e5f 6e61 6d65 3d27  a, column_name='
-00026e00: 6327 290a 0a20 2020 2064 6566 2074 6573  c')..    def tes
-00026e10: 745f 5f5f 696e 6974 5f5f 2873 656c 6629  t___init__(self)
-00026e20: 3a0a 2020 2020 2020 2020 2222 2254 6573  :.        """Tes
-00026e30: 7420 7468 6520 6060 4669 7865 6449 6e63  t the ``FixedInc
-00026e40: 7265 6d65 6e74 732e 5f5f 696e 6974 5f5f  rements.__init__
-00026e50: 6060 206d 6574 686f 642e 0a0a 2020 2020  `` method...    
-00026e60: 2020 2020 5468 6520 6060 636f 6c75 6d6e      The ``column
-00026e70: 5f6e 616d 6560 6020 616e 6420 6060 696e  _name`` and ``in
-00026e80: 6372 656d 656e 745f 7661 6c75 6560 6020  crement_value`` 
-00026e90: 696e 7374 616e 6365 2076 6172 6961 626c  instance variabl
-00026ea0: 6573 2073 686f 756c 6420 6265 2073 6574  es should be set
-00026eb0: 2e0a 0a20 2020 2020 2020 2049 6e70 7574  ...        Input
-00026ec0: 3a0a 2020 2020 2020 2020 2020 2020 2d20  :.            - 
-00026ed0: 636f 6c75 6d6e 206e 616d 6520 6173 2061  column name as a
-00026ee0: 2073 7472 696e 672e 0a20 2020 2020 2020   string..       
-00026ef0: 2020 2020 202d 2069 6e63 7265 6d65 6e74       - increment
-00026f00: 5f76 616c 7565 2061 7320 616e 2069 6e74  _value as an int
-00026f10: 2e0a 0a20 2020 2020 2020 2045 7870 6563  ...        Expec
-00026f20: 7465 6420 6265 6861 7669 6f72 3a0a 2020  ted behavior:.  
-00026f30: 2020 2020 2020 2020 2020 2d20 496e 7374            - Inst
-00026f40: 616e 6365 2077 6974 6820 6060 636f 6c75  ance with ``colu
-00026f50: 6d6e 5f6e 616d 6560 6020 616e 6420 6060  mn_name`` and ``
-00026f60: 696e 6372 656d 656e 745f 7661 6c75 6560  increment_value`
-00026f70: 6020 7365 742e 0a20 2020 2020 2020 2022  ` set..        "
-00026f80: 2222 0a20 2020 2020 2020 2023 2052 756e  "".        # Run
-00026f90: 0a20 2020 2020 2020 2069 6e73 7461 6e63  .        instanc
-00026fa0: 6520 3d20 4669 7865 6449 6e63 7265 6d65  e = FixedIncreme
-00026fb0: 6e74 7328 636f 6c75 6d6e 5f6e 616d 653d  nts(column_name=
-00026fc0: 2763 6f6c 756d 6e27 2c20 696e 6372 656d  'column', increm
-00026fd0: 656e 745f 7661 6c75 653d 3529 0a0a 2020  ent_value=5)..  
-00026fe0: 2020 2020 2020 2320 4173 7365 7274 0a20        # Assert. 
-00026ff0: 2020 2020 2020 2061 7373 6572 7420 696e         assert in
-00027000: 7374 616e 6365 2e63 6f6c 756d 6e5f 6e61  stance.column_na
-00027010: 6d65 203d 3d20 2763 6f6c 756d 6e27 0a20  me == 'column'. 
-00027020: 2020 2020 2020 2061 7373 6572 7420 696e         assert in
-00027030: 7374 616e 6365 2e69 6e63 7265 6d65 6e74  stance.increment
-00027040: 5f76 616c 7565 203d 3d20 350a 2020 2020  _value == 5.    
-00027050: 2020 2020 6173 7365 7274 2069 6e73 7461      assert insta
-00027060: 6e63 652e 636f 6e73 7472 6169 6e74 5f63  nce.constraint_c
-00027070: 6f6c 756d 6e73 203d 3d20 2827 636f 6c75  olumns == ('colu
-00027080: 6d6e 272c 2029 0a0a 2020 2020 6465 6620  mn', )..    def 
-00027090: 7465 7374 5f5f 5f69 6e69 745f 5f5f 696e  test___init___in
-000270a0: 6372 656d 656e 745f 7661 6c75 655f 6973  crement_value_is
-000270b0: 5f6e 6567 6174 6976 655f 6e75 6d62 6572  _negative_number
-000270c0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-000270d0: 2222 2254 6573 7420 7468 6520 6060 4669  """Test the ``Fi
-000270e0: 7865 6449 6e63 7265 6d65 6e74 732e 5f5f  xedIncrements.__
-000270f0: 696e 6974 5f5f 206d 6574 686f 6420 7769  init__ method wi
-00027100: 7468 2061 206e 6567 6174 6976 6520 696e  th a negative in
-00027110: 6372 656d 656e 742e 0a0a 2020 2020 2020  crement...      
-00027120: 2020 4966 2074 6865 2060 6069 6e63 7265    If the ``incre
-00027130: 6d65 6e74 5f76 616c 7565 6060 2069 7320  ment_value`` is 
-00027140: 6c65 7373 2074 6861 6e20 6f72 2065 7175  less than or equ
-00027150: 616c 2074 6f20 302c 2074 6865 6e20 616e  al to 0, then an
-00027160: 2065 7272 6f72 2073 686f 756c 6420 6265   error should be
-00027170: 2072 6169 7365 642e 0a0a 2020 2020 2020   raised...      
-00027180: 2020 496e 7075 743a 0a20 2020 2020 2020    Input:.       
-00027190: 2020 2020 202d 2063 6f6c 756d 6e20 6e61       - column na
-000271a0: 6d65 2061 7320 6120 7374 7269 6e67 2e0a  me as a string..
-000271b0: 2020 2020 2020 2020 2020 2020 2d20 696e              - in
-000271c0: 6372 656d 656e 745f 7661 6c75 6520 6173  crement_value as
-000271d0: 202d 310a 0a20 2020 2020 2020 2045 7870   -1..        Exp
-000271e0: 6563 7465 6420 6265 6861 7669 6f72 3a0a  ected behavior:.
-000271f0: 2020 2020 2020 2020 2020 2020 2d20 6060              - ``
-00027200: 5661 6c75 6545 7272 6f72 6060 2073 686f  ValueError`` sho
-00027210: 756c 6420 6265 2072 6169 7365 642e 0a20  uld be raised.. 
-00027220: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00027230: 2020 2023 2052 756e 202f 2041 7373 6572     # Run / Asser
-00027240: 740a 2020 2020 2020 2020 6572 726f 725f  t.        error_
-00027250: 6d65 7373 6167 6520 3d20 2754 6865 2069  message = 'The i
-00027260: 6e63 7265 6d65 6e74 5f76 616c 7565 206d  ncrement_value m
-00027270: 7573 7420 6265 2067 7265 6174 6572 2074  ust be greater t
-00027280: 6861 6e20 302e 270a 2020 2020 2020 2020  han 0.'.        
-00027290: 7769 7468 2070 7974 6573 742e 7261 6973  with pytest.rais
-000272a0: 6573 2856 616c 7565 4572 726f 722c 206d  es(ValueError, m
-000272b0: 6174 6368 3d65 7272 6f72 5f6d 6573 7361  atch=error_messa
-000272c0: 6765 293a 0a20 2020 2020 2020 2020 2020  ge):.           
-000272d0: 2046 6978 6564 496e 6372 656d 656e 7473   FixedIncrements
-000272e0: 2863 6f6c 756d 6e5f 6e61 6d65 3d27 636f  (column_name='co
-000272f0: 6c75 6d6e 272c 2069 6e63 7265 6d65 6e74  lumn', increment
-00027300: 5f76 616c 7565 3d2d 3129 0a0a 2020 2020  _value=-1)..    
-00027310: 6465 6620 7465 7374 5f5f 5f69 6e69 745f  def test___init_
-00027320: 5f5f 696e 6372 656d 656e 745f 7661 6c75  __increment_valu
-00027330: 655f 6973 5f64 6563 696d 616c 2873 656c  e_is_decimal(sel
-00027340: 6629 3a0a 2020 2020 2020 2020 2222 2254  f):.        """T
-00027350: 6573 7420 7468 6520 6060 4669 7865 6449  est the ``FixedI
-00027360: 6e63 7265 6d65 6e74 732e 5f5f 696e 6974  ncrements.__init
-00027370: 5f5f 206d 6574 686f 6420 7769 7468 2061  __ method with a
-00027380: 2064 6563 696d 616c 2061 7320 616e 2069   decimal as an i
-00027390: 6e63 7265 6d65 6e74 2e0a 0a20 2020 2020  ncrement...     
-000273a0: 2020 2049 6620 7468 6520 6060 696e 6372     If the ``incr
-000273b0: 656d 656e 745f 7661 6c75 6560 6020 6973  ement_value`` is
-000273c0: 206e 6f74 2061 2077 686f 6c65 206e 756d   not a whole num
-000273d0: 6265 722c 2074 6865 6e20 616e 2065 7272  ber, then an err
-000273e0: 6f72 2073 686f 756c 6420 6265 2072 6169  or should be rai
-000273f0: 7365 642e 0a0a 2020 2020 2020 2020 496e  sed...        In
-00027400: 7075 743a 0a20 2020 2020 2020 2020 2020  put:.           
-00027410: 202d 2063 6f6c 756d 6e20 6e61 6d65 2061   - column name a
-00027420: 7320 6120 7374 7269 6e67 2e0a 2020 2020  s a string..    
-00027430: 2020 2020 2020 2020 2d20 696e 6372 656d          - increm
-00027440: 656e 745f 7661 6c75 6520 6173 2031 2e35  ent_value as 1.5
-00027450: 0a0a 2020 2020 2020 2020 4578 7065 6374  ..        Expect
-00027460: 6564 2062 6568 6176 696f 723a 0a20 2020  ed behavior:.   
-00027470: 2020 2020 2020 2020 202d 2060 6056 616c           - ``Val
-00027480: 7565 4572 726f 7260 6020 7368 6f75 6c64  ueError`` should
-00027490: 2062 6520 7261 6973 6564 2e0a 2020 2020   be raised..    
-000274a0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-000274b0: 2320 5275 6e20 2f20 4173 7365 7274 0a20  # Run / Assert. 
-000274c0: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
-000274d0: 7361 6765 203d 2027 5468 6520 696e 6372  sage = 'The incr
-000274e0: 656d 656e 745f 7661 6c75 6520 6d75 7374  ement_value must
-000274f0: 2062 6520 6120 7768 6f6c 6520 6e75 6d62   be a whole numb
-00027500: 6572 2e27 0a20 2020 2020 2020 2077 6974  er.'.        wit
-00027510: 6820 7079 7465 7374 2e72 6169 7365 7328  h pytest.raises(
-00027520: 5661 6c75 6545 7272 6f72 2c20 6d61 7463  ValueError, matc
-00027530: 683d 6572 726f 725f 6d65 7373 6167 6529  h=error_message)
-00027540: 3a0a 2020 2020 2020 2020 2020 2020 4669  :.            Fi
-00027550: 7865 6449 6e63 7265 6d65 6e74 7328 636f  xedIncrements(co
-00027560: 6c75 6d6e 5f6e 616d 653d 2763 6f6c 756d  lumn_name='colum
-00027570: 6e27 2c20 696e 6372 656d 656e 745f 7661  n', increment_va
-00027580: 6c75 653d 312e 3529 0a0a 2020 2020 6465  lue=1.5)..    de
-00027590: 6620 7465 7374 5f5f 6669 7428 7365 6c66  f test__fit(self
-000275a0: 293a 0a20 2020 2020 2020 2022 2222 5465  ):.        """Te
-000275b0: 7374 2074 6865 2060 6046 6978 6564 496e  st the ``FixedIn
-000275c0: 6372 656d 656e 7473 2e5f 6669 7460 6020  crements._fit`` 
-000275d0: 6d65 7468 6f64 2e0a 0a20 2020 2020 2020  method...       
-000275e0: 2054 6865 2060 6066 6974 6060 206d 6574   The ``fit`` met
-000275f0: 686f 6420 7368 6f75 6c64 2073 746f 7265  hod should store
-00027600: 2074 6865 2064 7479 7065 206f 6620 7468   the dtype of th
-00027610: 6520 4461 7461 4672 616d 652e 0a0a 2020  e DataFrame...  
-00027620: 2020 2020 2020 496e 7075 743a 0a20 2020        Input:.   
-00027630: 2020 2020 2020 2020 202d 2041 2060 6070           - A ``p
-00027640: 616e 6461 732e 4461 7461 4672 616d 6560  andas.DataFrame`
-00027650: 6020 7769 7468 2061 2066 6c6f 6174 2064  ` with a float d
-00027660: 7479 7065 2e0a 0a20 2020 2020 2020 2045  type...        E
-00027670: 7870 6563 7465 6420 6265 6861 7669 6f72  xpected behavior
-00027680: 3a0a 2020 2020 2020 2020 2020 2020 2d20  :.            - 
-00027690: 5468 6520 6060 696e 7374 616e 6365 2e5f  The ``instance._
-000276a0: 6474 7970 6560 6020 7368 6f75 6c64 2062  dtype`` should b
-000276b0: 6520 7365 7420 746f 2066 6c6f 6174 2e0a  e set to float..
-000276c0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-000276d0: 2020 2020 2320 5365 7475 700a 2020 2020      # Setup.    
-000276e0: 2020 2020 6461 7461 203d 2070 642e 4461      data = pd.Da
-000276f0: 7461 4672 616d 6528 7b27 636f 6c75 6d6e  taFrame({'column
-00027700: 273a 205b 372c 2031 342c 2032 315d 7d2c  ': [7, 14, 21]},
-00027710: 2064 7479 7065 3d66 6c6f 6174 290a 2020   dtype=float).  
-00027720: 2020 2020 2020 696e 7374 616e 6365 203d        instance =
-00027730: 2046 6978 6564 496e 6372 656d 656e 7473   FixedIncrements
-00027740: 2863 6f6c 756d 6e5f 6e61 6d65 3d27 636f  (column_name='co
-00027750: 6c75 6d6e 272c 2069 6e63 7265 6d65 6e74  lumn', increment
-00027760: 5f76 616c 7565 3d37 290a 0a20 2020 2020  _value=7)..     
-00027770: 2020 2023 2052 756e 0a20 2020 2020 2020     # Run.       
-00027780: 2069 6e73 7461 6e63 652e 5f66 6974 2864   instance._fit(d
-00027790: 6174 6129 0a0a 2020 2020 2020 2020 2320  ata)..        # 
-000277a0: 4173 7365 7274 0a20 2020 2020 2020 2061  Assert.        a
-000277b0: 7373 6572 7420 696e 7374 616e 6365 2e5f  ssert instance._
-000277c0: 6474 7970 6520 3d3d 2066 6c6f 6174 0a0a  dtype == float..
-000277d0: 2020 2020 6465 6620 7465 7374 5f69 735f      def test_is_
-000277e0: 7661 6c69 6428 7365 6c66 293a 0a20 2020  valid(self):.   
-000277f0: 2020 2020 2022 2222 5465 7374 2074 6865       """Test the
-00027800: 2060 6046 6978 6564 496e 6372 656d 656e   ``FixedIncremen
-00027810: 7473 2e69 735f 7661 6c69 6460 6020 6d65  ts.is_valid`` me
-00027820: 7468 6f64 2e0a 0a20 2020 2020 2020 2054  thod...        T
-00027830: 6865 2060 6069 735f 7661 6c69 6460 6020  he ``is_valid`` 
-00027840: 6d65 7468 6f64 2073 686f 756c 6420 7265  method should re
-00027850: 7475 726e 2060 6054 7275 6560 6020 666f  turn ``True`` fo
-00027860: 7220 726f 7773 2074 6861 7420 6172 6520  r rows that are 
-00027870: 4e61 4e20 6f72 2065 7665 6e6c 7920 6469  NaN or evenly di
-00027880: 7669 7369 626c 650a 2020 2020 2020 2020  visible.        
-00027890: 6279 2074 6865 2069 6e63 7265 6d65 6e74  by the increment
-000278a0: 2e0a 0a20 2020 2020 2020 2049 6e70 7574  ...        Input
-000278b0: 3a0a 2020 2020 2020 2020 2020 2020 2d20  :.            - 
-000278c0: 4120 6060 7061 6e64 6173 2e44 6174 6146  A ``pandas.DataF
-000278d0: 7261 6d65 6060 2077 6974 6820 6f6e 6520  rame`` with one 
-000278e0: 636f 6c75 6d6e 2063 6f6e 7461 696e 696e  column containin
-000278f0: 6720 736f 6d65 204e 614e 732c 2073 6f6d  g some NaNs, som
-00027900: 6520 6e75 6d62 6572 7320 7468 6174 2061  e numbers that a
-00027910: 7265 0a20 2020 2020 2020 2020 2020 2064  re.            d
-00027920: 6976 6973 6962 6c65 2062 7920 7468 6520  ivisible by the 
-00027930: 696e 6372 656d 656e 7420 616e 6420 736f  increment and so
-00027940: 6d65 206e 756d 6265 7273 2074 6861 7420  me numbers that 
-00027950: 6172 6520 6e6f 742e 0a0a 2020 2020 2020  are not...      
-00027960: 2020 4f75 7470 7574 3a0a 2020 2020 2020    Output:.      
-00027970: 2020 2020 2020 2d20 4120 6060 7061 6e64        - A ``pand
-00027980: 6173 2e53 6572 6965 7360 6020 7768 6572  as.Series`` wher
-00027990: 6520 616c 6c20 7468 6520 726f 7773 2074  e all the rows t
-000279a0: 6861 7420 6172 6520 4e61 4e20 6f72 2064  hat are NaN or d
-000279b0: 6976 6973 6962 6c65 2062 7920 7468 6520  ivisible by the 
-000279c0: 696e 6372 656d 656e 7420 6172 650a 2020  increment are.  
-000279d0: 2020 2020 2020 2020 2020 6060 5472 7565            ``True
-000279e0: 6060 2e0a 2020 2020 2020 2020 2222 220a  ``..        """.
-000279f0: 2020 2020 2020 2020 2320 5365 7475 700a          # Setup.
-00027a00: 2020 2020 2020 2020 6461 7461 203d 2070          data = p
-00027a10: 642e 4461 7461 4672 616d 6528 7b27 636f  d.DataFrame({'co
-00027a20: 6c75 6d6e 273a 205b 372c 2031 342c 206e  lumn': [7, 14, n
-00027a30: 702e 6e61 6e2c 2032 302c 2038 2c20 3335  p.nan, 20, 8, 35
-00027a40: 5d7d 2c20 6474 7970 653d 666c 6f61 7429  ]}, dtype=float)
-00027a50: 0a20 2020 2020 2020 2069 6e73 7461 6e63  .        instanc
-00027a60: 6520 3d20 4669 7865 6449 6e63 7265 6d65  e = FixedIncreme
-00027a70: 6e74 7328 636f 6c75 6d6e 5f6e 616d 653d  nts(column_name=
-00027a80: 2763 6f6c 756d 6e27 2c20 696e 6372 656d  'column', increm
-00027a90: 656e 745f 7661 6c75 653d 3729 0a0a 2020  ent_value=7)..  
-00027aa0: 2020 2020 2020 2320 5275 6e0a 2020 2020        # Run.    
-00027ab0: 2020 2020 6973 5f76 616c 6964 203d 2069      is_valid = i
-00027ac0: 6e73 7461 6e63 652e 6973 5f76 616c 6964  nstance.is_valid
-00027ad0: 2864 6174 6129 0a0a 2020 2020 2020 2020  (data)..        
-00027ae0: 2320 4173 7365 7274 0a20 2020 2020 2020  # Assert.       
-00027af0: 2065 7870 6563 7465 6420 3d20 7064 2e53   expected = pd.S
-00027b00: 6572 6965 7328 5b54 7275 652c 2054 7275  eries([True, Tru
-00027b10: 652c 2054 7275 652c 2046 616c 7365 2c20  e, True, False, 
-00027b20: 4661 6c73 652c 2054 7275 655d 2c20 6e61  False, True], na
-00027b30: 6d65 3d27 636f 6c75 6d6e 2729 0a20 2020  me='column').   
-00027b40: 2020 2020 2070 642e 7465 7374 696e 672e       pd.testing.
-00027b50: 6173 7365 7274 5f73 6572 6965 735f 6571  assert_series_eq
-00027b60: 7561 6c28 6973 5f76 616c 6964 2c20 6578  ual(is_valid, ex
-00027b70: 7065 6374 6564 290a 0a20 2020 2064 6566  pected)..    def
-00027b80: 2074 6573 745f 5f74 7261 6e73 666f 726d   test__transform
-00027b90: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00027ba0: 2222 2254 6573 7420 7468 6520 6060 4669  """Test the ``Fi
-00027bb0: 7865 6449 6e63 7265 6d65 6e74 732e 5f74  xedIncrements._t
-00027bc0: 7261 6e73 666f 726d 6060 206d 6574 686f  ransform`` metho
-00027bd0: 642e 0a0a 2020 2020 2020 2020 5468 6520  d...        The 
-00027be0: 6060 5f74 7261 6e73 666f 726d 6060 206d  ``_transform`` m
-00027bf0: 6574 686f 6420 7368 6f75 6c64 2064 6976  ethod should div
-00027c00: 6964 6520 616c 6c20 7661 6c75 6573 2069  ide all values i
-00027c10: 6e20 7468 6520 6461 7461 2062 7920 7468  n the data by th
-00027c20: 6520 6060 696e 6372 656d 656e 745f 7661  e ``increment_va
-00027c30: 6c75 6560 602e 0a0a 2020 2020 2020 2020  lue``...        
-00027c40: 496e 7075 743a 0a20 2020 2020 2020 2020  Input:.         
-00027c50: 2020 202d 2041 2060 6070 642e 4461 7461     - A ``pd.Data
-00027c60: 4672 616d 6560 6020 7769 7468 206f 6e65  Frame`` with one
-00027c70: 2063 6f6c 756d 6e20 636f 6e74 6169 6e69   column containi
-00027c80: 6e67 204e 614e 7320 616e 6420 7661 6c75  ng NaNs and valu
-00027c90: 6573 2064 6976 6973 6962 6c65 2062 7920  es divisible by 
-00027ca0: 7468 650a 2020 2020 2020 2020 2020 2020  the.            
-00027cb0: 6060 696e 6372 656d 656e 745f 7661 6c75  ``increment_valu
-00027cc0: 6560 602e 0a0a 2020 2020 2020 2020 4f75  e``...        Ou
-00027cd0: 7470 7574 3a0a 2020 2020 2020 2020 2020  tput:.          
-00027ce0: 2020 2d20 4120 6060 7064 2e44 6174 6146    - A ``pd.DataF
-00027cf0: 7261 6d65 6060 2077 6974 6820 616c 6c20  rame`` with all 
-00027d00: 7468 6520 7661 6c75 6573 2069 6e20 7468  the values in th
-00027d10: 6174 2063 6f6c 756d 6e20 6469 7669 6465  at column divide
-00027d20: 6420 6279 2074 6865 0a20 2020 2020 2020  d by the.       
-00027d30: 2020 2020 2060 6069 6e63 7265 6d65 6e74       ``increment
-00027d40: 5f76 616c 7565 6060 2061 6e64 2074 6865  _value`` and the
-00027d50: 204e 614e 7320 6c65 6674 2061 6c6f 6e65   NaNs left alone
-00027d60: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00027d70: 2020 2020 2020 2320 5365 7475 700a 2020        # Setup.  
-00027d80: 2020 2020 2020 6461 7461 203d 2070 642e        data = pd.
-00027d90: 4461 7461 4672 616d 6528 7b27 636f 6c75  DataFrame({'colu
-00027da0: 6d6e 273a 205b 372c 2031 342c 206e 702e  mn': [7, 14, np.
-00027db0: 6e61 6e2c 2033 355d 7d29 0a20 2020 2020  nan, 35]}).     
-00027dc0: 2020 2069 6e73 7461 6e63 6520 3d20 4669     instance = Fi
-00027dd0: 7865 6449 6e63 7265 6d65 6e74 7328 636f  xedIncrements(co
-00027de0: 6c75 6d6e 5f6e 616d 653d 2763 6f6c 756d  lumn_name='colum
-00027df0: 6e27 2c20 696e 6372 656d 656e 745f 7661  n', increment_va
-00027e00: 6c75 653d 3729 0a0a 2020 2020 2020 2020  lue=7)..        
-00027e10: 2320 5275 6e0a 2020 2020 2020 2020 7472  # Run.        tr
-00027e20: 616e 7366 6f72 6d65 6420 3d20 696e 7374  ansformed = inst
-00027e30: 616e 6365 2e5f 7472 616e 7366 6f72 6d28  ance._transform(
-00027e40: 6461 7461 290a 0a20 2020 2020 2020 2023  data)..        #
-00027e50: 2041 7373 6572 740a 2020 2020 2020 2020   Assert.        
-00027e60: 6578 7065 6374 6564 203d 2070 642e 4461  expected = pd.Da
-00027e70: 7461 4672 616d 6528 7b27 636f 6c75 6d6e  taFrame({'column
-00027e80: 273a 205b 312c 2032 2c20 6e70 2e6e 616e  ': [1, 2, np.nan
-00027e90: 2c20 355d 7d29 0a20 2020 2020 2020 2070  , 5]}).        p
-00027ea0: 642e 7465 7374 696e 672e 6173 7365 7274  d.testing.assert
-00027eb0: 5f66 7261 6d65 5f65 7175 616c 2874 7261  _frame_equal(tra
-00027ec0: 6e73 666f 726d 6564 2c20 6578 7065 6374  nsformed, expect
-00027ed0: 6564 290a 0a20 2020 2064 6566 2074 6573  ed)..    def tes
-00027ee0: 745f 7265 7665 7273 655f 7472 616e 7366  t_reverse_transf
-00027ef0: 6f72 6d28 7365 6c66 293a 0a20 2020 2020  orm(self):.     
-00027f00: 2020 2022 2222 5465 7374 2074 6865 2060     """Test the `
-00027f10: 6046 6978 6564 496e 6372 656d 656e 7473  `FixedIncrements
-00027f20: 2e72 6576 6572 7365 5f74 7261 6e73 666f  .reverse_transfo
-00027f30: 726d 6060 206d 6574 686f 642e 0a0a 2020  rm`` method...  
-00027f40: 2020 2020 2020 5468 6520 6060 7265 7665        The ``reve
-00027f50: 7273 655f 7472 616e 7366 6f72 6d60 6020  rse_transform`` 
-00027f60: 6d65 7468 6f64 2073 686f 756c 6420 726f  method should ro
-00027f70: 756e 6420 616c 6c20 7361 6d70 6c65 6420  und all sampled 
-00027f80: 7661 6c75 6573 2074 6f20 7468 6520 6e65  values to the ne
-00027f90: 6172 6573 7420 696e 742c 0a20 2020 2020  arest int,.     
-00027fa0: 2020 2061 6e64 2074 6865 6e20 6d75 6c74     and then mult
-00027fb0: 6970 6c79 2074 6865 6d20 6279 2074 6865  iply them by the
-00027fc0: 2060 6069 6e63 7265 6d65 6e74 5f76 616c   ``increment_val
-00027fd0: 7565 6060 2061 6e64 2063 6f6e 7665 7274  ue`` and convert
-00027fe0: 2074 6865 6d20 746f 2074 6865 2060 605f   them to the ``_
-00027ff0: 6474 7970 6560 602e 0a0a 2020 2020 2020  dtype``...      
-00028000: 2020 5365 7475 703a 0a20 2020 2020 2020    Setup:.       
-00028010: 2020 2020 202d 2053 6574 2074 6865 2060       - Set the `
-00028020: 605f 6474 7970 6560 6020 746f 2069 6e74  `_dtype`` to int
-00028030: 3634 2e0a 0a20 2020 2020 2020 2049 6e70  64...        Inp
-00028040: 7574 3a0a 2020 2020 2020 2020 2020 2020  ut:.            
-00028050: 2d20 4120 6060 7061 6e64 6173 2e44 6174  - A ``pandas.Dat
-00028060: 6146 7261 6d65 6060 2077 6974 6820 666c  aFrame`` with fl
-00028070: 6f61 7473 2e0a 0a20 2020 2020 2020 204f  oats...        O
-00028080: 7574 7075 743a 0a20 2020 2020 2020 2020  utput:.         
-00028090: 2020 202d 2041 2060 6070 616e 6461 732e     - A ``pandas.
-000280a0: 4461 7461 4672 616d 6560 6020 7769 7468  DataFrame`` with
-000280b0: 2074 6865 2076 616c 7565 7320 6d75 6c74   the values mult
-000280c0: 6970 6c69 6564 2062 7920 7468 6520 6060  iplied by the ``
-000280d0: 696e 6372 656d 656e 745f 7661 6c75 6560  increment_value`
-000280e0: 6020 616e 640a 2020 2020 2020 2020 2020  ` and.          
-000280f0: 2020 636f 6e76 6572 7465 6420 746f 2069    converted to i
-00028100: 6e74 732e 0a20 2020 2020 2020 2022 2222  nts..        """
-00028110: 0a20 2020 2020 2020 2023 2053 6574 7570  .        # Setup
-00028120: 0a20 2020 2020 2020 2064 6174 6120 3d20  .        data = 
-00028130: 7064 2e44 6174 6146 7261 6d65 287b 2763  pd.DataFrame({'c
-00028140: 6f6c 756d 6e27 3a20 5b31 2e33 2c20 332e  olumn': [1.3, 3.
-00028150: 352c 2034 2e32 2c20 322e 315d 7d29 0a20  5, 4.2, 2.1]}). 
-00028160: 2020 2020 2020 2069 6e73 7461 6e63 6520         instance 
-00028170: 3d20 4669 7865 6449 6e63 7265 6d65 6e74  = FixedIncrement
-00028180: 7328 636f 6c75 6d6e 5f6e 616d 653d 2763  s(column_name='c
-00028190: 6f6c 756d 6e27 2c20 696e 6372 656d 656e  olumn', incremen
-000281a0: 745f 7661 6c75 653d 3729 0a20 2020 2020  t_value=7).     
-000281b0: 2020 2069 6e73 7461 6e63 652e 5f64 7479     instance._dty
-000281c0: 7065 203d 206e 702e 696e 7436 340a 0a20  pe = np.int64.. 
-000281d0: 2020 2020 2020 2023 2052 756e 0a20 2020         # Run.   
-000281e0: 2020 2020 2072 6576 6572 7365 5f74 7261       reverse_tra
-000281f0: 6e73 666f 726d 6564 203d 2069 6e73 7461  nsformed = insta
-00028200: 6e63 652e 7265 7665 7273 655f 7472 616e  nce.reverse_tran
-00028210: 7366 6f72 6d28 6461 7461 290a 0a20 2020  sform(data)..   
-00028220: 2020 2020 2023 2041 7373 6572 740a 2020       # Assert.  
-00028230: 2020 2020 2020 6578 7065 6374 6564 203d        expected =
-00028240: 2070 642e 4461 7461 4672 616d 6528 7b27   pd.DataFrame({'
-00028250: 636f 6c75 6d6e 273a 205b 372c 2032 382c  column': [7, 28,
-00028260: 2032 382c 2031 345d 7d29 0a20 2020 2020   28, 14]}).     
-00028270: 2020 2070 642e 7465 7374 696e 672e 6173     pd.testing.as
-00028280: 7365 7274 5f66 7261 6d65 5f65 7175 616c  sert_frame_equal
-00028290: 2865 7870 6563 7465 642c 2072 6576 6572  (expected, rever
-000282a0: 7365 5f74 7261 6e73 666f 726d 6564 290a  se_transformed).
-000282b0: 0a20 2020 2064 6566 2074 6573 745f 7265  .    def test_re
-000282c0: 7665 7273 655f 7472 616e 7366 6f72 6d5f  verse_transform_
-000282d0: 6e61 6e73 2873 656c 6629 3a0a 2020 2020  nans(self):.    
-000282e0: 2020 2020 2222 2254 6573 7420 7468 6520      """Test the 
-000282f0: 6060 4669 7865 6449 6e63 7265 6d65 6e74  ``FixedIncrement
-00028300: 732e 7265 7665 7273 655f 7472 616e 7366  s.reverse_transf
-00028310: 6f72 6d60 6020 6d65 7468 6f64 2077 6974  orm`` method wit
-00028320: 6820 4e61 4e73 2e0a 0a20 2020 2020 2020  h NaNs...       
-00028330: 2054 6865 2060 6072 6576 6572 7365 5f74   The ``reverse_t
-00028340: 7261 6e73 666f 726d 6060 206d 6574 686f  ransform`` metho
-00028350: 6420 7368 6f75 6c64 2069 676e 6f72 6520  d should ignore 
-00028360: 7468 6520 4e61 4e20 7661 6c75 6573 2e0a  the NaN values..
-00028370: 0a20 2020 2020 2020 2053 6574 7570 3a0a  .        Setup:.
-00028380: 2020 2020 2020 2020 2020 2020 2d20 5365              - Se
-00028390: 7420 7468 6520 6060 5f64 7479 7065 6060  t the ``_dtype``
-000283a0: 2074 6f20 666c 6f61 7436 342e 0a0a 2020   to float64...  
-000283b0: 2020 2020 2020 496e 7075 743a 0a20 2020        Input:.   
-000283c0: 2020 2020 2020 2020 202d 2041 2060 6070           - A ``p
-000283d0: 616e 6461 732e 4461 7461 4672 616d 6560  andas.DataFrame`
-000283e0: 6020 7769 7468 2066 6c6f 6174 732e 0a0a  ` with floats...
-000283f0: 2020 2020 2020 2020 4f75 7470 7574 3a0a          Output:.
-00028400: 2020 2020 2020 2020 2020 2020 2d20 4120              - A 
-00028410: 6060 7061 6e64 6173 2e44 6174 6146 7261  ``pandas.DataFra
-00028420: 6d65 6060 2077 6974 6820 7468 6520 7661  me`` with the va
-00028430: 6c75 6573 206d 756c 7469 706c 6965 6420  lues multiplied 
-00028440: 6279 2074 6865 2060 6069 6e63 7265 6d65  by the ``increme
-00028450: 6e74 5f76 616c 7565 6060 2061 6e64 0a20  nt_value`` and. 
-00028460: 2020 2020 2020 2020 2020 2074 6865 204e             the N
-00028470: 614e 7320 6967 6e6f 7265 642e 0a20 2020  aNs ignored..   
-00028480: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00028490: 2023 2053 6574 7570 0a20 2020 2020 2020   # Setup.       
-000284a0: 2064 6174 6120 3d20 7064 2e44 6174 6146   data = pd.DataF
-000284b0: 7261 6d65 287b 2763 6f6c 756d 6e27 3a20  rame({'column': 
-000284c0: 5b31 2e33 2c20 332e 352c 206e 702e 6e61  [1.3, 3.5, np.na
-000284d0: 6e2c 2034 2e32 2c20 6e70 2e6e 616e 2c20  n, 4.2, np.nan, 
-000284e0: 322e 315d 7d29 0a20 2020 2020 2020 2069  2.1]}).        i
-000284f0: 6e73 7461 6e63 6520 3d20 4669 7865 6449  nstance = FixedI
-00028500: 6e63 7265 6d65 6e74 7328 636f 6c75 6d6e  ncrements(column
-00028510: 5f6e 616d 653d 2763 6f6c 756d 6e27 2c20  _name='column', 
-00028520: 696e 6372 656d 656e 745f 7661 6c75 653d  increment_value=
-00028530: 3729 0a20 2020 2020 2020 2069 6e73 7461  7).        insta
-00028540: 6e63 652e 5f64 7479 7065 203d 206e 702e  nce._dtype = np.
-00028550: 666c 6f61 7436 340a 0a20 2020 2020 2020  float64..       
-00028560: 2023 2052 756e 0a20 2020 2020 2020 2072   # Run.        r
-00028570: 6576 6572 7365 5f74 7261 6e73 666f 726d  everse_transform
-00028580: 6564 203d 2069 6e73 7461 6e63 652e 7265  ed = instance.re
-00028590: 7665 7273 655f 7472 616e 7366 6f72 6d28  verse_transform(
-000285a0: 6461 7461 290a 0a20 2020 2020 2020 2023  data)..        #
-000285b0: 2041 7373 6572 740a 2020 2020 2020 2020   Assert.        
-000285c0: 6578 7065 6374 6564 203d 2070 642e 4461  expected = pd.Da
-000285d0: 7461 4672 616d 6528 7b27 636f 6c75 6d6e  taFrame({'column
-000285e0: 273a 205b 372c 2032 382c 206e 702e 6e61  ': [7, 28, np.na
-000285f0: 6e2c 2032 382c 206e 702e 6e61 6e2c 2031  n, 28, np.nan, 1
-00028600: 345d 7d29 0a20 2020 2020 2020 2070 642e  4]}).        pd.
-00028610: 7465 7374 696e 672e 6173 7365 7274 5f66  testing.assert_f
-00028620: 7261 6d65 5f65 7175 616c 2865 7870 6563  rame_equal(expec
-00028630: 7465 642c 2072 6576 6572 7365 5f74 7261  ted, reverse_tra
-00028640: 6e73 666f 726d 6564 290a                 nsformed).
+0000c2b0: 2020 2020 6465 6620 7465 7374 5f5f 7472      def test__tr
+0000c2c0: 616e 7366 6f72 6d28 7365 6c66 293a 0a20  ansform(self):. 
+0000c2d0: 2020 2020 2020 2022 2222 5465 7374 2074         """Test t
+0000c2e0: 6865 2060 6049 6e65 7175 616c 6974 792e  he ``Inequality.
+0000c2f0: 5f74 7261 6e73 666f 726d 6060 206d 6574  _transform`` met
+0000c300: 686f 642e 0a0a 2020 2020 2020 2020 5468  hod...        Th
+0000c310: 6520 6d65 7468 6f64 2069 7320 6578 7065  e method is expe
+0000c320: 6374 6564 2074 6f20 636f 6d70 7574 6520  cted to compute 
+0000c330: 7468 6520 6469 7374 616e 6365 2062 6574  the distance bet
+0000c340: 7765 656e 2074 6865 2068 6967 6820 616e  ween the high an
+0000c350: 6420 6c6f 7720 636f 6c75 6d6e 730a 2020  d low columns.  
+0000c360: 2020 2020 2020 616e 6420 6372 6561 7465        and create
+0000c370: 2061 2064 6966 6620 636f 6c75 6d6e 2077   a diff column w
+0000c380: 6974 6820 7468 6520 6c6f 6761 7269 7468  ith the logarith
+0000c390: 6d20 6f66 2074 6865 2064 6973 7461 6e63  m of the distanc
+0000c3a0: 6520 2b20 312e 0a0a 2020 2020 2020 2020  e + 1...        
+0000c3b0: 5365 7475 703a 0a20 2020 2020 2020 202d  Setup:.        -
+0000c3c0: 2060 605f 6469 6666 5f63 6f6c 756d 6e5f   ``_diff_column_
+0000c3d0: 6e61 6d65 6060 2069 7320 7365 7420 746f  name`` is set to
+0000c3e0: 2060 6027 6123 6227 6060 2e0a 2020 2020   ``'a#b'``..    
+0000c3f0: 2020 2020 496e 7075 743a 0a20 2020 2020      Input:.     
+0000c400: 2020 202d 2054 6162 6c65 2077 6974 6820     - Table with 
+0000c410: 7477 6f20 636f 6c75 6d6e 7320 6174 2061  two columns at a
+0000c420: 2063 6f6e 7374 616e 7420 6469 7374 616e   constant distan
+0000c430: 6365 206f 6620 3320 616e 6420 6f6e 6520  ce of 3 and one 
+0000c440: 6164 6469 7469 6f6e 616c 2064 756d 6d79  additional dummy
+0000c450: 2063 6f6c 756d 6e2e 0a20 2020 2020 2020   column..       
+0000c460: 204f 7574 7075 743a 0a20 2020 2020 2020   Output:.       
+0000c470: 202d 2053 616d 6520 7461 626c 6520 7769   - Same table wi
+0000c480: 7468 2061 2064 6966 6620 636f 6c75 6d6e  th a diff column
+0000c490: 206f 6620 7468 6520 6c6f 6720 6f66 2064   of the log of d
+0000c4a0: 6973 7461 6e63 6573 202b 2031 2c20 7768  istances + 1, wh
+0000c4b0: 6963 6820 6973 206e 702e 6c6f 6728 3429  ich is np.log(4)
+0000c4c0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+0000c4d0: 2020 2020 2020 2320 5365 7475 700a 2020        # Setup.  
+0000c4e0: 2020 2020 2020 696e 7374 616e 6365 203d        instance =
+0000c4f0: 2049 6e65 7175 616c 6974 7928 6c6f 775f   Inequality(low_
+0000c500: 636f 6c75 6d6e 5f6e 616d 653d 2761 272c  column_name='a',
+0000c510: 2068 6967 685f 636f 6c75 6d6e 5f6e 616d   high_column_nam
+0000c520: 653d 2762 2729 0a20 2020 2020 2020 2069  e='b').        i
+0000c530: 6e73 7461 6e63 652e 5f64 6966 665f 636f  nstance._diff_co
+0000c540: 6c75 6d6e 5f6e 616d 6520 3d20 2761 2362  lumn_name = 'a#b
+0000c550: 270a 0a20 2020 2020 2020 2023 2052 756e  '..        # Run
+0000c560: 0a20 2020 2020 2020 2074 6162 6c65 5f64  .        table_d
+0000c570: 6174 6120 3d20 7064 2e44 6174 6146 7261  ata = pd.DataFra
+0000c580: 6d65 287b 0a20 2020 2020 2020 2020 2020  me({.           
+0000c590: 2027 6127 3a20 5b31 2c20 322c 2033 5d2c   'a': [1, 2, 3],
+0000c5a0: 0a20 2020 2020 2020 2020 2020 2027 6227  .            'b'
+0000c5b0: 3a20 5b34 2c20 352c 2036 5d2c 0a20 2020  : [4, 5, 6],.   
+0000c5c0: 2020 2020 2020 2020 2027 6327 3a20 5b37           'c': [7
+0000c5d0: 2c20 382c 2039 5d2c 0a20 2020 2020 2020  , 8, 9],.       
+0000c5e0: 207d 290a 2020 2020 2020 2020 6f75 7420   }).        out 
+0000c5f0: 3d20 696e 7374 616e 6365 2e5f 7472 616e  = instance._tran
+0000c600: 7366 6f72 6d28 7461 626c 655f 6461 7461  sform(table_data
+0000c610: 290a 0a20 2020 2020 2020 2023 2041 7373  )..        # Ass
+0000c620: 6572 740a 2020 2020 2020 2020 6578 7065  ert.        expe
+0000c630: 6374 6564 5f6f 7574 203d 2070 642e 4461  cted_out = pd.Da
+0000c640: 7461 4672 616d 6528 7b0a 2020 2020 2020  taFrame({.      
+0000c650: 2020 2020 2020 2761 273a 205b 312c 2032        'a': [1, 2
+0000c660: 2c20 335d 2c0a 2020 2020 2020 2020 2020  , 3],.          
+0000c670: 2020 2763 273a 205b 372c 2038 2c20 395d    'c': [7, 8, 9]
+0000c680: 2c0a 2020 2020 2020 2020 2020 2020 2761  ,.            'a
+0000c690: 2362 273a 205b 6e70 2e6c 6f67 2834 295d  #b': [np.log(4)]
+0000c6a0: 202a 2033 2c0a 2020 2020 2020 2020 7d29   * 3,.        })
+0000c6b0: 0a20 2020 2020 2020 2070 642e 7465 7374  .        pd.test
+0000c6c0: 696e 672e 6173 7365 7274 5f66 7261 6d65  ing.assert_frame
+0000c6d0: 5f65 7175 616c 286f 7574 2c20 6578 7065  _equal(out, expe
+0000c6e0: 6374 6564 5f6f 7574 290a 0a20 2020 2064  cted_out)..    d
+0000c6f0: 6566 2074 6573 745f 5f74 7261 6e73 666f  ef test__transfo
+0000c700: 726d 5f77 6974 685f 6e61 6e73 2873 656c  rm_with_nans(sel
+0000c710: 6629 3a0a 0a20 2020 2020 2020 2023 2053  f):..        # S
+0000c720: 6574 7570 0a20 2020 2020 2020 2069 6e73  etup.        ins
+0000c730: 7461 6e63 6520 3d20 496e 6571 7561 6c69  tance = Inequali
+0000c740: 7479 286c 6f77 5f63 6f6c 756d 6e5f 6e61  ty(low_column_na
+0000c750: 6d65 3d27 6127 2c20 6869 6768 5f63 6f6c  me='a', high_col
+0000c760: 756d 6e5f 6e61 6d65 3d27 6227 290a 2020  umn_name='b').  
+0000c770: 2020 2020 2020 696e 7374 616e 6365 2e5f        instance._
+0000c780: 6469 6666 5f63 6f6c 756d 6e5f 6e61 6d65  diff_column_name
+0000c790: 203d 2027 6123 6227 0a0a 2020 2020 2020   = 'a#b'..      
+0000c7a0: 2020 7461 626c 655f 6461 7461 5f77 6974    table_data_wit
+0000c7b0: 685f 6e61 6e73 203d 2070 642e 4461 7461  h_nans = pd.Data
+0000c7c0: 4672 616d 6528 7b0a 2020 2020 2020 2020  Frame({.        
+0000c7d0: 2020 2020 2761 273a 205b 312c 206e 702e      'a': [1, np.
+0000c7e0: 6e61 6e2c 2033 2c20 6e70 2e6e 616e 5d2c  nan, 3, np.nan],
+0000c7f0: 2027 6227 3a20 5b6e 702e 6e61 6e2c 2032   'b': [np.nan, 2
+0000c800: 2c20 342c 206e 702e 6e61 6e5d 0a20 2020  , 4, np.nan].   
+0000c810: 2020 2020 207d 290a 0a20 2020 2020 2020       })..       
+0000c820: 2074 6162 6c65 5f64 6174 615f 7769 7468   table_data_with
+0000c830: 6f75 745f 6e61 6e73 203d 2070 642e 4461  out_nans = pd.Da
+0000c840: 7461 4672 616d 6528 7b0a 2020 2020 2020  taFrame({.      
+0000c850: 2020 2020 2020 2761 273a 205b 312c 2032        'a': [1, 2
+0000c860: 2c20 335d 2c20 2762 273a 205b 322c 2033  , 3], 'b': [2, 3
+0000c870: 2c20 345d 0a20 2020 2020 2020 207d 290a  , 4].        }).
+0000c880: 0a20 2020 2020 2020 2023 2052 756e 0a20  .        # Run. 
+0000c890: 2020 2020 2020 206f 7574 7075 745f 7769         output_wi
+0000c8a0: 7468 5f6e 616e 7320 3d20 696e 7374 616e  th_nans = instan
+0000c8b0: 6365 2e5f 7472 616e 7366 6f72 6d28 7461  ce._transform(ta
+0000c8c0: 626c 655f 6461 7461 5f77 6974 685f 6e61  ble_data_with_na
+0000c8d0: 6e73 290a 2020 2020 2020 2020 6f75 7470  ns).        outp
+0000c8e0: 7574 5f77 6974 686f 7574 5f6e 616e 7320  ut_without_nans 
+0000c8f0: 3d20 696e 7374 616e 6365 2e5f 7472 616e  = instance._tran
+0000c900: 7366 6f72 6d28 7461 626c 655f 6461 7461  sform(table_data
+0000c910: 5f77 6974 686f 7574 5f6e 616e 7329 0a0a  _without_nans)..
+0000c920: 2020 2020 2020 2020 2320 4173 7365 7274          # Assert
+0000c930: 0a20 2020 2020 2020 2065 7870 6563 7465  .        expecte
+0000c940: 645f 6f75 7470 7574 5f77 6974 685f 6e61  d_output_with_na
+0000c950: 6e73 203d 2070 642e 4461 7461 4672 616d  ns = pd.DataFram
+0000c960: 6528 7b0a 2020 2020 2020 2020 2020 2020  e({.            
+0000c970: 2761 273a 205b 312e 2c20 322e 2c20 332e  'a': [1., 2., 3.
+0000c980: 2c20 322e 5d2c 0a20 2020 2020 2020 2020  , 2.],.         
+0000c990: 2020 2027 6123 6227 3a20 5b6e 702e 6c6f     'a#b': [np.lo
+0000c9a0: 6728 3229 5d20 2a20 342c 0a20 2020 2020  g(2)] * 4,.     
+0000c9b0: 2020 2020 2020 2027 6123 622e 6e61 6e5f         'a#b.nan_
+0000c9c0: 636f 6d70 6f6e 656e 7427 3a20 5b27 6227  component': ['b'
+0000c9d0: 2c20 2761 272c 2027 4e6f 6e65 272c 2027  , 'a', 'None', '
+0000c9e0: 612c 2062 275d 0a20 2020 2020 2020 207d  a, b'].        }
+0000c9f0: 290a 0a20 2020 2020 2020 2065 7870 6563  )..        expec
+0000ca00: 7465 645f 6f75 7470 7574 5f77 6974 686f  ted_output_witho
+0000ca10: 7574 5f6e 616e 7320 3d20 7064 2e44 6174  ut_nans = pd.Dat
+0000ca20: 6146 7261 6d65 287b 0a20 2020 2020 2020  aFrame({.       
+0000ca30: 2020 2020 2027 6127 3a20 5b31 2c20 322c       'a': [1, 2,
+0000ca40: 2033 5d2c 0a20 2020 2020 2020 2020 2020   3],.           
+0000ca50: 2027 6123 6227 3a20 5b6e 702e 6c6f 6728   'a#b': [np.log(
+0000ca60: 3229 5d20 2a20 332c 0a20 2020 2020 2020  2)] * 3,.       
+0000ca70: 207d 290a 0a20 2020 2020 2020 2070 642e   })..        pd.
+0000ca80: 7465 7374 696e 672e 6173 7365 7274 5f66  testing.assert_f
+0000ca90: 7261 6d65 5f65 7175 616c 286f 7574 7075  rame_equal(outpu
+0000caa0: 745f 7769 7468 5f6e 616e 732c 2065 7870  t_with_nans, exp
+0000cab0: 6563 7465 645f 6f75 7470 7574 5f77 6974  ected_output_wit
+0000cac0: 685f 6e61 6e73 290a 2020 2020 2020 2020  h_nans).        
+0000cad0: 7064 2e74 6573 7469 6e67 2e61 7373 6572  pd.testing.asser
+0000cae0: 745f 6672 616d 655f 6571 7561 6c28 6f75  t_frame_equal(ou
+0000caf0: 7470 7574 5f77 6974 686f 7574 5f6e 616e  tput_without_nan
+0000cb00: 732c 2065 7870 6563 7465 645f 6f75 7470  s, expected_outp
+0000cb10: 7574 5f77 6974 686f 7574 5f6e 616e 7329  ut_without_nans)
+0000cb20: 0a0a 2020 2020 6465 6620 7465 7374 5f74  ..    def test_t
+0000cb30: 7261 6e73 666f 726d 5f65 7869 7374 696e  ransform_existin
+0000cb40: 675f 636f 6c75 6d6e 5f6e 616d 6528 7365  g_column_name(se
+0000cb50: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+0000cb60: 5465 7374 2060 605f 7472 616e 7366 6f72  Test ``_transfor
+0000cb70: 6d60 6020 6d65 7468 6f64 2077 6865 6e20  m`` method when 
+0000cb80: 7468 6520 6060 6469 6666 5f63 6f6c 756d  the ``diff_colum
+0000cb90: 6e5f 6e61 6d65 6060 2061 6c72 6561 6479  n_name`` already
+0000cba0: 2065 7869 7374 7320 696e 2074 6865 2074   exists in the t
+0000cbb0: 6162 6c65 2e22 2222 0a20 2020 2020 2020  able.""".       
+0000cbc0: 2023 2053 6574 7570 0a20 2020 2020 2020   # Setup.       
+0000cbd0: 2069 6e73 7461 6e63 6520 3d20 496e 6571   instance = Ineq
+0000cbe0: 7561 6c69 7479 286c 6f77 5f63 6f6c 756d  uality(low_colum
+0000cbf0: 6e5f 6e61 6d65 3d27 6127 2c20 6869 6768  n_name='a', high
+0000cc00: 5f63 6f6c 756d 6e5f 6e61 6d65 3d27 6227  _column_name='b'
+0000cc10: 290a 2020 2020 2020 2020 7461 626c 655f  ).        table_
+0000cc20: 6461 7461 203d 2070 642e 4461 7461 4672  data = pd.DataFr
+0000cc30: 616d 6528 7b0a 2020 2020 2020 2020 2020  ame({.          
+0000cc40: 2020 2761 273a 205b 312c 2032 2c20 335d    'a': [1, 2, 3]
+0000cc50: 2c0a 2020 2020 2020 2020 2020 2020 2762  ,.            'b
+0000cc60: 273a 205b 342c 2035 2c20 365d 2c0a 2020  ': [4, 5, 6],.  
+0000cc70: 2020 2020 2020 2020 2020 2761 2362 273a            'a#b':
+0000cc80: 205b 2763 272c 2027 6427 2c20 2765 275d   ['c', 'd', 'e']
+0000cc90: 2c0a 2020 2020 2020 2020 7d29 0a0a 2020  ,.        })..  
+0000cca0: 2020 2020 2020 2320 5275 6e0a 2020 2020        # Run.    
+0000ccb0: 2020 2020 6f75 7470 7574 203d 2069 6e73      output = ins
+0000ccc0: 7461 6e63 652e 5f74 7261 6e73 666f 726d  tance._transform
+0000ccd0: 2874 6162 6c65 5f64 6174 6129 0a0a 2020  (table_data)..  
+0000cce0: 2020 2020 2020 2320 4173 7365 7274 0a20        # Assert. 
+0000ccf0: 2020 2020 2020 2065 7870 6563 7465 645f         expected_
+0000cd00: 636f 6c75 6d6e 5f6e 616d 6520 3d20 5b27  column_name = ['
+0000cd10: 6127 2c20 2761 2362 272c 2027 6123 625f  a', 'a#b', 'a#b_
+0000cd20: 275d 0a20 2020 2020 2020 2061 7373 6572  '].        asser
+0000cd30: 7420 6c69 7374 286f 7574 7075 742e 636f  t list(output.co
+0000cd40: 6c75 6d6e 7329 203d 3d20 6578 7065 6374  lumns) == expect
+0000cd50: 6564 5f63 6f6c 756d 6e5f 6e61 6d65 0a0a  ed_column_name..
+0000cd60: 2020 2020 6465 6620 7465 7374 5f5f 7472      def test__tr
+0000cd70: 616e 7366 6f72 6d5f 6461 7465 7469 6d65  ansform_datetime
+0000cd80: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+0000cd90: 2222 2254 6573 7420 7468 6520 6060 496e  """Test the ``In
+0000cda0: 6571 7561 6c69 7479 2e5f 7472 616e 7366  equality._transf
+0000cdb0: 6f72 6d60 6020 6d65 7468 6f64 2e0a 0a20  orm`` method... 
+0000cdc0: 2020 2020 2020 2054 6865 206d 6574 686f         The metho
+0000cdd0: 6420 6973 2065 7870 6563 7465 6420 746f  d is expected to
+0000cde0: 2063 6f6d 7075 7465 2074 6865 2064 6973   compute the dis
+0000cdf0: 7461 6e63 6520 6265 7477 6565 6e20 7468  tance between th
+0000ce00: 6520 6869 6768 2061 6e64 206c 6f77 2063  e high and low c
+0000ce10: 6f6c 756d 6e73 0a20 2020 2020 2020 2061  olumns.        a
+0000ce20: 6e64 2063 7265 6174 6520 6120 6469 6666  nd create a diff
+0000ce30: 2063 6f6c 756d 6e20 7769 7468 2074 6865   column with the
+0000ce40: 206c 6f67 6172 6974 686d 206f 6620 7468   logarithm of th
+0000ce50: 6520 6469 7374 616e 6365 202b 2031 2e0a  e distance + 1..
+0000ce60: 0a20 2020 2020 2020 2053 6574 7570 3a0a  .        Setup:.
+0000ce70: 2020 2020 2020 2020 2d20 6060 5f64 6966          - ``_dif
+0000ce80: 665f 636f 6c75 6d6e 5f6e 616d 6560 6020  f_column_name`` 
+0000ce90: 6973 2073 6574 2074 6f20 6060 2761 2362  is set to ``'a#b
+0000cea0: 2760 602e 0a20 2020 2020 2020 2049 6e70  '``..        Inp
+0000ceb0: 7574 3a0a 2020 2020 2020 2020 2d20 5461  ut:.        - Ta
+0000cec0: 626c 6520 7769 7468 2074 776f 2064 6174  ble with two dat
+0000ced0: 6574 696d 6520 636f 6c75 6d6e 7320 6174  etime columns at
+0000cee0: 2061 2064 6973 7461 6e63 6520 6f66 2033   a distance of 3
+0000cef0: 2061 6e64 206f 6e65 2061 6464 6974 696f   and one additio
+0000cf00: 6e61 6c20 6475 6d6d 7920 636f 6c75 6d6e  nal dummy column
+0000cf10: 2e0a 2020 2020 2020 2020 4f75 7470 7574  ..        Output
+0000cf20: 3a0a 2020 2020 2020 2020 2d20 5361 6d65  :.        - Same
+0000cf30: 2074 6162 6c65 2077 6974 6820 6120 6469   table with a di
+0000cf40: 6666 2063 6f6c 756d 6e20 6f66 2074 6865  ff column of the
+0000cf50: 206c 6f67 206f 6620 6469 7374 616e 6365   log of distance
+0000cf60: 7320 2b20 312c 2077 6869 6368 2069 7320  s + 1, which is 
+0000cf70: 6e70 2e6c 6f67 2834 292e 0a20 2020 2020  np.log(4)..     
+0000cf80: 2020 2022 2222 0a20 2020 2020 2020 2023     """.        #
+0000cf90: 2053 6574 7570 0a20 2020 2020 2020 2069   Setup.        i
+0000cfa0: 6e73 7461 6e63 6520 3d20 496e 6571 7561  nstance = Inequa
+0000cfb0: 6c69 7479 286c 6f77 5f63 6f6c 756d 6e5f  lity(low_column_
+0000cfc0: 6e61 6d65 3d27 6127 2c20 6869 6768 5f63  name='a', high_c
+0000cfd0: 6f6c 756d 6e5f 6e61 6d65 3d27 6227 290a  olumn_name='b').
+0000cfe0: 2020 2020 2020 2020 696e 7374 616e 6365          instance
+0000cff0: 2e5f 6469 6666 5f63 6f6c 756d 6e5f 6e61  ._diff_column_na
+0000d000: 6d65 203d 2027 6123 6227 0a20 2020 2020  me = 'a#b'.     
+0000d010: 2020 2069 6e73 7461 6e63 652e 5f69 735f     instance._is_
+0000d020: 6461 7465 7469 6d65 203d 2054 7275 650a  datetime = True.
+0000d030: 0a20 2020 2020 2020 2023 2052 756e 0a20  .        # Run. 
+0000d040: 2020 2020 2020 2074 6162 6c65 5f64 6174         table_dat
+0000d050: 6120 3d20 7064 2e44 6174 6146 7261 6d65  a = pd.DataFrame
+0000d060: 287b 0a20 2020 2020 2020 2020 2020 2027  ({.            '
+0000d070: 6127 3a20 7064 2e74 6f5f 6461 7465 7469  a': pd.to_dateti
+0000d080: 6d65 285b 2732 3032 302d 3031 2d30 3154  me(['2020-01-01T
+0000d090: 3030 3a30 303a 3030 272c 2027 3230 3230  00:00:00', '2020
+0000d0a0: 2d30 312d 3032 5430 303a 3030 3a30 3027  -01-02T00:00:00'
+0000d0b0: 5d29 2c0a 2020 2020 2020 2020 2020 2020  ]),.            
+0000d0c0: 2762 273a 2070 642e 746f 5f64 6174 6574  'b': pd.to_datet
+0000d0d0: 696d 6528 5b27 3230 3230 2d30 312d 3031  ime(['2020-01-01
+0000d0e0: 5430 303a 3030 3a30 3127 2c20 2732 3032  T00:00:01', '202
+0000d0f0: 302d 3031 2d30 3254 3030 3a30 303a 3031  0-01-02T00:00:01
+0000d100: 275d 292c 0a20 2020 2020 2020 2020 2020  ']),.           
+0000d110: 2027 6327 3a20 5b31 2c20 325d 2c0a 2020   'c': [1, 2],.  
+0000d120: 2020 2020 2020 7d29 0a20 2020 2020 2020        }).       
+0000d130: 206f 7574 203d 2069 6e73 7461 6e63 652e   out = instance.
+0000d140: 5f74 7261 6e73 666f 726d 2874 6162 6c65  _transform(table
+0000d150: 5f64 6174 6129 0a0a 2020 2020 2020 2020  _data)..        
+0000d160: 2320 4173 7365 7274 0a20 2020 2020 2020  # Assert.       
+0000d170: 2065 7870 6563 7465 645f 6f75 7420 3d20   expected_out = 
+0000d180: 7064 2e44 6174 6146 7261 6d65 287b 0a20  pd.DataFrame({. 
+0000d190: 2020 2020 2020 2020 2020 2027 6127 3a20             'a': 
+0000d1a0: 7064 2e74 6f5f 6461 7465 7469 6d65 285b  pd.to_datetime([
+0000d1b0: 2732 3032 302d 3031 2d30 3154 3030 3a30  '2020-01-01T00:0
+0000d1c0: 303a 3030 272c 2027 3230 3230 2d30 312d  0:00', '2020-01-
+0000d1d0: 3032 5430 303a 3030 3a30 3027 5d29 2c0a  02T00:00:00']),.
+0000d1e0: 2020 2020 2020 2020 2020 2020 2763 273a              'c':
+0000d1f0: 205b 312c 2032 5d2c 0a20 2020 2020 2020   [1, 2],.       
+0000d200: 2020 2020 2027 6123 6227 3a20 5b6e 702e       'a#b': [np.
+0000d210: 6c6f 6728 315f 3030 305f 3030 305f 3030  log(1_000_000_00
+0000d220: 3129 2c20 6e70 2e6c 6f67 2831 5f30 3030  1), np.log(1_000
+0000d230: 5f30 3030 5f30 3031 295d 2c0a 2020 2020  _000_001)],.    
+0000d240: 2020 2020 7d29 0a20 2020 2020 2020 2070      }).        p
+0000d250: 642e 7465 7374 696e 672e 6173 7365 7274  d.testing.assert
+0000d260: 5f66 7261 6d65 5f65 7175 616c 286f 7574  _frame_equal(out
+0000d270: 2c20 6578 7065 6374 6564 5f6f 7574 290a  , expected_out).
+0000d280: 0a20 2020 2064 6566 2074 6573 745f 5f74  .    def test__t
+0000d290: 7261 6e73 666f 726d 5f64 6174 6574 696d  ransform_datetim
+0000d2a0: 655f 6474 7970 655f 6f62 6a65 6374 2873  e_dtype_object(s
+0000d2b0: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
+0000d2c0: 2254 6573 7420 7468 6520 6060 496e 6571  "Test the ``Ineq
+0000d2d0: 7561 6c69 7479 2e5f 7472 616e 7366 6f72  uality._transfor
+0000d2e0: 6d60 6020 6d65 7468 6f64 2e0a 0a20 2020  m`` method...   
+0000d2f0: 2020 2020 2054 6865 206d 6574 686f 6420       The method 
+0000d300: 6973 2065 7870 6563 7465 6420 746f 2063  is expected to c
+0000d310: 6f6d 7075 7465 2074 6865 2064 6973 7461  ompute the dista
+0000d320: 6e63 6520 6265 7477 6565 6e20 7468 6520  nce between the 
+0000d330: 6869 6768 2061 6e64 206c 6f77 2063 6f6c  high and low col
+0000d340: 756d 6e73 0a20 2020 2020 2020 2061 6e64  umns.        and
+0000d350: 2063 7265 6174 6520 6120 6469 6666 2063   create a diff c
+0000d360: 6f6c 756d 6e20 7769 7468 2074 6865 206c  olumn with the l
+0000d370: 6f67 6172 6974 686d 206f 6620 7468 6520  ogarithm of the 
+0000d380: 6469 7374 616e 6365 202b 2031 2065 7665  distance + 1 eve
+0000d390: 6e20 7768 656e 2074 686f 7365 0a20 2020  n when those.   
+0000d3a0: 2020 2020 2061 7265 2066 726f 6d20 6060       are from ``
+0000d3b0: 5f64 7479 7065 6060 206f 626a 6563 7420  _dtype`` object 
+0000d3c0: 6275 7420 6172 6520 7265 7072 6573 656e  but are represen
+0000d3d0: 7469 6e67 2061 2064 6174 6574 696d 652e  ting a datetime.
+0000d3e0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0000d3f0: 2020 2020 2023 2053 6574 7570 0a20 2020       # Setup.   
+0000d400: 2020 2020 2069 6e73 7461 6e63 6520 3d20       instance = 
+0000d410: 496e 6571 7561 6c69 7479 286c 6f77 5f63  Inequality(low_c
+0000d420: 6f6c 756d 6e5f 6e61 6d65 3d27 6127 2c20  olumn_name='a', 
+0000d430: 6869 6768 5f63 6f6c 756d 6e5f 6e61 6d65  high_column_name
+0000d440: 3d27 6227 290a 2020 2020 2020 2020 696e  ='b').        in
+0000d450: 7374 616e 6365 2e5f 6469 6666 5f63 6f6c  stance._diff_col
+0000d460: 756d 6e5f 6e61 6d65 203d 2027 6123 6227  umn_name = 'a#b'
+0000d470: 0a20 2020 2020 2020 2069 6e73 7461 6e63  .        instanc
+0000d480: 652e 5f69 735f 6461 7465 7469 6d65 203d  e._is_datetime =
+0000d490: 2054 7275 650a 2020 2020 2020 2020 696e   True.        in
+0000d4a0: 7374 616e 6365 2e5f 6474 7970 6520 3d20  stance._dtype = 
+0000d4b0: 274f 270a 0a20 2020 2020 2020 2023 2052  'O'..        # R
+0000d4c0: 756e 0a20 2020 2020 2020 2074 6162 6c65  un.        table
+0000d4d0: 5f64 6174 6120 3d20 7064 2e44 6174 6146  _data = pd.DataF
+0000d4e0: 7261 6d65 287b 0a20 2020 2020 2020 2020  rame({.         
+0000d4f0: 2020 2027 6127 3a20 5b27 3230 3230 2d30     'a': ['2020-0
+0000d500: 312d 3031 5430 303a 3030 3a30 3027 2c20  1-01T00:00:00', 
+0000d510: 2732 3032 302d 3031 2d30 3254 3030 3a30  '2020-01-02T00:0
+0000d520: 303a 3030 275d 2c0a 2020 2020 2020 2020  0:00'],.        
+0000d530: 2020 2020 2762 273a 205b 2732 3032 302d      'b': ['2020-
+0000d540: 3031 2d30 3154 3030 3a30 303a 3031 272c  01-01T00:00:01',
+0000d550: 2027 3230 3230 2d30 312d 3032 5430 303a   '2020-01-02T00:
+0000d560: 3030 3a30 3127 5d2c 0a20 2020 2020 2020  00:01'],.       
+0000d570: 2020 2020 2027 6327 3a20 5b31 2c20 325d       'c': [1, 2]
+0000d580: 2c0a 2020 2020 2020 2020 7d29 0a20 2020  ,.        }).   
+0000d590: 2020 2020 206f 7574 203d 2069 6e73 7461       out = insta
+0000d5a0: 6e63 652e 5f74 7261 6e73 666f 726d 2874  nce._transform(t
+0000d5b0: 6162 6c65 5f64 6174 6129 0a0a 2020 2020  able_data)..    
+0000d5c0: 2020 2020 2320 4173 7365 7274 0a20 2020      # Assert.   
+0000d5d0: 2020 2020 2065 7870 6563 7465 645f 6f75       expected_ou
+0000d5e0: 7420 3d20 7064 2e44 6174 6146 7261 6d65  t = pd.DataFrame
+0000d5f0: 287b 0a20 2020 2020 2020 2020 2020 2027  ({.            '
+0000d600: 6127 3a20 5b27 3230 3230 2d30 312d 3031  a': ['2020-01-01
+0000d610: 5430 303a 3030 3a30 3027 2c20 2732 3032  T00:00:00', '202
+0000d620: 302d 3031 2d30 3254 3030 3a30 303a 3030  0-01-02T00:00:00
+0000d630: 275d 2c0a 2020 2020 2020 2020 2020 2020  '],.            
+0000d640: 2763 273a 205b 312c 2032 5d2c 0a20 2020  'c': [1, 2],.   
+0000d650: 2020 2020 2020 2020 2027 6123 6227 3a20           'a#b': 
+0000d660: 5b6e 702e 6c6f 6728 315f 3030 305f 3030  [np.log(1_000_00
+0000d670: 305f 3030 3129 2c20 6e70 2e6c 6f67 2831  0_001), np.log(1
+0000d680: 5f30 3030 5f30 3030 5f30 3031 295d 2c0a  _000_000_001)],.
+0000d690: 2020 2020 2020 2020 7d29 0a20 2020 2020          }).     
+0000d6a0: 2020 2070 642e 7465 7374 696e 672e 6173     pd.testing.as
+0000d6b0: 7365 7274 5f66 7261 6d65 5f65 7175 616c  sert_frame_equal
+0000d6c0: 286f 7574 2c20 6578 7065 6374 6564 5f6f  (out, expected_o
+0000d6d0: 7574 290a 0a20 2020 2064 6566 2074 6573  ut)..    def tes
+0000d6e0: 745f 7265 7665 7273 655f 7472 616e 7366  t_reverse_transf
+0000d6f0: 6f72 6d28 7365 6c66 293a 0a20 2020 2020  orm(self):.     
+0000d700: 2020 2022 2222 5465 7374 2074 6865 2060     """Test the `
+0000d710: 6049 6e65 7175 616c 6974 792e 7265 7665  `Inequality.reve
+0000d720: 7273 655f 7472 616e 7366 6f72 6d60 6020  rse_transform`` 
+0000d730: 6d65 7468 6f64 2e0a 0a20 2020 2020 2020  method...       
+0000d740: 2054 6865 206d 6574 686f 6420 6973 2065   The method is e
+0000d750: 7870 6563 7465 6420 746f 3a0a 2020 2020  xpected to:.    
+0000d760: 2020 2020 2020 2020 2d20 6170 706c 7920          - apply 
+0000d770: 616e 2065 7870 6f6e 656e 7469 616c 2074  an exponential t
+0000d780: 6f20 7468 6520 696e 7075 740a 2020 2020  o the input.    
+0000d790: 2020 2020 2020 2020 2d20 7375 6274 7261          - subtra
+0000d7a0: 6374 2031 0a20 2020 2020 2020 2020 2020  ct 1.           
+0000d7b0: 202d 2061 6464 2074 6865 206c 6f77 2063   - add the low c
+0000d7c0: 6f6c 756d 6e0a 2020 2020 2020 2020 2020  olumn.          
+0000d7d0: 2020 2d20 636f 6e76 6572 7420 7468 6520    - convert the 
+0000d7e0: 6f75 7470 7574 2074 6f20 696e 7465 6765  output to intege
+0000d7f0: 7273 0a20 2020 2020 2020 2020 2020 202d  rs.            -
+0000d800: 2061 6464 2062 6163 6b20 7468 6520 6472   add back the dr
+0000d810: 6f70 7065 6420 636f 6c75 6d6e 0a0a 2020  opped column..  
+0000d820: 2020 2020 2020 5365 7475 703a 0a20 2020        Setup:.   
+0000d830: 2020 2020 202d 2060 605f 6469 6666 5f63       - ``_diff_c
+0000d840: 6f6c 756d 6e5f 6e61 6d65 203d 2027 6123  olumn_name = 'a#
+0000d850: 6227 6060 0a20 2020 2020 2020 202d 2060  b'``.        - `
+0000d860: 605f 6474 7970 6560 6020 6173 2069 6e74  `_dtype`` as int
+0000d870: 6567 6572 0a20 2020 2020 2020 2049 6e70  eger.        Inp
+0000d880: 7574 3a0a 2020 2020 2020 2020 2d20 5461  ut:.        - Ta
+0000d890: 626c 6520 7769 7468 2061 2064 6966 6620  ble with a diff 
+0000d8a0: 636f 6c75 6d6e 2074 6861 7420 636f 6e74  column that cont
+0000d8b0: 6169 6e73 2074 6865 2063 6f6e 7374 616e  ains the constan
+0000d8c0: 7420 6e70 2e6c 6f67 2834 292e 0a20 2020  t np.log(4)..   
+0000d8d0: 2020 2020 204f 7574 7075 743a 0a20 2020       Output:.   
+0000d8e0: 2020 2020 202d 2053 616d 6520 7461 626c       - Same tabl
+0000d8f0: 6520 7769 7468 2074 6865 2068 6967 6820  e with the high 
+0000d900: 636f 6c75 6d6e 2072 6570 6c61 6365 6420  column replaced 
+0000d910: 6279 2074 6865 206c 6f77 206f 6e65 202b  by the low one +
+0000d920: 2033 2077 6974 6820 6469 6666 2063 6f6c   3 with diff col
+0000d930: 756d 6e20 6472 6f70 7065 642e 0a20 2020  umn dropped..   
+0000d940: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0000d950: 2023 2053 6574 7570 0a20 2020 2020 2020   # Setup.       
+0000d960: 2069 6e73 7461 6e63 6520 3d20 496e 6571   instance = Ineq
+0000d970: 7561 6c69 7479 286c 6f77 5f63 6f6c 756d  uality(low_colum
+0000d980: 6e5f 6e61 6d65 3d27 6127 2c20 6869 6768  n_name='a', high
+0000d990: 5f63 6f6c 756d 6e5f 6e61 6d65 3d27 6227  _column_name='b'
+0000d9a0: 290a 2020 2020 2020 2020 696e 7374 616e  ).        instan
+0000d9b0: 6365 2e5f 6474 7970 6520 3d20 7064 2e53  ce._dtype = pd.S
+0000d9c0: 6572 6965 7328 5b31 5d29 2e64 7479 7065  eries([1]).dtype
+0000d9d0: 2020 2320 6578 6163 7420 6474 7970 6520    # exact dtype 
+0000d9e0: 2833 3220 6f72 2036 3429 2064 6570 656e  (32 or 64) depen
+0000d9f0: 6473 206f 6e20 4f53 0a20 2020 2020 2020  ds on OS.       
+0000da00: 2069 6e73 7461 6e63 652e 5f64 6966 665f   instance._diff_
+0000da10: 636f 6c75 6d6e 5f6e 616d 6520 3d20 2761  column_name = 'a
+0000da20: 2362 270a 0a20 2020 2020 2020 2023 2052  #b'..        # R
+0000da30: 756e 0a20 2020 2020 2020 2074 7261 6e73  un.        trans
+0000da40: 666f 726d 6564 203d 2070 642e 4461 7461  formed = pd.Data
+0000da50: 4672 616d 6528 7b0a 2020 2020 2020 2020  Frame({.        
+0000da60: 2020 2020 2761 273a 205b 312c 2032 2c20      'a': [1, 2, 
+0000da70: 335d 2c0a 2020 2020 2020 2020 2020 2020  3],.            
+0000da80: 2763 273a 205b 372c 2038 2c20 395d 2c0a  'c': [7, 8, 9],.
+0000da90: 2020 2020 2020 2020 2020 2020 2761 2362              'a#b
+0000daa0: 273a 205b 6e70 2e6c 6f67 2834 295d 202a  ': [np.log(4)] *
+0000dab0: 2033 2c0a 2020 2020 2020 2020 7d29 0a20   3,.        }). 
+0000dac0: 2020 2020 2020 206f 7574 203d 2069 6e73         out = ins
+0000dad0: 7461 6e63 652e 7265 7665 7273 655f 7472  tance.reverse_tr
+0000dae0: 616e 7366 6f72 6d28 7472 616e 7366 6f72  ansform(transfor
+0000daf0: 6d65 6429 0a0a 2020 2020 2020 2020 2320  med)..        # 
+0000db00: 4173 7365 7274 0a20 2020 2020 2020 2065  Assert.        e
+0000db10: 7870 6563 7465 645f 6f75 7420 3d20 7064  xpected_out = pd
+0000db20: 2e44 6174 6146 7261 6d65 287b 0a20 2020  .DataFrame({.   
+0000db30: 2020 2020 2020 2020 2027 6127 3a20 5b31           'a': [1
+0000db40: 2c20 322c 2033 5d2c 0a20 2020 2020 2020  , 2, 3],.       
+0000db50: 2020 2020 2027 6327 3a20 5b37 2c20 382c       'c': [7, 8,
+0000db60: 2039 5d2c 0a20 2020 2020 2020 2020 2020   9],.           
+0000db70: 2027 6227 3a20 5b34 2c20 352c 2036 5d2c   'b': [4, 5, 6],
+0000db80: 0a20 2020 2020 2020 207d 290a 2020 2020  .        }).    
+0000db90: 2020 2020 7064 2e74 6573 7469 6e67 2e61      pd.testing.a
+0000dba0: 7373 6572 745f 6672 616d 655f 6571 7561  ssert_frame_equa
+0000dbb0: 6c28 6f75 742c 2065 7870 6563 7465 645f  l(out, expected_
+0000dbc0: 6f75 7429 0a0a 2020 2020 6465 6620 7465  out)..    def te
+0000dbd0: 7374 5f72 6576 6572 7365 5f74 7261 6e73  st_reverse_trans
+0000dbe0: 666f 726d 5f66 6c6f 6174 7328 7365 6c66  form_floats(self
+0000dbf0: 293a 0a20 2020 2020 2020 2022 2222 5465  ):.        """Te
+0000dc00: 7374 2074 6865 2060 6049 6e65 7175 616c  st the ``Inequal
+0000dc10: 6974 792e 7265 7665 7273 655f 7472 616e  ity.reverse_tran
+0000dc20: 7366 6f72 6d60 6020 6d65 7468 6f64 2e0a  sform`` method..
+0000dc30: 0a20 2020 2020 2020 2054 6865 206d 6574  .        The met
+0000dc40: 686f 6420 6973 2065 7870 6563 7465 6420  hod is expected 
+0000dc50: 746f 3a0a 2020 2020 2020 2020 2020 2020  to:.            
+0000dc60: 2d20 6170 706c 7920 616e 2065 7870 6f6e  - apply an expon
+0000dc70: 656e 7469 616c 2074 6f20 7468 6520 696e  ential to the in
+0000dc80: 7075 740a 2020 2020 2020 2020 2020 2020  put.            
+0000dc90: 2d20 7375 6274 7261 6374 2031 0a20 2020  - subtract 1.   
+0000dca0: 2020 2020 2020 2020 202d 2061 6464 2074           - add t
+0000dcb0: 6865 206c 6f77 2063 6f6c 756d 6e0a 2020  he low column.  
+0000dcc0: 2020 2020 2020 2020 2020 2d20 636f 6e76            - conv
+0000dcd0: 6572 7420 7468 6520 6f75 7470 7574 2074  ert the output t
+0000dce0: 6f20 666c 6f61 7473 0a20 2020 2020 2020  o floats.       
+0000dcf0: 2020 2020 202d 2061 6464 2062 6163 6b20       - add back 
+0000dd00: 7468 6520 6472 6f70 7065 6420 636f 6c75  the dropped colu
+0000dd10: 6d6e 0a0a 2020 2020 2020 2020 5365 7475  mn..        Setu
+0000dd20: 703a 0a20 2020 2020 2020 202d 2060 605f  p:.        - ``_
+0000dd30: 6469 6666 5f63 6f6c 756d 6e5f 6e61 6d65  diff_column_name
+0000dd40: 203d 2027 6123 6227 6060 0a20 2020 2020   = 'a#b'``.     
+0000dd50: 2020 202d 2060 605f 6474 7970 6560 6020     - ``_dtype`` 
+0000dd60: 6173 2066 6c6f 6174 0a20 2020 2020 2020  as float.       
+0000dd70: 2049 6e70 7574 3a0a 2020 2020 2020 2020   Input:.        
+0000dd80: 2d20 5461 626c 6520 7769 7468 2061 2064  - Table with a d
+0000dd90: 6966 6620 636f 6c75 6d6e 2074 6861 7420  iff column that 
+0000dda0: 636f 6e74 6169 6e73 2074 6865 2063 6f6e  contains the con
+0000ddb0: 7374 616e 7420 6e70 2e6c 6f67 2834 292e  stant np.log(4).
+0000ddc0: 0a20 2020 2020 2020 204f 7574 7075 743a  .        Output:
+0000ddd0: 0a20 2020 2020 2020 202d 2053 616d 6520  .        - Same 
+0000dde0: 7461 626c 6520 7769 7468 2074 6865 2068  table with the h
+0000ddf0: 6967 6820 636f 6c75 6d6e 2072 6570 6c61  igh column repla
+0000de00: 6365 6420 6279 2074 6865 206c 6f77 206f  ced by the low o
+0000de10: 6e65 202b 2033 2077 6974 6820 6469 6666  ne + 3 with diff
+0000de20: 2063 6f6c 756d 6e20 6472 6f70 7065 642e   column dropped.
+0000de30: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0000de40: 2020 2020 2023 2053 6574 7570 0a20 2020       # Setup.   
+0000de50: 2020 2020 2069 6e73 7461 6e63 6520 3d20       instance = 
+0000de60: 496e 6571 7561 6c69 7479 286c 6f77 5f63  Inequality(low_c
+0000de70: 6f6c 756d 6e5f 6e61 6d65 3d27 6127 2c20  olumn_name='a', 
+0000de80: 6869 6768 5f63 6f6c 756d 6e5f 6e61 6d65  high_column_name
+0000de90: 3d27 6227 290a 2020 2020 2020 2020 696e  ='b').        in
+0000dea0: 7374 616e 6365 2e5f 6474 7970 6520 3d20  stance._dtype = 
+0000deb0: 6e70 2e64 7479 7065 2827 666c 6f61 7427  np.dtype('float'
+0000dec0: 290a 2020 2020 2020 2020 696e 7374 616e  ).        instan
+0000ded0: 6365 2e5f 6469 6666 5f63 6f6c 756d 6e5f  ce._diff_column_
+0000dee0: 6e61 6d65 203d 2027 6123 6227 0a0a 2020  name = 'a#b'..  
+0000def0: 2020 2020 2020 2320 5275 6e0a 2020 2020        # Run.    
+0000df00: 2020 2020 7472 616e 7366 6f72 6d65 6420      transformed 
+0000df10: 3d20 7064 2e44 6174 6146 7261 6d65 287b  = pd.DataFrame({
+0000df20: 0a20 2020 2020 2020 2020 2020 2027 6127  .            'a'
+0000df30: 3a20 5b31 2e31 2c20 322e 322c 2033 2e33  : [1.1, 2.2, 3.3
+0000df40: 5d2c 0a20 2020 2020 2020 2020 2020 2027  ],.            '
+0000df50: 6327 3a20 5b37 2c20 382c 2039 5d2c 0a20  c': [7, 8, 9],. 
+0000df60: 2020 2020 2020 2020 2020 2027 6123 6227             'a#b'
+0000df70: 3a20 5b6e 702e 6c6f 6728 3429 5d20 2a20  : [np.log(4)] * 
+0000df80: 332c 0a20 2020 2020 2020 207d 290a 2020  3,.        }).  
+0000df90: 2020 2020 2020 6f75 7420 3d20 696e 7374        out = inst
+0000dfa0: 616e 6365 2e72 6576 6572 7365 5f74 7261  ance.reverse_tra
+0000dfb0: 6e73 666f 726d 2874 7261 6e73 666f 726d  nsform(transform
+0000dfc0: 6564 290a 0a20 2020 2020 2020 2023 2041  ed)..        # A
+0000dfd0: 7373 6572 740a 2020 2020 2020 2020 6578  ssert.        ex
+0000dfe0: 7065 6374 6564 5f6f 7574 203d 2070 642e  pected_out = pd.
+0000dff0: 4461 7461 4672 616d 6528 7b0a 2020 2020  DataFrame({.    
+0000e000: 2020 2020 2020 2020 2761 273a 205b 312e          'a': [1.
+0000e010: 312c 2032 2e32 2c20 332e 335d 2c0a 2020  1, 2.2, 3.3],.  
+0000e020: 2020 2020 2020 2020 2020 2763 273a 205b            'c': [
+0000e030: 372c 2038 2c20 395d 2c0a 2020 2020 2020  7, 8, 9],.      
+0000e040: 2020 2020 2020 2762 273a 205b 342e 312c        'b': [4.1,
+0000e050: 2035 2e32 2c20 362e 335d 2c0a 2020 2020   5.2, 6.3],.    
+0000e060: 2020 2020 7d29 0a20 2020 2020 2020 2070      }).        p
+0000e070: 642e 7465 7374 696e 672e 6173 7365 7274  d.testing.assert
+0000e080: 5f66 7261 6d65 5f65 7175 616c 286f 7574  _frame_equal(out
+0000e090: 2c20 6578 7065 6374 6564 5f6f 7574 290a  , expected_out).
+0000e0a0: 0a20 2020 2064 6566 2074 6573 745f 7265  .    def test_re
+0000e0b0: 7665 7273 655f 7472 616e 7366 6f72 6d5f  verse_transform_
+0000e0c0: 6461 7465 7469 6d65 2873 656c 6629 3a0a  datetime(self):.
+0000e0d0: 2020 2020 2020 2020 2222 2254 6573 7420          """Test 
+0000e0e0: 7468 6520 6060 496e 6571 7561 6c69 7479  the ``Inequality
+0000e0f0: 2e72 6576 6572 7365 5f74 7261 6e73 666f  .reverse_transfo
+0000e100: 726d 6060 206d 6574 686f 642e 0a0a 2020  rm`` method...  
+0000e110: 2020 2020 2020 5468 6520 6d65 7468 6f64        The method
+0000e120: 2069 7320 6578 7065 6374 6564 2074 6f3a   is expected to:
+0000e130: 0a20 2020 2020 2020 2020 2020 202d 2061  .            - a
+0000e140: 7070 6c79 2061 6e20 6578 706f 6e65 6e74  pply an exponent
+0000e150: 6961 6c20 746f 2074 6865 2069 6e70 7574  ial to the input
+0000e160: 0a20 2020 2020 2020 2020 2020 202d 2073  .            - s
+0000e170: 7562 7472 6163 7420 310a 2020 2020 2020  ubtract 1.      
+0000e180: 2020 2020 2020 2d20 6164 6420 7468 6520        - add the 
+0000e190: 6c6f 7720 636f 6c75 6d6e 0a20 2020 2020  low column.     
+0000e1a0: 2020 2020 2020 202d 2063 6f6e 7665 7274         - convert
+0000e1b0: 2074 6865 206f 7574 7075 7420 746f 2064   the output to d
+0000e1c0: 6174 6574 696d 650a 2020 2020 2020 2020  atetime.        
+0000e1d0: 2020 2020 2d20 6164 6420 6261 636b 2074      - add back t
+0000e1e0: 6865 2064 726f 7070 6564 2063 6f6c 756d  he dropped colum
+0000e1f0: 6e0a 0a20 2020 2020 2020 2053 6574 7570  n..        Setup
+0000e200: 3a0a 2020 2020 2020 2020 2d20 6060 5f64  :.        - ``_d
+0000e210: 6966 665f 636f 6c75 6d6e 5f6e 616d 6520  iff_column_name 
+0000e220: 3d20 2761 2362 2760 600a 2020 2020 2020  = 'a#b'``.      
+0000e230: 2020 2d20 6060 5f64 7479 7065 6060 2061    - ``_dtype`` a
+0000e240: 7320 6461 7465 7469 6d65 0a20 2020 2020  s datetime.     
+0000e250: 2020 2049 6e70 7574 3a0a 2020 2020 2020     Input:.      
+0000e260: 2020 2d20 5461 626c 6520 7769 7468 2061    - Table with a
+0000e270: 2064 6966 6620 636f 6c75 6d6e 2074 6861   diff column tha
+0000e280: 7420 636f 6e74 6169 6e73 2074 6865 2063  t contains the c
+0000e290: 6f6e 7374 616e 7420 6e70 2e6c 6f67 2834  onstant np.log(4
+0000e2a0: 292e 0a20 2020 2020 2020 204f 7574 7075  )..        Outpu
+0000e2b0: 743a 0a20 2020 2020 2020 202d 2053 616d  t:.        - Sam
+0000e2c0: 6520 7461 626c 6520 7769 7468 2074 6865  e table with the
+0000e2d0: 2068 6967 6820 636f 6c75 6d6e 2072 6570   high column rep
+0000e2e0: 6c61 6365 6420 6279 2074 6865 206c 6f77  laced by the low
+0000e2f0: 206f 6e65 202b 2031 7365 6320 7769 7468   one + 1sec with
+0000e300: 2064 6966 6620 636f 6c75 6d6e 2064 726f   diff column dro
+0000e310: 7070 6564 2e0a 2020 2020 2020 2020 2222  pped..        ""
+0000e320: 220a 2020 2020 2020 2020 2320 5365 7475  ".        # Setu
+0000e330: 700a 2020 2020 2020 2020 696e 7374 616e  p.        instan
+0000e340: 6365 203d 2049 6e65 7175 616c 6974 7928  ce = Inequality(
+0000e350: 6c6f 775f 636f 6c75 6d6e 5f6e 616d 653d  low_column_name=
+0000e360: 2761 272c 2068 6967 685f 636f 6c75 6d6e  'a', high_column
+0000e370: 5f6e 616d 653d 2762 2729 0a20 2020 2020  _name='b').     
+0000e380: 2020 2069 6e73 7461 6e63 652e 5f64 7479     instance._dty
+0000e390: 7065 203d 206e 702e 6474 7970 6528 273c  pe = np.dtype('<
+0000e3a0: 4d38 5b6e 735d 2729 0a20 2020 2020 2020  M8[ns]').       
+0000e3b0: 2069 6e73 7461 6e63 652e 5f64 6966 665f   instance._diff_
+0000e3c0: 636f 6c75 6d6e 5f6e 616d 6520 3d20 2761  column_name = 'a
+0000e3d0: 2362 270a 2020 2020 2020 2020 696e 7374  #b'.        inst
+0000e3e0: 616e 6365 2e5f 6973 5f64 6174 6574 696d  ance._is_datetim
+0000e3f0: 6520 3d20 5472 7565 0a0a 2020 2020 2020  e = True..      
+0000e400: 2020 2320 5275 6e0a 2020 2020 2020 2020    # Run.        
+0000e410: 7472 616e 7366 6f72 6d65 6420 3d20 7064  transformed = pd
+0000e420: 2e44 6174 6146 7261 6d65 287b 0a20 2020  .DataFrame({.   
+0000e430: 2020 2020 2020 2020 2027 6127 3a20 7064           'a': pd
+0000e440: 2e74 6f5f 6461 7465 7469 6d65 285b 2732  .to_datetime(['2
+0000e450: 3032 302d 3031 2d30 3154 3030 3a30 303a  020-01-01T00:00:
+0000e460: 3030 272c 2027 3230 3230 2d30 312d 3032  00', '2020-01-02
+0000e470: 5430 303a 3030 3a30 3027 5d29 2c0a 2020  T00:00:00']),.  
+0000e480: 2020 2020 2020 2020 2020 2763 273a 205b            'c': [
+0000e490: 312c 2032 5d2c 0a20 2020 2020 2020 2020  1, 2],.         
+0000e4a0: 2020 2027 6123 6227 3a20 5b6e 702e 6c6f     'a#b': [np.lo
+0000e4b0: 6728 315f 3030 305f 3030 305f 3030 3129  g(1_000_000_001)
+0000e4c0: 2c20 6e70 2e6c 6f67 2831 5f30 3030 5f30  , np.log(1_000_0
+0000e4d0: 3030 5f30 3031 295d 2c0a 2020 2020 2020  00_001)],.      
+0000e4e0: 2020 7d29 0a20 2020 2020 2020 206f 7574    }).        out
+0000e4f0: 203d 2069 6e73 7461 6e63 652e 7265 7665   = instance.reve
+0000e500: 7273 655f 7472 616e 7366 6f72 6d28 7472  rse_transform(tr
+0000e510: 616e 7366 6f72 6d65 6429 0a0a 2020 2020  ansformed)..    
+0000e520: 2020 2020 2320 4173 7365 7274 0a20 2020      # Assert.   
+0000e530: 2020 2020 2065 7870 6563 7465 645f 6f75       expected_ou
+0000e540: 7420 3d20 7064 2e44 6174 6146 7261 6d65  t = pd.DataFrame
+0000e550: 287b 0a20 2020 2020 2020 2020 2020 2027  ({.            '
+0000e560: 6127 3a20 7064 2e74 6f5f 6461 7465 7469  a': pd.to_dateti
+0000e570: 6d65 285b 2732 3032 302d 3031 2d30 3154  me(['2020-01-01T
+0000e580: 3030 3a30 303a 3030 272c 2027 3230 3230  00:00:00', '2020
+0000e590: 2d30 312d 3032 5430 303a 3030 3a30 3027  -01-02T00:00:00'
+0000e5a0: 5d29 2c0a 2020 2020 2020 2020 2020 2020  ]),.            
+0000e5b0: 2763 273a 205b 312c 2032 5d2c 0a20 2020  'c': [1, 2],.   
+0000e5c0: 2020 2020 2020 2020 2027 6227 3a20 7064           'b': pd
+0000e5d0: 2e74 6f5f 6461 7465 7469 6d65 285b 2732  .to_datetime(['2
+0000e5e0: 3032 302d 3031 2d30 3154 3030 3a30 303a  020-01-01T00:00:
+0000e5f0: 3031 272c 2027 3230 3230 2d30 312d 3032  01', '2020-01-02
+0000e600: 5430 303a 3030 3a30 3127 5d29 0a20 2020  T00:00:01']).   
+0000e610: 2020 2020 207d 290a 2020 2020 2020 2020       }).        
+0000e620: 7064 2e74 6573 7469 6e67 2e61 7373 6572  pd.testing.asser
+0000e630: 745f 6672 616d 655f 6571 7561 6c28 6f75  t_frame_equal(ou
+0000e640: 742c 2065 7870 6563 7465 645f 6f75 7429  t, expected_out)
+0000e650: 0a0a 2020 2020 6465 6620 7465 7374 5f72  ..    def test_r
+0000e660: 6576 6572 7365 5f74 7261 6e73 666f 726d  everse_transform
+0000e670: 5f64 6174 6574 696d 655f 6474 7970 655f  _datetime_dtype_
+0000e680: 6973 5f6f 626a 6563 7428 7365 6c66 293a  is_object(self):
+0000e690: 0a20 2020 2020 2020 2022 2222 5465 7374  .        """Test
+0000e6a0: 2074 6865 2060 6049 6e65 7175 616c 6974   the ``Inequalit
+0000e6b0: 792e 7265 7665 7273 655f 7472 616e 7366  y.reverse_transf
+0000e6c0: 6f72 6d60 6020 6d65 7468 6f64 2e0a 0a20  orm`` method... 
+0000e6d0: 2020 2020 2020 2054 6869 7320 7368 6f75         This shou
+0000e6e0: 6c64 2063 6173 7420 7468 6520 6060 6c6f  ld cast the ``lo
+0000e6f0: 7760 6020 636f 6c75 6d6e 2074 6f20 6060  w`` column to ``
+0000e700: 6461 7465 7469 6d65 6060 2077 6865 6e20  datetime`` when 
+0000e710: 7468 6520 6060 6474 7970 6560 6020 6973  the ``dtype`` is
+0000e720: 0a20 2020 2020 2020 206f 626a 6563 742e  .        object.
+0000e730: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0000e740: 2020 2020 2023 2053 6574 7570 0a20 2020       # Setup.   
+0000e750: 2020 2020 2069 6e73 7461 6e63 6520 3d20       instance = 
+0000e760: 496e 6571 7561 6c69 7479 286c 6f77 5f63  Inequality(low_c
+0000e770: 6f6c 756d 6e5f 6e61 6d65 3d27 6127 2c20  olumn_name='a', 
+0000e780: 6869 6768 5f63 6f6c 756d 6e5f 6e61 6d65  high_column_name
+0000e790: 3d27 6227 290a 2020 2020 2020 2020 696e  ='b').        in
+0000e7a0: 7374 616e 6365 2e5f 6474 7970 6520 3d20  stance._dtype = 
+0000e7b0: 6e70 2e64 7479 7065 2827 4f27 290a 2020  np.dtype('O').  
+0000e7c0: 2020 2020 2020 696e 7374 616e 6365 2e5f        instance._
+0000e7d0: 6469 6666 5f63 6f6c 756d 6e5f 6e61 6d65  diff_column_name
+0000e7e0: 203d 2027 6123 6227 0a20 2020 2020 2020   = 'a#b'.       
+0000e7f0: 2069 6e73 7461 6e63 652e 5f69 735f 6461   instance._is_da
+0000e800: 7465 7469 6d65 203d 2054 7275 650a 0a20  tetime = True.. 
+0000e810: 2020 2020 2020 2023 2052 756e 0a20 2020         # Run.   
+0000e820: 2020 2020 2074 7261 6e73 666f 726d 6564       transformed
+0000e830: 203d 2070 642e 4461 7461 4672 616d 6528   = pd.DataFrame(
+0000e840: 7b0a 2020 2020 2020 2020 2020 2020 2761  {.            'a
+0000e850: 273a 205b 2732 3032 302d 3031 2d30 3154  ': ['2020-01-01T
+0000e860: 3030 3a30 303a 3030 272c 2027 3230 3230  00:00:00', '2020
+0000e870: 2d30 312d 3032 5430 303a 3030 3a30 3027  -01-02T00:00:00'
+0000e880: 5d2c 0a20 2020 2020 2020 2020 2020 2027  ],.            '
+0000e890: 6327 3a20 5b31 2c20 325d 2c0a 2020 2020  c': [1, 2],.    
+0000e8a0: 2020 2020 2020 2020 2761 2362 273a 205b          'a#b': [
+0000e8b0: 6e70 2e6c 6f67 2831 5f30 3030 5f30 3030  np.log(1_000_000
+0000e8c0: 5f30 3031 292c 206e 702e 6c6f 6728 315f  _001), np.log(1_
+0000e8d0: 3030 305f 3030 305f 3030 3129 5d2c 0a20  000_000_001)],. 
+0000e8e0: 2020 2020 2020 207d 290a 2020 2020 2020         }).      
+0000e8f0: 2020 6f75 7420 3d20 696e 7374 616e 6365    out = instance
+0000e900: 2e72 6576 6572 7365 5f74 7261 6e73 666f  .reverse_transfo
+0000e910: 726d 2874 7261 6e73 666f 726d 6564 290a  rm(transformed).
+0000e920: 0a20 2020 2020 2020 2023 2041 7373 6572  .        # Asser
+0000e930: 740a 2020 2020 2020 2020 6578 7065 6374  t.        expect
+0000e940: 6564 5f6f 7574 203d 2070 642e 4461 7461  ed_out = pd.Data
+0000e950: 4672 616d 6528 7b0a 2020 2020 2020 2020  Frame({.        
+0000e960: 2020 2020 2761 273a 205b 2732 3032 302d      'a': ['2020-
+0000e970: 3031 2d30 3154 3030 3a30 303a 3030 272c  01-01T00:00:00',
+0000e980: 2027 3230 3230 2d30 312d 3032 5430 303a   '2020-01-02T00:
+0000e990: 3030 3a30 3027 5d2c 0a20 2020 2020 2020  00:00'],.       
+0000e9a0: 2020 2020 2027 6327 3a20 5b31 2c20 325d       'c': [1, 2]
+0000e9b0: 2c0a 2020 2020 2020 2020 2020 2020 2762  ,.            'b
+0000e9c0: 273a 205b 7064 2e54 696d 6573 7461 6d70  ': [pd.Timestamp
+0000e9d0: 2827 3230 3230 2d30 312d 3031 2030 303a  ('2020-01-01 00:
+0000e9e0: 3030 3a30 3127 292c 2070 642e 5469 6d65  00:01'), pd.Time
+0000e9f0: 7374 616d 7028 2732 3032 302d 3031 2d30  stamp('2020-01-0
+0000ea00: 3220 3030 3a30 303a 3031 2729 5d0a 2020  2 00:00:01')].  
+0000ea10: 2020 2020 2020 7d29 0a20 2020 2020 2020        }).       
+0000ea20: 2065 7870 6563 7465 645f 6f75 745b 2762   expected_out['b
+0000ea30: 275d 203d 2065 7870 6563 7465 645f 6f75  '] = expected_ou
+0000ea40: 745b 2762 275d 2e61 7374 7970 6528 6e70  t['b'].astype(np
+0000ea50: 2e64 7479 7065 2827 4f27 2929 0a20 2020  .dtype('O')).   
+0000ea60: 2020 2020 2070 642e 7465 7374 696e 672e       pd.testing.
+0000ea70: 6173 7365 7274 5f66 7261 6d65 5f65 7175  assert_frame_equ
+0000ea80: 616c 286f 7574 2c20 6578 7065 6374 6564  al(out, expected
+0000ea90: 5f6f 7574 290a 0a0a 636c 6173 7320 5465  _out)...class Te
+0000eaa0: 7374 5363 616c 6172 496e 6571 7561 6c69  stScalarInequali
+0000eab0: 7479 2829 3a0a 0a20 2020 2064 6566 2074  ty():..    def t
+0000eac0: 6573 745f 5f76 616c 6964 6174 655f 696e  est__validate_in
+0000ead0: 7075 7473 2873 656c 6629 3a0a 2020 2020  puts(self):.    
+0000eae0: 2020 2020 2222 2254 6573 7420 7468 6520      """Test the 
+0000eaf0: 6060 5363 616c 6172 496e 6571 7561 6c69  ``ScalarInequali
+0000eb00: 7479 2e5f 7661 6c69 6461 7465 5f69 6e70  ty._validate_inp
+0000eb10: 7574 7360 6020 6d65 7468 6f64 2e0a 0a20  uts`` method... 
+0000eb20: 2020 2020 2020 2049 6e70 7574 3a0a 2020         Input:.  
+0000eb30: 2020 2020 2020 2d20 2049 6e63 6f72 7265        -  Incorre
+0000eb40: 6374 2070 6172 616d 6574 6572 7320 666f  ct parameters fo
+0000eb50: 7220 7468 6520 6d65 7468 6f64 0a20 2020  r the method.   
+0000eb60: 2020 2020 2052 6169 7365 733a 0a20 2020       Raises:.   
+0000eb70: 2020 2020 202d 204c 6973 7420 6f66 2056       - List of V
+0000eb80: 616c 7565 4572 726f 7273 0a20 2020 2020  alueErrors.     
+0000eb90: 2020 2022 2222 0a20 2020 2020 2020 2023     """.        #
+0000eba0: 2052 756e 202f 2041 7373 6572 740a 2020   Run / Assert.  
+0000ebb0: 2020 2020 2020 7769 7468 2070 7974 6573        with pytes
+0000ebc0: 742e 7261 6973 6573 2841 6767 7265 6761  t.raises(Aggrega
+0000ebd0: 7465 436f 6e73 7472 6169 6e74 7345 7272  teConstraintsErr
+0000ebe0: 6f72 2920 6173 2065 7272 6f72 3a0a 2020  or) as error:.  
+0000ebf0: 2020 2020 2020 2020 2020 5363 616c 6172            Scalar
+0000ec00: 496e 6571 7561 6c69 7479 2e5f 7661 6c69  Inequality._vali
+0000ec10: 6461 7465 5f69 6e70 7574 7328 0a20 2020  date_inputs(.   
+0000ec20: 2020 2020 2020 2020 2020 2020 206e 6f74               not
+0000ec30: 5f68 6967 685f 636f 6c75 6d6e 3d4e 6f6e  _high_column=Non
+0000ec40: 652c 206e 6f74 5f6c 6f77 5f63 6f6c 756d  e, not_low_colum
+0000ec50: 6e3d 4e6f 6e65 2c20 7265 6c61 7469 6f6e  n=None, relation
+0000ec60: 3d27 2b27 290a 0a20 2020 2020 2020 2065  ='+')..        e
+0000ec70: 7272 5f6d 7367 203d 2028 0a20 2020 2020  rr_msg = (.     
+0000ec80: 2020 2020 2020 2072 274d 6973 7369 6e67         r'Missing
+0000ec90: 2072 6571 7569 7265 6420 7661 6c75 6573   required values
+0000eca0: 207b 282e 2a29 7d20 696e 2061 2053 6361   {(.*)} in a Sca
+0000ecb0: 6c61 7249 6e65 7175 616c 6974 7920 636f  larInequality co
+0000ecc0: 6e73 7472 6169 6e74 2e27 0a20 2020 2020  nstraint.'.     
+0000ecd0: 2020 2020 2020 2072 275c 6e5c 6e49 6e76         r'\n\nInv
+0000ece0: 616c 6964 2076 616c 7565 7320 7b28 2e2a  alid values {(.*
+0000ecf0: 297d 2061 7265 2070 7265 7365 6e74 2069  )} are present i
+0000ed00: 6e20 6120 5363 616c 6172 496e 6571 7561  n a ScalarInequa
+0000ed10: 6c69 7479 2063 6f6e 7374 7261 696e 742e  lity constraint.
+0000ed20: 270a 2020 2020 2020 2020 2020 2020 7227  '.            r'
+0000ed30: 5c6e 5c6e 496e 7661 6c69 6420 7265 6c61  \n\nInvalid rela
+0000ed40: 7469 6f6e 2076 616c 7565 207b 282e 2a29  tion value {(.*)
+0000ed50: 7d20 696e 2061 2053 6361 6c61 7249 6e65  } in a ScalarIne
+0000ed60: 7175 616c 6974 7920 636f 6e73 7472 6169  quality constrai
+0000ed70: 6e74 2e27 0a20 2020 2020 2020 2020 2020  nt.'.           
+0000ed80: 2022 2054 6865 2072 656c 6174 696f 6e20   " The relation 
+0000ed90: 6d75 7374 2062 6520 6f6e 6520 6f66 3a20  must be one of: 
+0000eda0: 273e 272c 2027 3e3d 272c 2027 3c27 206f  '>', '>=', '<' o
+0000edb0: 7220 273c 3d27 2e22 0a20 2020 2020 2020  r '<='.".       
+0000edc0: 2029 0a20 2020 2020 2020 2067 726f 7570   ).        group
+0000edd0: 7320 3d20 7265 2e73 6561 7263 6828 6572  s = re.search(er
+0000ede0: 725f 6d73 672c 2073 7472 2865 7272 6f72  r_msg, str(error
+0000edf0: 2e76 616c 7565 2929 0a20 2020 2020 2020  .value)).       
+0000ee00: 2061 7373 6572 7420 6772 6f75 7073 2069   assert groups i
+0000ee10: 7320 6e6f 7420 4e6f 6e65 0a20 2020 2020  s not None.     
+0000ee20: 2020 2061 7373 6572 7420 7365 7428 6576     assert set(ev
+0000ee30: 616c 2867 726f 7570 732e 6772 6f75 7028  al(groups.group(
+0000ee40: 3129 2929 203d 3d20 7b27 636f 6c75 6d6e  1))) == {'column
+0000ee50: 5f6e 616d 6527 2c20 2776 616c 7565 277d  _name', 'value'}
+0000ee60: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+0000ee70: 7365 7428 6576 616c 2867 726f 7570 732e  set(eval(groups.
+0000ee80: 6772 6f75 7028 3229 2929 203d 3d20 7b27  group(2))) == {'
+0000ee90: 6e6f 745f 6869 6768 5f63 6f6c 756d 6e27  not_high_column'
+0000eea0: 2c20 276e 6f74 5f6c 6f77 5f63 6f6c 756d  , 'not_low_colum
+0000eeb0: 6e27 7d0a 2020 2020 2020 2020 6173 7365  n'}.        asse
+0000eec0: 7274 2073 7472 2865 7661 6c28 6772 6f75  rt str(eval(grou
+0000eed0: 7073 2e67 726f 7570 2833 2929 2920 3d3d  ps.group(3))) ==
+0000eee0: 2027 2b27 0a0a 2020 2020 6465 6620 7465   '+'..    def te
+0000eef0: 7374 5f5f 7661 6c69 6461 7465 5f6d 6574  st__validate_met
+0000ef00: 6164 6174 615f 636f 6c75 6d6e 7328 7365  adata_columns(se
+0000ef10: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+0000ef20: 5465 7374 2074 6865 2060 605f 7661 6c69  Test the ``_vali
+0000ef30: 6461 7465 5f6d 6574 6164 6174 615f 636f  date_metadata_co
+0000ef40: 6c75 6d6e 7360 6020 6d65 7468 6f64 2e0a  lumns`` method..
+0000ef50: 0a20 2020 2020 2020 2041 6c6c 206f 6620  .        All of 
+0000ef60: 7468 6520 636f 6c75 6d6e 7320 7061 7373  the columns pass
+0000ef70: 6564 2069 6e20 636f 6c75 6d6e 5f6e 616d  ed in column_nam
+0000ef80: 6573 2073 686f 756c 6420 6265 2069 6e20  es should be in 
+0000ef90: 7468 6520 6d65 7461 6461 7461 2e0a 0a20  the metadata... 
+0000efa0: 2020 2020 2020 2049 6e70 7574 3a0a 2020         Input:.  
+0000efb0: 2020 2020 2020 2020 2020 2d20 636f 6c75            - colu
+0000efc0: 6d6e 5f6e 616d 6520 7769 7468 2063 6f6c  mn_name with col
+0000efd0: 756d 6e20 7468 6174 2069 7320 696e 2074  umn that is in t
+0000efe0: 6865 206d 6574 6164 6174 612e 0a0a 2020  he metadata...  
+0000eff0: 2020 2020 2020 5369 6465 2065 6666 6563        Side effec
+0000f000: 743a 0a20 2020 2020 2020 2020 2020 202d  t:.            -
+0000f010: 204e 6f20 6572 726f 7220 7368 6f75 6c64   No error should
+0000f020: 2062 6520 7261 6973 6564 2e0a 2020 2020   be raised..    
+0000f030: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0000f040: 2320 5365 7475 700a 2020 2020 2020 2020  # Setup.        
+0000f050: 6d65 7461 6461 7461 203d 204d 6f63 6b28  metadata = Mock(
+0000f060: 290a 2020 2020 2020 2020 6d65 7461 6461  ).        metada
+0000f070: 7461 2e63 6f6c 756d 6e73 203d 207b 2761  ta.columns = {'a
+0000f080: 273a 2031 2c20 2762 273a 2032 7d0a 0a20  ': 1, 'b': 2}.. 
+0000f090: 2020 2020 2020 2023 2052 756e 0a20 2020         # Run.   
+0000f0a0: 2020 2020 2053 6361 6c61 7249 6e65 7175       ScalarInequ
+0000f0b0: 616c 6974 792e 5f76 616c 6964 6174 655f  ality._validate_
+0000f0c0: 6d65 7461 6461 7461 5f63 6f6c 756d 6e73  metadata_columns
+0000f0d0: 286d 6574 6164 6174 612c 2063 6f6c 756d  (metadata, colum
+0000f0e0: 6e5f 6e61 6d65 3d27 6127 290a 0a20 2020  n_name='a')..   
+0000f0f0: 2064 6566 2074 6573 745f 5f76 616c 6964   def test__valid
+0000f100: 6174 655f 6d65 7461 6461 7461 5f63 6f6c  ate_metadata_col
+0000f110: 756d 6e73 5f72 6169 7365 735f 6572 726f  umns_raises_erro
+0000f120: 7228 7365 6c66 293a 0a20 2020 2020 2020  r(self):.       
+0000f130: 2022 2222 5465 7374 2074 6865 2060 605f   """Test the ``_
+0000f140: 7661 6c69 6461 7465 5f6d 6574 6164 6174  validate_metadat
+0000f150: 615f 636f 6c75 6d6e 7360 6020 6d65 7468  a_columns`` meth
+0000f160: 6f64 2773 2065 7272 6f72 2063 6f6e 6469  od's error condi
+0000f170: 7469 6f6e 2e0a 0a20 2020 2020 2020 2049  tion...        I
+0000f180: 6620 7468 6520 636f 6c75 6d6e 5f6e 616d  f the column_nam
+0000f190: 6520 6973 206e 6f74 2069 6e20 7468 6520  e is not in the 
+0000f1a0: 6d65 7461 6461 7461 2c20 616e 2065 7272  metadata, an err
+0000f1b0: 6f72 2073 686f 756c 6420 6265 2072 6169  or should be rai
+0000f1c0: 7365 642e 0a0a 2020 2020 2020 2020 496e  sed...        In
+0000f1d0: 7075 743a 0a20 2020 2020 2020 2020 2020  put:.           
+0000f1e0: 202d 2063 6f6c 756d 6e5f 6e61 6d65 2074   - column_name t
+0000f1f0: 6861 7420 6973 206e 6f74 2069 6e20 7468  hat is not in th
+0000f200: 6520 6d65 7461 6461 7461 2e0a 0a20 2020  e metadata...   
+0000f210: 2020 2020 2053 6964 6520 6566 6665 6374       Side effect
+0000f220: 3a0a 2020 2020 2020 2020 2020 2020 2d20  :.            - 
+0000f230: 436f 6e73 7472 6169 6e74 4d65 7461 6461  ConstraintMetada
+0000f240: 7461 4572 726f 7220 7368 6f75 6c64 2062  taError should b
+0000f250: 6520 7261 6973 6564 2e0a 2020 2020 2020  e raised..      
+0000f260: 2020 2222 220a 2020 2020 2020 2020 2320    """.        # 
+0000f270: 5365 7475 700a 2020 2020 2020 2020 6d65  Setup.        me
+0000f280: 7461 6461 7461 203d 204d 6f63 6b28 290a  tadata = Mock().
+0000f290: 2020 2020 2020 2020 6d65 7461 6461 7461          metadata
+0000f2a0: 2e63 6f6c 756d 6e73 203d 207b 2761 273a  .columns = {'a':
+0000f2b0: 2031 2c20 2762 273a 2032 7d0a 0a20 2020   1, 'b': 2}..   
+0000f2c0: 2020 2020 2023 2052 756e 0a20 2020 2020       # Run.     
+0000f2d0: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
+0000f2e0: 203d 2072 652e 6573 6361 7065 280a 2020   = re.escape(.  
+0000f2f0: 2020 2020 2020 2020 2020 2741 2053 6361            'A Sca
+0000f300: 6c61 7249 6e65 7175 616c 6974 7920 636f  larInequality co
+0000f310: 6e73 7472 6169 6e74 2069 7320 6265 696e  nstraint is bein
+0000f320: 6720 6170 706c 6965 6420 746f 2069 6e76  g applied to inv
+0000f330: 616c 6964 2063 6f6c 756d 6e20 6e61 6d65  alid column name
+0000f340: 7320 270a 2020 2020 2020 2020 2020 2020  s '.            
+0000f350: 227b 2763 277d 2e20 5468 6520 636f 6c75  "{'c'}. The colu
+0000f360: 6d6e 7320 6d75 7374 2065 7869 7374 2069  mns must exist i
+0000f370: 6e20 7468 6520 7461 626c 652e 220a 2020  n the table.".  
+0000f380: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0000f390: 7769 7468 2070 7974 6573 742e 7261 6973  with pytest.rais
+0000f3a0: 6573 2843 6f6e 7374 7261 696e 744d 6574  es(ConstraintMet
+0000f3b0: 6164 6174 6145 7272 6f72 2c20 6d61 7463  adataError, matc
+0000f3c0: 683d 6572 726f 725f 6d65 7373 6167 6529  h=error_message)
+0000f3d0: 3a0a 2020 2020 2020 2020 2020 2020 5363  :.            Sc
+0000f3e0: 616c 6172 496e 6571 7561 6c69 7479 2e5f  alarInequality._
+0000f3f0: 7661 6c69 6461 7465 5f6d 6574 6164 6174  validate_metadat
+0000f400: 615f 636f 6c75 6d6e 7328 6d65 7461 6461  a_columns(metada
+0000f410: 7461 2c20 636f 6c75 6d6e 5f6e 616d 653d  ta, column_name=
+0000f420: 2763 2729 0a0a 2020 2020 6465 6620 7465  'c')..    def te
+0000f430: 7374 5f5f 7661 6c69 6461 7465 5f6d 6574  st__validate_met
+0000f440: 6164 6174 615f 7370 6563 6966 6963 5f74  adata_specific_t
+0000f450: 6f5f 636f 6e73 7472 6169 6e74 5f6e 756d  o_constraint_num
+0000f460: 6572 6963 616c 2873 656c 6629 3a0a 2020  erical(self):.  
+0000f470: 2020 2020 2020 2222 2254 6573 7420 7468        """Test th
+0000f480: 6520 6060 5f76 616c 6964 6174 655f 6d65  e ``_validate_me
+0000f490: 7461 6461 7461 5f73 7065 6369 6669 635f  tadata_specific_
+0000f4a0: 746f 5f63 6f6e 7374 7261 696e 7460 6020  to_constraint`` 
+0000f4b0: 6d65 7468 6f64 2e0a 0a20 2020 2020 2020  method...       
+0000f4c0: 2049 6620 7468 6520 636f 6c75 6d6e 5f6e   If the column_n
+0000f4d0: 616d 6520 6861 7320 616e 2073 6474 7970  ame has an sdtyp
+0000f4e0: 6520 6f66 206e 756d 6572 6963 616c 2c20  e of numerical, 
+0000f4f0: 616e 6420 7468 6520 7661 6c75 650a 2020  and the value.  
+0000f500: 2020 2020 2020 6973 2061 6e20 696e 7420        is an int 
+0000f510: 6f72 2066 6c6f 6174 2c20 7468 656e 206e  or float, then n
+0000f520: 6f20 6572 726f 7220 7368 6f75 6c64 2062  o error should b
+0000f530: 6520 7261 6973 6564 2e0a 0a20 2020 2020  e raised...     
+0000f540: 2020 2053 6574 7570 3a0a 2020 2020 2020     Setup:.      
+0000f550: 2020 2020 2020 2d20 4d65 7461 6461 7461        - Metadata
+0000f560: 2077 6974 6820 7468 6520 7364 7479 7065   with the sdtype
+0000f570: 2073 6574 2074 6f20 6e75 6d65 7269 6361   set to numerica
+0000f580: 6c2e 0a0a 2020 2020 2020 2020 496e 7075  l...        Inpu
+0000f590: 743a 0a20 2020 2020 2020 2020 2020 202d  t:.            -
+0000f5a0: 2054 6865 2063 6f6c 756d 6e20 6e61 6d65   The column name
+0000f5b0: 2061 6e64 2061 2076 616c 7565 2073 6574   and a value set
+0000f5c0: 2074 6f20 6120 6e75 6d62 6572 2e0a 2020   to a number..  
+0000f5d0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0000f5e0: 2020 2320 5365 7475 700a 2020 2020 2020    # Setup.      
+0000f5f0: 2020 6d65 7461 6461 7461 203d 204d 6f63    metadata = Moc
+0000f600: 6b28 290a 2020 2020 2020 2020 6d65 7461  k().        meta
+0000f610: 6461 7461 2e63 6f6c 756d 6e73 203d 207b  data.columns = {
+0000f620: 2761 273a 207b 2773 6474 7970 6527 3a20  'a': {'sdtype': 
+0000f630: 276e 756d 6572 6963 616c 277d 7d0a 0a20  'numerical'}}.. 
+0000f640: 2020 2020 2020 2023 2052 756e 0a20 2020         # Run.   
+0000f650: 2020 2020 2053 6361 6c61 7249 6e65 7175       ScalarInequ
+0000f660: 616c 6974 792e 5f76 616c 6964 6174 655f  ality._validate_
+0000f670: 6d65 7461 6461 7461 5f73 7065 6369 6669  metadata_specifi
+0000f680: 635f 746f 5f63 6f6e 7374 7261 696e 7428  c_to_constraint(
+0000f690: 0a20 2020 2020 2020 2020 2020 206d 6574  .            met
+0000f6a0: 6164 6174 612c 0a20 2020 2020 2020 2020  adata,.         
+0000f6b0: 2020 2063 6f6c 756d 6e5f 6e61 6d65 3d27     column_name='
+0000f6c0: 6127 2c0a 2020 2020 2020 2020 2020 2020  a',.            
+0000f6d0: 7265 6c61 7469 6f6e 3d27 3e27 2c0a 2020  relation='>',.  
+0000f6e0: 2020 2020 2020 2020 2020 7661 6c75 653d            value=
+0000f6f0: 370a 2020 2020 2020 2020 290a 0a20 2020  7.        )..   
+0000f700: 2064 6566 2074 6573 745f 5f76 616c 6964   def test__valid
+0000f710: 6174 655f 6d65 7461 6461 7461 5f73 7065  ate_metadata_spe
+0000f720: 6369 6669 635f 746f 5f63 6f6e 7374 7261  cific_to_constra
+0000f730: 696e 745f 6e75 6d65 7269 6361 6c5f 6572  int_numerical_er
+0000f740: 726f 7228 7365 6c66 293a 0a20 2020 2020  ror(self):.     
+0000f750: 2020 2022 2222 5465 7374 2074 6865 2060     """Test the `
+0000f760: 605f 7661 6c69 6461 7465 5f6d 6574 6164  `_validate_metad
+0000f770: 6174 615f 7370 6563 6966 6963 5f74 6f5f  ata_specific_to_
+0000f780: 636f 6e73 7472 6169 6e74 6060 206d 6574  constraint`` met
+0000f790: 686f 642e 0a0a 2020 2020 2020 2020 4966  hod...        If
+0000f7a0: 2074 6865 2063 6f6c 756d 6e5f 6e61 6d65   the column_name
+0000f7b0: 2068 6173 2061 6e20 7364 7479 7065 206f   has an sdtype o
+0000f7c0: 6620 6e75 6d65 7269 6361 6c2c 2061 6e64  f numerical, and
+0000f7d0: 2074 6865 2076 616c 7565 0a20 2020 2020   the value.     
+0000f7e0: 2020 2069 7320 6e6f 7420 616e 2069 6e74     is not an int
+0000f7f0: 206f 7220 666c 6f61 742c 2074 6865 6e20   or float, then 
+0000f800: 616e 2065 7272 6f72 2073 686f 756c 6420  an error should 
+0000f810: 6265 2072 6169 7365 642e 0a0a 2020 2020  be raised...    
+0000f820: 2020 2020 5365 7475 703a 0a20 2020 2020      Setup:.     
+0000f830: 2020 2020 2020 202d 204d 6574 6164 6174         - Metadat
+0000f840: 6120 7769 7468 2074 6865 2073 6474 7970  a with the sdtyp
+0000f850: 6520 7365 7420 746f 206e 756d 6572 6963  e set to numeric
+0000f860: 616c 2e0a 0a20 2020 2020 2020 2049 6e70  al...        Inp
+0000f870: 7574 3a0a 2020 2020 2020 2020 2020 2020  ut:.            
+0000f880: 2d20 5468 6520 636f 6c75 6d6e 206e 616d  - The column nam
+0000f890: 6520 616e 6420 6120 7661 6c75 6520 7365  e and a value se
+0000f8a0: 7420 746f 2061 2073 7472 696e 672e 0a20  t to a string.. 
+0000f8b0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0000f8c0: 2020 2023 2053 6574 7570 0a20 2020 2020     # Setup.     
+0000f8d0: 2020 206d 6574 6164 6174 6120 3d20 4d6f     metadata = Mo
+0000f8e0: 636b 2829 0a20 2020 2020 2020 206d 6574  ck().        met
+0000f8f0: 6164 6174 612e 636f 6c75 6d6e 7320 3d20  adata.columns = 
+0000f900: 7b27 6127 3a20 7b27 7364 7479 7065 273a  {'a': {'sdtype':
+0000f910: 2027 6e75 6d65 7269 6361 6c27 7d7d 0a0a   'numerical'}}..
+0000f920: 2020 2020 2020 2020 2320 5275 6e0a 2020          # Run.  
+0000f930: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
+0000f940: 6167 6520 3d20 2227 7661 6c75 6527 206d  age = "'value' m
+0000f950: 7573 7420 6265 2061 6e20 696e 7420 6f72  ust be an int or
+0000f960: 2066 6c6f 6174 2e22 0a20 2020 2020 2020   float.".       
+0000f970: 2077 6974 6820 7079 7465 7374 2e72 6169   with pytest.rai
+0000f980: 7365 7328 436f 6e73 7472 6169 6e74 4d65  ses(ConstraintMe
+0000f990: 7461 6461 7461 4572 726f 722c 206d 6174  tadataError, mat
+0000f9a0: 6368 3d65 7272 6f72 5f6d 6573 7361 6765  ch=error_message
+0000f9b0: 293a 0a20 2020 2020 2020 2020 2020 2053  ):.            S
+0000f9c0: 6361 6c61 7249 6e65 7175 616c 6974 792e  calarInequality.
+0000f9d0: 5f76 616c 6964 6174 655f 6d65 7461 6461  _validate_metada
+0000f9e0: 7461 5f73 7065 6369 6669 635f 746f 5f63  ta_specific_to_c
+0000f9f0: 6f6e 7374 7261 696e 7428 0a20 2020 2020  onstraint(.     
+0000fa00: 2020 2020 2020 2020 2020 206d 6574 6164             metad
+0000fa10: 6174 612c 0a20 2020 2020 2020 2020 2020  ata,.           
+0000fa20: 2020 2020 2063 6f6c 756d 6e5f 6e61 6d65       column_name
+0000fa30: 3d27 6127 2c0a 2020 2020 2020 2020 2020  ='a',.          
+0000fa40: 2020 2020 2020 7265 6c61 7469 6f6e 3d27        relation='
+0000fa50: 3e27 2c0a 2020 2020 2020 2020 2020 2020  >',.            
+0000fa60: 2020 2020 7661 6c75 653d 2737 270a 2020      value='7'.  
+0000fa70: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+0000fa80: 2040 7061 7463 6828 2773 6476 2e63 6f6e   @patch('sdv.con
+0000fa90: 7374 7261 696e 7473 2e74 6162 756c 6172  straints.tabular
+0000faa0: 2e6d 6174 6368 6573 5f64 6174 6574 696d  .matches_datetim
+0000fab0: 655f 666f 726d 6174 2729 0a20 2020 2064  e_format').    d
+0000fac0: 6566 2074 6573 745f 5f76 616c 6964 6174  ef test__validat
+0000fad0: 655f 6d65 7461 6461 7461 5f73 7065 6369  e_metadata_speci
+0000fae0: 6669 635f 746f 5f63 6f6e 7374 7261 696e  fic_to_constrain
+0000faf0: 745f 6461 7465 7469 6d65 2873 656c 662c  t_datetime(self,
+0000fb00: 2064 6174 6574 696d 655f 666f 726d 6174   datetime_format
+0000fb10: 5f6d 6f63 6b29 3a0a 2020 2020 2020 2020  _mock):.        
+0000fb20: 2222 2254 6573 7420 7468 6520 6060 5f76  """Test the ``_v
+0000fb30: 616c 6964 6174 655f 6d65 7461 6461 7461  alidate_metadata
+0000fb40: 5f73 7065 6369 6669 635f 746f 5f63 6f6e  _specific_to_con
+0000fb50: 7374 7261 696e 7460 6020 6d65 7468 6f64  straint`` method
+0000fb60: 2e0a 0a20 2020 2020 2020 2049 6620 7468  ...        If th
+0000fb70: 6520 636f 6c75 6d6e 5f6e 616d 6520 6861  e column_name ha
+0000fb80: 7320 616e 2073 6474 7970 6520 6f66 2064  s an sdtype of d
+0000fb90: 6174 6574 696d 652c 2061 6e64 2074 6865  atetime, and the
+0000fba0: 2076 616c 7565 0a20 2020 2020 2020 2069   value.        i
+0000fbb0: 7320 6120 6461 7465 7469 6d65 2073 7472  s a datetime str
+0000fbc0: 696e 6720 7468 6174 206d 6174 6368 6573  ing that matches
+0000fbd0: 2074 6865 2066 6f72 6d61 742c 2074 6865   the format, the
+0000fbe0: 6e20 6e6f 2065 7272 6f72 2073 686f 756c  n no error shoul
+0000fbf0: 6420 6265 2072 6169 7365 642e 0a0a 2020  d be raised...  
+0000fc00: 2020 2020 2020 5365 7475 703a 0a20 2020        Setup:.   
+0000fc10: 2020 2020 2020 2020 202d 204d 6574 6164           - Metad
+0000fc20: 6174 6120 7769 7468 2074 6865 2073 6474  ata with the sdt
+0000fc30: 7970 6520 7365 7420 746f 2064 6174 6574  ype set to datet
+0000fc40: 696d 6520 616e 6420 6120 6461 7465 7469  ime and a dateti
+0000fc50: 6d65 5f66 6f72 6d61 742e 0a20 2020 2020  me_format..     
+0000fc60: 2020 2020 2020 202d 204d 6f63 6b20 7468         - Mock th
+0000fc70: 6520 6060 6d61 7463 6865 735f 6461 7465  e ``matches_date
+0000fc80: 7469 6d65 5f66 6f72 6d61 7460 6020 6675  time_format`` fu
+0000fc90: 6e63 7469 6f6e 2074 6f20 7265 7475 726e  nction to return
+0000fca0: 2054 7275 652e 0a0a 2020 2020 2020 2020   True...        
+0000fcb0: 496e 7075 743a 0a20 2020 2020 2020 2020  Input:.         
+0000fcc0: 2020 202d 2054 6865 2063 6f6c 756d 6e20     - The column 
+0000fcd0: 6e61 6d65 2061 6e64 2061 2076 616c 7565  name and a value
+0000fce0: 2073 6574 2074 6f20 6120 6461 7465 7469   set to a dateti
+0000fcf0: 6d65 206f 6620 7468 6520 7269 6768 7420  me of the right 
+0000fd00: 666f 726d 6174 2e0a 2020 2020 2020 2020  format..        
+0000fd10: 2222 220a 2020 2020 2020 2020 2320 5365  """.        # Se
+0000fd20: 7475 700a 2020 2020 2020 2020 6d65 7461  tup.        meta
+0000fd30: 6461 7461 203d 204d 6f63 6b28 290a 2020  data = Mock().  
+0000fd40: 2020 2020 2020 6d65 7461 6461 7461 2e63        metadata.c
+0000fd50: 6f6c 756d 6e73 203d 207b 2761 273a 207b  olumns = {'a': {
+0000fd60: 2773 6474 7970 6527 3a20 2764 6174 6574  'sdtype': 'datet
+0000fd70: 696d 6527 2c20 2764 6174 6574 696d 655f  ime', 'datetime_
+0000fd80: 666f 726d 6174 273a 2027 6d2f 642f 7927  format': 'm/d/y'
+0000fd90: 7d7d 0a20 2020 2020 2020 2064 6174 6574  }}.        datet
+0000fda0: 696d 655f 666f 726d 6174 5f6d 6f63 6b2e  ime_format_mock.
+0000fdb0: 7265 7475 726e 5f76 616c 7565 203d 2054  return_value = T
+0000fdc0: 7275 650a 0a20 2020 2020 2020 2023 2052  rue..        # R
+0000fdd0: 756e 0a20 2020 2020 2020 2053 6361 6c61  un.        Scala
+0000fde0: 7249 6e65 7175 616c 6974 792e 5f76 616c  rInequality._val
+0000fdf0: 6964 6174 655f 6d65 7461 6461 7461 5f73  idate_metadata_s
+0000fe00: 7065 6369 6669 635f 746f 5f63 6f6e 7374  pecific_to_const
+0000fe10: 7261 696e 7428 0a20 2020 2020 2020 2020  raint(.         
+0000fe20: 2020 206d 6574 6164 6174 612c 0a20 2020     metadata,.   
+0000fe30: 2020 2020 2020 2020 2063 6f6c 756d 6e5f           column_
+0000fe40: 6e61 6d65 3d27 6127 2c0a 2020 2020 2020  name='a',.      
+0000fe50: 2020 2020 2020 7265 6c61 7469 6f6e 3d27        relation='
+0000fe60: 3e27 2c0a 2020 2020 2020 2020 2020 2020  >',.            
+0000fe70: 7661 6c75 653d 2731 2f31 2f32 3032 3027  value='1/1/2020'
+0000fe80: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+0000fe90: 4070 6174 6368 2827 7364 762e 636f 6e73  @patch('sdv.cons
+0000fea0: 7472 6169 6e74 732e 7461 6275 6c61 722e  traints.tabular.
+0000feb0: 6d61 7463 6865 735f 6461 7465 7469 6d65  matches_datetime
+0000fec0: 5f66 6f72 6d61 7427 290a 2020 2020 6465  _format').    de
+0000fed0: 6620 7465 7374 5f5f 7661 6c69 6461 7465  f test__validate
+0000fee0: 5f6d 6574 6164 6174 615f 7370 6563 6966  _metadata_specif
+0000fef0: 6963 5f74 6f5f 636f 6e73 7472 6169 6e74  ic_to_constraint
+0000ff00: 5f64 6174 6574 696d 655f 6572 726f 7228  _datetime_error(
+0000ff10: 7365 6c66 2c20 6461 7465 7469 6d65 5f66  self, datetime_f
+0000ff20: 6f72 6d61 745f 6d6f 636b 293a 0a20 2020  ormat_mock):.   
+0000ff30: 2020 2020 2022 2222 5465 7374 2074 6865       """Test the
+0000ff40: 2060 605f 7661 6c69 6461 7465 5f6d 6574   ``_validate_met
+0000ff50: 6164 6174 615f 7370 6563 6966 6963 5f74  adata_specific_t
+0000ff60: 6f5f 636f 6e73 7472 6169 6e74 6060 206d  o_constraint`` m
+0000ff70: 6574 686f 642e 0a0a 2020 2020 2020 2020  ethod...        
+0000ff80: 4966 2074 6865 2063 6f6c 756d 6e5f 6e61  If the column_na
+0000ff90: 6d65 2068 6173 2061 6e20 7364 7479 7065  me has an sdtype
+0000ffa0: 206f 6620 6461 7465 7469 6d65 2c20 616e   of datetime, an
+0000ffb0: 6420 7468 6520 7661 6c75 650a 2020 2020  d the value.    
+0000ffc0: 2020 2020 6973 2061 2064 6174 6574 696d      is a datetim
+0000ffd0: 6520 7374 7269 6e67 2074 6861 7420 646f  e string that do
+0000ffe0: 6573 6e27 7420 6d61 7463 6820 7468 6520  esn't match the 
+0000fff0: 666f 726d 6174 2c20 7468 656e 2061 6e20  format, then an 
+00010000: 6572 726f 7220 7368 6f75 6c64 2062 6520  error should be 
+00010010: 7261 6973 6564 2e0a 0a20 2020 2020 2020  raised...       
+00010020: 2053 6574 7570 3a0a 2020 2020 2020 2020   Setup:.        
+00010030: 2020 2020 2d20 4d65 7461 6461 7461 2077      - Metadata w
+00010040: 6974 6820 7468 6520 7364 7479 7065 2073  ith the sdtype s
+00010050: 6574 2074 6f20 6461 7465 7469 6d65 2061  et to datetime a
+00010060: 6e64 2061 2064 6174 6574 696d 655f 666f  nd a datetime_fo
+00010070: 726d 6174 2e0a 2020 2020 2020 2020 2020  rmat..          
+00010080: 2020 2d20 4d6f 636b 2074 6865 2060 606d    - Mock the ``m
+00010090: 6174 6368 6573 5f64 6174 6574 696d 655f  atches_datetime_
+000100a0: 666f 726d 6174 6060 2066 756e 6374 696f  format`` functio
+000100b0: 6e20 746f 2072 6574 7572 6e20 4661 6c73  n to return Fals
+000100c0: 652e 0a0a 2020 2020 2020 2020 496e 7075  e...        Inpu
+000100d0: 743a 0a20 2020 2020 2020 2020 2020 202d  t:.            -
+000100e0: 2054 6865 2063 6f6c 756d 6e20 6e61 6d65   The column name
+000100f0: 2061 6e64 2061 2076 616c 7565 2073 6574   and a value set
+00010100: 2074 6f20 6120 6461 7465 7469 6d65 206f   to a datetime o
+00010110: 6620 7468 6520 7772 6f6e 6720 666f 726d  f the wrong form
+00010120: 6174 2e0a 0a20 2020 2020 2020 2053 6964  at...        Sid
+00010130: 6520 6566 6665 6374 3a0a 2020 2020 2020  e effect:.      
+00010140: 2020 2020 2020 2d20 4120 436f 6e73 7472        - A Constr
+00010150: 6169 6e74 4d65 7461 6461 7461 4572 726f  aintMetadataErro
+00010160: 7220 7368 6f75 6c64 2062 6520 7261 6973  r should be rais
+00010170: 6564 2e0a 2020 2020 2020 2020 2222 220a  ed..        """.
+00010180: 2020 2020 2020 2020 2320 5365 7475 700a          # Setup.
+00010190: 2020 2020 2020 2020 6d65 7461 6461 7461          metadata
+000101a0: 203d 204d 6f63 6b28 290a 2020 2020 2020   = Mock().      
+000101b0: 2020 6d65 7461 6461 7461 2e63 6f6c 756d    metadata.colum
+000101c0: 6e73 203d 207b 2761 273a 207b 2773 6474  ns = {'a': {'sdt
+000101d0: 7970 6527 3a20 2764 6174 6574 696d 6527  ype': 'datetime'
+000101e0: 2c20 2764 6174 6574 696d 655f 666f 726d  , 'datetime_form
+000101f0: 6174 273a 2027 6d2f 642f 7927 7d7d 0a20  at': 'm/d/y'}}. 
+00010200: 2020 2020 2020 2064 6174 6574 696d 655f         datetime_
+00010210: 666f 726d 6174 5f6d 6f63 6b2e 7265 7475  format_mock.retu
+00010220: 726e 5f76 616c 7565 203d 2046 616c 7365  rn_value = False
+00010230: 0a0a 2020 2020 2020 2020 2320 5275 6e0a  ..        # Run.
+00010240: 2020 2020 2020 2020 6572 726f 725f 6d65          error_me
+00010250: 7373 6167 6520 3d20 2227 7661 6c75 6527  ssage = "'value'
+00010260: 206d 7573 7420 6265 2061 2064 6174 6574   must be a datet
+00010270: 696d 6520 7374 7269 6e67 206f 6620 7468  ime string of th
+00010280: 6520 7269 6768 7420 666f 726d 6174 220a  e right format".
+00010290: 2020 2020 2020 2020 7769 7468 2070 7974          with pyt
+000102a0: 6573 742e 7261 6973 6573 2843 6f6e 7374  est.raises(Const
+000102b0: 7261 696e 744d 6574 6164 6174 6145 7272  raintMetadataErr
+000102c0: 6f72 2c20 6d61 7463 683d 6572 726f 725f  or, match=error_
+000102d0: 6d65 7373 6167 6529 3a0a 2020 2020 2020  message):.      
+000102e0: 2020 2020 2020 5363 616c 6172 496e 6571        ScalarIneq
+000102f0: 7561 6c69 7479 2e5f 7661 6c69 6461 7465  uality._validate
+00010300: 5f6d 6574 6164 6174 615f 7370 6563 6966  _metadata_specif
+00010310: 6963 5f74 6f5f 636f 6e73 7472 6169 6e74  ic_to_constraint
+00010320: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00010330: 2020 6d65 7461 6461 7461 2c0a 2020 2020    metadata,.    
+00010340: 2020 2020 2020 2020 2020 2020 636f 6c75              colu
+00010350: 6d6e 5f6e 616d 653d 2761 272c 0a20 2020  mn_name='a',.   
+00010360: 2020 2020 2020 2020 2020 2020 2072 656c               rel
+00010370: 6174 696f 6e3d 273e 272c 0a20 2020 2020  ation='>',.     
+00010380: 2020 2020 2020 2020 2020 2076 616c 7565             value
+00010390: 3d27 312d 312d 3230 3230 270a 2020 2020  ='1-1-2020'.    
+000103a0: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
+000103b0: 6566 2074 6573 745f 5f76 616c 6964 6174  ef test__validat
+000103c0: 655f 6d65 7461 6461 7461 5f73 7065 6369  e_metadata_speci
+000103d0: 6669 635f 746f 5f63 6f6e 7374 7261 696e  fic_to_constrain
+000103e0: 745f 6261 645f 7479 7065 2873 656c 6629  t_bad_type(self)
+000103f0: 3a0a 2020 2020 2020 2020 2222 2254 6573  :.        """Tes
+00010400: 7420 7468 6520 6060 5f76 616c 6964 6174  t the ``_validat
+00010410: 655f 6d65 7461 6461 7461 5f73 7065 6369  e_metadata_speci
+00010420: 6669 635f 746f 5f63 6f6e 7374 7261 696e  fic_to_constrain
+00010430: 7460 6020 6d65 7468 6f64 2e0a 0a20 2020  t`` method...   
+00010440: 2020 2020 2049 6620 7468 6520 636f 6c75       If the colu
+00010450: 6d6e 5f6e 616d 6520 6861 7320 616e 2073  mn_name has an s
+00010460: 6474 7970 6520 7468 6174 2069 7320 6e6f  dtype that is no
+00010470: 7420 6120 6461 7465 7469 6d65 2073 7472  t a datetime str
+00010480: 696e 672c 2069 6e74 206f 720a 2020 2020  ing, int or.    
+00010490: 2020 2020 666c 6f61 7420 7468 656e 2061      float then a
+000104a0: 6e20 6572 726f 7220 7368 6f75 6c64 2062  n error should b
+000104b0: 6520 7261 6973 6564 2e0a 0a20 2020 2020  e raised...     
+000104c0: 2020 2053 6574 7570 3a0a 2020 2020 2020     Setup:.      
+000104d0: 2020 2020 2020 2d20 4d65 7461 6461 7461        - Metadata
+000104e0: 2077 6974 6820 7468 6520 7364 7479 7065   with the sdtype
+000104f0: 2073 6574 2074 6f20 6361 7465 676f 7269   set to categori
+00010500: 6361 6c2e 0a0a 2020 2020 2020 2020 496e  cal...        In
+00010510: 7075 743a 0a20 2020 2020 2020 2020 2020  put:.           
+00010520: 202d 2054 6865 2063 6f6c 756d 6e20 6e61   - The column na
+00010530: 6d65 2c20 7265 6c61 7469 6f6e 2061 6e64  me, relation and
+00010540: 2076 616c 7565 2e0a 0a20 2020 2020 2020   value...       
+00010550: 2053 6964 6520 6566 6665 6374 3a0a 2020   Side effect:.  
+00010560: 2020 2020 2020 2020 2020 2d20 4120 436f            - A Co
+00010570: 6e73 7472 6169 6e74 4d65 7461 6461 7461  nstraintMetadata
+00010580: 4572 726f 7220 7368 6f75 6c64 2062 6520  Error should be 
+00010590: 7261 6973 6564 2e0a 2020 2020 2020 2020  raised..        
+000105a0: 2222 220a 2020 2020 2020 2020 2320 5365  """.        # Se
+000105b0: 7475 700a 2020 2020 2020 2020 6d65 7461  tup.        meta
+000105c0: 6461 7461 203d 204d 6f63 6b28 290a 2020  data = Mock().  
+000105d0: 2020 2020 2020 6d65 7461 6461 7461 2e63        metadata.c
+000105e0: 6f6c 756d 6e73 203d 207b 2761 273a 207b  olumns = {'a': {
+000105f0: 2773 6474 7970 6527 3a20 2763 6174 6567  'sdtype': 'categ
+00010600: 6f72 6963 616c 277d 7d0a 0a20 2020 2020  orical'}}..     
+00010610: 2020 2023 2052 756e 0a20 2020 2020 2020     # Run.       
+00010620: 2065 7272 6f72 5f6d 6573 7361 6765 203d   error_message =
+00010630: 2028 0a20 2020 2020 2020 2020 2020 2027   (.            '
+00010640: 4120 5363 616c 6172 496e 6571 7561 6c69  A ScalarInequali
+00010650: 7479 2063 6f6e 7374 7261 696e 7420 6973  ty constraint is
+00010660: 2062 6569 6e67 2061 7070 6c69 6564 2074   being applied t
+00010670: 6f20 636f 6c75 6d6e 7320 7769 7468 206d  o columns with m
+00010680: 6973 6d61 7463 6865 6420 7364 7479 7065  ismatched sdtype
+00010690: 732e 2027 0a20 2020 2020 2020 2020 2020  s. '.           
+000106a0: 2027 4e75 6d65 7269 6361 6c20 636f 6c75   'Numerical colu
+000106b0: 6d6e 7320 6d75 7374 2062 6520 636f 6d70  mns must be comp
+000106c0: 6172 6564 2074 6f20 696e 7465 6765 7220  ared to integer 
+000106d0: 6f72 2066 6c6f 6174 2076 616c 7565 732e  or float values.
+000106e0: 2027 0a20 2020 2020 2020 2020 2020 2027   '.            '
+000106f0: 4461 7465 7469 6d65 7320 636f 6c75 6d6e  Datetimes column
+00010700: 206d 7573 7420 6265 2063 6f6d 7061 7265   must be compare
+00010710: 6420 746f 2064 6174 6574 696d 6520 7374  d to datetime st
+00010720: 7269 6e67 732e 270a 2020 2020 2020 2020  rings.'.        
+00010730: 290a 2020 2020 2020 2020 7769 7468 2070  ).        with p
+00010740: 7974 6573 742e 7261 6973 6573 2843 6f6e  ytest.raises(Con
+00010750: 7374 7261 696e 744d 6574 6164 6174 6145  straintMetadataE
+00010760: 7272 6f72 2c20 6d61 7463 683d 6572 726f  rror, match=erro
+00010770: 725f 6d65 7373 6167 6529 3a0a 2020 2020  r_message):.    
+00010780: 2020 2020 2020 2020 5363 616c 6172 496e          ScalarIn
+00010790: 6571 7561 6c69 7479 2e5f 7661 6c69 6461  equality._valida
+000107a0: 7465 5f6d 6574 6164 6174 615f 7370 6563  te_metadata_spec
+000107b0: 6966 6963 5f74 6f5f 636f 6e73 7472 6169  ific_to_constrai
+000107c0: 6e74 280a 2020 2020 2020 2020 2020 2020  nt(.            
+000107d0: 2020 2020 6d65 7461 6461 7461 2c0a 2020      metadata,.  
+000107e0: 2020 2020 2020 2020 2020 2020 2020 636f                co
+000107f0: 6c75 6d6e 5f6e 616d 653d 2761 272c 0a20  lumn_name='a',. 
+00010800: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00010810: 656c 6174 696f 6e3d 273e 272c 0a20 2020  elation='>',.   
+00010820: 2020 2020 2020 2020 2020 2020 2076 616c               val
+00010830: 7565 3d37 0a20 2020 2020 2020 2020 2020  ue=7.           
+00010840: 2029 0a0a 2020 2020 6465 6620 7465 7374   )..    def test
+00010850: 5f5f 7661 6c69 6461 7465 5f69 6e69 745f  __validate_init_
+00010860: 696e 7075 7473 5f69 6e63 6f72 7265 6374  inputs_incorrect
+00010870: 5f63 6f6c 756d 6e28 7365 6c66 293a 0a20  _column(self):. 
+00010880: 2020 2020 2020 2022 2222 5465 7374 2074         """Test t
+00010890: 6865 2060 605f 7661 6c69 6461 7465 5f69  he ``_validate_i
+000108a0: 6e69 745f 696e 7075 7473 6060 206d 6574  nit_inputs`` met
+000108b0: 686f 642e 0a0a 2020 2020 2020 2020 456e  hod...        En
+000108c0: 7375 7265 2074 6865 206d 6574 686f 6420  sure the method 
+000108d0: 7261 6973 6573 2061 6e20 6572 726f 7220  raises an error 
+000108e0: 7768 656e 2074 6865 2063 6f6c 756d 6e20  when the column 
+000108f0: 6e61 6d65 2069 7320 6e6f 7420 6120 7374  name is not a st
+00010900: 7269 6e67 2e0a 0a20 2020 2020 2020 2049  ring...        I
+00010910: 6e70 7574 3a0a 2020 2020 2020 2020 2d20  nput:.        - 
+00010920: 6120 6e6f 6e2d 7374 7269 6e67 0a20 2020  a non-string.   
+00010930: 2020 2020 202d 2061 206e 756d 6265 720a       - a number.
+00010940: 2020 2020 2020 2020 2d20 616e 2069 6e65          - an ine
+00010950: 7175 616c 6974 790a 2020 2020 2020 2020  quality.        
+00010960: 5369 6465 2065 6666 6563 743a 0a20 2020  Side effect:.   
+00010970: 2020 2020 202d 2052 6169 7365 2060 6056       - Raise ``V
+00010980: 616c 7565 4572 726f 7260 6020 6265 6361  alueError`` beca
+00010990: 7573 6520 7468 6520 636f 6c75 6d6e 206e  use the column n
+000109a0: 616d 6520 6d75 7374 2062 6520 6120 7374  ame must be a st
+000109b0: 7269 6e67 0a20 2020 2020 2020 2022 2222  ring.        """
+000109c0: 0a20 2020 2020 2020 2023 2052 756e 202f  .        # Run /
+000109d0: 2041 7373 6572 740a 2020 2020 2020 2020   Assert.        
+000109e0: 6572 725f 6d73 6720 3d20 2760 636f 6c75  err_msg = '`colu
+000109f0: 6d6e 5f6e 616d 6560 206d 7573 7420 6265  mn_name` must be
+00010a00: 2061 2073 7472 696e 672e 270a 2020 2020   a string.'.    
+00010a10: 2020 2020 7769 7468 2070 7974 6573 742e      with pytest.
+00010a20: 7261 6973 6573 2856 616c 7565 4572 726f  raises(ValueErro
+00010a30: 722c 206d 6174 6368 3d65 7272 5f6d 7367  r, match=err_msg
+00010a40: 293a 0a20 2020 2020 2020 2020 2020 2053  ):.            S
+00010a50: 6361 6c61 7249 6e65 7175 616c 6974 792e  calarInequality.
+00010a60: 5f76 616c 6964 6174 655f 696e 6974 5f69  _validate_init_i
+00010a70: 6e70 7574 7328 636f 6c75 6d6e 5f6e 616d  nputs(column_nam
+00010a80: 653d 5b27 6127 5d2c 2076 616c 7565 3d31  e=['a'], value=1
+00010a90: 2c20 7265 6c61 7469 6f6e 3d27 3e27 290a  , relation='>').
+00010aa0: 0a20 2020 2064 6566 2074 6573 745f 5f76  .    def test__v
+00010ab0: 616c 6964 6174 655f 696e 6974 5f69 6e70  alidate_init_inp
+00010ac0: 7574 735f 696e 636f 7272 6563 745f 7661  uts_incorrect_va
+00010ad0: 6c75 655f 6461 7465 7469 6d65 2873 656c  lue_datetime(sel
+00010ae0: 6629 3a0a 2020 2020 2020 2020 2222 2254  f):.        """T
+00010af0: 6573 7420 7468 6520 6060 5f76 616c 6964  est the ``_valid
+00010b00: 6174 655f 696e 6974 5f69 6e70 7574 7360  ate_init_inputs`
+00010b10: 6020 6d65 7468 6f64 2e0a 0a20 2020 2020  ` method...     
+00010b20: 2020 2045 6e73 7572 6520 7468 6520 6d65     Ensure the me
+00010b30: 7468 6f64 2072 6169 7365 7320 616e 2065  thod raises an e
+00010b40: 7272 6f72 2077 6865 6e20 7468 6520 6060  rror when the ``
+00010b50: 7661 6c75 6560 6020 6973 206e 6f74 2061  value`` is not a
+00010b60: 2060 6044 6174 6574 696d 6560 6020 7265   ``Datetime`` re
+00010b70: 7072 6573 656e 7465 640a 2020 2020 2020  presented.      
+00010b80: 2020 6173 2073 7472 696e 672e 0a0a 2020    as string...  
+00010b90: 2020 2020 2020 496e 7075 743a 0a20 2020        Input:.   
+00010ba0: 2020 2020 202d 2061 2073 7472 696e 670a       - a string.
+00010bb0: 2020 2020 2020 2020 2d20 6120 6e6f 6e20          - a non 
+00010bc0: 7374 7269 6e67 2064 6174 6574 696d 650a  string datetime.
+00010bd0: 2020 2020 2020 2020 2d20 616e 2069 6e65          - an ine
+00010be0: 7175 616c 6974 790a 2020 2020 2020 2020  quality.        
+00010bf0: 5369 6465 2065 6666 6563 743a 0a20 2020  Side effect:.   
+00010c00: 2020 2020 202d 2052 6169 7365 2060 6056       - Raise ``V
+00010c10: 616c 7565 4572 726f 7260 6020 6265 6361  alueError`` beca
+00010c20: 7573 6520 7468 6520 6461 7465 7469 6d65  use the datetime
+00010c30: 2068 6173 2074 6f20 6265 2072 6570 7265   has to be repre
+00010c40: 7365 6e74 6564 2061 7320 6120 7374 7269  sented as a stri
+00010c50: 6e67 2e0a 2020 2020 2020 2020 2222 220a  ng..        """.
+00010c60: 2020 2020 2020 2020 2320 5275 6e20 2f20          # Run / 
+00010c70: 4173 7365 7274 0a20 2020 2020 2020 2076  Assert.        v
+00010c80: 616c 7565 203d 2070 642e 746f 5f64 6174  alue = pd.to_dat
+00010c90: 6574 696d 6528 2732 3032 312d 3032 2d30  etime('2021-02-0
+00010ca0: 3127 290a 2020 2020 2020 2020 6572 725f  1').        err_
+00010cb0: 6d73 6720 3d20 2744 6174 6574 696d 6520  msg = 'Datetime 
+00010cc0: 6d75 7374 2062 6520 7265 7072 6573 656e  must be represen
+00010cd0: 7465 6420 6173 2061 2073 7472 696e 672e  ted as a string.
+00010ce0: 270a 2020 2020 2020 2020 7769 7468 2070  '.        with p
+00010cf0: 7974 6573 742e 7261 6973 6573 2856 616c  ytest.raises(Val
+00010d00: 7565 4572 726f 722c 206d 6174 6368 3d65  ueError, match=e
+00010d10: 7272 5f6d 7367 293a 0a20 2020 2020 2020  rr_msg):.       
+00010d20: 2020 2020 2053 6361 6c61 7249 6e65 7175       ScalarInequ
+00010d30: 616c 6974 792e 5f76 616c 6964 6174 655f  ality._validate_
+00010d40: 696e 6974 5f69 6e70 7574 7328 636f 6c75  init_inputs(colu
+00010d50: 6d6e 5f6e 616d 653d 2761 272c 2076 616c  mn_name='a', val
+00010d60: 7565 3d76 616c 7565 2c20 7265 6c61 7469  ue=value, relati
+00010d70: 6f6e 3d27 3e27 290a 0a20 2020 2064 6566  on='>')..    def
+00010d80: 2074 6573 745f 5f76 616c 6964 6174 655f   test__validate_
+00010d90: 696e 6974 5f69 6e70 7574 735f 696e 636f  init_inputs_inco
+00010da0: 7272 6563 745f 7661 6c75 6528 7365 6c66  rrect_value(self
+00010db0: 293a 0a20 2020 2020 2020 2022 2222 5465  ):.        """Te
+00010dc0: 7374 2074 6865 2060 605f 7661 6c69 6461  st the ``_valida
+00010dd0: 7465 5f69 6e69 745f 696e 7075 7473 6060  te_init_inputs``
+00010de0: 206d 6574 686f 642e 0a0a 2020 2020 2020   method...      
+00010df0: 2020 456e 7375 7265 2074 6865 206d 6574    Ensure the met
+00010e00: 686f 6420 7261 6973 6573 2061 6e20 6572  hod raises an er
+00010e10: 726f 7220 7768 656e 2074 6865 2076 616c  ror when the val
+00010e20: 7565 2069 7320 6e6f 7420 6e75 6d65 7269  ue is not numeri
+00010e30: 6361 6c2e 0a0a 2020 2020 2020 2020 496e  cal...        In
+00010e40: 7075 743a 0a20 2020 2020 2020 202d 2061  put:.        - a
+00010e50: 2073 7472 696e 670a 2020 2020 2020 2020   string.        
+00010e60: 2d20 6120 6e6f 6e2d 6e75 6d62 6572 0a20  - a non-number. 
+00010e70: 2020 2020 2020 202d 2061 6e20 696e 6571         - an ineq
+00010e80: 7561 6c69 7479 0a20 2020 2020 2020 2053  uality.        S
+00010e90: 6964 6520 6566 6665 6374 3a0a 2020 2020  ide effect:.    
+00010ea0: 2020 2020 2d20 5261 6973 6520 6060 5661      - Raise ``Va
+00010eb0: 6c75 6545 7272 6f72 6060 2062 6563 6175  lueError`` becau
+00010ec0: 7365 2074 6865 2076 616c 7565 206d 7573  se the value mus
+00010ed0: 7420 6265 2061 206e 756d 6572 6963 616c  t be a numerical
+00010ee0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00010ef0: 2020 2020 2023 2052 756e 202f 2041 7373       # Run / Ass
+00010f00: 6572 740a 2020 2020 2020 2020 6572 725f  ert.        err_
+00010f10: 6d73 6720 3d20 2760 7661 6c75 6560 206d  msg = '`value` m
+00010f20: 7573 7420 6265 2061 206e 756d 6265 7220  ust be a number 
+00010f30: 6f72 2061 2073 7472 696e 6720 7468 6174  or a string that
+00010f40: 2072 6570 7265 7365 6e74 7320 6120 6461   represents a da
+00010f50: 7465 7469 6d65 2e27 0a20 2020 2020 2020  tetime.'.       
+00010f60: 2077 6974 6820 7079 7465 7374 2e72 6169   with pytest.rai
+00010f70: 7365 7328 5661 6c75 6545 7272 6f72 2c20  ses(ValueError, 
+00010f80: 6d61 7463 683d 6572 725f 6d73 6729 3a0a  match=err_msg):.
+00010f90: 2020 2020 2020 2020 2020 2020 5363 616c              Scal
+00010fa0: 6172 496e 6571 7561 6c69 7479 2e5f 7661  arInequality._va
+00010fb0: 6c69 6461 7465 5f69 6e69 745f 696e 7075  lidate_init_inpu
+00010fc0: 7473 2863 6f6c 756d 6e5f 6e61 6d65 3d27  ts(column_name='
+00010fd0: 6127 2c20 7661 6c75 653d 2762 272c 2072  a', value='b', r
+00010fe0: 656c 6174 696f 6e3d 273e 2729 0a0a 2020  elation='>')..  
+00010ff0: 2020 6465 6620 7465 7374 5f5f 7661 6c69    def test__vali
+00011000: 6461 7465 5f69 6e69 745f 696e 7075 7473  date_init_inputs
+00011010: 5f69 6e63 6f72 7265 6374 5f72 656c 6174  _incorrect_relat
+00011020: 696f 6e28 7365 6c66 293a 0a20 2020 2020  ion(self):.     
+00011030: 2020 2022 2222 5465 7374 2074 6865 2060     """Test the `
+00011040: 605f 7661 6c69 6461 7465 5f69 6e69 745f  `_validate_init_
+00011050: 696e 7075 7473 6060 206d 6574 686f 642e  inputs`` method.
+00011060: 0a0a 2020 2020 2020 2020 5261 6973 6520  ..        Raise 
+00011070: 616e 2065 7272 6f72 2077 6865 6e20 7468  an error when th
+00011080: 6520 7265 6c61 7469 6f6e 2069 7320 6e6f  e relation is no
+00011090: 7420 7661 6c69 642e 0a0a 2020 2020 2020  t valid...      
+000110a0: 2020 496e 7075 743a 0a20 2020 2020 2020    Input:.       
+000110b0: 202d 2061 2073 7472 696e 670a 2020 2020   - a string.    
+000110c0: 2020 2020 2d20 6120 6e75 6d62 6572 0a20      - a number. 
+000110d0: 2020 2020 2020 202d 2061 206e 6f6e 2d69         - a non-i
+000110e0: 6e65 7175 616c 6974 790a 2020 2020 2020  nequality.      
+000110f0: 2020 5369 6465 2065 6666 6563 743a 0a20    Side effect:. 
+00011100: 2020 2020 2020 202d 2052 6169 7365 2060         - Raise `
+00011110: 6056 616c 7565 4572 726f 7260 6020 6265  `ValueError`` be
+00011120: 6361 7573 6520 7468 6520 7265 6c61 7469  cause the relati
+00011130: 6f6e 206d 7573 7420 6265 2061 6e20 696e  on must be an in
+00011140: 6571 7561 6c69 7479 0a20 2020 2020 2020  equality.       
+00011150: 2022 2222 0a20 2020 2020 2020 2023 2052   """.        # R
+00011160: 756e 202f 2041 7373 6572 740a 2020 2020  un / Assert.    
+00011170: 2020 2020 6572 725f 6d73 6720 3d20 2760      err_msg = '`
+00011180: 7265 6c61 7469 6f6e 6020 6d75 7374 2062  relation` must b
+00011190: 6520 6f6e 6520 6f66 2074 6865 2066 6f6c  e one of the fol
+000111a0: 6c6f 7769 6e67 3a20 603e 602c 2060 3e3d  lowing: `>`, `>=
+000111b0: 602c 2060 3c60 2c20 603c 3d60 270a 2020  `, `<`, `<=`'.  
+000111c0: 2020 2020 2020 7769 7468 2070 7974 6573        with pytes
+000111d0: 742e 7261 6973 6573 2856 616c 7565 4572  t.raises(ValueEr
+000111e0: 726f 722c 206d 6174 6368 3d65 7272 5f6d  ror, match=err_m
+000111f0: 7367 293a 0a20 2020 2020 2020 2020 2020  sg):.           
+00011200: 2053 6361 6c61 7249 6e65 7175 616c 6974   ScalarInequalit
+00011210: 792e 5f76 616c 6964 6174 655f 696e 6974  y._validate_init
+00011220: 5f69 6e70 7574 7328 636f 6c75 6d6e 5f6e  _inputs(column_n
+00011230: 616d 653d 2761 272c 2076 616c 7565 3d31  ame='a', value=1
+00011240: 2c20 7265 6c61 7469 6f6e 3d27 3d27 290a  , relation='=').
+00011250: 0a20 2020 2040 7061 7463 6828 2773 6476  .    @patch('sdv
+00011260: 2e63 6f6e 7374 7261 696e 7473 2e53 6361  .constraints.Sca
+00011270: 6c61 7249 6e65 7175 616c 6974 792e 5f76  larInequality._v
+00011280: 616c 6964 6174 655f 696e 6974 5f69 6e70  alidate_init_inp
+00011290: 7574 7327 290a 2020 2020 6465 6620 7465  uts').    def te
+000112a0: 7374 5f5f 5f69 6e69 745f 5f5f 2873 656c  st___init___(sel
+000112b0: 662c 206d 6f63 6b5f 7661 6c69 6461 7465  f, mock_validate
+000112c0: 293a 0a20 2020 2020 2020 2022 2222 5465  ):.        """Te
+000112d0: 7374 2074 6865 2060 6053 6361 6c61 7249  st the ``ScalarI
+000112e0: 6e65 7175 616c 6974 792e 5f5f 696e 6974  nequality.__init
+000112f0: 5f5f 6060 206d 6574 686f 642e 0a0a 2020  __`` method...  
+00011300: 2020 2020 2020 5468 6520 7061 7373 6564        The passed
+00011310: 2061 7267 756d 656e 7473 2073 686f 756c   arguments shoul
+00011320: 6420 6265 2073 746f 7265 6420 6173 2061  d be stored as a
+00011330: 7474 7269 6275 7465 732e 0a0a 2020 2020  ttributes...    
+00011340: 2020 2020 496e 7075 743a 0a20 2020 2020      Input:.     
+00011350: 2020 202d 2063 6f6c 756d 6e5f 6e61 6d65     - column_name
+00011360: 2073 686f 756c 6420 6265 2061 2063 6f6c   should be a col
+00011370: 756d 6e20 6e61 6d65 0a20 2020 2020 2020  umn name.       
+00011380: 202d 2076 616c 7565 2073 686f 756c 6420   - value should 
+00011390: 6265 2061 206e 756d 6265 720a 2020 2020  be a number.    
+000113a0: 2020 2020 2d20 7265 6c61 7469 6f6e 2073      - relation s
+000113b0: 686f 756c 6420 6265 2061 6e20 696e 6571  hould be an ineq
+000113c0: 7561 6c69 7479 2073 796d 626f 6c0a 2020  uality symbol.  
+000113d0: 2020 2020 2020 5369 6465 2065 6666 6563        Side effec
+000113e0: 7473 3a0a 2020 2020 2020 2020 2d20 5f63  ts:.        - _c
+000113f0: 6f6c 756d 6e5f 6e61 6d65 2069 7320 7365  olumn_name is se
+00011400: 7420 746f 2063 6f6c 756d 6e5f 6e61 6d65  t to column_name
+00011410: 0a20 2020 2020 2020 202d 205f 7661 6c75  .        - _valu
+00011420: 6520 6973 2073 6574 2074 6f20 7661 6c75  e is set to valu
+00011430: 650a 2020 2020 2020 2020 2d20 5f64 6966  e.        - _dif
+00011440: 665f 636f 6c75 6d6e 5f6e 616d 6520 6973  f_column_name is
+00011450: 2073 6574 2074 6f20 2763 6f6c 756d 6e5f   set to 'column_
+00011460: 6e61 6d65 2364 6966 6627 0a20 2020 2020  name#diff'.     
+00011470: 2020 202d 205f 6f70 6572 6174 6f72 2069     - _operator i
+00011480: 7320 7365 7420 746f 2074 6865 206e 756d  s set to the num
+00011490: 7079 206f 7065 7261 7469 6f6e 2063 6f72  py operation cor
+000114a0: 7265 7370 6f6e 6469 6e67 2074 6f20 7468  responding to th
+000114b0: 6520 696e 7075 7420 7265 6c61 7469 6f6e  e input relation
+000114c0: 0a20 2020 2020 2020 202d 205f 6474 7970  .        - _dtyp
+000114d0: 6520 616e 6420 5f69 735f 6461 7465 7469  e and _is_dateti
+000114e0: 6d65 2061 7265 204e 6f6e 650a 2020 2020  me are None.    
+000114f0: 2020 2020 2d20 5f76 616c 6964 6174 655f      - _validate_
+00011500: 696e 6974 5f69 6e70 7574 7320 6973 2063  init_inputs is c
+00011510: 616c 6c65 6420 6f6e 6365 0a20 2020 2020  alled once.     
+00011520: 2020 2022 2222 0a20 2020 2020 2020 2023     """.        #
+00011530: 2052 756e 0a20 2020 2020 2020 2069 6e73   Run.        ins
+00011540: 7461 6e63 6520 3d20 5363 616c 6172 496e  tance = ScalarIn
+00011550: 6571 7561 6c69 7479 2863 6f6c 756d 6e5f  equality(column_
+00011560: 6e61 6d65 3d27 6127 2c20 7661 6c75 653d  name='a', value=
+00011570: 312c 2072 656c 6174 696f 6e3d 273e 2729  1, relation='>')
+00011580: 0a0a 2020 2020 2020 2020 2320 4173 7365  ..        # Asse
+00011590: 7274 730a 2020 2020 2020 2020 6173 7365  rts.        asse
+000115a0: 7274 2069 6e73 7461 6e63 652e 5f63 6f6c  rt instance._col
+000115b0: 756d 6e5f 6e61 6d65 203d 3d20 2761 270a  umn_name == 'a'.
+000115c0: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
+000115d0: 6e73 7461 6e63 652e 5f76 616c 7565 203d  nstance._value =
+000115e0: 3d20 310a 2020 2020 2020 2020 6173 7365  = 1.        asse
+000115f0: 7274 2069 6e73 7461 6e63 652e 5f64 6966  rt instance._dif
+00011600: 665f 636f 6c75 6d6e 5f6e 616d 6520 3d3d  f_column_name ==
+00011610: 2027 6123 6469 6666 270a 2020 2020 2020   'a#diff'.      
+00011620: 2020 6173 7365 7274 2069 6e73 7461 6e63    assert instanc
+00011630: 652e 5f6f 7065 7261 746f 7220 3d3d 206e  e._operator == n
+00011640: 702e 6772 6561 7465 720a 2020 2020 2020  p.greater.      
+00011650: 2020 6173 7365 7274 2069 6e73 7461 6e63    assert instanc
+00011660: 652e 5f64 7479 7065 2069 7320 4e6f 6e65  e._dtype is None
+00011670: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00011680: 696e 7374 616e 6365 2e5f 6973 5f64 6174  instance._is_dat
+00011690: 6574 696d 6520 6973 204e 6f6e 650a 2020  etime is None.  
+000116a0: 2020 2020 2020 6d6f 636b 5f76 616c 6964        mock_valid
+000116b0: 6174 652e 6173 7365 7274 5f63 616c 6c65  ate.assert_calle
+000116c0: 645f 6f6e 6365 5f77 6974 6828 2761 272c  d_once_with('a',
+000116d0: 2031 2c20 273e 2729 0a0a 2020 2020 6465   1, '>')..    de
+000116e0: 6620 7465 7374 5f5f 6765 745f 6973 5f64  f test__get_is_d
+000116f0: 6174 6574 696d 655f 696e 636f 7272 6563  atetime_incorrec
+00011700: 745f 6461 7461 2873 656c 6629 3a0a 2020  t_data(self):.  
+00011710: 2020 2020 2020 2222 2254 6573 7420 7468        """Test th
+00011720: 6520 6060 5363 616c 6172 496e 6571 7561  e ``ScalarInequa
+00011730: 6c69 7479 2e5f 6765 745f 6973 5f64 6174  lity._get_is_dat
+00011740: 6574 696d 6560 6020 6d65 7468 6f64 2e0a  etime`` method..
+00011750: 0a20 2020 2020 2020 2045 6e73 7572 6520  .        Ensure 
+00011760: 7468 6174 2069 6620 6f6e 6520 6f66 2063  that if one of c
+00011770: 6f6c 756d 6e2f 7661 6c75 6520 6973 2064  olumn/value is d
+00011780: 6174 6574 696d 652c 2062 6f74 6820 6f66  atetime, both of
+00011790: 2074 6865 6d20 6172 652e 0a0a 2020 2020   them are...    
+000117a0: 2020 2020 496e 7075 743a 0a20 2020 2020      Input:.     
+000117b0: 2020 202d 2054 6162 6c65 2064 6174 612e     - Table data.
+000117c0: 0a20 2020 2020 2020 2053 6964 6520 4566  .        Side Ef
+000117d0: 6665 6374 3a0a 2020 2020 2020 2020 2d20  fect:.        - 
+000117e0: 5261 6973 6573 2060 6056 616c 7565 4572  Raises ``ValueEr
+000117f0: 726f 7260 6020 6966 206f 6e6c 7920 6f6e  ror`` if only on
+00011800: 6520 6f66 2063 6f6c 756d 6e2f 7661 6c75  e of column/valu
+00011810: 6520 6973 2064 6174 6574 696d 652e 0a20  e is datetime.. 
+00011820: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00011830: 2020 2023 2053 6574 7570 790a 2020 2020     # Setupy.    
+00011840: 2020 2020 7461 626c 655f 6461 7461 203d      table_data =
+00011850: 2070 642e 4461 7461 4672 616d 6528 7b0a   pd.DataFrame({.
+00011860: 2020 2020 2020 2020 2020 2020 2761 273a              'a':
+00011870: 2070 642e 746f 5f64 6174 6574 696d 6528   pd.to_datetime(
+00011880: 5b27 3230 3230 2d30 312d 3031 275d 292c  ['2020-01-01']),
+00011890: 0a20 2020 2020 2020 207d 290a 2020 2020  .        }).    
+000118a0: 2020 2020 696e 7374 616e 6365 203d 2053      instance = S
+000118b0: 6361 6c61 7249 6e65 7175 616c 6974 7928  calarInequality(
+000118c0: 636f 6c75 6d6e 5f6e 616d 653d 2761 272c  column_name='a',
+000118d0: 2076 616c 7565 3d31 2c20 7265 6c61 7469   value=1, relati
+000118e0: 6f6e 3d27 3c27 290a 0a20 2020 2020 2020  on='<')..       
+000118f0: 2023 2052 756e 202f 2041 7373 6572 740a   # Run / Assert.
+00011900: 2020 2020 2020 2020 6572 725f 6d73 6720          err_msg 
+00011910: 3d20 2742 6f74 6820 636f 6c75 6d6e 2061  = 'Both column a
+00011920: 6e64 2076 616c 7565 206d 7573 7420 6265  nd value must be
+00011930: 2064 6174 6574 696d 652e 270a 2020 2020   datetime.'.    
+00011940: 2020 2020 7769 7468 2070 7974 6573 742e      with pytest.
+00011950: 7261 6973 6573 2856 616c 7565 4572 726f  raises(ValueErro
+00011960: 722c 206d 6174 6368 3d65 7272 5f6d 7367  r, match=err_msg
+00011970: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
+00011980: 6e73 7461 6e63 652e 5f67 6574 5f69 735f  nstance._get_is_
+00011990: 6461 7465 7469 6d65 2874 6162 6c65 5f64  datetime(table_d
+000119a0: 6174 6129 0a0a 2020 2020 6465 6620 7465  ata)..    def te
+000119b0: 7374 5f5f 7661 6c69 6461 7465 5f63 6f6c  st__validate_col
+000119c0: 756d 6e73 5f65 7869 7374 5f69 6e63 6f72  umns_exist_incor
+000119d0: 7265 6374 5f63 6f6c 756d 6e73 2873 656c  rect_columns(sel
+000119e0: 6629 3a0a 2020 2020 2020 2020 2222 2254  f):.        """T
+000119f0: 6573 7420 7468 6520 6060 5363 616c 6172  est the ``Scalar
+00011a00: 496e 6571 7561 6c69 7479 2e5f 7661 6c69  Inequality._vali
+00011a10: 6461 7465 5f63 6f6c 756d 6e73 5f65 7869  date_columns_exi
+00011a20: 7374 6060 206d 6574 686f 642e 0a0a 2020  st`` method...  
+00011a30: 2020 2020 2020 5468 6973 206d 6574 686f        This metho
+00011a40: 6420 7261 6973 6573 2061 6e20 6572 726f  d raises an erro
+00011a50: 7220 6966 2060 6063 6f6c 756d 6e5f 6e61  r if ``column_na
+00011a60: 6d65 6060 2064 6f65 7320 6e6f 7420 6578  me`` does not ex
+00011a70: 6973 742e 0a0a 2020 2020 2020 2020 496e  ist...        In
+00011a80: 7075 743a 0a20 2020 2020 2020 202d 2054  put:.        - T
+00011a90: 6162 6c65 2077 6974 6820 6769 7665 6e20  able with given 
+00011aa0: 6461 7461 2e0a 2020 2020 2020 2020 2222  data..        ""
+00011ab0: 220a 2020 2020 2020 2020 2320 5365 7475  ".        # Setu
+00011ac0: 700a 2020 2020 2020 2020 7461 626c 655f  p.        table_
+00011ad0: 6461 7461 203d 2070 642e 4461 7461 4672  data = pd.DataFr
+00011ae0: 616d 6528 7b0a 2020 2020 2020 2020 2020  ame({.          
+00011af0: 2020 2761 273a 205b 312c 2032 2c20 345d    'a': [1, 2, 4]
+00011b00: 2c0a 2020 2020 2020 2020 2020 2020 2762  ,.            'b
+00011b10: 273a 205b 342c 2035 2c20 365d 0a20 2020  ': [4, 5, 6].   
+00011b20: 2020 2020 207d 290a 2020 2020 2020 2020       }).        
+00011b30: 696e 7374 616e 6365 203d 2053 6361 6c61  instance = Scala
+00011b40: 7249 6e65 7175 616c 6974 7928 636f 6c75  rInequality(colu
+00011b50: 6d6e 5f6e 616d 653d 2763 272c 2076 616c  mn_name='c', val
+00011b60: 7565 3d35 2c20 7265 6c61 7469 6f6e 3d27  ue=5, relation='
+00011b70: 3e27 290a 0a20 2020 2020 2020 2023 2052  >')..        # R
+00011b80: 756e 202f 2041 7373 6572 740a 2020 2020  un / Assert.    
+00011b90: 2020 2020 7769 7468 2070 7974 6573 742e      with pytest.
+00011ba0: 7261 6973 6573 284b 6579 4572 726f 7229  raises(KeyError)
+00011bb0: 3a0a 2020 2020 2020 2020 2020 2020 696e  :.            in
+00011bc0: 7374 616e 6365 2e5f 7661 6c69 6461 7465  stance._validate
+00011bd0: 5f63 6f6c 756d 6e73 5f65 7869 7374 2874  _columns_exist(t
+00011be0: 6162 6c65 5f64 6174 6129 0a0a 2020 2020  able_data)..    
+00011bf0: 6465 6620 7465 7374 5f5f 6669 7428 7365  def test__fit(se
+00011c00: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+00011c10: 5465 7374 2074 6865 2060 6053 6361 6c61  Test the ``Scala
+00011c20: 7249 6e65 7175 616c 6974 792e 5f66 6974  rInequality._fit
+00011c30: 6060 206d 6574 686f 642e 0a0a 2020 2020  `` method...    
+00011c40: 2020 2020 5468 6520 6d65 7468 6f64 2073      The method s
+00011c50: 686f 756c 6420 6c65 6172 6e20 7468 6520  hould learn the 
+00011c60: 6060 6474 7970 6560 6020 6f66 2060 6063  ``dtype`` of ``c
+00011c70: 6f6c 756d 6e5f 6e61 6d65 6060 2061 6e64  olumn_name`` and
+00011c80: 2060 605f 6973 5f64 6174 6574 696d 6560   ``_is_datetime`
+00011c90: 602e 0a0a 2020 2020 2020 2020 496e 7075  `...        Inpu
+00011ca0: 743a 0a20 2020 2020 2020 202d 2054 6162  t:.        - Tab
+00011cb0: 6c65 2064 6174 6120 7769 7468 2069 6e74  le data with int
+00011cc0: 6567 6572 732e 0a20 2020 2020 2020 2053  egers..        S
+00011cd0: 6964 6520 4566 6665 6374 3a0a 2020 2020  ide Effect:.    
+00011ce0: 2020 2020 2d20 5f76 616c 6964 6174 655f      - _validate_
+00011cf0: 636f 6c75 6d6e 735f 6578 6973 7420 7368  columns_exist sh
+00011d00: 6f75 6c64 2062 6520 6361 6c6c 6564 206f  ould be called o
+00011d10: 6e63 650a 2020 2020 2020 2020 2d20 5f67  nce.        - _g
+00011d20: 6574 5f69 735f 6461 7465 7469 6d65 2073  et_is_datetime s
+00011d30: 686f 756c 6420 6265 2063 616c 6c65 6420  hould be called 
+00011d40: 6f6e 6365 0a20 2020 2020 2020 202d 205f  once.        - _
+00011d50: 6973 5f64 6174 6574 696d 6520 7368 6f75  is_datetime shou
+00011d60: 6c64 2072 6563 6569 7665 2074 6865 206f  ld receive the o
+00011d70: 7574 7075 7420 6f66 205f 6765 745f 6973  utput of _get_is
+00011d80: 5f64 6174 6574 696d 650a 2020 2020 2020  _datetime.      
+00011d90: 2020 2d20 5f64 7479 7065 2073 686f 756c    - _dtype shoul
+00011da0: 6420 6265 2061 206c 6973 7420 6f66 2069  d be a list of i
+00011db0: 6e74 6567 6572 2064 7479 7065 732e 0a20  nteger dtypes.. 
+00011dc0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00011dd0: 2020 2023 2053 6574 7570 0a20 2020 2020     # Setup.     
+00011de0: 2020 2074 6162 6c65 5f64 6174 6120 3d20     table_data = 
+00011df0: 7064 2e44 6174 6146 7261 6d65 287b 0a20  pd.DataFrame({. 
+00011e00: 2020 2020 2020 2020 2020 2027 6127 3a20             'a': 
+00011e10: 5b31 2c20 322c 2034 5d2c 0a20 2020 2020  [1, 2, 4],.     
+00011e20: 2020 2020 2020 2027 6227 3a20 5b34 2c20         'b': [4, 
+00011e30: 352c 2036 5d0a 2020 2020 2020 2020 7d29  5, 6].        })
+00011e40: 0a20 2020 2020 2020 2069 6e73 7461 6e63  .        instanc
+00011e50: 6520 3d20 5363 616c 6172 496e 6571 7561  e = ScalarInequa
+00011e60: 6c69 7479 2863 6f6c 756d 6e5f 6e61 6d65  lity(column_name
+00011e70: 3d27 6227 2c20 7661 6c75 653d 332c 2072  ='b', value=3, r
+00011e80: 656c 6174 696f 6e3d 273e 2729 0a20 2020  elation='>').   
+00011e90: 2020 2020 2069 6e73 7461 6e63 652e 5f76       instance._v
+00011ea0: 616c 6964 6174 655f 636f 6c75 6d6e 735f  alidate_columns_
+00011eb0: 6578 6973 7420 3d20 4d6f 636b 2829 0a20  exist = Mock(). 
+00011ec0: 2020 2020 2020 2069 6e73 7461 6e63 652e         instance.
+00011ed0: 5f67 6574 5f69 735f 6461 7465 7469 6d65  _get_is_datetime
+00011ee0: 203d 204d 6f63 6b28 7265 7475 726e 5f76   = Mock(return_v
+00011ef0: 616c 7565 3d46 616c 7365 290a 0a20 2020  alue=False)..   
+00011f00: 2020 2020 2023 2052 756e 0a20 2020 2020       # Run.     
+00011f10: 2020 2069 6e73 7461 6e63 652e 5f66 6974     instance._fit
+00011f20: 2874 6162 6c65 5f64 6174 6129 0a0a 2020  (table_data)..  
+00011f30: 2020 2020 2020 2320 4173 7365 7274 0a20        # Assert. 
+00011f40: 2020 2020 2020 2069 6e73 7461 6e63 652e         instance.
+00011f50: 5f76 616c 6964 6174 655f 636f 6c75 6d6e  _validate_column
+00011f60: 735f 6578 6973 742e 6173 7365 7274 5f63  s_exist.assert_c
+00011f70: 616c 6c65 645f 6f6e 6365 5f77 6974 6828  alled_once_with(
+00011f80: 7461 626c 655f 6461 7461 290a 2020 2020  table_data).    
+00011f90: 2020 2020 696e 7374 616e 6365 2e5f 6765      instance._ge
+00011fa0: 745f 6973 5f64 6174 6574 696d 652e 6173  t_is_datetime.as
+00011fb0: 7365 7274 5f63 616c 6c65 645f 6f6e 6365  sert_called_once
+00011fc0: 5f77 6974 6828 7461 626c 655f 6461 7461  _with(table_data
+00011fd0: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
+00011fe0: 206e 6f74 2069 6e73 7461 6e63 652e 5f69   not instance._i
+00011ff0: 735f 6461 7465 7469 6d65 0a20 2020 2020  s_datetime.     
+00012000: 2020 2061 7373 6572 7420 696e 7374 616e     assert instan
+00012010: 6365 2e5f 6474 7970 6520 3d3d 2070 642e  ce._dtype == pd.
+00012020: 5365 7269 6573 285b 315d 292e 6474 7970  Series([1]).dtyp
+00012030: 6520 2023 2065 7861 6374 2064 7479 7065  e  # exact dtype
+00012040: 2028 3332 206f 7220 3634 2920 6465 7065   (32 or 64) depe
+00012050: 6e64 7320 6f6e 204f 530a 0a20 2020 2064  nds on OS..    d
+00012060: 6566 2074 6573 745f 5f66 6974 5f66 6c6f  ef test__fit_flo
+00012070: 6174 7328 7365 6c66 293a 0a20 2020 2020  ats(self):.     
+00012080: 2020 2022 2222 5465 7374 2074 6865 2060     """Test the `
+00012090: 6053 6361 6c61 7249 6e65 7175 616c 6974  `ScalarInequalit
+000120a0: 792e 5f66 6974 6060 206d 6574 686f 642e  y._fit`` method.
+000120b0: 0a0a 2020 2020 2020 2020 5468 6520 6174  ..        The at
+000120c0: 7472 6962 7574 6520 6060 5f64 7479 7065  tribute ``_dtype
+000120d0: 6060 2073 686f 756c 6420 6265 2066 6c6f  `` should be flo
+000120e0: 6174 2077 6865 6e20 6060 636f 6c75 6d6e  at when ``column
+000120f0: 5f6e 616d 6560 6020 636f 6e74 6169 6e73  _name`` contains
+00012100: 2066 6c6f 6174 732e 0a0a 2020 2020 2020   floats...      
+00012110: 2020 496e 7075 743a 0a20 2020 2020 2020    Input:.       
+00012120: 202d 2054 6162 6c65 2064 6174 6120 7769   - Table data wi
+00012130: 7468 2066 6c6f 6174 732e 0a20 2020 2020  th floats..     
+00012140: 2020 2053 6964 6520 4566 6665 6374 3a0a     Side Effect:.
+00012150: 2020 2020 2020 2020 2d20 5f64 7479 7065          - _dtype
+00012160: 2073 686f 756c 6420 6265 2061 2066 6c6f   should be a flo
+00012170: 6174 2064 7479 7065 2e0a 2020 2020 2020  at dtype..      
+00012180: 2020 2222 220a 2020 2020 2020 2020 2320    """.        # 
+00012190: 5365 7475 700a 2020 2020 2020 2020 7461  Setup.        ta
+000121a0: 626c 655f 6461 7461 203d 2070 642e 4461  ble_data = pd.Da
+000121b0: 7461 4672 616d 6528 7b0a 2020 2020 2020  taFrame({.      
+000121c0: 2020 2020 2020 2761 273a 205b 312c 2032        'a': [1, 2
+000121d0: 2c20 345d 2c0a 2020 2020 2020 2020 2020  , 4],.          
+000121e0: 2020 2762 273a 205b 342e 2c20 352e 2c20    'b': [4., 5., 
+000121f0: 362e 5d0a 2020 2020 2020 2020 7d29 0a20  6.].        }). 
+00012200: 2020 2020 2020 2069 6e73 7461 6e63 6520         instance 
+00012210: 3d20 5363 616c 6172 496e 6571 7561 6c69  = ScalarInequali
+00012220: 7479 2863 6f6c 756d 6e5f 6e61 6d65 3d27  ty(column_name='
+00012230: 6227 2c20 7661 6c75 653d 3130 2c20 7265  b', value=10, re
+00012240: 6c61 7469 6f6e 3d27 3e27 290a 0a20 2020  lation='>')..   
+00012250: 2020 2020 2023 2052 756e 0a20 2020 2020       # Run.     
+00012260: 2020 2069 6e73 7461 6e63 652e 5f66 6974     instance._fit
+00012270: 2874 6162 6c65 5f64 6174 6129 0a0a 2020  (table_data)..  
+00012280: 2020 2020 2020 2320 4173 7365 7274 0a20        # Assert. 
+00012290: 2020 2020 2020 2061 7373 6572 7420 696e         assert in
+000122a0: 7374 616e 6365 2e5f 6474 7970 6520 3d3d  stance._dtype ==
+000122b0: 206e 702e 6474 7970 6528 2766 6c6f 6174   np.dtype('float
+000122c0: 2729 0a0a 2020 2020 6465 6620 7465 7374  ')..    def test
+000122d0: 5f5f 6669 745f 6461 7465 7469 6d65 2873  __fit_datetime(s
+000122e0: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
+000122f0: 2254 6573 7420 7468 6520 6060 5363 616c  "Test the ``Scal
+00012300: 6172 496e 6571 7561 6c69 7479 2e5f 6669  arInequality._fi
+00012310: 7460 6020 6d65 7468 6f64 2e0a 0a20 2020  t`` method...   
+00012320: 2020 2020 2054 6865 2061 7474 7269 6275       The attribu
+00012330: 7465 2060 605f 6474 7970 6560 6020 7368  te ``_dtype`` sh
+00012340: 6f75 6c64 2062 6520 6461 7465 7469 6d65  ould be datetime
+00012350: 2077 6865 6e20 6060 636f 6c75 6d6e 5f6e   when ``column_n
+00012360: 616d 6560 6020 636f 6e74 6169 6e73 2064  ame`` contains d
+00012370: 6174 6574 696d 6573 2e0a 0a20 2020 2020  atetimes...     
+00012380: 2020 2049 6e70 7574 3a0a 2020 2020 2020     Input:.      
+00012390: 2020 2d20 5461 626c 6520 6461 7461 2077    - Table data w
+000123a0: 6974 6820 6461 7465 7469 6d65 732e 0a20  ith datetimes.. 
+000123b0: 2020 2020 2020 2053 6964 6520 4566 6665         Side Effe
+000123c0: 6374 3a0a 2020 2020 2020 2020 2d20 5f64  ct:.        - _d
+000123d0: 7479 7065 2073 686f 756c 6420 6265 2061  type should be a
+000123e0: 206c 6973 7420 6f66 2064 6174 6574 696d   list of datetim
+000123f0: 6520 6474 7970 6573 2e0a 2020 2020 2020  e dtypes..      
+00012400: 2020 2222 220a 2020 2020 2020 2020 2320    """.        # 
+00012410: 5365 7475 700a 2020 2020 2020 2020 7461  Setup.        ta
+00012420: 626c 655f 6461 7461 203d 2070 642e 4461  ble_data = pd.Da
+00012430: 7461 4672 616d 6528 7b0a 2020 2020 2020  taFrame({.      
+00012440: 2020 2020 2020 2761 273a 2070 642e 746f        'a': pd.to
+00012450: 5f64 6174 6574 696d 6528 5b27 3230 3230  _datetime(['2020
+00012460: 2d30 312d 3031 275d 292c 0a20 2020 2020  -01-01']),.     
+00012470: 2020 2020 2020 2027 6227 3a20 7064 2e74         'b': pd.t
+00012480: 6f5f 6461 7465 7469 6d65 285b 2732 3032  o_datetime(['202
+00012490: 302d 3031 2d30 3227 5d29 0a20 2020 2020  0-01-02']).     
+000124a0: 2020 207d 290a 2020 2020 2020 2020 696e     }).        in
+000124b0: 7374 616e 6365 203d 2053 6361 6c61 7249  stance = ScalarI
+000124c0: 6e65 7175 616c 6974 7928 636f 6c75 6d6e  nequality(column
+000124d0: 5f6e 616d 653d 2762 272c 2076 616c 7565  _name='b', value
+000124e0: 3d27 3230 3230 2d30 312d 3031 272c 2072  ='2020-01-01', r
+000124f0: 656c 6174 696f 6e3d 273e 2729 0a0a 2020  elation='>')..  
+00012500: 2020 2020 2020 2320 5275 6e0a 2020 2020        # Run.    
+00012510: 2020 2020 696e 7374 616e 6365 2e5f 6669      instance._fi
+00012520: 7428 7461 626c 655f 6461 7461 290a 0a20  t(table_data).. 
+00012530: 2020 2020 2020 2023 2041 7373 6572 740a         # Assert.
+00012540: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
+00012550: 6e73 7461 6e63 652e 5f64 7479 7065 203d  nstance._dtype =
+00012560: 3d20 6e70 2e64 7479 7065 2827 3c4d 385b  = np.dtype('<M8[
+00012570: 6e73 5d27 290a 0a20 2020 2064 6566 2074  ns]')..    def t
+00012580: 6573 745f 6973 5f76 616c 6964 2873 656c  est_is_valid(sel
+00012590: 6629 3a0a 2020 2020 2020 2020 2222 2254  f):.        """T
+000125a0: 6573 7420 7468 6520 6060 5363 616c 6172  est the ``Scalar
+000125b0: 496e 6571 7561 6c69 7479 2e69 735f 7661  Inequality.is_va
+000125c0: 6c69 6460 6020 6d65 7468 6f64 2077 6974  lid`` method wit
+000125d0: 6820 6060 7265 6c61 7469 6f6e 203d 2027  h ``relation = '
+000125e0: 3e27 6060 2e0a 0a20 2020 2020 2020 2054  >'``...        T
+000125f0: 6865 206d 6574 686f 6420 7368 6f75 6c64  he method should
+00012600: 2072 6574 7572 6e20 5472 7565 2077 6865   return True whe
+00012610: 6e20 6060 636f 6c75 6d6e 5f6e 616d 6560  n ``column_name`
+00012620: 6020 6973 2067 7265 6174 6572 2074 6861  ` is greater tha
+00012630: 6e0a 2020 2020 2020 2020 6060 7661 6c75  n.        ``valu
+00012640: 6560 6020 6f72 2074 6865 2072 6f77 2063  e`` or the row c
+00012650: 6f6e 7461 696e 7320 6e61 6e2c 206f 7468  ontains nan, oth
+00012660: 6572 7769 7365 2072 6574 7572 6e20 4661  erwise return Fa
+00012670: 6c73 652e 0a0a 2020 2020 2020 2020 496e  lse...        In
+00012680: 7075 743a 0a20 2020 2020 2020 202d 2054  put:.        - T
+00012690: 6162 6c65 2077 6974 6820 6120 6d69 7874  able with a mixt
+000126a0: 7572 6520 6f66 2076 616c 6964 2061 6e64  ure of valid and
+000126b0: 2069 6e76 616c 6964 2072 6f77 732c 2061   invalid rows, a
+000126c0: 7320 7765 6c6c 2061 7320 6e70 2e6e 616e  s well as np.nan
+000126d0: 732e 0a20 2020 2020 2020 204f 7574 7075  s..        Outpu
+000126e0: 743a 0a20 2020 2020 2020 202d 2046 616c  t:.        - Fal
+000126f0: 7365 2073 686f 756c 6420 6265 2072 6574  se should be ret
+00012700: 7572 6e65 6420 666f 7220 7468 6520 7374  urned for the st
+00012710: 7269 6374 6c79 2069 6e76 616c 6964 2072  rictly invalid r
+00012720: 6f77 7320 616e 6420 5472 7565 2066 6f72  ows and True for
+00012730: 2074 6865 2072 6573 742e 0a20 2020 2020   the rest..     
+00012740: 2020 2022 2222 0a20 2020 2020 2020 2023     """.        #
+00012750: 2053 6574 7570 0a20 2020 2020 2020 2069   Setup.        i
+00012760: 6e73 7461 6e63 6520 3d20 5363 616c 6172  nstance = Scalar
+00012770: 496e 6571 7561 6c69 7479 2863 6f6c 756d  Inequality(colum
+00012780: 6e5f 6e61 6d65 3d27 6227 2c20 7661 6c75  n_name='b', valu
+00012790: 653d 322c 2072 656c 6174 696f 6e3d 273e  e=2, relation='>
+000127a0: 2729 0a0a 2020 2020 2020 2020 2320 5275  ')..        # Ru
+000127b0: 6e0a 2020 2020 2020 2020 7461 626c 655f  n.        table_
+000127c0: 6461 7461 203d 2070 642e 4461 7461 4672  data = pd.DataFr
+000127d0: 616d 6528 7b0a 2020 2020 2020 2020 2020  ame({.          
+000127e0: 2020 2761 273a 205b 312c 206e 702e 6e61    'a': [1, np.na
+000127f0: 6e2c 2033 2c20 342c 204e 6f6e 655d 2c0a  n, 3, 4, None],.
+00012800: 2020 2020 2020 2020 2020 2020 2762 273a              'b':
+00012810: 205b 342c 2032 2c20 6e70 2e6e 616e 2c20   [4, 2, np.nan, 
+00012820: 2d36 2c20 4e6f 6e65 5d2c 0a20 2020 2020  -6, None],.     
+00012830: 2020 207d 290a 2020 2020 2020 2020 6f75     }).        ou
+00012840: 7420 3d20 696e 7374 616e 6365 2e69 735f  t = instance.is_
+00012850: 7661 6c69 6428 7461 626c 655f 6461 7461  valid(table_data
+00012860: 290a 0a20 2020 2020 2020 2023 2041 7373  )..        # Ass
+00012870: 6572 740a 2020 2020 2020 2020 6578 7065  ert.        expe
+00012880: 6374 6564 5f6f 7574 203d 205b 5472 7565  cted_out = [True
+00012890: 2c20 4661 6c73 652c 2054 7275 652c 2046  , False, True, F
+000128a0: 616c 7365 2c20 5472 7565 5d0a 2020 2020  alse, True].    
+000128b0: 2020 2020 6e70 2e74 6573 7469 6e67 2e61      np.testing.a
+000128c0: 7373 6572 745f 6172 7261 795f 6571 7561  ssert_array_equa
+000128d0: 6c28 6578 7065 6374 6564 5f6f 7574 2c20  l(expected_out, 
+000128e0: 6f75 7429 0a0a 2020 2020 6465 6620 7465  out)..    def te
+000128f0: 7374 5f69 735f 7661 6c69 645f 6461 7465  st_is_valid_date
+00012900: 7469 6d65 7328 7365 6c66 293a 0a20 2020  times(self):.   
+00012910: 2020 2020 2022 2222 5465 7374 2074 6865       """Test the
+00012920: 2060 6053 6361 6c61 7249 6e65 7175 616c   ``ScalarInequal
+00012930: 6974 792e 6973 5f76 616c 6964 6060 206d  ity.is_valid`` m
+00012940: 6574 686f 6420 7769 7468 2064 6174 6574  ethod with datet
+00012950: 696d 6573 2061 6e64 2060 6072 656c 6174  imes and ``relat
+00012960: 696f 6e20 3d20 273c 3d27 6060 2e0a 0a20  ion = '<='``... 
+00012970: 2020 2020 2020 2054 6865 206d 6574 686f         The metho
+00012980: 6420 7368 6f75 6c64 2072 6574 7572 6e20  d should return 
+00012990: 5472 7565 2077 6865 6e20 6060 636f 6c75  True when ``colu
+000129a0: 6d6e 5f6e 616d 6560 6020 6973 2067 7265  mn_name`` is gre
+000129b0: 6174 6572 206f 7220 6571 7561 6c20 746f  ater or equal to
+000129c0: 0a20 2020 2020 2020 2060 6076 616c 7565  .        ``value
+000129d0: 6060 206f 7220 7468 6520 726f 7720 636f  `` or the row co
+000129e0: 6e74 6169 6e73 206e 616e 2c20 6f74 6865  ntains nan, othe
+000129f0: 7277 6973 6520 7265 7475 726e 2046 616c  rwise return Fal
+00012a00: 7365 2e0a 0a20 2020 2020 2020 2049 6e70  se...        Inp
+00012a10: 7574 3a0a 2020 2020 2020 2020 2d20 5461  ut:.        - Ta
+00012a20: 626c 6520 7769 7468 2064 6174 6574 696d  ble with datetim
+00012a30: 6573 2061 6e64 206e 702e 6e61 6e73 2e0a  es and np.nans..
+00012a40: 2020 2020 2020 2020 4f75 7470 7574 3a0a          Output:.
+00012a50: 2020 2020 2020 2020 2d20 4661 6c73 6520          - False 
+00012a60: 7368 6f75 6c64 2062 6520 7265 7475 726e  should be return
+00012a70: 6564 2066 6f72 2074 6865 2073 7472 6963  ed for the stric
+00012a80: 746c 7920 696e 7661 6c69 6420 726f 7773  tly invalid rows
+00012a90: 2061 6e64 2054 7275 6520 666f 7220 7468   and True for th
+00012aa0: 6520 7265 7374 2e0a 2020 2020 2020 2020  e rest..        
+00012ab0: 2222 220a 2020 2020 2020 2020 2320 5365  """.        # Se
+00012ac0: 7475 700a 2020 2020 2020 2020 696e 7374  tup.        inst
+00012ad0: 616e 6365 203d 2053 6361 6c61 7249 6e65  ance = ScalarIne
+00012ae0: 7175 616c 6974 7928 0a20 2020 2020 2020  quality(.       
+00012af0: 2020 2020 2063 6f6c 756d 6e5f 6e61 6d65       column_name
+00012b00: 3d27 6227 2c0a 2020 2020 2020 2020 2020  ='b',.          
+00012b10: 2020 7661 6c75 653d 2738 2f33 312f 3230    value='8/31/20
+00012b20: 3231 272c 0a20 2020 2020 2020 2020 2020  21',.           
+00012b30: 2072 656c 6174 696f 6e3d 273e 3d27 290a   relation='>=').
+00012b40: 0a20 2020 2020 2020 2023 2052 756e 0a20  .        # Run. 
+00012b50: 2020 2020 2020 2074 6162 6c65 5f64 6174         table_dat
+00012b60: 6120 3d20 7064 2e44 6174 6146 7261 6d65  a = pd.DataFrame
+00012b70: 287b 0a20 2020 2020 2020 2020 2020 2027  ({.            '
+00012b80: 6227 3a20 5b64 6174 6574 696d 6528 3230  b': [datetime(20
+00012b90: 3231 2c20 382c 2033 3029 2c20 6461 7465  21, 8, 30), date
+00012ba0: 7469 6d65 2832 3032 312c 2038 2c20 3331  time(2021, 8, 31
+00012bb0: 292c 2064 6174 6574 696d 6528 3230 3231  ), datetime(2021
+00012bc0: 2c20 392c 2032 292c 206e 702e 6e61 6e5d  , 9, 2), np.nan]
+00012bd0: 2c0a 2020 2020 2020 2020 2020 2020 2763  ,.            'c
+00012be0: 273a 205b 372c 2038 2c20 392c 2031 305d  ': [7, 8, 9, 10]
+00012bf0: 0a20 2020 2020 2020 207d 290a 2020 2020  .        }).    
+00012c00: 2020 2020 6f75 7420 3d20 696e 7374 616e      out = instan
+00012c10: 6365 2e69 735f 7661 6c69 6428 7461 626c  ce.is_valid(tabl
+00012c20: 655f 6461 7461 290a 0a20 2020 2020 2020  e_data)..       
+00012c30: 2023 2041 7373 6572 740a 2020 2020 2020   # Assert.      
+00012c40: 2020 6578 7065 6374 6564 5f6f 7574 203d    expected_out =
+00012c50: 205b 4661 6c73 652c 2054 7275 652c 2054   [False, True, T
+00012c60: 7275 652c 2054 7275 655d 0a20 2020 2020  rue, True].     
+00012c70: 2020 206e 702e 7465 7374 696e 672e 6173     np.testing.as
+00012c80: 7365 7274 5f61 7272 6179 5f65 7175 616c  sert_array_equal
+00012c90: 2865 7870 6563 7465 645f 6f75 742c 206f  (expected_out, o
+00012ca0: 7574 290a 0a20 2020 2064 6566 2074 6573  ut)..    def tes
+00012cb0: 745f 6973 5f76 616c 6964 5f64 6174 6574  t_is_valid_datet
+00012cc0: 696d 6573 5f61 735f 6f62 6a65 6374 2873  imes_as_object(s
+00012cd0: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
+00012ce0: 2254 6573 7420 7468 6520 6060 5363 616c  "Test the ``Scal
+00012cf0: 6172 496e 6571 7561 6c69 7479 2e69 735f  arInequality.is_
+00012d00: 7661 6c69 6460 6020 6d65 7468 6f64 2077  valid`` method w
+00012d10: 6974 6820 6461 7465 7469 6d65 7320 616e  ith datetimes an
+00012d20: 6420 7468 6569 7220 6474 7970 6520 6973  d their dtype is
+00012d30: 206f 626a 6563 742e 0a0a 2020 2020 2020   object...      
+00012d40: 2020 5468 6520 6d65 7468 6f64 2073 686f    The method sho
+00012d50: 756c 6420 7265 7475 726e 2054 7275 6520  uld return True 
+00012d60: 7768 656e 2060 6063 6f6c 756d 6e5f 6e61  when ``column_na
+00012d70: 6d65 6060 2069 7320 6772 6561 7465 7220  me`` is greater 
+00012d80: 6f72 2065 7175 616c 2074 6f0a 2020 2020  or equal to.    
+00012d90: 2020 2020 6060 7661 6c75 6560 6020 6f72      ``value`` or
+00012da0: 2074 6865 2072 6f77 2063 6f6e 7461 696e   the row contain
+00012db0: 7320 6e61 6e2c 2065 7665 6e20 7768 656e  s nan, even when
+00012dc0: 2074 6865 2060 6064 6174 6574 696d 6560   the ``datetime`
+00012dd0: 6020 6973 2070 6173 7365 6420 6173 2061  ` is passed as a
+00012de0: 6e20 6f62 6a65 6374 2e0a 2020 2020 2020  n object..      
+00012df0: 2020 2222 220a 2020 2020 2020 2020 2320    """.        # 
+00012e00: 5365 7475 700a 2020 2020 2020 2020 696e  Setup.        in
+00012e10: 7374 616e 6365 203d 2053 6361 6c61 7249  stance = ScalarI
+00012e20: 6e65 7175 616c 6974 7928 0a20 2020 2020  nequality(.     
+00012e30: 2020 2020 2020 2063 6f6c 756d 6e5f 6e61         column_na
+00012e40: 6d65 3d27 6227 2c0a 2020 2020 2020 2020  me='b',.        
+00012e50: 2020 2020 7661 6c75 653d 2738 2f33 312f      value='8/31/
+00012e60: 3230 3231 272c 0a20 2020 2020 2020 2020  2021',.         
+00012e70: 2020 2072 656c 6174 696f 6e3d 273e 3d27     relation='>='
+00012e80: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+00012e90: 2020 2069 6e73 7461 6e63 652e 5f64 7479     instance._dty
+00012ea0: 7065 203d 206e 702e 6474 7970 6528 274f  pe = np.dtype('O
+00012eb0: 2729 0a20 2020 2020 2020 2069 6e73 7461  ').        insta
+00012ec0: 6e63 652e 5f69 735f 6461 7465 7469 6d65  nce._is_datetime
+00012ed0: 203d 2054 7275 650a 0a20 2020 2020 2020   = True..       
+00012ee0: 2023 2052 756e 0a20 2020 2020 2020 2074   # Run.        t
+00012ef0: 6162 6c65 5f64 6174 6120 3d20 7064 2e44  able_data = pd.D
+00012f00: 6174 6146 7261 6d65 287b 0a20 2020 2020  ataFrame({.     
+00012f10: 2020 2020 2020 2027 6227 3a20 5b27 3230         'b': ['20
+00012f20: 3231 2c20 382c 2033 3027 2c20 2732 3032  21, 8, 30', '202
+00012f30: 312c 2038 2c20 3331 272c 2027 3230 3231  1, 8, 31', '2021
+00012f40: 2c20 392c 2032 272c 206e 702e 6e61 6e5d  , 9, 2', np.nan]
+00012f50: 2c0a 2020 2020 2020 2020 2020 2020 2763  ,.            'c
+00012f60: 273a 205b 372c 2038 2c20 392c 2031 305d  ': [7, 8, 9, 10]
+00012f70: 0a20 2020 2020 2020 207d 290a 2020 2020  .        }).    
+00012f80: 2020 2020 6f75 7420 3d20 696e 7374 616e      out = instan
+00012f90: 6365 2e69 735f 7661 6c69 6428 7461 626c  ce.is_valid(tabl
+00012fa0: 655f 6461 7461 290a 0a20 2020 2020 2020  e_data)..       
+00012fb0: 2023 2041 7373 6572 740a 2020 2020 2020   # Assert.      
+00012fc0: 2020 6578 7065 6374 6564 5f6f 7574 203d    expected_out =
+00012fd0: 205b 4661 6c73 652c 2054 7275 652c 2054   [False, True, T
+00012fe0: 7275 652c 2054 7275 655d 0a20 2020 2020  rue, True].     
+00012ff0: 2020 206e 702e 7465 7374 696e 672e 6173     np.testing.as
+00013000: 7365 7274 5f61 7272 6179 5f65 7175 616c  sert_array_equal
+00013010: 2865 7870 6563 7465 645f 6f75 742c 206f  (expected_out, o
+00013020: 7574 290a 0a20 2020 2064 6566 2074 6573  ut)..    def tes
+00013030: 745f 5f74 7261 6e73 666f 726d 2873 656c  t__transform(sel
+00013040: 6629 3a0a 2020 2020 2020 2020 2222 2254  f):.        """T
+00013050: 6573 7420 7468 6520 6060 5363 616c 6172  est the ``Scalar
+00013060: 496e 6571 7561 6c69 7479 2e5f 7472 616e  Inequality._tran
+00013070: 7366 6f72 6d60 6020 6d65 7468 6f64 2e0a  sform`` method..
+00013080: 0a20 2020 2020 2020 2054 6865 206d 6574  .        The met
+00013090: 686f 6420 6973 2065 7870 6563 7465 6420  hod is expected 
+000130a0: 746f 2063 6f6d 7075 7465 2074 6865 2064  to compute the d
+000130b0: 6973 7461 6e63 6520 6265 7477 6565 6e20  istance between 
+000130c0: 7468 6520 6060 636f 6c75 6d6e 5f6e 616d  the ``column_nam
+000130d0: 6560 6020 616e 6420 6060 7661 6c75 6560  e`` and ``value`
+000130e0: 600a 2020 2020 2020 2020 616e 6420 6372  `.        and cr
+000130f0: 6561 7465 2061 2064 6966 6620 636f 6c75  eate a diff colu
+00013100: 6d6e 2077 6974 6820 7468 6520 6c6f 6761  mn with the loga
+00013110: 7269 7468 6d20 6f66 2074 6865 2064 6973  rithm of the dis
+00013120: 7461 6e63 6520 2b20 312e 0a0a 2020 2020  tance + 1...    
+00013130: 2020 2020 5365 7475 703a 0a20 2020 2020      Setup:.     
+00013140: 2020 202d 2060 605f 6469 6666 5f63 6f6c     - ``_diff_col
+00013150: 756d 6e5f 6e61 6d65 6060 2069 7320 7365  umn_name`` is se
+00013160: 7420 746f 2060 6027 6123 2760 602e 0a20  t to ``'a#'``.. 
+00013170: 2020 2020 2020 2049 6e70 7574 3a0a 2020         Input:.  
+00013180: 2020 2020 2020 2d20 5461 626c 6520 6461        - Table da
+00013190: 7461 2e0a 2020 2020 2020 2020 4f75 7470  ta..        Outp
+000131a0: 7574 3a0a 2020 2020 2020 2020 2d20 5361  ut:.        - Sa
+000131b0: 6d65 2074 6162 6c65 2077 6974 6820 6120  me table with a 
+000131c0: 6469 6666 2063 6f6c 756d 6e20 6f66 2074  diff column of t
+000131d0: 6865 206c 6f67 206f 6620 7468 6520 6469  he log of the di
+000131e0: 7374 616e 6365 7320 2b20 310a 2020 2020  stances + 1.    
+000131f0: 2020 2020 2020 696e 2074 6865 2060 6063        in the ``c
+00013200: 6f6c 756d 6e5f 6e61 6d65 6060 2773 2070  olumn_name``'s p
+00013210: 6c61 6365 2e0a 2020 2020 2020 2020 2222  lace..        ""
+00013220: 220a 2020 2020 2020 2020 2320 5365 7475  ".        # Setu
+00013230: 700a 2020 2020 2020 2020 696e 7374 616e  p.        instan
+00013240: 6365 203d 2053 6361 6c61 7249 6e65 7175  ce = ScalarInequ
+00013250: 616c 6974 7928 636f 6c75 6d6e 5f6e 616d  ality(column_nam
+00013260: 653d 2761 272c 2076 616c 7565 3d31 2c20  e='a', value=1, 
+00013270: 7265 6c61 7469 6f6e 3d27 3e3d 2729 0a20  relation='>='). 
+00013280: 2020 2020 2020 2069 6e73 7461 6e63 652e         instance.
+00013290: 5f64 6966 665f 636f 6c75 6d6e 5f6e 616d  _diff_column_nam
+000132a0: 6520 3d20 2761 2327 0a0a 2020 2020 2020  e = 'a#'..      
+000132b0: 2020 2320 5275 6e0a 2020 2020 2020 2020    # Run.        
+000132c0: 7461 626c 655f 6461 7461 203d 2070 642e  table_data = pd.
+000132d0: 4461 7461 4672 616d 6528 7b0a 2020 2020  DataFrame({.    
+000132e0: 2020 2020 2020 2020 2761 273a 205b 312c          'a': [1,
+000132f0: 2032 2c20 335d 2c0a 2020 2020 2020 2020   2, 3],.        
+00013300: 2020 2020 2763 273a 205b 372c 2038 2c20      'c': [7, 8, 
+00013310: 395d 2c0a 2020 2020 2020 2020 7d29 0a20  9],.        }). 
+00013320: 2020 2020 2020 206f 7574 203d 2069 6e73         out = ins
+00013330: 7461 6e63 652e 5f74 7261 6e73 666f 726d  tance._transform
+00013340: 2874 6162 6c65 5f64 6174 6129 0a0a 2020  (table_data)..  
+00013350: 2020 2020 2020 2320 4173 7365 7274 0a20        # Assert. 
+00013360: 2020 2020 2020 2065 7870 6563 7465 645f         expected_
+00013370: 6f75 7420 3d20 7064 2e44 6174 6146 7261  out = pd.DataFra
+00013380: 6d65 287b 0a20 2020 2020 2020 2020 2020  me({.           
+00013390: 2027 6327 3a20 5b37 2c20 382c 2039 5d2c   'c': [7, 8, 9],
+000133a0: 0a20 2020 2020 2020 2020 2020 2027 6123  .            'a#
+000133b0: 273a 205b 6e70 2e6c 6f67 2831 292c 206e  ': [np.log(1), n
+000133c0: 702e 6c6f 6728 3229 2c20 6e70 2e6c 6f67  p.log(2), np.log
+000133d0: 2833 295d 2c0a 2020 2020 2020 2020 7d29  (3)],.        })
+000133e0: 0a20 2020 2020 2020 2070 642e 7465 7374  .        pd.test
+000133f0: 696e 672e 6173 7365 7274 5f66 7261 6d65  ing.assert_frame
+00013400: 5f65 7175 616c 286f 7574 2c20 6578 7065  _equal(out, expe
+00013410: 6374 6564 5f6f 7574 290a 0a20 2020 2064  cted_out)..    d
+00013420: 6566 2074 6573 745f 5f74 7261 6e73 666f  ef test__transfo
+00013430: 726d 5f64 6174 6574 696d 6528 7365 6c66  rm_datetime(self
+00013440: 293a 0a20 2020 2020 2020 2022 2222 5465  ):.        """Te
+00013450: 7374 2074 6865 2060 6053 6361 6c61 7249  st the ``ScalarI
+00013460: 6e65 7175 616c 6974 792e 5f74 7261 6e73  nequality._trans
+00013470: 666f 726d 6060 206d 6574 686f 642e 0a0a  form`` method...
+00013480: 2020 2020 2020 2020 5468 6520 6d65 7468          The meth
+00013490: 6f64 2069 7320 6578 7065 6374 6564 2074  od is expected t
+000134a0: 6f20 636f 6d70 7574 6520 7468 6520 6469  o compute the di
+000134b0: 7374 616e 6365 2062 6574 7765 656e 2074  stance between t
+000134c0: 6865 2060 6063 6f6c 756d 6e5f 6e61 6d65  he ``column_name
+000134d0: 6060 2061 6e64 2060 6076 616c 7565 6060  `` and ``value``
+000134e0: 0a20 2020 2020 2020 2061 6e64 2063 7265  .        and cre
+000134f0: 6174 6520 6120 6469 6666 2063 6f6c 756d  ate a diff colum
+00013500: 6e20 7769 7468 2074 6865 206c 6f67 6172  n with the logar
+00013510: 6974 686d 206f 6620 7468 6520 6469 7374  ithm of the dist
+00013520: 616e 6365 202b 2031 2e0a 0a20 2020 2020  ance + 1...     
+00013530: 2020 2053 6574 7570 3a0a 2020 2020 2020     Setup:.      
+00013540: 2020 2d20 6060 5f64 6966 665f 636f 6c75    - ``_diff_colu
+00013550: 6d6e 5f6e 616d 6560 6020 6973 2073 6574  mn_name`` is set
+00013560: 2074 6f20 6060 2761 2327 6060 2e0a 2020   to ``'a#'``..  
+00013570: 2020 2020 2020 496e 7075 743a 0a20 2020        Input:.   
+00013580: 2020 2020 202d 2054 6162 6c65 2064 6174       - Table dat
+00013590: 6120 7769 7468 2064 6174 6574 696d 6573  a with datetimes
+000135a0: 2e0a 2020 2020 2020 2020 4f75 7470 7574  ..        Output
+000135b0: 3a0a 2020 2020 2020 2020 2d20 5361 6d65  :.        - Same
+000135c0: 2074 6162 6c65 2077 6974 6820 6120 6469   table with a di
+000135d0: 6666 2063 6f6c 756d 6e20 6f66 2074 6865  ff column of the
+000135e0: 206c 6f67 6172 6974 686d 7320 6f66 2074   logarithms of t
+000135f0: 6865 2064 6973 7461 6e63 6573 202b 2031  he distances + 1
+00013600: 0a20 2020 2020 2020 2020 2069 6e20 7468  .          in th
+00013610: 6520 6060 636f 6c75 6d6e 5f6e 616d 6560  e ``column_name`
+00013620: 6027 7320 706c 6163 652e 0a20 2020 2020  `'s place..     
+00013630: 2020 2022 2222 0a20 2020 2020 2020 2023     """.        #
+00013640: 2053 6574 7570 0a20 2020 2020 2020 2069   Setup.        i
+00013650: 6e73 7461 6e63 6520 3d20 5363 616c 6172  nstance = Scalar
+00013660: 496e 6571 7561 6c69 7479 280a 2020 2020  Inequality(.    
+00013670: 2020 2020 2020 2020 636f 6c75 6d6e 5f6e          column_n
+00013680: 616d 653d 2761 272c 0a20 2020 2020 2020  ame='a',.       
+00013690: 2020 2020 2076 616c 7565 3d27 3230 3230       value='2020
+000136a0: 2d30 312d 3031 5430 303a 3030 3a30 3027  -01-01T00:00:00'
+000136b0: 2c0a 2020 2020 2020 2020 2020 2020 7265  ,.            re
+000136c0: 6c61 7469 6f6e 3d27 3e27 290a 2020 2020  lation='>').    
+000136d0: 2020 2020 696e 7374 616e 6365 2e5f 6469      instance._di
+000136e0: 6666 5f63 6f6c 756d 6e5f 6e61 6d65 203d  ff_column_name =
+000136f0: 2027 6123 270a 2020 2020 2020 2020 696e   'a#'.        in
+00013700: 7374 616e 6365 2e5f 6973 5f64 6174 6574  stance._is_datet
+00013710: 696d 6520 3d20 5472 7565 0a0a 2020 2020  ime = True..    
+00013720: 2020 2020 2320 5275 6e0a 2020 2020 2020      # Run.      
+00013730: 2020 7461 626c 655f 6461 7461 203d 2070    table_data = p
+00013740: 642e 4461 7461 4672 616d 6528 7b0a 2020  d.DataFrame({.  
+00013750: 2020 2020 2020 2020 2020 2761 273a 2070            'a': p
+00013760: 642e 746f 5f64 6174 6574 696d 6528 5b27  d.to_datetime(['
+00013770: 3230 3230 2d30 312d 3031 5430 303a 3030  2020-01-01T00:00
+00013780: 3a30 3127 2c20 2732 3032 302d 3031 2d30  :01', '2020-01-0
+00013790: 3154 3030 3a30 303a 3031 275d 292c 0a20  1T00:00:01']),. 
+000137a0: 2020 2020 2020 2020 2020 2027 6327 3a20             'c': 
+000137b0: 5b31 2c20 325d 2c0a 2020 2020 2020 2020  [1, 2],.        
+000137c0: 7d29 0a20 2020 2020 2020 206f 7574 203d  }).        out =
+000137d0: 2069 6e73 7461 6e63 652e 5f74 7261 6e73   instance._trans
+000137e0: 666f 726d 2874 6162 6c65 5f64 6174 6129  form(table_data)
+000137f0: 0a0a 2020 2020 2020 2020 2320 4173 7365  ..        # Asse
+00013800: 7274 0a20 2020 2020 2020 2065 7870 6563  rt.        expec
+00013810: 7465 645f 6f75 7420 3d20 7064 2e44 6174  ted_out = pd.Dat
+00013820: 6146 7261 6d65 287b 0a20 2020 2020 2020  aFrame({.       
+00013830: 2020 2020 2027 6327 3a20 5b31 2c20 325d       'c': [1, 2]
+00013840: 2c0a 2020 2020 2020 2020 2020 2020 2761  ,.            'a
+00013850: 2327 3a20 5b6e 702e 6c6f 6728 315f 3030  #': [np.log(1_00
+00013860: 305f 3030 305f 3030 3129 2c20 6e70 2e6c  0_000_001), np.l
+00013870: 6f67 2831 5f30 3030 5f30 3030 5f30 3031  og(1_000_000_001
+00013880: 295d 2c0a 2020 2020 2020 2020 7d29 0a20  )],.        }). 
+00013890: 2020 2020 2020 2070 642e 7465 7374 696e         pd.testin
+000138a0: 672e 6173 7365 7274 5f66 7261 6d65 5f65  g.assert_frame_e
+000138b0: 7175 616c 286f 7574 2c20 6578 7065 6374  qual(out, expect
+000138c0: 6564 5f6f 7574 290a 0a20 2020 2064 6566  ed_out)..    def
+000138d0: 2074 6573 745f 7265 7665 7273 655f 7472   test_reverse_tr
+000138e0: 616e 7366 6f72 6d28 7365 6c66 293a 0a20  ansform(self):. 
+000138f0: 2020 2020 2020 2022 2222 5465 7374 2074         """Test t
+00013900: 6865 2060 6053 6361 6c61 7249 6e65 7175  he ``ScalarInequ
+00013910: 616c 6974 792e 7265 7665 7273 655f 7472  ality.reverse_tr
+00013920: 616e 7366 6f72 6d60 6020 6d65 7468 6f64  ansform`` method
+00013930: 2e0a 0a20 2020 2020 2020 2054 6865 206d  ...        The m
+00013940: 6574 686f 6420 6973 2065 7870 6563 7465  ethod is expecte
+00013950: 6420 746f 3a0a 2020 2020 2020 2020 2020  d to:.          
+00013960: 2020 2d20 6170 706c 7920 616e 2065 7870    - apply an exp
+00013970: 6f6e 656e 7469 616c 2074 6f20 7468 6520  onential to the 
+00013980: 696e 7075 740a 2020 2020 2020 2020 2020  input.          
+00013990: 2020 2d20 7375 6274 7261 6374 2031 0a20    - subtract 1. 
+000139a0: 2020 2020 2020 2020 2020 202d 2061 6464             - add
+000139b0: 2074 6865 2060 6063 6f6c 756d 6e5f 6e61   the ``column_na
+000139c0: 6d65 6060 0a20 2020 2020 2020 2020 2020  me``.           
+000139d0: 202d 2063 6f6e 7665 7274 2074 6865 206f   - convert the o
+000139e0: 7574 7075 7420 746f 2069 6e74 6567 6572  utput to integer
+000139f0: 730a 2020 2020 2020 2020 2020 2020 2d20  s.            - 
+00013a00: 6164 6420 6261 636b 2074 6865 2064 726f  add back the dro
+00013a10: 7070 6564 2063 6f6c 756d 6e0a 0a20 2020  pped column..   
+00013a20: 2020 2020 2053 6574 7570 3a0a 2020 2020       Setup:.    
+00013a30: 2020 2020 2d20 6060 5f64 6966 665f 636f      - ``_diff_co
+00013a40: 6c75 6d6e 5f6e 616d 6520 3d20 2761 2327  lumn_name = 'a#'
+00013a50: 6060 0a20 2020 2020 2020 202d 2060 605f  ``.        - ``_
+00013a60: 6474 7970 6560 6020 6173 2069 6e74 6567  dtype`` as integ
+00013a70: 6572 0a20 2020 2020 2020 2049 6e70 7574  er.        Input
+00013a80: 3a0a 2020 2020 2020 2020 2d20 5461 626c  :.        - Tabl
+00013a90: 6520 7769 7468 2061 2064 6966 6620 636f  e with a diff co
+00013aa0: 6c75 6d6e 2074 6861 7420 636f 6e74 6169  lumn that contai
+00013ab0: 6e73 2074 6865 2063 6f6e 7374 616e 7420  ns the constant 
+00013ac0: 6e70 2e6c 6f67 2834 292e 0a20 2020 2020  np.log(4)..     
+00013ad0: 2020 204f 7574 7075 743a 0a20 2020 2020     Output:.     
+00013ae0: 2020 202d 2053 616d 6520 7461 626c 6520     - Same table 
+00013af0: 7769 7468 2074 6865 2068 6967 6820 636f  with the high co
+00013b00: 6c75 6d6e 2072 6570 6c61 6365 6420 6279  lumn replaced by
+00013b10: 2074 6865 206c 6f77 206f 6e65 202b 2033   the low one + 3
+00013b20: 2c20 6173 2069 6e74 0a20 2020 2020 2020  , as int.       
+00013b30: 2061 6e64 2074 6865 2064 6966 6620 636f   and the diff co
+00013b40: 6c75 6d6e 2064 726f 7070 6564 2e0a 2020  lumn dropped..  
+00013b50: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00013b60: 2020 2320 5365 7475 700a 2020 2020 2020    # Setup.      
+00013b70: 2020 696e 7374 616e 6365 203d 2053 6361    instance = Sca
+00013b80: 6c61 7249 6e65 7175 616c 6974 7928 636f  larInequality(co
+00013b90: 6c75 6d6e 5f6e 616d 653d 2761 272c 2076  lumn_name='a', v
+00013ba0: 616c 7565 3d31 2c20 7265 6c61 7469 6f6e  alue=1, relation
+00013bb0: 3d27 3e3d 2729 0a20 2020 2020 2020 2069  ='>=').        i
+00013bc0: 6e73 7461 6e63 652e 5f64 7479 7065 203d  nstance._dtype =
+00013bd0: 2070 642e 5365 7269 6573 285b 315d 292e   pd.Series([1]).
+00013be0: 6474 7970 6520 2023 2065 7861 6374 2064  dtype  # exact d
+00013bf0: 7479 7065 2028 3332 206f 7220 3634 2920  type (32 or 64) 
+00013c00: 6465 7065 6e64 7320 6f6e 204f 530a 2020  depends on OS.  
+00013c10: 2020 2020 2020 696e 7374 616e 6365 2e5f        instance._
+00013c20: 6469 6666 5f63 6f6c 756d 6e5f 6e61 6d65  diff_column_name
+00013c30: 203d 2027 6123 270a 0a20 2020 2020 2020   = 'a#'..       
+00013c40: 2023 2052 756e 0a20 2020 2020 2020 2074   # Run.        t
+00013c50: 7261 6e73 666f 726d 6564 203d 2070 642e  ransformed = pd.
+00013c60: 4461 7461 4672 616d 6528 7b0a 2020 2020  DataFrame({.    
+00013c70: 2020 2020 2020 2020 2761 2327 3a20 5b6e          'a#': [n
+00013c80: 702e 6c6f 6728 3129 2c20 6e70 2e6c 6f67  p.log(1), np.log
+00013c90: 2832 292c 206e 702e 6c6f 6728 3329 5d2c  (2), np.log(3)],
+00013ca0: 0a20 2020 2020 2020 2020 2020 2027 6327  .            'c'
+00013cb0: 3a20 5b37 2c20 382c 2039 5d2c 0a20 2020  : [7, 8, 9],.   
+00013cc0: 2020 2020 207d 290a 2020 2020 2020 2020       }).        
+00013cd0: 6f75 7420 3d20 696e 7374 616e 6365 2e72  out = instance.r
+00013ce0: 6576 6572 7365 5f74 7261 6e73 666f 726d  everse_transform
+00013cf0: 2874 7261 6e73 666f 726d 6564 290a 0a20  (transformed).. 
+00013d00: 2020 2020 2020 2023 2041 7373 6572 740a         # Assert.
+00013d10: 2020 2020 2020 2020 6578 7065 6374 6564          expected
+00013d20: 5f6f 7574 203d 2070 642e 4461 7461 4672  _out = pd.DataFr
+00013d30: 616d 6528 7b0a 2020 2020 2020 2020 2020  ame({.          
+00013d40: 2020 2763 273a 205b 372c 2038 2c20 395d    'c': [7, 8, 9]
+00013d50: 2c0a 2020 2020 2020 2020 2020 2020 2761  ,.            'a
+00013d60: 273a 205b 312c 2032 2c20 335d 2c0a 2020  ': [1, 2, 3],.  
+00013d70: 2020 2020 2020 7d29 0a20 2020 2020 2020        }).       
+00013d80: 2070 642e 7465 7374 696e 672e 6173 7365   pd.testing.asse
+00013d90: 7274 5f66 7261 6d65 5f65 7175 616c 286f  rt_frame_equal(o
+00013da0: 7574 2c20 6578 7065 6374 6564 5f6f 7574  ut, expected_out
+00013db0: 290a 0a20 2020 2064 6566 2074 6573 745f  )..    def test_
+00013dc0: 7265 7665 7273 655f 7472 616e 7366 6f72  reverse_transfor
+00013dd0: 6d5f 666c 6f61 7473 2873 656c 6629 3a0a  m_floats(self):.
+00013de0: 2020 2020 2020 2020 2222 2254 6573 7420          """Test 
+00013df0: 7468 6520 6060 5363 616c 6172 496e 6571  the ``ScalarIneq
+00013e00: 7561 6c69 7479 2e72 6576 6572 7365 5f74  uality.reverse_t
+00013e10: 7261 6e73 666f 726d 6060 206d 6574 686f  ransform`` metho
+00013e20: 642e 0a0a 2020 2020 2020 2020 5468 6520  d...        The 
+00013e30: 6d65 7468 6f64 2069 7320 6578 7065 6374  method is expect
+00013e40: 6564 2074 6f3a 0a20 2020 2020 2020 2020  ed to:.         
+00013e50: 2020 202d 2061 7070 6c79 2061 6e20 6578     - apply an ex
+00013e60: 706f 6e65 6e74 6961 6c20 746f 2074 6865  ponential to the
+00013e70: 2069 6e70 7574 0a20 2020 2020 2020 2020   input.         
+00013e80: 2020 202d 2073 7562 7472 6163 7420 310a     - subtract 1.
+00013e90: 2020 2020 2020 2020 2020 2020 2d20 6164              - ad
+00013ea0: 6420 7468 6520 6060 7661 6c75 6560 600a  d the ``value``.
+00013eb0: 2020 2020 2020 2020 2020 2020 2d20 636f              - co
+00013ec0: 6e76 6572 7420 7468 6520 6f75 7470 7574  nvert the output
+00013ed0: 2074 6f20 666c 6f61 740a 2020 2020 2020   to float.      
+00013ee0: 2020 2020 2020 2d20 6164 6420 6261 636b        - add back
+00013ef0: 2074 6865 2064 726f 7070 6564 2063 6f6c   the dropped col
+00013f00: 756d 6e0a 0a20 2020 2020 2020 2053 6574  umn..        Set
+00013f10: 7570 3a0a 2020 2020 2020 2020 2d20 6060  up:.        - ``
+00013f20: 5f64 6966 665f 636f 6c75 6d6e 5f6e 616d  _diff_column_nam
+00013f30: 6520 3d20 2761 2327 6060 0a20 2020 2020  e = 'a#'``.     
+00013f40: 2020 202d 2060 605f 6474 7970 6560 6020     - ``_dtype`` 
+00013f50: 6173 2066 6c6f 6174 0a20 2020 2020 2020  as float.       
+00013f60: 2049 6e70 7574 3a0a 2020 2020 2020 2020   Input:.        
+00013f70: 2d20 5461 626c 6520 7769 7468 2061 2064  - Table with a d
+00013f80: 6966 6620 636f 6c75 6d6e 2074 6861 7420  iff column that 
+00013f90: 636f 6e74 6169 6e73 2074 6865 2063 6f6e  contains the con
+00013fa0: 7374 616e 7420 6e70 2e6c 6f67 2834 292e  stant np.log(4).
+00013fb0: 0a20 2020 2020 2020 204f 7574 7075 743a  .        Output:
+00013fc0: 0a20 2020 2020 2020 202d 2053 616d 6520  .        - Same 
+00013fd0: 7461 626c 6520 7769 7468 2074 6865 2068  table with the h
+00013fe0: 6967 6820 636f 6c75 6d6e 2072 6570 6c61  igh column repla
+00013ff0: 6365 6420 6279 2074 6865 206c 6f77 206f  ced by the low o
+00014000: 6e65 202b 2031 2c20 6173 2066 6c6f 6174  ne + 1, as float
+00014010: 0a20 2020 2020 2020 2061 6e64 2074 6865  .        and the
+00014020: 2064 6966 6620 636f 6c75 6d6e 2064 726f   diff column dro
+00014030: 7070 6564 2e0a 2020 2020 2020 2020 2222  pped..        ""
+00014040: 220a 2020 2020 2020 2020 2320 5365 7475  ".        # Setu
+00014050: 700a 2020 2020 2020 2020 696e 7374 616e  p.        instan
+00014060: 6365 203d 2053 6361 6c61 7249 6e65 7175  ce = ScalarInequ
+00014070: 616c 6974 7928 636f 6c75 6d6e 5f6e 616d  ality(column_nam
+00014080: 653d 2761 272c 2076 616c 7565 3d31 2c20  e='a', value=1, 
+00014090: 7265 6c61 7469 6f6e 3d27 3e3d 2729 0a20  relation='>='). 
+000140a0: 2020 2020 2020 2069 6e73 7461 6e63 652e         instance.
+000140b0: 5f64 7479 7065 203d 206e 702e 6474 7970  _dtype = np.dtyp
+000140c0: 6528 2766 6c6f 6174 2729 0a20 2020 2020  e('float').     
+000140d0: 2020 2069 6e73 7461 6e63 652e 5f64 6966     instance._dif
+000140e0: 665f 636f 6c75 6d6e 5f6e 616d 6520 3d20  f_column_name = 
+000140f0: 2761 2327 0a0a 2020 2020 2020 2020 2320  'a#'..        # 
+00014100: 5275 6e0a 2020 2020 2020 2020 7472 616e  Run.        tran
+00014110: 7366 6f72 6d65 6420 3d20 7064 2e44 6174  sformed = pd.Dat
+00014120: 6146 7261 6d65 287b 0a20 2020 2020 2020  aFrame({.       
+00014130: 2020 2020 2027 6123 273a 205b 6e70 2e6c       'a#': [np.l
+00014140: 6f67 2831 2e31 292c 206e 702e 6c6f 6728  og(1.1), np.log(
+00014150: 322e 3129 2c20 6e70 2e6c 6f67 2833 2e33  2.1), np.log(3.3
+00014160: 295d 2c0a 2020 2020 2020 2020 2020 2020  )],.            
+00014170: 2763 273a 205b 372c 2038 2c20 395d 2c0a  'c': [7, 8, 9],.
+00014180: 2020 2020 2020 2020 7d29 0a20 2020 2020          }).     
+00014190: 2020 206f 7574 203d 2069 6e73 7461 6e63     out = instanc
+000141a0: 652e 7265 7665 7273 655f 7472 616e 7366  e.reverse_transf
+000141b0: 6f72 6d28 7472 616e 7366 6f72 6d65 6429  orm(transformed)
+000141c0: 0a0a 2020 2020 2020 2020 2320 4173 7365  ..        # Asse
+000141d0: 7274 0a20 2020 2020 2020 2065 7870 6563  rt.        expec
+000141e0: 7465 645f 6f75 7420 3d20 7064 2e44 6174  ted_out = pd.Dat
+000141f0: 6146 7261 6d65 287b 0a20 2020 2020 2020  aFrame({.       
+00014200: 2020 2020 2027 6327 3a20 5b37 2c20 382c       'c': [7, 8,
+00014210: 2039 5d2c 0a20 2020 2020 2020 2020 2020   9],.           
+00014220: 2027 6127 3a20 5b31 2e31 2c20 322e 312c   'a': [1.1, 2.1,
+00014230: 2033 2e33 5d2c 0a20 2020 2020 2020 207d   3.3],.        }
+00014240: 290a 2020 2020 2020 2020 7064 2e74 6573  ).        pd.tes
+00014250: 7469 6e67 2e61 7373 6572 745f 6672 616d  ting.assert_fram
+00014260: 655f 6571 7561 6c28 6f75 742c 2065 7870  e_equal(out, exp
+00014270: 6563 7465 645f 6f75 7429 0a0a 2020 2020  ected_out)..    
+00014280: 6465 6620 7465 7374 5f72 6576 6572 7365  def test_reverse
+00014290: 5f74 7261 6e73 666f 726d 5f64 6174 6574  _transform_datet
+000142a0: 696d 6528 7365 6c66 293a 0a20 2020 2020  ime(self):.     
+000142b0: 2020 2022 2222 5465 7374 2074 6865 2060     """Test the `
+000142c0: 6053 6361 6c61 7249 6e65 7175 616c 6974  `ScalarInequalit
+000142d0: 792e 7265 7665 7273 655f 7472 616e 7366  y.reverse_transf
+000142e0: 6f72 6d60 6020 6d65 7468 6f64 2e0a 0a20  orm`` method... 
+000142f0: 2020 2020 2020 2054 6865 206d 6574 686f         The metho
+00014300: 6420 6973 2065 7870 6563 7465 6420 746f  d is expected to
+00014310: 3a0a 2020 2020 2020 2020 2020 2020 2d20  :.            - 
+00014320: 6170 706c 7920 616e 2065 7870 6f6e 656e  apply an exponen
+00014330: 7469 616c 2074 6f20 7468 6520 696e 7075  tial to the inpu
+00014340: 740a 2020 2020 2020 2020 2020 2020 2d20  t.            - 
+00014350: 7375 6274 7261 6374 2031 0a20 2020 2020  subtract 1.     
+00014360: 2020 2020 2020 202d 2061 6464 2074 6865         - add the
+00014370: 2060 6063 6f6c 756d 6e5f 6e61 6d65 6060   ``column_name``
+00014380: 0a20 2020 2020 2020 2020 2020 202d 2063  .            - c
+00014390: 6f6e 7665 7274 2074 6865 206f 7574 7075  onvert the outpu
+000143a0: 7420 746f 2064 6174 6574 696d 650a 2020  t to datetime.  
+000143b0: 2020 2020 2020 2020 2020 2d20 6164 6420            - add 
+000143c0: 6261 636b 2074 6865 2064 726f 7070 6564  back the dropped
+000143d0: 2063 6f6c 756d 6e0a 0a20 2020 2020 2020   column..       
+000143e0: 2053 6574 7570 3a0a 2020 2020 2020 2020   Setup:.        
+000143f0: 2d20 6060 5f64 6966 665f 636f 6c75 6d6e  - ``_diff_column
+00014400: 5f6e 616d 6520 3d20 2761 2327 6060 0a20  _name = 'a#'``. 
+00014410: 2020 2020 2020 202d 2060 605f 6474 7970         - ``_dtyp
+00014420: 6560 6020 6173 2064 6174 6574 696d 650a  e`` as datetime.
+00014430: 2020 2020 2020 2020 496e 7075 743a 0a20          Input:. 
+00014440: 2020 2020 2020 202d 2054 6162 6c65 2077         - Table w
+00014450: 6974 6820 6120 6469 6666 2063 6f6c 756d  ith a diff colum
+00014460: 6e20 7468 6174 2063 6f6e 7461 696e 7320  n that contains 
+00014470: 7468 6520 636f 6e73 7461 6e74 206e 702e  the constant np.
+00014480: 6c6f 6728 3429 2e0a 2020 2020 2020 2020  log(4)..        
+00014490: 4f75 7470 7574 3a0a 2020 2020 2020 2020  Output:.        
+000144a0: 2d20 5361 6d65 2074 6162 6c65 2077 6974  - Same table wit
+000144b0: 6820 7468 6520 6869 6768 2063 6f6c 756d  h the high colum
+000144c0: 6e20 7265 706c 6163 6564 2062 7920 7468  n replaced by th
+000144d0: 6520 6c6f 7720 6f6e 6520 2b20 332c 2061  e low one + 3, a
+000144e0: 7320 6461 7465 7469 6d65 0a20 2020 2020  s datetime.     
+000144f0: 2020 2061 6e64 2074 6865 2064 6966 6620     and the diff 
+00014500: 636f 6c75 6d6e 2064 726f 7070 6564 2e0a  column dropped..
+00014510: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00014520: 2020 2020 2320 5365 7475 700a 2020 2020      # Setup.    
+00014530: 2020 2020 696e 7374 616e 6365 203d 2053      instance = S
+00014540: 6361 6c61 7249 6e65 7175 616c 6974 7928  calarInequality(
+00014550: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
+00014560: 756d 6e5f 6e61 6d65 3d27 6127 2c0a 2020  umn_name='a',.  
+00014570: 2020 2020 2020 2020 2020 7661 6c75 653d            value=
+00014580: 2732 3032 302d 3031 2d30 3154 3030 3a30  '2020-01-01T00:0
+00014590: 303a 3030 272c 0a20 2020 2020 2020 2020  0:00',.         
+000145a0: 2020 2072 656c 6174 696f 6e3d 273e 3d27     relation='>='
+000145b0: 290a 2020 2020 2020 2020 696e 7374 616e  ).        instan
+000145c0: 6365 2e5f 6474 7970 6520 3d20 6e70 2e64  ce._dtype = np.d
+000145d0: 7479 7065 2827 3c4d 385b 6e73 5d27 290a  type('<M8[ns]').
+000145e0: 2020 2020 2020 2020 696e 7374 616e 6365          instance
+000145f0: 2e5f 6469 6666 5f63 6f6c 756d 6e5f 6e61  ._diff_column_na
+00014600: 6d65 203d 2027 6123 270a 2020 2020 2020  me = 'a#'.      
+00014610: 2020 696e 7374 616e 6365 2e5f 6973 5f64    instance._is_d
+00014620: 6174 6574 696d 6520 3d20 5472 7565 0a0a  atetime = True..
+00014630: 2020 2020 2020 2020 2320 5275 6e0a 2020          # Run.  
+00014640: 2020 2020 2020 7472 616e 7366 6f72 6d65        transforme
+00014650: 6420 3d20 7064 2e44 6174 6146 7261 6d65  d = pd.DataFrame
+00014660: 287b 0a20 2020 2020 2020 2020 2020 2027  ({.            '
+00014670: 6123 273a 205b 6e70 2e6c 6f67 2831 5f30  a#': [np.log(1_0
+00014680: 3030 5f30 3030 5f30 3031 292c 206e 702e  00_000_001), np.
+00014690: 6c6f 6728 315f 3030 305f 3030 305f 3030  log(1_000_000_00
+000146a0: 3129 5d2c 0a20 2020 2020 2020 2020 2020  1)],.           
+000146b0: 2027 6327 3a20 5b31 2c20 325d 2c0a 2020   'c': [1, 2],.  
+000146c0: 2020 2020 2020 7d29 0a20 2020 2020 2020        }).       
+000146d0: 206f 7574 203d 2069 6e73 7461 6e63 652e   out = instance.
+000146e0: 7265 7665 7273 655f 7472 616e 7366 6f72  reverse_transfor
+000146f0: 6d28 7472 616e 7366 6f72 6d65 6429 0a0a  m(transformed)..
+00014700: 2020 2020 2020 2020 2320 4173 7365 7274          # Assert
+00014710: 0a20 2020 2020 2020 2065 7870 6563 7465  .        expecte
+00014720: 645f 6f75 7420 3d20 7064 2e44 6174 6146  d_out = pd.DataF
+00014730: 7261 6d65 287b 0a20 2020 2020 2020 2020  rame({.         
+00014740: 2020 2027 6327 3a20 5b31 2c20 325d 2c0a     'c': [1, 2],.
+00014750: 2020 2020 2020 2020 2020 2020 2761 273a              'a':
+00014760: 2070 642e 746f 5f64 6174 6574 696d 6528   pd.to_datetime(
+00014770: 5b27 3230 3230 2d30 312d 3031 5430 303a  ['2020-01-01T00:
+00014780: 3030 3a30 3127 2c20 2732 3032 302d 3031  00:01', '2020-01
+00014790: 2d30 3154 3030 3a30 303a 3031 275d 292c  -01T00:00:01']),
+000147a0: 0a20 2020 2020 2020 207d 290a 2020 2020  .        }).    
+000147b0: 2020 2020 7064 2e74 6573 7469 6e67 2e61      pd.testing.a
+000147c0: 7373 6572 745f 6672 616d 655f 6571 7561  ssert_frame_equa
+000147d0: 6c28 6f75 742c 2065 7870 6563 7465 645f  l(out, expected_
+000147e0: 6f75 7429 0a0a 2020 2020 6465 6620 7465  out)..    def te
+000147f0: 7374 5f72 6576 6572 7365 5f74 7261 6e73  st_reverse_trans
+00014800: 666f 726d 5f6f 7065 7261 746f 725f 6c65  form_operator_le
+00014810: 7373 2873 656c 6629 3a0a 2020 2020 2020  ss(self):.      
+00014820: 2020 2222 2254 6573 7420 7468 6520 6060    """Test the ``
+00014830: 5363 616c 6172 496e 6571 7561 6c69 7479  ScalarInequality
+00014840: 2e72 6576 6572 7365 5f74 7261 6e73 666f  .reverse_transfo
+00014850: 726d 6060 206d 6574 686f 6420 7768 656e  rm`` method when
+00014860: 206f 7065 7261 746f 7220 6973 2060 606e   operator is ``n
+00014870: 702e 6c65 7373 6060 2e22 2222 0a20 2020  p.less``.""".   
+00014880: 2020 2020 2023 2053 6574 7570 0a20 2020       # Setup.   
+00014890: 2020 2020 2069 6e73 7461 6e63 6520 3d20       instance = 
+000148a0: 5363 616c 6172 496e 6571 7561 6c69 7479  ScalarInequality
+000148b0: 2863 6f6c 756d 6e5f 6e61 6d65 3d27 6127  (column_name='a'
+000148c0: 2c20 7661 6c75 653d 312c 2072 656c 6174  , value=1, relat
+000148d0: 696f 6e3d 273c 2729 0a20 2020 2020 2020  ion='<').       
+000148e0: 2069 6e73 7461 6e63 652e 5f64 7479 7065   instance._dtype
+000148f0: 203d 206e 702e 6474 7970 6528 2766 6c6f   = np.dtype('flo
+00014900: 6174 2729 0a20 2020 2020 2020 2069 6e73  at').        ins
+00014910: 7461 6e63 652e 5f64 6966 665f 636f 6c75  tance._diff_colu
+00014920: 6d6e 5f6e 616d 6520 3d20 2761 2327 0a0a  mn_name = 'a#'..
+00014930: 2020 2020 2020 2020 2320 5275 6e0a 2020          # Run.  
+00014940: 2020 2020 2020 7472 616e 7366 6f72 6d65        transforme
+00014950: 6420 3d20 7064 2e44 6174 6146 7261 6d65  d = pd.DataFrame
+00014960: 287b 0a20 2020 2020 2020 2020 2020 2027  ({.            '
+00014970: 6123 273a 205b 6e70 2e6c 6f67 2831 2e31  a#': [np.log(1.1
+00014980: 292c 206e 702e 6c6f 6728 322e 3129 2c20  ), np.log(2.1), 
+00014990: 6e70 2e6c 6f67 2833 2e33 295d 2c0a 2020  np.log(3.3)],.  
+000149a0: 2020 2020 2020 2020 2020 2763 273a 205b            'c': [
+000149b0: 372c 2038 2c20 395d 2c0a 2020 2020 2020  7, 8, 9],.      
+000149c0: 2020 7d29 0a20 2020 2020 2020 206f 7574    }).        out
+000149d0: 203d 2069 6e73 7461 6e63 652e 7265 7665   = instance.reve
+000149e0: 7273 655f 7472 616e 7366 6f72 6d28 7472  rse_transform(tr
+000149f0: 616e 7366 6f72 6d65 6429 0a0a 2020 2020  ansformed)..    
+00014a00: 2020 2020 2320 4173 7365 7274 0a20 2020      # Assert.   
+00014a10: 2020 2020 2065 7870 6563 7465 645f 6f75       expected_ou
+00014a20: 7420 3d20 7064 2e44 6174 6146 7261 6d65  t = pd.DataFrame
+00014a30: 287b 0a20 2020 2020 2020 2020 2020 2027  ({.            '
+00014a40: 6327 3a20 5b37 2c20 382c 2039 5d2c 0a20  c': [7, 8, 9],. 
+00014a50: 2020 2020 2020 2020 2020 2027 6127 3a20             'a': 
+00014a60: 5b30 2e39 2c20 2d30 2e31 2c20 2d31 2e33  [0.9, -0.1, -1.3
+00014a70: 5d2c 0a20 2020 2020 2020 207d 290a 2020  ],.        }).  
+00014a80: 2020 2020 2020 7064 2e74 6573 7469 6e67        pd.testing
+00014a90: 2e61 7373 6572 745f 6672 616d 655f 6571  .assert_frame_eq
+00014aa0: 7561 6c28 6f75 742c 2065 7870 6563 7465  ual(out, expecte
+00014ab0: 645f 6f75 7429 0a0a 0a63 6c61 7373 2054  d_out)...class T
+00014ac0: 6573 7450 6f73 6974 6976 6528 293a 0a0a  estPositive():..
+00014ad0: 2020 2020 6465 6620 7465 7374 5f5f 7661      def test__va
+00014ae0: 6c69 6461 7465 5f69 6e70 7574 7328 7365  lidate_inputs(se
+00014af0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+00014b00: 5465 7374 2074 6865 2060 6050 6f73 6974  Test the ``Posit
+00014b10: 6976 652e 5f76 616c 6964 6174 655f 696e  ive._validate_in
+00014b20: 7075 7473 6060 206d 6574 686f 642e 0a0a  puts`` method...
+00014b30: 2020 2020 2020 2020 496e 7075 743a 0a20          Input:. 
+00014b40: 2020 2020 2020 202d 2020 496e 636f 7272         -  Incorr
+00014b50: 6563 7420 7061 7261 6d65 7465 7273 2066  ect parameters f
+00014b60: 6f72 2074 6865 206d 6574 686f 640a 2020  or the method.  
+00014b70: 2020 2020 2020 5261 6973 6573 3a0a 2020        Raises:.  
+00014b80: 2020 2020 2020 2d20 4c69 7374 206f 6620        - List of 
+00014b90: 5661 6c75 6545 7272 6f72 730a 2020 2020  ValueErrors.    
+00014ba0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00014bb0: 2320 5275 6e20 2f20 4173 7365 7274 0a20  # Run / Assert. 
+00014bc0: 2020 2020 2020 2077 6974 6820 7079 7465         with pyte
+00014bd0: 7374 2e72 6169 7365 7328 4167 6772 6567  st.raises(Aggreg
+00014be0: 6174 6543 6f6e 7374 7261 696e 7473 4572  ateConstraintsEr
+00014bf0: 726f 7229 2061 7320 6572 726f 723a 0a20  ror) as error:. 
+00014c00: 2020 2020 2020 2020 2020 2050 6f73 6974             Posit
+00014c10: 6976 652e 5f76 616c 6964 6174 655f 696e  ive._validate_in
+00014c20: 7075 7473 286e 6f74 5f63 6f6c 756d 6e5f  puts(not_column_
+00014c30: 6e61 6d65 3d4e 6f6e 652c 2073 6f6d 6574  name=None, somet
+00014c40: 6869 6e67 5f65 6c73 653d 4e6f 6e65 290a  hing_else=None).
+00014c50: 0a20 2020 2020 2020 2065 7272 5f6d 7367  .        err_msg
+00014c60: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
+00014c70: 2072 274d 6973 7369 6e67 2072 6571 7569   r'Missing requi
+00014c80: 7265 6420 7661 6c75 6573 207b 282e 2a29  red values {(.*)
+00014c90: 7d20 696e 2061 2050 6f73 6974 6976 6520  } in a Positive 
+00014ca0: 636f 6e73 7472 6169 6e74 2e27 0a20 2020  constraint.'.   
+00014cb0: 2020 2020 2020 2020 2072 275c 6e5c 6e49           r'\n\nI
+00014cc0: 6e76 616c 6964 2076 616c 7565 7320 7b28  nvalid values {(
+00014cd0: 2e2a 297d 2061 7265 2070 7265 7365 6e74  .*)} are present
+00014ce0: 2069 6e20 6120 506f 7369 7469 7665 2063   in a Positive c
+00014cf0: 6f6e 7374 7261 696e 742e 270a 2020 2020  onstraint.'.    
+00014d00: 2020 2020 290a 2020 2020 2020 2020 6772      ).        gr
+00014d10: 6f75 7073 203d 2072 652e 7365 6172 6368  oups = re.search
+00014d20: 2865 7272 5f6d 7367 2c20 7374 7228 6572  (err_msg, str(er
+00014d30: 726f 722e 7661 6c75 6529 290a 2020 2020  ror.value)).    
+00014d40: 2020 2020 6173 7365 7274 2067 726f 7570      assert group
+00014d50: 7320 6973 206e 6f74 204e 6f6e 650a 2020  s is not None.  
+00014d60: 2020 2020 2020 6173 7365 7274 2073 7472        assert str
+00014d70: 2865 7661 6c28 6772 6f75 7073 2e67 726f  (eval(groups.gro
+00014d80: 7570 2831 2929 2920 3d3d 2027 636f 6c75  up(1))) == 'colu
+00014d90: 6d6e 5f6e 616d 6527 0a20 2020 2020 2020  mn_name'.       
+00014da0: 2061 7373 6572 7420 7365 7428 6576 616c   assert set(eval
+00014db0: 2867 726f 7570 732e 6772 6f75 7028 3229  (groups.group(2)
+00014dc0: 2929 203d 3d20 7b27 736f 6d65 7468 696e  )) == {'somethin
+00014dd0: 675f 656c 7365 272c 2027 6e6f 745f 636f  g_else', 'not_co
+00014de0: 6c75 6d6e 5f6e 616d 6527 7d0a 0a20 2020  lumn_name'}..   
+00014df0: 2064 6566 2074 6573 745f 5f76 616c 6964   def test__valid
+00014e00: 6174 655f 6d65 7461 6461 7461 5f63 6f6c  ate_metadata_col
+00014e10: 756d 6e73 2873 656c 6629 3a0a 2020 2020  umns(self):.    
+00014e20: 2020 2020 2222 2254 6573 7420 7468 6520      """Test the 
+00014e30: 6060 5f76 616c 6964 6174 655f 6d65 7461  ``_validate_meta
+00014e40: 6461 7461 5f63 6f6c 756d 6e73 6060 206d  data_columns`` m
+00014e50: 6574 686f 642e 0a0a 2020 2020 2020 2020  ethod...        
+00014e60: 5468 6520 636f 6c75 6d6e 2070 6173 7365  The column passe
+00014e70: 6420 696e 2063 6f6c 756d 6e5f 6e61 6d65  d in column_name
+00014e80: 2073 686f 756c 6420 6265 2069 6e20 7468   should be in th
+00014e90: 6520 6d65 7461 6461 7461 2e0a 0a20 2020  e metadata...   
+00014ea0: 2020 2020 2049 6e70 7574 3a0a 2020 2020       Input:.    
+00014eb0: 2020 2020 2020 2020 2d20 636f 6c75 6d6e          - column
+00014ec0: 5f6e 616d 6520 7468 6174 2069 7320 696e  _name that is in
+00014ed0: 2074 6865 206d 6574 6164 6174 612e 0a0a   the metadata...
+00014ee0: 2020 2020 2020 2020 5369 6465 2065 6666          Side eff
+00014ef0: 6563 743a 0a20 2020 2020 2020 2020 2020  ect:.           
+00014f00: 202d 204e 6f20 6572 726f 7220 7368 6f75   - No error shou
+00014f10: 6c64 2062 6520 7261 6973 6564 2e0a 2020  ld be raised..  
+00014f20: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00014f30: 2020 2320 5365 7475 700a 2020 2020 2020    # Setup.      
+00014f40: 2020 6d65 7461 6461 7461 203d 204d 6f63    metadata = Moc
+00014f50: 6b28 290a 2020 2020 2020 2020 6d65 7461  k().        meta
+00014f60: 6461 7461 2e63 6f6c 756d 6e73 203d 207b  data.columns = {
+00014f70: 2761 273a 2031 2c20 2762 273a 2032 7d0a  'a': 1, 'b': 2}.
+00014f80: 0a20 2020 2020 2020 2023 2052 756e 0a20  .        # Run. 
+00014f90: 2020 2020 2020 2050 6f73 6974 6976 652e         Positive.
+00014fa0: 5f76 616c 6964 6174 655f 6d65 7461 6461  _validate_metada
+00014fb0: 7461 5f63 6f6c 756d 6e73 286d 6574 6164  ta_columns(metad
+00014fc0: 6174 612c 2063 6f6c 756d 6e5f 6e61 6d65  ata, column_name
+00014fd0: 3d27 6127 290a 0a20 2020 2064 6566 2074  ='a')..    def t
+00014fe0: 6573 745f 5f76 616c 6964 6174 655f 6d65  est__validate_me
+00014ff0: 7461 6461 7461 5f63 6f6c 756d 6e73 5f72  tadata_columns_r
+00015000: 6169 7365 735f 6572 726f 7228 7365 6c66  aises_error(self
+00015010: 293a 0a20 2020 2020 2020 2022 2222 5465  ):.        """Te
+00015020: 7374 2074 6865 2060 605f 7661 6c69 6461  st the ``_valida
+00015030: 7465 5f6d 6574 6164 6174 615f 636f 6c75  te_metadata_colu
+00015040: 6d6e 7360 6020 6d65 7468 6f64 2773 2065  mns`` method's e
+00015050: 7272 6f72 2063 6f6e 6469 7469 6f6e 2e0a  rror condition..
+00015060: 0a20 2020 2020 2020 2049 6620 636f 6c75  .        If colu
+00015070: 6d6e 5f6e 616d 6520 6973 206e 6f74 2069  mn_name is not i
+00015080: 6e20 7468 6520 6d65 7461 6461 7461 2c20  n the metadata, 
+00015090: 616e 2065 7272 6f72 2073 686f 756c 6420  an error should 
+000150a0: 6265 2072 6169 7365 642e 0a0a 2020 2020  be raised...    
+000150b0: 2020 2020 496e 7075 743a 0a20 2020 2020      Input:.     
+000150c0: 2020 2020 2020 202d 2063 6f6c 756d 6e5f         - column_
+000150d0: 6e61 6d65 2074 6861 7420 6973 206e 6f74  name that is not
+000150e0: 2069 6e20 7468 6520 6d65 7461 6461 7461   in the metadata
+000150f0: 2e0a 0a20 2020 2020 2020 2053 6964 6520  ...        Side 
+00015100: 6566 6665 6374 3a0a 2020 2020 2020 2020  effect:.        
+00015110: 2020 2020 2d20 436f 6e73 7472 6169 6e74      - Constraint
+00015120: 4d65 7461 6461 7461 4572 726f 7220 7368  MetadataError sh
+00015130: 6f75 6c64 2062 6520 7261 6973 6564 2e0a  ould be raised..
+00015140: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00015150: 2020 2020 2320 5365 7475 700a 2020 2020      # Setup.    
+00015160: 2020 2020 6d65 7461 6461 7461 203d 204d      metadata = M
+00015170: 6f63 6b28 290a 2020 2020 2020 2020 6d65  ock().        me
+00015180: 7461 6461 7461 2e63 6f6c 756d 6e73 203d  tadata.columns =
+00015190: 207b 2761 273a 2031 2c20 2762 273a 2032   {'a': 1, 'b': 2
+000151a0: 7d0a 0a20 2020 2020 2020 2023 2052 756e  }..        # Run
+000151b0: 0a20 2020 2020 2020 2065 7272 6f72 5f6d  .        error_m
+000151c0: 6573 7361 6765 203d 2072 652e 6573 6361  essage = re.esca
+000151d0: 7065 280a 2020 2020 2020 2020 2020 2020  pe(.            
+000151e0: 2741 2050 6f73 6974 6976 6520 636f 6e73  'A Positive cons
+000151f0: 7472 6169 6e74 2069 7320 6265 696e 6720  traint is being 
+00015200: 6170 706c 6965 6420 746f 2069 6e76 616c  applied to inval
+00015210: 6964 2063 6f6c 756d 6e20 6e61 6d65 7320  id column names 
+00015220: 270a 2020 2020 2020 2020 2020 2020 227b  '.            "{
+00015230: 2763 277d 2e20 5468 6520 636f 6c75 6d6e  'c'}. The column
+00015240: 7320 6d75 7374 2065 7869 7374 2069 6e20  s must exist in 
+00015250: 7468 6520 7461 626c 652e 220a 2020 2020  the table.".    
+00015260: 2020 2020 290a 2020 2020 2020 2020 7769      ).        wi
+00015270: 7468 2070 7974 6573 742e 7261 6973 6573  th pytest.raises
+00015280: 2843 6f6e 7374 7261 696e 744d 6574 6164  (ConstraintMetad
+00015290: 6174 6145 7272 6f72 2c20 6d61 7463 683d  ataError, match=
+000152a0: 6572 726f 725f 6d65 7373 6167 6529 3a0a  error_message):.
+000152b0: 2020 2020 2020 2020 2020 2020 506f 7369              Posi
+000152c0: 7469 7665 2e5f 7661 6c69 6461 7465 5f6d  tive._validate_m
+000152d0: 6574 6164 6174 615f 636f 6c75 6d6e 7328  etadata_columns(
+000152e0: 6d65 7461 6461 7461 2c20 636f 6c75 6d6e  metadata, column
+000152f0: 5f6e 616d 653d 2763 2729 0a0a 2020 2020  _name='c')..    
+00015300: 6465 6620 7465 7374 5f5f 7661 6c69 6461  def test__valida
+00015310: 7465 5f6d 6574 6164 6174 615f 7370 6563  te_metadata_spec
+00015320: 6966 6963 5f74 6f5f 636f 6e73 7472 6169  ific_to_constrai
+00015330: 6e74 2873 656c 6629 3a0a 2020 2020 2020  nt(self):.      
+00015340: 2020 2222 2220 5465 7374 2074 6865 2060    """ Test the `
+00015350: 605f 7661 6c69 6461 7465 5f6d 6574 6164  `_validate_metad
+00015360: 6174 615f 7370 6563 6966 6963 5f74 6f5f  ata_specific_to_
+00015370: 636f 6e73 7472 6169 6e74 6060 206d 6574  constraint`` met
+00015380: 686f 642e 0a0a 2020 2020 2020 2020 4966  hod...        If
+00015390: 2074 6865 2063 6f6c 756d 6e20 6e61 6d65   the column name
+000153a0: 2070 726f 7669 6465 6420 6861 7320 616e   provided has an
+000153b0: 2073 6474 7970 6520 6f66 206e 756d 6572   sdtype of numer
+000153c0: 6963 616c 2c20 7468 656e 206e 6f20 6572  ical, then no er
+000153d0: 726f 7220 7368 6f75 6c64 0a20 2020 2020  ror should.     
+000153e0: 2020 2062 6520 7261 6973 6564 2e0a 0a20     be raised... 
+000153f0: 2020 2020 2020 2049 6e70 7574 3a0a 2020         Input:.  
+00015400: 2020 2020 2020 2020 2020 2d20 4d65 7461            - Meta
+00015410: 6461 7461 2077 6974 6820 7468 6520 636f  data with the co
+00015420: 6c75 6d6e 2773 2073 6474 7970 6520 7365  lumn's sdtype se
+00015430: 7420 746f 206e 756d 6572 6963 616c 2e0a  t to numerical..
+00015440: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00015450: 2020 2020 2320 5365 7475 700a 2020 2020      # Setup.    
+00015460: 2020 2020 6d65 7461 6461 7461 203d 204d      metadata = M
+00015470: 6f63 6b28 290a 2020 2020 2020 2020 6d65  ock().        me
+00015480: 7461 6461 7461 2e63 6f6c 756d 6e73 203d  tadata.columns =
+00015490: 207b 0a20 2020 2020 2020 2020 2020 2027   {.            '
+000154a0: 6127 3a20 7b27 7364 7479 7065 273a 2027  a': {'sdtype': '
+000154b0: 6e75 6d65 7269 6361 6c27 7d0a 2020 2020  numerical'}.    
+000154c0: 2020 2020 7d0a 0a20 2020 2020 2020 2023      }..        #
+000154d0: 2052 756e 0a20 2020 2020 2020 2050 6f73   Run.        Pos
+000154e0: 6974 6976 652e 5f76 616c 6964 6174 655f  itive._validate_
+000154f0: 6d65 7461 6461 7461 5f73 7065 6369 6669  metadata_specifi
+00015500: 635f 746f 5f63 6f6e 7374 7261 696e 7428  c_to_constraint(
+00015510: 0a20 2020 2020 2020 2020 2020 206d 6574  .            met
+00015520: 6164 6174 612c 0a20 2020 2020 2020 2020  adata,.         
+00015530: 2020 2063 6f6c 756d 6e5f 6e61 6d65 3d27     column_name='
+00015540: 6127 0a20 2020 2020 2020 2029 0a0a 2020  a'.        )..  
+00015550: 2020 6465 6620 7465 7374 5f5f 7661 6c69    def test__vali
+00015560: 6461 7465 5f6d 6574 6164 6174 615f 7370  date_metadata_sp
+00015570: 6563 6966 6963 5f74 6f5f 636f 6e73 7472  ecific_to_constr
+00015580: 6169 6e74 5f65 7272 6f72 2873 656c 6629  aint_error(self)
+00015590: 3a0a 2020 2020 2020 2020 2222 2220 5465  :.        """ Te
+000155a0: 7374 2074 6865 2060 605f 7661 6c69 6461  st the ``_valida
+000155b0: 7465 5f6d 6574 6164 6174 615f 7370 6563  te_metadata_spec
+000155c0: 6966 6963 5f74 6f5f 636f 6e73 7472 6169  ific_to_constrai
+000155d0: 6e74 6060 206d 6574 686f 642e 0a0a 2020  nt`` method...  
+000155e0: 2020 2020 2020 4966 2074 6865 2063 6f6c        If the col
+000155f0: 756d 6e20 6e61 6d65 2070 726f 7669 6465  umn name provide
+00015600: 6420 646f 6573 206e 6f74 2068 6176 6520  d does not have 
+00015610: 616e 2073 6474 7970 6520 6f66 206e 756d  an sdtype of num
+00015620: 6572 6963 616c 2c20 7468 656e 2061 6e20  erical, then an 
+00015630: 6572 726f 7220 7368 6f75 6c64 0a20 2020  error should.   
+00015640: 2020 2020 2062 6520 7261 6973 6564 2e0a       be raised..
+00015650: 0a20 2020 2020 2020 2049 6e70 7574 3a0a  .        Input:.
+00015660: 2020 2020 2020 2020 2020 2020 2d20 4d65              - Me
+00015670: 7461 6461 7461 2077 6974 6820 7468 6520  tadata with the 
+00015680: 636f 6c75 6d6e 2773 2073 6474 7970 6520  column's sdtype 
+00015690: 7365 7420 746f 2064 6174 6574 696d 652e  set to datetime.
+000156a0: 0a0a 2020 2020 2020 2020 5369 6465 2065  ..        Side e
+000156b0: 6666 6563 743a 0a20 2020 2020 2020 2020  ffect:.         
+000156c0: 2020 202d 2052 6169 7365 7320 436f 6e73     - Raises Cons
+000156d0: 7472 6169 6e74 4d65 7461 6461 7461 4572  traintMetadataEr
+000156e0: 726f 720a 2020 2020 2020 2020 2222 220a  ror.        """.
+000156f0: 2020 2020 2020 2020 2320 5365 7475 700a          # Setup.
+00015700: 2020 2020 2020 2020 6d65 7461 6461 7461          metadata
+00015710: 203d 204d 6f63 6b28 290a 2020 2020 2020   = Mock().      
+00015720: 2020 6d65 7461 6461 7461 2e63 6f6c 756d    metadata.colum
+00015730: 6e73 203d 207b 0a20 2020 2020 2020 2020  ns = {.         
+00015740: 2020 2027 6127 3a20 7b27 7364 7479 7065     'a': {'sdtype
+00015750: 273a 2027 6461 7465 7469 6d65 277d 0a20  ': 'datetime'}. 
+00015760: 2020 2020 2020 207d 0a0a 2020 2020 2020         }..      
+00015770: 2020 2320 5275 6e0a 2020 2020 2020 2020    # Run.        
+00015780: 6572 726f 725f 6d65 7373 6167 6520 3d20  error_message = 
+00015790: 280a 2020 2020 2020 2020 2020 2020 2741  (.            'A
+000157a0: 2050 6f73 6974 6976 6520 636f 6e73 7472   Positive constr
+000157b0: 6169 6e74 2069 7320 6265 696e 6720 6170  aint is being ap
+000157c0: 706c 6965 6420 746f 2061 6e20 696e 7661  plied to an inva
+000157d0: 6c69 6420 636f 6c75 6d6e 2027 0a20 2020  lid column '.   
+000157e0: 2020 2020 2020 2020 2022 2761 272e 2054           "'a'. T
+000157f0: 6869 7320 636f 6e73 7472 6169 6e74 2069  his constraint i
+00015800: 7320 6f6e 6c79 2064 6566 696e 6564 2066  s only defined f
+00015810: 6f72 206e 756d 6572 6963 616c 2063 6f6c  or numerical col
+00015820: 756d 6e73 2e22 0a20 2020 2020 2020 2029  umns.".        )
+00015830: 0a20 2020 2020 2020 2077 6974 6820 7079  .        with py
+00015840: 7465 7374 2e72 6169 7365 7328 436f 6e73  test.raises(Cons
+00015850: 7472 6169 6e74 4d65 7461 6461 7461 4572  traintMetadataEr
+00015860: 726f 722c 206d 6174 6368 3d65 7272 6f72  ror, match=error
+00015870: 5f6d 6573 7361 6765 293a 0a20 2020 2020  _message):.     
+00015880: 2020 2020 2020 2050 6f73 6974 6976 652e         Positive.
+00015890: 5f76 616c 6964 6174 655f 6d65 7461 6461  _validate_metada
+000158a0: 7461 5f73 7065 6369 6669 635f 746f 5f63  ta_specific_to_c
+000158b0: 6f6e 7374 7261 696e 7428 0a20 2020 2020  onstraint(.     
+000158c0: 2020 2020 2020 2020 2020 206d 6574 6164             metad
+000158d0: 6174 612c 0a20 2020 2020 2020 2020 2020  ata,.           
+000158e0: 2020 2020 2063 6f6c 756d 6e5f 6e61 6d65       column_name
+000158f0: 3d27 6127 0a20 2020 2020 2020 2020 2020  ='a'.           
+00015900: 2029 0a0a 2020 2020 6465 6620 7465 7374   )..    def test
+00015910: 5f5f 696e 6974 5f5f 2873 656c 6629 3a0a  __init__(self):.
+00015920: 2020 2020 2020 2020 2222 2254 6573 7420          """Test 
+00015930: 7468 6520 6060 506f 7369 7469 7665 2e5f  the ``Positive._
+00015940: 5f69 6e69 745f 5f60 6020 6d65 7468 6f64  _init__`` method
+00015950: 2e0a 0a20 2020 2020 2020 2045 6e73 7572  ...        Ensur
+00015960: 6520 7468 6520 6174 7472 6962 7574 6573  e the attributes
+00015970: 2061 7265 2063 6f72 7265 6374 6c79 2073   are correctly s
+00015980: 6574 2e0a 2020 2020 2020 2020 2222 220a  et..        """.
+00015990: 2020 2020 2020 2020 2320 5275 6e0a 2020          # Run.  
+000159a0: 2020 2020 2020 696e 7374 616e 6365 203d        instance =
+000159b0: 2050 6f73 6974 6976 6528 636f 6c75 6d6e   Positive(column
+000159c0: 5f6e 616d 653d 2761 6263 2729 0a0a 2020  _name='abc')..  
+000159d0: 2020 2020 2020 2320 4173 7365 7274 730a        # Asserts.
+000159e0: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
+000159f0: 6e73 7461 6e63 652e 5f76 616c 7565 203d  nstance._value =
+00015a00: 3d20 300a 2020 2020 2020 2020 6173 7365  = 0.        asse
+00015a10: 7274 2069 6e73 7461 6e63 652e 5f63 6f6c  rt instance._col
+00015a20: 756d 6e5f 6e61 6d65 203d 3d20 2761 6263  umn_name == 'abc
+00015a30: 270a 2020 2020 2020 2020 6173 7365 7274  '.        assert
+00015a40: 2069 6e73 7461 6e63 652e 5f6f 7065 7261   instance._opera
+00015a50: 746f 7220 3d3d 206e 702e 6772 6561 7465  tor == np.greate
+00015a60: 725f 6571 7561 6c0a 0a20 2020 2064 6566  r_equal..    def
+00015a70: 2074 6573 745f 5f69 6e69 745f 5f73 7472   test__init__str
+00015a80: 6963 745f 7472 7565 2873 656c 6629 3a0a  ict_true(self):.
+00015a90: 2020 2020 2020 2020 2222 2254 6573 7420          """Test 
+00015aa0: 7468 6520 6060 506f 7369 7469 7665 2e5f  the ``Positive._
+00015ab0: 5f69 6e69 745f 5f60 6020 6d65 7468 6f64  _init__`` method
+00015ac0: 2e0a 0a20 2020 2020 2020 2045 6e73 7572  ...        Ensur
+00015ad0: 6520 7468 6520 6174 7472 6962 7574 6573  e the attributes
+00015ae0: 2061 7265 2063 6f72 7265 6374 6c79 2073   are correctly s
+00015af0: 6574 2077 6865 6e20 6060 7374 7269 6374  et when ``strict
+00015b00: 5f62 6f75 6e64 6172 6965 7360 6020 6973  _boundaries`` is
+00015b10: 2054 7275 652e 0a20 2020 2020 2020 2022   True..        "
+00015b20: 2222 0a20 2020 2020 2020 2023 2052 756e  "".        # Run
+00015b30: 0a20 2020 2020 2020 2069 6e73 7461 6e63  .        instanc
+00015b40: 6520 3d20 506f 7369 7469 7665 2863 6f6c  e = Positive(col
+00015b50: 756d 6e5f 6e61 6d65 3d27 6162 6327 2c20  umn_name='abc', 
+00015b60: 7374 7269 6374 5f62 6f75 6e64 6172 6965  strict_boundarie
+00015b70: 733d 5472 7565 290a 0a20 2020 2020 2020  s=True)..       
+00015b80: 2023 2041 7373 6572 7473 0a20 2020 2020   # Asserts.     
+00015b90: 2020 2061 7373 6572 7420 696e 7374 616e     assert instan
+00015ba0: 6365 2e5f 7661 6c75 6520 3d3d 2030 0a20  ce._value == 0. 
+00015bb0: 2020 2020 2020 2061 7373 6572 7420 696e         assert in
+00015bc0: 7374 616e 6365 2e5f 636f 6c75 6d6e 5f6e  stance._column_n
+00015bd0: 616d 6520 3d3d 2027 6162 6327 0a20 2020  ame == 'abc'.   
+00015be0: 2020 2020 2061 7373 6572 7420 696e 7374       assert inst
+00015bf0: 616e 6365 2e5f 6f70 6572 6174 6f72 203d  ance._operator =
+00015c00: 3d20 6e70 2e67 7265 6174 6572 0a0a 0a63  = np.greater...c
+00015c10: 6c61 7373 2054 6573 744e 6567 6174 6976  lass TestNegativ
+00015c20: 6528 293a 0a0a 2020 2020 6465 6620 7465  e():..    def te
+00015c30: 7374 5f5f 7661 6c69 6461 7465 5f69 6e70  st__validate_inp
+00015c40: 7574 7328 7365 6c66 293a 0a20 2020 2020  uts(self):.     
+00015c50: 2020 2022 2222 5465 7374 2074 6865 2060     """Test the `
+00015c60: 604e 6567 6174 6976 652e 5f76 616c 6964  `Negative._valid
+00015c70: 6174 655f 696e 7075 7473 6060 206d 6574  ate_inputs`` met
+00015c80: 686f 642e 0a0a 2020 2020 2020 2020 496e  hod...        In
+00015c90: 7075 743a 0a20 2020 2020 2020 202d 2020  put:.        -  
+00015ca0: 496e 636f 7272 6563 7420 7061 7261 6d65  Incorrect parame
+00015cb0: 7465 7273 2066 6f72 2074 6865 206d 6574  ters for the met
+00015cc0: 686f 640a 2020 2020 2020 2020 5261 6973  hod.        Rais
+00015cd0: 6573 3a0a 2020 2020 2020 2020 2d20 4c69  es:.        - Li
+00015ce0: 7374 206f 6620 5661 6c75 6545 7272 6f72  st of ValueError
+00015cf0: 730a 2020 2020 2020 2020 2222 220a 2020  s.        """.  
+00015d00: 2020 2020 2020 2320 5275 6e20 2f20 4173        # Run / As
+00015d10: 7365 7274 0a20 2020 2020 2020 2077 6974  sert.        wit
+00015d20: 6820 7079 7465 7374 2e72 6169 7365 7328  h pytest.raises(
+00015d30: 4167 6772 6567 6174 6543 6f6e 7374 7261  AggregateConstra
+00015d40: 696e 7473 4572 726f 7229 2061 7320 6572  intsError) as er
+00015d50: 726f 723a 0a20 2020 2020 2020 2020 2020  ror:.           
+00015d60: 204e 6567 6174 6976 652e 5f76 616c 6964   Negative._valid
+00015d70: 6174 655f 696e 7075 7473 286e 6f74 5f63  ate_inputs(not_c
+00015d80: 6f6c 756d 6e5f 6e61 6d65 3d4e 6f6e 652c  olumn_name=None,
+00015d90: 2073 6f6d 6574 6869 6e67 5f65 6c73 653d   something_else=
+00015da0: 4e6f 6e65 290a 0a20 2020 2020 2020 2065  None)..        e
+00015db0: 7272 5f6d 7367 203d 2028 0a20 2020 2020  rr_msg = (.     
+00015dc0: 2020 2020 2020 2072 274d 6973 7369 6e67         r'Missing
+00015dd0: 2072 6571 7569 7265 6420 7661 6c75 6573   required values
+00015de0: 207b 282e 2a29 7d20 696e 2061 204e 6567   {(.*)} in a Neg
+00015df0: 6174 6976 6520 636f 6e73 7472 6169 6e74  ative constraint
+00015e00: 2e27 0a20 2020 2020 2020 2020 2020 2072  .'.            r
+00015e10: 275c 6e5c 6e49 6e76 616c 6964 2076 616c  '\n\nInvalid val
+00015e20: 7565 7320 7b28 2e2a 297d 2061 7265 2070  ues {(.*)} are p
+00015e30: 7265 7365 6e74 2069 6e20 6120 4e65 6761  resent in a Nega
+00015e40: 7469 7665 2063 6f6e 7374 7261 696e 742e  tive constraint.
+00015e50: 270a 2020 2020 2020 2020 290a 2020 2020  '.        ).    
+00015e60: 2020 2020 6772 6f75 7073 203d 2072 652e      groups = re.
+00015e70: 7365 6172 6368 2865 7272 5f6d 7367 2c20  search(err_msg, 
+00015e80: 7374 7228 6572 726f 722e 7661 6c75 6529  str(error.value)
+00015e90: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
+00015ea0: 2067 726f 7570 7320 6973 206e 6f74 204e   groups is not N
+00015eb0: 6f6e 650a 2020 2020 2020 2020 6173 7365  one.        asse
+00015ec0: 7274 2073 7472 2865 7661 6c28 6772 6f75  rt str(eval(grou
+00015ed0: 7073 2e67 726f 7570 2831 2929 2920 3d3d  ps.group(1))) ==
+00015ee0: 2027 636f 6c75 6d6e 5f6e 616d 6527 0a20   'column_name'. 
+00015ef0: 2020 2020 2020 2061 7373 6572 7420 7365         assert se
+00015f00: 7428 6576 616c 2867 726f 7570 732e 6772  t(eval(groups.gr
+00015f10: 6f75 7028 3229 2929 203d 3d20 7b27 736f  oup(2))) == {'so
+00015f20: 6d65 7468 696e 675f 656c 7365 272c 2027  mething_else', '
+00015f30: 6e6f 745f 636f 6c75 6d6e 5f6e 616d 6527  not_column_name'
+00015f40: 7d0a 0a20 2020 2064 6566 2074 6573 745f  }..    def test_
+00015f50: 5f76 616c 6964 6174 655f 6d65 7461 6461  _validate_metada
+00015f60: 7461 5f63 6f6c 756d 6e73 2873 656c 6629  ta_columns(self)
+00015f70: 3a0a 2020 2020 2020 2020 2222 2254 6573  :.        """Tes
+00015f80: 7420 7468 6520 6060 5f76 616c 6964 6174  t the ``_validat
+00015f90: 655f 6d65 7461 6461 7461 5f63 6f6c 756d  e_metadata_colum
+00015fa0: 6e73 6060 206d 6574 686f 642e 0a0a 2020  ns`` method...  
+00015fb0: 2020 2020 2020 5468 6520 636f 6c75 6d6e        The column
+00015fc0: 2070 6173 7365 6420 696e 2063 6f6c 756d   passed in colum
+00015fd0: 6e5f 6e61 6d65 2073 686f 756c 6420 6265  n_name should be
+00015fe0: 2069 6e20 7468 6520 6d65 7461 6461 7461   in the metadata
+00015ff0: 2e0a 0a20 2020 2020 2020 2049 6e70 7574  ...        Input
+00016000: 3a0a 2020 2020 2020 2020 2020 2020 2d20  :.            - 
+00016010: 636f 6c75 6d6e 5f6e 616d 6520 7468 6174  column_name that
+00016020: 2069 7320 696e 2074 6865 206d 6574 6164   is in the metad
+00016030: 6174 612e 0a0a 2020 2020 2020 2020 5369  ata...        Si
+00016040: 6465 2065 6666 6563 743a 0a20 2020 2020  de effect:.     
+00016050: 2020 2020 2020 202d 204e 6f20 6572 726f         - No erro
+00016060: 7220 7368 6f75 6c64 2062 6520 7261 6973  r should be rais
+00016070: 6564 2e0a 2020 2020 2020 2020 2222 220a  ed..        """.
+00016080: 2020 2020 2020 2020 2320 5365 7475 700a          # Setup.
+00016090: 2020 2020 2020 2020 6d65 7461 6461 7461          metadata
+000160a0: 203d 204d 6f63 6b28 290a 2020 2020 2020   = Mock().      
+000160b0: 2020 6d65 7461 6461 7461 2e63 6f6c 756d    metadata.colum
+000160c0: 6e73 203d 207b 2761 273a 2031 2c20 2762  ns = {'a': 1, 'b
+000160d0: 273a 2032 7d0a 0a20 2020 2020 2020 2023  ': 2}..        #
+000160e0: 2052 756e 0a20 2020 2020 2020 204e 6567   Run.        Neg
+000160f0: 6174 6976 652e 5f76 616c 6964 6174 655f  ative._validate_
+00016100: 6d65 7461 6461 7461 5f63 6f6c 756d 6e73  metadata_columns
+00016110: 286d 6574 6164 6174 612c 2063 6f6c 756d  (metadata, colum
+00016120: 6e5f 6e61 6d65 3d27 6127 290a 0a20 2020  n_name='a')..   
+00016130: 2064 6566 2074 6573 745f 5f76 616c 6964   def test__valid
+00016140: 6174 655f 6d65 7461 6461 7461 5f63 6f6c  ate_metadata_col
+00016150: 756d 6e73 5f72 6169 7365 735f 6572 726f  umns_raises_erro
+00016160: 7228 7365 6c66 293a 0a20 2020 2020 2020  r(self):.       
+00016170: 2022 2222 5465 7374 2074 6865 2060 605f   """Test the ``_
+00016180: 7661 6c69 6461 7465 5f6d 6574 6164 6174  validate_metadat
+00016190: 615f 636f 6c75 6d6e 7360 6020 6d65 7468  a_columns`` meth
+000161a0: 6f64 2773 2065 7272 6f72 2063 6f6e 6469  od's error condi
+000161b0: 7469 6f6e 2e0a 0a20 2020 2020 2020 2049  tion...        I
+000161c0: 6620 636f 6c75 6d6e 5f6e 616d 6520 6973  f column_name is
+000161d0: 206e 6f74 2069 6e20 7468 6520 6d65 7461   not in the meta
+000161e0: 6461 7461 2c20 616e 2065 7272 6f72 2073  data, an error s
+000161f0: 686f 756c 6420 6265 2072 6169 7365 642e  hould be raised.
+00016200: 0a0a 2020 2020 2020 2020 496e 7075 743a  ..        Input:
+00016210: 0a20 2020 2020 2020 2020 2020 202d 2063  .            - c
+00016220: 6f6c 756d 6e5f 6e61 6d65 2074 6861 7420  olumn_name that 
+00016230: 6973 206e 6f74 2069 6e20 7468 6520 6d65  is not in the me
+00016240: 7461 6461 7461 2e0a 0a20 2020 2020 2020  tadata...       
+00016250: 2053 6964 6520 6566 6665 6374 3a0a 2020   Side effect:.  
+00016260: 2020 2020 2020 2020 2020 2d20 436f 6e73            - Cons
+00016270: 7472 6169 6e74 4d65 7461 6461 7461 4572  traintMetadataEr
+00016280: 726f 7220 7368 6f75 6c64 2062 6520 7261  ror should be ra
+00016290: 6973 6564 2e0a 2020 2020 2020 2020 2222  ised..        ""
+000162a0: 220a 2020 2020 2020 2020 2320 5365 7475  ".        # Setu
+000162b0: 700a 2020 2020 2020 2020 6d65 7461 6461  p.        metada
+000162c0: 7461 203d 204d 6f63 6b28 290a 2020 2020  ta = Mock().    
+000162d0: 2020 2020 6d65 7461 6461 7461 2e63 6f6c      metadata.col
+000162e0: 756d 6e73 203d 207b 2761 273a 2031 2c20  umns = {'a': 1, 
+000162f0: 2762 273a 2032 7d0a 0a20 2020 2020 2020  'b': 2}..       
+00016300: 2023 2052 756e 0a20 2020 2020 2020 2065   # Run.        e
+00016310: 7272 6f72 5f6d 6573 7361 6765 203d 2072  rror_message = r
+00016320: 652e 6573 6361 7065 280a 2020 2020 2020  e.escape(.      
+00016330: 2020 2020 2020 2741 204e 6567 6174 6976        'A Negativ
+00016340: 6520 636f 6e73 7472 6169 6e74 2069 7320  e constraint is 
+00016350: 6265 696e 6720 6170 706c 6965 6420 746f  being applied to
+00016360: 2069 6e76 616c 6964 2063 6f6c 756d 6e20   invalid column 
+00016370: 6e61 6d65 7320 270a 2020 2020 2020 2020  names '.        
+00016380: 2020 2020 227b 2763 277d 2e20 5468 6520      "{'c'}. The 
+00016390: 636f 6c75 6d6e 7320 6d75 7374 2065 7869  columns must exi
+000163a0: 7374 2069 6e20 7468 6520 7461 626c 652e  st in the table.
+000163b0: 220a 2020 2020 2020 2020 290a 2020 2020  ".        ).    
+000163c0: 2020 2020 7769 7468 2070 7974 6573 742e      with pytest.
+000163d0: 7261 6973 6573 2843 6f6e 7374 7261 696e  raises(Constrain
+000163e0: 744d 6574 6164 6174 6145 7272 6f72 2c20  tMetadataError, 
+000163f0: 6d61 7463 683d 6572 726f 725f 6d65 7373  match=error_mess
+00016400: 6167 6529 3a0a 2020 2020 2020 2020 2020  age):.          
+00016410: 2020 4e65 6761 7469 7665 2e5f 7661 6c69    Negative._vali
+00016420: 6461 7465 5f6d 6574 6164 6174 615f 636f  date_metadata_co
+00016430: 6c75 6d6e 7328 6d65 7461 6461 7461 2c20  lumns(metadata, 
+00016440: 636f 6c75 6d6e 5f6e 616d 653d 2763 2729  column_name='c')
+00016450: 0a0a 2020 2020 6465 6620 7465 7374 5f5f  ..    def test__
+00016460: 7661 6c69 6461 7465 5f6d 6574 6164 6174  validate_metadat
+00016470: 615f 7370 6563 6966 6963 5f74 6f5f 636f  a_specific_to_co
+00016480: 6e73 7472 6169 6e74 2873 656c 6629 3a0a  nstraint(self):.
+00016490: 2020 2020 2020 2020 2222 2220 5465 7374          """ Test
+000164a0: 2074 6865 2060 605f 7661 6c69 6461 7465   the ``_validate
+000164b0: 5f6d 6574 6164 6174 615f 7370 6563 6966  _metadata_specif
+000164c0: 6963 5f74 6f5f 636f 6e73 7472 6169 6e74  ic_to_constraint
+000164d0: 6060 206d 6574 686f 642e 0a0a 2020 2020  `` method...    
+000164e0: 2020 2020 4966 2074 6865 2063 6f6c 756d      If the colum
+000164f0: 6e20 6e61 6d65 2070 726f 7669 6465 6420  n name provided 
+00016500: 6861 7320 616e 2073 6474 7970 6520 6f66  has an sdtype of
+00016510: 206e 756d 6572 6963 616c 2c20 7468 656e   numerical, then
+00016520: 206e 6f20 6572 726f 7220 7368 6f75 6c64   no error should
+00016530: 0a20 2020 2020 2020 2062 6520 7261 6973  .        be rais
+00016540: 6564 2e0a 0a20 2020 2020 2020 2049 6e70  ed...        Inp
+00016550: 7574 3a0a 2020 2020 2020 2020 2020 2020  ut:.            
+00016560: 2d20 4d65 7461 6461 7461 2077 6974 6820  - Metadata with 
+00016570: 7468 6520 636f 6c75 6d6e 2773 2073 6474  the column's sdt
+00016580: 7970 6520 7365 7420 746f 206e 756d 6572  ype set to numer
+00016590: 6963 616c 2e0a 2020 2020 2020 2020 2222  ical..        ""
+000165a0: 220a 2020 2020 2020 2020 2320 5365 7475  ".        # Setu
+000165b0: 700a 2020 2020 2020 2020 6d65 7461 6461  p.        metada
+000165c0: 7461 203d 204d 6f63 6b28 290a 2020 2020  ta = Mock().    
+000165d0: 2020 2020 6d65 7461 6461 7461 2e63 6f6c      metadata.col
+000165e0: 756d 6e73 203d 207b 0a20 2020 2020 2020  umns = {.       
+000165f0: 2020 2020 2027 6127 3a20 7b27 7364 7479       'a': {'sdty
+00016600: 7065 273a 2027 6e75 6d65 7269 6361 6c27  pe': 'numerical'
+00016610: 7d0a 2020 2020 2020 2020 7d0a 0a20 2020  }.        }..   
+00016620: 2020 2020 2023 2052 756e 0a20 2020 2020       # Run.     
+00016630: 2020 2050 6f73 6974 6976 652e 5f76 616c     Positive._val
+00016640: 6964 6174 655f 6d65 7461 6461 7461 5f73  idate_metadata_s
+00016650: 7065 6369 6669 635f 746f 5f63 6f6e 7374  pecific_to_const
+00016660: 7261 696e 7428 0a20 2020 2020 2020 2020  raint(.         
+00016670: 2020 206d 6574 6164 6174 612c 0a20 2020     metadata,.   
+00016680: 2020 2020 2020 2020 2063 6f6c 756d 6e5f           column_
+00016690: 6e61 6d65 3d27 6127 0a20 2020 2020 2020  name='a'.       
+000166a0: 2029 0a0a 2020 2020 6465 6620 7465 7374   )..    def test
+000166b0: 5f5f 7661 6c69 6461 7465 5f6d 6574 6164  __validate_metad
+000166c0: 6174 615f 7370 6563 6966 6963 5f74 6f5f  ata_specific_to_
+000166d0: 636f 6e73 7472 6169 6e74 5f65 7272 6f72  constraint_error
+000166e0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+000166f0: 2222 2220 5465 7374 2074 6865 2060 605f  """ Test the ``_
+00016700: 7661 6c69 6461 7465 5f6d 6574 6164 6174  validate_metadat
+00016710: 615f 7370 6563 6966 6963 5f74 6f5f 636f  a_specific_to_co
+00016720: 6e73 7472 6169 6e74 6060 206d 6574 686f  nstraint`` metho
+00016730: 642e 0a0a 2020 2020 2020 2020 4966 2074  d...        If t
+00016740: 6865 2063 6f6c 756d 6e20 6e61 6d65 2070  he column name p
+00016750: 726f 7669 6465 6420 646f 6573 206e 6f74  rovided does not
+00016760: 2068 6176 6520 616e 2073 6474 7970 6520   have an sdtype 
+00016770: 6f66 206e 756d 6572 6963 616c 2c20 7468  of numerical, th
+00016780: 656e 2061 6e20 6572 726f 7220 7368 6f75  en an error shou
+00016790: 6c64 0a20 2020 2020 2020 2062 6520 7261  ld.        be ra
+000167a0: 6973 6564 2e0a 0a20 2020 2020 2020 2049  ised...        I
+000167b0: 6e70 7574 3a0a 2020 2020 2020 2020 2020  nput:.          
+000167c0: 2020 2d20 4d65 7461 6461 7461 2077 6974    - Metadata wit
+000167d0: 6820 7468 6520 636f 6c75 6d6e 2773 2073  h the column's s
+000167e0: 6474 7970 6520 7365 7420 746f 2064 6174  dtype set to dat
+000167f0: 6574 696d 652e 0a0a 2020 2020 2020 2020  etime...        
+00016800: 5369 6465 2065 6666 6563 743a 0a20 2020  Side effect:.   
+00016810: 2020 2020 2020 2020 202d 2052 6169 7365           - Raise
+00016820: 7320 436f 6e73 7472 6169 6e74 4d65 7461  s ConstraintMeta
+00016830: 6461 7461 4572 726f 720a 2020 2020 2020  dataError.      
+00016840: 2020 2222 220a 2020 2020 2020 2020 2320    """.        # 
+00016850: 5365 7475 700a 2020 2020 2020 2020 6d65  Setup.        me
+00016860: 7461 6461 7461 203d 204d 6f63 6b28 290a  tadata = Mock().
+00016870: 2020 2020 2020 2020 6d65 7461 6461 7461          metadata
+00016880: 2e63 6f6c 756d 6e73 203d 207b 0a20 2020  .columns = {.   
+00016890: 2020 2020 2020 2020 2027 6127 3a20 7b27           'a': {'
+000168a0: 7364 7479 7065 273a 2027 6461 7465 7469  sdtype': 'dateti
+000168b0: 6d65 277d 0a20 2020 2020 2020 207d 0a0a  me'}.        }..
+000168c0: 2020 2020 2020 2020 2320 5275 6e0a 2020          # Run.  
+000168d0: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
+000168e0: 6167 6520 3d20 280a 2020 2020 2020 2020  age = (.        
+000168f0: 2020 2020 2741 204e 6567 6174 6976 6520      'A Negative 
+00016900: 636f 6e73 7472 6169 6e74 2069 7320 6265  constraint is be
+00016910: 696e 6720 6170 706c 6965 6420 746f 2061  ing applied to a
+00016920: 6e20 696e 7661 6c69 6420 636f 6c75 6d6e  n invalid column
+00016930: 2027 0a20 2020 2020 2020 2020 2020 2022   '.            "
+00016940: 2761 272e 2054 6869 7320 636f 6e73 7472  'a'. This constr
+00016950: 6169 6e74 2069 7320 6f6e 6c79 2064 6566  aint is only def
+00016960: 696e 6564 2066 6f72 206e 756d 6572 6963  ined for numeric
+00016970: 616c 2063 6f6c 756d 6e73 2e22 0a20 2020  al columns.".   
+00016980: 2020 2020 2029 0a20 2020 2020 2020 2077       ).        w
+00016990: 6974 6820 7079 7465 7374 2e72 6169 7365  ith pytest.raise
+000169a0: 7328 436f 6e73 7472 6169 6e74 4d65 7461  s(ConstraintMeta
+000169b0: 6461 7461 4572 726f 722c 206d 6174 6368  dataError, match
+000169c0: 3d65 7272 6f72 5f6d 6573 7361 6765 293a  =error_message):
+000169d0: 0a20 2020 2020 2020 2020 2020 204e 6567  .            Neg
+000169e0: 6174 6976 652e 5f76 616c 6964 6174 655f  ative._validate_
+000169f0: 6d65 7461 6461 7461 5f73 7065 6369 6669  metadata_specifi
+00016a00: 635f 746f 5f63 6f6e 7374 7261 696e 7428  c_to_constraint(
+00016a10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016a20: 206d 6574 6164 6174 612c 0a20 2020 2020   metadata,.     
+00016a30: 2020 2020 2020 2020 2020 2063 6f6c 756d             colum
+00016a40: 6e5f 6e61 6d65 3d27 6127 0a20 2020 2020  n_name='a'.     
+00016a50: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
+00016a60: 6620 7465 7374 5f5f 696e 6974 5f5f 2873  f test__init__(s
+00016a70: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
+00016a80: 2254 6573 7420 7468 6520 6060 4e65 6761  "Test the ``Nega
+00016a90: 7469 7665 2e5f 5f69 6e69 745f 5f60 6020  tive.__init__`` 
+00016aa0: 6d65 7468 6f64 2e0a 0a20 2020 2020 2020  method...       
+00016ab0: 2045 6e73 7572 6520 7468 6520 6174 7472   Ensure the attr
+00016ac0: 6962 7574 6573 2061 7265 2063 6f72 7265  ibutes are corre
+00016ad0: 6374 6c79 2073 6574 2e0a 2020 2020 2020  ctly set..      
+00016ae0: 2020 2222 220a 2020 2020 2020 2020 2320    """.        # 
+00016af0: 5275 6e0a 2020 2020 2020 2020 696e 7374  Run.        inst
+00016b00: 616e 6365 203d 204e 6567 6174 6976 6528  ance = Negative(
+00016b10: 636f 6c75 6d6e 5f6e 616d 653d 2761 6263  column_name='abc
+00016b20: 2729 0a0a 2020 2020 2020 2020 2320 4173  ')..        # As
+00016b30: 7365 7274 730a 2020 2020 2020 2020 6173  serts.        as
+00016b40: 7365 7274 2069 6e73 7461 6e63 652e 5f76  sert instance._v
+00016b50: 616c 7565 203d 3d20 300a 2020 2020 2020  alue == 0.      
+00016b60: 2020 6173 7365 7274 2069 6e73 7461 6e63    assert instanc
+00016b70: 652e 5f63 6f6c 756d 6e5f 6e61 6d65 203d  e._column_name =
+00016b80: 3d20 2761 6263 270a 2020 2020 2020 2020  = 'abc'.        
+00016b90: 6173 7365 7274 2069 6e73 7461 6e63 652e  assert instance.
+00016ba0: 5f6f 7065 7261 746f 7220 3d3d 206e 702e  _operator == np.
+00016bb0: 6c65 7373 5f65 7175 616c 0a0a 2020 2020  less_equal..    
+00016bc0: 6465 6620 7465 7374 5f5f 696e 6974 5f5f  def test__init__
+00016bd0: 7374 7269 6374 5f74 7275 6528 7365 6c66  strict_true(self
+00016be0: 293a 0a20 2020 2020 2020 2022 2222 5465  ):.        """Te
+00016bf0: 7374 2074 6865 2060 604e 6567 6174 6976  st the ``Negativ
+00016c00: 652e 5f5f 696e 6974 5f5f 6060 206d 6574  e.__init__`` met
+00016c10: 686f 642e 0a0a 2020 2020 2020 2020 456e  hod...        En
+00016c20: 7375 7265 2074 6865 2061 7474 7269 6275  sure the attribu
+00016c30: 7465 7320 6172 6520 636f 7272 6563 746c  tes are correctl
+00016c40: 7920 7365 7420 7768 656e 2060 6073 7472  y set when ``str
+00016c50: 6963 745f 626f 756e 6461 7269 6573 6060  ict_boundaries``
+00016c60: 2069 7320 5472 7565 2e0a 2020 2020 2020   is True..      
+00016c70: 2020 2222 220a 2020 2020 2020 2020 2320    """.        # 
+00016c80: 5275 6e0a 2020 2020 2020 2020 696e 7374  Run.        inst
+00016c90: 616e 6365 203d 204e 6567 6174 6976 6528  ance = Negative(
+00016ca0: 636f 6c75 6d6e 5f6e 616d 653d 2761 6263  column_name='abc
+00016cb0: 272c 2073 7472 6963 745f 626f 756e 6461  ', strict_bounda
+00016cc0: 7269 6573 3d54 7275 6529 0a0a 2020 2020  ries=True)..    
+00016cd0: 2020 2020 2320 4173 7365 7274 730a 2020      # Asserts.  
+00016ce0: 2020 2020 2020 6173 7365 7274 2069 6e73        assert ins
+00016cf0: 7461 6e63 652e 5f76 616c 7565 203d 3d20  tance._value == 
+00016d00: 300a 2020 2020 2020 2020 6173 7365 7274  0.        assert
+00016d10: 2069 6e73 7461 6e63 652e 5f63 6f6c 756d   instance._colum
+00016d20: 6e5f 6e61 6d65 203d 3d20 2761 6263 270a  n_name == 'abc'.
+00016d30: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
+00016d40: 6e73 7461 6e63 652e 5f6f 7065 7261 746f  nstance._operato
+00016d50: 7220 3d3d 206e 702e 6c65 7373 0a0a 0a63  r == np.less...c
+00016d60: 6c61 7373 2054 6573 7452 616e 6765 2829  lass TestRange()
+00016d70: 3a0a 0a20 2020 2064 6566 2074 6573 745f  :..    def test_
+00016d80: 5f76 616c 6964 6174 655f 696e 7075 7473  _validate_inputs
+00016d90: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00016da0: 2222 2254 6573 7420 7468 6520 6060 5261  """Test the ``Ra
+00016db0: 6e67 652e 5f76 616c 6964 6174 655f 696e  nge._validate_in
+00016dc0: 7075 7473 6060 206d 6574 686f 642e 0a0a  puts`` method...
+00016dd0: 2020 2020 2020 2020 496e 7075 743a 0a20          Input:. 
+00016de0: 2020 2020 2020 202d 2020 496e 636f 7272         -  Incorr
+00016df0: 6563 7420 7061 7261 6d65 7465 7273 2066  ect parameters f
+00016e00: 6f72 2074 6865 206d 6574 686f 640a 2020  or the method.  
+00016e10: 2020 2020 2020 5261 6973 6573 3a0a 2020        Raises:.  
+00016e20: 2020 2020 2020 2d20 4c69 7374 206f 6620        - List of 
+00016e30: 5661 6c75 6545 7272 6f72 730a 2020 2020  ValueErrors.    
+00016e40: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00016e50: 2320 5275 6e20 2f20 4173 7365 7274 0a20  # Run / Assert. 
+00016e60: 2020 2020 2020 2077 6974 6820 7079 7465         with pyte
+00016e70: 7374 2e72 6169 7365 7328 4167 6772 6567  st.raises(Aggreg
+00016e80: 6174 6543 6f6e 7374 7261 696e 7473 4572  ateConstraintsEr
+00016e90: 726f 7229 2061 7320 6572 726f 723a 0a20  ror) as error:. 
+00016ea0: 2020 2020 2020 2020 2020 2052 616e 6765             Range
+00016eb0: 2e5f 7661 6c69 6461 7465 5f69 6e70 7574  ._validate_input
+00016ec0: 7328 6e6f 745f 6869 6768 5f63 6f6c 756d  s(not_high_colum
+00016ed0: 6e3d 4e6f 6e65 2c20 6e6f 745f 6c6f 775f  n=None, not_low_
+00016ee0: 636f 6c75 6d6e 3d4e 6f6e 6529 0a0a 2020  column=None)..  
+00016ef0: 2020 2020 2020 6572 725f 6d73 6720 3d20        err_msg = 
+00016f00: 280a 2020 2020 2020 2020 2020 2020 7227  (.            r'
+00016f10: 4d69 7373 696e 6720 7265 7175 6972 6564  Missing required
+00016f20: 2076 616c 7565 7320 7b28 2e2a 297d 2069   values {(.*)} i
+00016f30: 6e20 6120 5261 6e67 6520 636f 6e73 7472  n a Range constr
+00016f40: 6169 6e74 2e27 0a20 2020 2020 2020 2020  aint.'.         
+00016f50: 2020 2072 275c 6e5c 6e49 6e76 616c 6964     r'\n\nInvalid
+00016f60: 2076 616c 7565 7320 7b28 2e2a 297d 2061   values {(.*)} a
+00016f70: 7265 2070 7265 7365 6e74 2069 6e20 6120  re present in a 
+00016f80: 5261 6e67 6520 636f 6e73 7472 6169 6e74  Range constraint
+00016f90: 2e27 0a20 2020 2020 2020 2029 0a20 2020  .'.        ).   
+00016fa0: 2020 2020 2067 726f 7570 7320 3d20 7265       groups = re
+00016fb0: 2e73 6561 7263 6828 6572 725f 6d73 672c  .search(err_msg,
+00016fc0: 2073 7472 2865 7272 6f72 2e76 616c 7565   str(error.value
+00016fd0: 2929 0a20 2020 2020 2020 2061 7373 6572  )).        asser
+00016fe0: 7420 6772 6f75 7073 2069 7320 6e6f 7420  t groups is not 
+00016ff0: 4e6f 6e65 0a20 2020 2020 2020 2061 7373  None.        ass
+00017000: 6572 7420 7365 7428 6576 616c 2867 726f  ert set(eval(gro
+00017010: 7570 732e 6772 6f75 7028 3129 2929 203d  ups.group(1))) =
+00017020: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
+00017030: 276d 6964 646c 655f 636f 6c75 6d6e 5f6e  'middle_column_n
+00017040: 616d 6527 2c20 2768 6967 685f 636f 6c75  ame', 'high_colu
+00017050: 6d6e 5f6e 616d 6527 2c20 276c 6f77 5f63  mn_name', 'low_c
+00017060: 6f6c 756d 6e5f 6e61 6d65 270a 2020 2020  olumn_name'.    
+00017070: 2020 2020 7d0a 2020 2020 2020 2020 6173      }.        as
+00017080: 7365 7274 2073 6574 2865 7661 6c28 6772  sert set(eval(gr
+00017090: 6f75 7073 2e67 726f 7570 2832 2929 2920  oups.group(2))) 
+000170a0: 3d3d 207b 276e 6f74 5f68 6967 685f 636f  == {'not_high_co
+000170b0: 6c75 6d6e 272c 2027 6e6f 745f 6c6f 775f  lumn', 'not_low_
+000170c0: 636f 6c75 6d6e 277d 0a0a 2020 2020 6465  column'}..    de
+000170d0: 6620 7465 7374 5f5f 7661 6c69 6461 7465  f test__validate
+000170e0: 5f6d 6574 6164 6174 615f 636f 6c75 6d6e  _metadata_column
+000170f0: 7328 7365 6c66 293a 0a20 2020 2020 2020  s(self):.       
+00017100: 2022 2222 5465 7374 2074 6865 2060 605f   """Test the ``_
+00017110: 7661 6c69 6461 7465 5f6d 6574 6164 6174  validate_metadat
+00017120: 615f 636f 6c75 6d6e 7360 6020 6d65 7468  a_columns`` meth
+00017130: 6f64 2e0a 0a20 2020 2020 2020 2041 6c6c  od...        All
+00017140: 206f 6620 7468 6520 636f 6c75 6d6e 7320   of the columns 
+00017150: 7061 7373 6564 2073 686f 756c 6420 6265  passed should be
+00017160: 2069 6e20 7468 6520 6d65 7461 6461 7461   in the metadata
+00017170: 2e0a 0a20 2020 2020 2020 2049 6e70 7574  ...        Input
+00017180: 3a0a 2020 2020 2020 2020 2020 2020 2d20  :.            - 
+00017190: 6869 6768 5f63 6f6c 756d 6e5f 6e61 6d65  high_column_name
+000171a0: 2c20 6c6f 775f 636f 6c75 6d6e 5f6e 616d  , low_column_nam
+000171b0: 6520 616e 6420 6d69 6464 6c65 5f63 6f6c  e and middle_col
+000171c0: 756d 6e5f 6e61 6d65 2074 6861 7420 6172  umn_name that ar
+000171d0: 6520 616c 6c20 696e 2074 6865 0a20 2020  e all in the.   
+000171e0: 2020 2020 2020 2020 206d 6574 6164 6174           metadat
+000171f0: 612e 0a0a 2020 2020 2020 2020 5369 6465  a...        Side
+00017200: 2065 6666 6563 743a 0a20 2020 2020 2020   effect:.       
+00017210: 2020 2020 202d 204e 6f20 6572 726f 7220       - No error 
+00017220: 7368 6f75 6c64 2062 6520 7261 6973 6564  should be raised
+00017230: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+00017240: 2020 2020 2020 2320 5365 7475 700a 2020        # Setup.  
+00017250: 2020 2020 2020 6d65 7461 6461 7461 203d        metadata =
+00017260: 204d 6f63 6b28 290a 2020 2020 2020 2020   Mock().        
+00017270: 6d65 7461 6461 7461 2e63 6f6c 756d 6e73  metadata.columns
+00017280: 203d 207b 2761 273a 2031 2c20 2762 273a   = {'a': 1, 'b':
+00017290: 2032 2c20 2763 273a 2033 7d0a 0a20 2020   2, 'c': 3}..   
+000172a0: 2020 2020 2023 2052 756e 0a20 2020 2020       # Run.     
+000172b0: 2020 2052 616e 6765 2e5f 7661 6c69 6461     Range._valida
+000172c0: 7465 5f6d 6574 6164 6174 615f 636f 6c75  te_metadata_colu
+000172d0: 6d6e 7328 0a20 2020 2020 2020 2020 2020  mns(.           
+000172e0: 206d 6574 6164 6174 612c 0a20 2020 2020   metadata,.     
+000172f0: 2020 2020 2020 2068 6967 685f 636f 6c75         high_colu
+00017300: 6d6e 5f6e 616d 653d 2761 272c 0a20 2020  mn_name='a',.   
+00017310: 2020 2020 2020 2020 206c 6f77 5f63 6f6c           low_col
+00017320: 756d 6e5f 6e61 6d65 3d27 6227 2c0a 2020  umn_name='b',.  
+00017330: 2020 2020 2020 2020 2020 6d69 6464 6c65            middle
+00017340: 5f63 6f6c 756d 6e5f 6e61 6d65 3d27 6327  _column_name='c'
+00017350: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+00017360: 6465 6620 7465 7374 5f5f 7661 6c69 6461  def test__valida
+00017370: 7465 5f6d 6574 6164 6174 615f 636f 6c75  te_metadata_colu
+00017380: 6d6e 735f 7261 6973 6573 5f65 7272 6f72  mns_raises_error
+00017390: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+000173a0: 2222 2254 6573 7420 7468 6520 6060 5f76  """Test the ``_v
+000173b0: 616c 6964 6174 655f 6d65 7461 6461 7461  alidate_metadata
+000173c0: 5f63 6f6c 756d 6e73 6060 206d 6574 686f  _columns`` metho
+000173d0: 6427 7320 6572 726f 7220 636f 6e64 6974  d's error condit
+000173e0: 696f 6e2e 0a0a 2020 2020 2020 2020 4966  ion...        If
+000173f0: 2061 6e79 2063 6f6c 756d 6e73 2070 6173   any columns pas
+00017400: 7365 6420 6172 6520 6e6f 7420 696e 2074  sed are not in t
+00017410: 6865 206d 6574 6164 6174 612c 2061 6e20  he metadata, an 
+00017420: 6572 726f 7220 7368 6f75 6c64 2062 6520  error should be 
+00017430: 7261 6973 6564 2e0a 0a20 2020 2020 2020  raised...       
+00017440: 2049 6e70 7574 3a0a 2020 2020 2020 2020   Input:.        
+00017450: 2020 2020 2d20 6c6f 775f 636f 6c75 6d6e      - low_column
+00017460: 5f6e 616d 6520 7468 6174 2069 7320 6e6f  _name that is no
+00017470: 7420 696e 2074 6865 206d 6574 6164 6174  t in the metadat
+00017480: 612e 0a0a 2020 2020 2020 2020 5369 6465  a...        Side
+00017490: 2065 6666 6563 743a 0a20 2020 2020 2020   effect:.       
+000174a0: 2020 2020 202d 2043 6f6e 7374 7261 696e       - Constrain
+000174b0: 744d 6574 6164 6174 6145 7272 6f72 2073  tMetadataError s
+000174c0: 686f 756c 6420 6265 2072 6169 7365 642e  hould be raised.
+000174d0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+000174e0: 2020 2020 2023 2053 6574 7570 0a20 2020       # Setup.   
+000174f0: 2020 2020 206d 6574 6164 6174 6120 3d20       metadata = 
+00017500: 4d6f 636b 2829 0a20 2020 2020 2020 206d  Mock().        m
+00017510: 6574 6164 6174 612e 636f 6c75 6d6e 7320  etadata.columns 
+00017520: 3d20 7b27 6127 3a20 312c 2027 6227 3a20  = {'a': 1, 'b': 
+00017530: 327d 0a0a 2020 2020 2020 2020 2320 5275  2}..        # Ru
+00017540: 6e0a 2020 2020 2020 2020 6572 726f 725f  n.        error_
+00017550: 6d65 7373 6167 6520 3d20 7265 2e65 7363  message = re.esc
+00017560: 6170 6528 0a20 2020 2020 2020 2020 2020  ape(.           
+00017570: 2027 4120 5261 6e67 6520 636f 6e73 7472   'A Range constr
+00017580: 6169 6e74 2069 7320 6265 696e 6720 6170  aint is being ap
+00017590: 706c 6965 6420 746f 2069 6e76 616c 6964  plied to invalid
+000175a0: 2063 6f6c 756d 6e20 6e61 6d65 7320 270a   column names '.
+000175b0: 2020 2020 2020 2020 2020 2020 227b 2763              "{'c
+000175c0: 277d 2e20 5468 6520 636f 6c75 6d6e 7320  '}. The columns 
+000175d0: 6d75 7374 2065 7869 7374 2069 6e20 7468  must exist in th
+000175e0: 6520 7461 626c 652e 220a 2020 2020 2020  e table.".      
+000175f0: 2020 290a 2020 2020 2020 2020 7769 7468    ).        with
+00017600: 2070 7974 6573 742e 7261 6973 6573 2843   pytest.raises(C
+00017610: 6f6e 7374 7261 696e 744d 6574 6164 6174  onstraintMetadat
+00017620: 6145 7272 6f72 2c20 6d61 7463 683d 6572  aError, match=er
+00017630: 726f 725f 6d65 7373 6167 6529 3a0a 2020  ror_message):.  
+00017640: 2020 2020 2020 2020 2020 5261 6e67 652e            Range.
+00017650: 5f76 616c 6964 6174 655f 6d65 7461 6461  _validate_metada
+00017660: 7461 5f63 6f6c 756d 6e73 280a 2020 2020  ta_columns(.    
+00017670: 2020 2020 2020 2020 2020 2020 6d65 7461              meta
+00017680: 6461 7461 2c0a 2020 2020 2020 2020 2020  data,.          
+00017690: 2020 2020 2020 6869 6768 5f63 6f6c 756d        high_colum
+000176a0: 6e5f 6e61 6d65 3d27 6127 2c0a 2020 2020  n_name='a',.    
+000176b0: 2020 2020 2020 2020 2020 2020 6c6f 775f              low_
+000176c0: 636f 6c75 6d6e 5f6e 616d 653d 2762 272c  column_name='b',
+000176d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000176e0: 206d 6964 646c 655f 636f 6c75 6d6e 5f6e   middle_column_n
+000176f0: 616d 653d 2763 270a 2020 2020 2020 2020  ame='c'.        
+00017700: 2020 2020 290a 0a20 2020 2064 6566 2074      )..    def t
+00017710: 6573 745f 5f76 616c 6964 6174 655f 6d65  est__validate_me
+00017720: 7461 6461 7461 5f73 7065 6369 6669 635f  tadata_specific_
+00017730: 746f 5f63 6f6e 7374 7261 696e 745f 6461  to_constraint_da
+00017740: 7465 7469 6d65 2873 656c 6629 3a0a 2020  tetime(self):.  
+00017750: 2020 2020 2020 2222 2254 6573 7420 7468        """Test th
+00017760: 6520 6060 5f76 616c 6964 6174 655f 6d65  e ``_validate_me
+00017770: 7461 6461 7461 5f73 7065 6369 6669 635f  tadata_specific_
+00017780: 746f 5f63 6f6e 7374 7261 696e 7460 6020  to_constraint`` 
+00017790: 7769 7468 2064 6174 6574 696d 6573 2e0a  with datetimes..
+000177a0: 0a20 2020 2020 2020 2049 6620 7468 6520  .        If the 
+000177b0: 6060 6869 6768 5f63 6f6c 756d 6e5f 6e61  ``high_column_na
+000177c0: 6d65 6060 2c20 6060 6d69 6464 6c65 5f63  me``, ``middle_c
+000177d0: 6f6c 756d 6e5f 6e61 6d65 6060 2061 6e64  olumn_name`` and
+000177e0: 2060 606c 6f77 5f63 6f6c 756d 6e5f 6e61   ``low_column_na
+000177f0: 6d65 6060 0a20 2020 2020 2020 2061 7265  me``.        are
+00017800: 2064 6174 6574 696d 6573 2c20 7468 656e   datetimes, then
+00017810: 2074 6865 2076 616c 6964 6174 696f 6e20   the validation 
+00017820: 7368 6f75 6c64 206e 6f74 2072 6169 7365  should not raise
+00017830: 2061 6e20 6572 726f 722e 0a0a 2020 2020   an error...    
+00017840: 2020 2020 496e 7075 743a 0a20 2020 2020      Input:.     
+00017850: 2020 2020 2020 202d 204d 6574 6164 6174         - Metadat
+00017860: 6120 7769 7468 2073 6474 7970 6573 2073  a with sdtypes s
+00017870: 6574 2074 6f20 6461 7465 7469 6d65 2066  et to datetime f
+00017880: 6f72 2074 6865 2068 6967 682c 206d 6964  or the high, mid
+00017890: 646c 6520 616e 6420 6c6f 7720 636f 6c75  dle and low colu
+000178a0: 6d6e 2e0a 2020 2020 2020 2020 2222 220a  mn..        """.
+000178b0: 2020 2020 2020 2020 2320 5365 7475 700a          # Setup.
+000178c0: 2020 2020 2020 2020 6d65 7461 6461 7461          metadata
+000178d0: 203d 204d 6f63 6b28 290a 2020 2020 2020   = Mock().      
+000178e0: 2020 6d65 7461 6461 7461 2e63 6f6c 756d    metadata.colum
+000178f0: 6e73 203d 207b 0a20 2020 2020 2020 2020  ns = {.         
+00017900: 2020 2027 6127 3a20 7b27 7364 7479 7065     'a': {'sdtype
+00017910: 273a 2027 6461 7465 7469 6d65 277d 2c0a  ': 'datetime'},.
+00017920: 2020 2020 2020 2020 2020 2020 2762 273a              'b':
+00017930: 207b 2773 6474 7970 6527 3a20 2764 6174   {'sdtype': 'dat
+00017940: 6574 696d 6527 7d2c 0a20 2020 2020 2020  etime'},.       
+00017950: 2020 2020 2027 6327 3a20 7b27 7364 7479       'c': {'sdty
+00017960: 7065 273a 2027 6461 7465 7469 6d65 277d  pe': 'datetime'}
+00017970: 0a20 2020 2020 2020 207d 0a0a 2020 2020  .        }..    
+00017980: 2020 2020 2320 5275 6e0a 2020 2020 2020      # Run.      
+00017990: 2020 5261 6e67 652e 5f76 616c 6964 6174    Range._validat
+000179a0: 655f 6d65 7461 6461 7461 5f73 7065 6369  e_metadata_speci
+000179b0: 6669 635f 746f 5f63 6f6e 7374 7261 696e  fic_to_constrain
+000179c0: 7428 0a20 2020 2020 2020 2020 2020 206d  t(.            m
+000179d0: 6574 6164 6174 612c 0a20 2020 2020 2020  etadata,.       
+000179e0: 2020 2020 2068 6967 685f 636f 6c75 6d6e       high_column
+000179f0: 5f6e 616d 653d 2761 272c 0a20 2020 2020  _name='a',.     
+00017a00: 2020 2020 2020 206c 6f77 5f63 6f6c 756d         low_colum
+00017a10: 6e5f 6e61 6d65 3d27 6227 2c0a 2020 2020  n_name='b',.    
+00017a20: 2020 2020 2020 2020 6d69 6464 6c65 5f63          middle_c
+00017a30: 6f6c 756d 6e5f 6e61 6d65 3d27 6327 0a20  olumn_name='c'. 
+00017a40: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
+00017a50: 6620 7465 7374 5f5f 7661 6c69 6461 7465  f test__validate
+00017a60: 5f6d 6574 6164 6174 615f 7370 6563 6966  _metadata_specif
+00017a70: 6963 5f74 6f5f 636f 6e73 7472 6169 6e74  ic_to_constraint
+00017a80: 5f64 6174 6574 696d 655f 6572 726f 7228  _datetime_error(
+00017a90: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
+00017aa0: 2222 5465 7374 2074 6865 2060 605f 7661  ""Test the ``_va
+00017ab0: 6c69 6461 7465 5f6d 6574 6164 6174 615f  lidate_metadata_
+00017ac0: 7370 6563 6966 6963 5f74 6f5f 636f 6e73  specific_to_cons
+00017ad0: 7472 6169 6e74 6060 2077 6974 6820 6461  traint`` with da
+00017ae0: 7465 7469 6d65 732e 0a0a 2020 2020 2020  tetimes...      
+00017af0: 2020 4966 2074 6865 2060 6068 6967 685f    If the ``high_
+00017b00: 636f 6c75 6d6e 5f6e 616d 6560 602c 2060  column_name``, `
+00017b10: 606d 6964 646c 655f 636f 6c75 6d6e 5f6e  `middle_column_n
+00017b20: 616d 6560 6020 616e 6420 6060 6c6f 775f  ame`` and ``low_
+00017b30: 636f 6c75 6d6e 5f6e 616d 6560 600a 2020  column_name``.  
+00017b40: 2020 2020 2020 6172 6520 6e6f 7420 616c        are not al
+00017b50: 6c20 6461 7465 7469 6d65 732c 2074 6865  l datetimes, the
+00017b60: 6e20 7468 6520 7661 6c69 6461 7469 6f6e  n the validation
+00017b70: 2073 686f 756c 6420 7261 6973 6520 616e   should raise an
+00017b80: 2065 7272 6f72 2e0a 0a20 2020 2020 2020   error...       
+00017b90: 2049 6e70 7574 3a0a 2020 2020 2020 2020   Input:.        
+00017ba0: 2020 2020 2d20 4d65 7461 6461 7461 2077      - Metadata w
+00017bb0: 6974 6820 7364 7479 7065 7320 7365 7420  ith sdtypes set 
+00017bc0: 746f 2064 6174 6574 696d 6520 666f 7220  to datetime for 
+00017bd0: 7468 6520 6869 6768 2061 6e64 206c 6f77  the high and low
+00017be0: 2063 6f6c 756d 6e0a 2020 2020 2020 2020   column.        
+00017bf0: 2020 2020 6275 7420 6e6f 7420 7468 6520      but not the 
+00017c00: 6d69 6464 6c65 2e0a 2020 2020 2020 2020  middle..        
+00017c10: 2222 220a 2020 2020 2020 2020 2320 5365  """.        # Se
+00017c20: 7475 700a 2020 2020 2020 2020 6d65 7461  tup.        meta
+00017c30: 6461 7461 203d 204d 6f63 6b28 290a 2020  data = Mock().  
+00017c40: 2020 2020 2020 6d65 7461 6461 7461 2e63        metadata.c
+00017c50: 6f6c 756d 6e73 203d 207b 0a20 2020 2020  olumns = {.     
+00017c60: 2020 2020 2020 2027 6127 3a20 7b27 7364         'a': {'sd
+00017c70: 7479 7065 273a 2027 6461 7465 7469 6d65  type': 'datetime
+00017c80: 277d 2c0a 2020 2020 2020 2020 2020 2020  '},.            
+00017c90: 2762 273a 207b 2773 6474 7970 6527 3a20  'b': {'sdtype': 
+00017ca0: 2764 6174 6574 696d 6527 7d2c 0a20 2020  'datetime'},.   
+00017cb0: 2020 2020 2020 2020 2027 6327 3a20 7b27           'c': {'
+00017cc0: 7364 7479 7065 273a 2027 6e75 6d65 7269  sdtype': 'numeri
+00017cd0: 6361 6c27 7d0a 2020 2020 2020 2020 7d0a  cal'}.        }.
+00017ce0: 0a20 2020 2020 2020 2023 2052 756e 0a20  .        # Run. 
+00017cf0: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
+00017d00: 7361 6765 203d 2072 652e 6573 6361 7065  sage = re.escape
+00017d10: 280a 2020 2020 2020 2020 2020 2020 2741  (.            'A
+00017d20: 2052 616e 6765 2063 6f6e 7374 7261 696e   Range constrain
+00017d30: 7420 6973 2062 6569 6e67 2061 7070 6c69  t is being appli
+00017d40: 6564 2074 6f20 636f 6c75 6d6e 7320 7769  ed to columns wi
+00017d50: 7468 206d 6973 6d61 7463 6865 6420 7364  th mismatched sd
+00017d60: 7479 7065 7320 270a 2020 2020 2020 2020  types '.        
+00017d70: 2020 2020 225b 2761 272c 2027 6327 2c20      "['a', 'c', 
+00017d80: 2762 275d 2e20 416c 6c20 636f 6c75 6d6e  'b']. All column
+00017d90: 7320 6d75 7374 2062 6520 6569 7468 6572  s must be either
+00017da0: 206e 756d 6572 6963 616c 206f 7220 6461   numerical or da
+00017db0: 7465 7469 6d65 2e22 0a20 2020 2020 2020  tetime.".       
+00017dc0: 2029 0a20 2020 2020 2020 2077 6974 6820   ).        with 
+00017dd0: 7079 7465 7374 2e72 6169 7365 7328 436f  pytest.raises(Co
+00017de0: 6e73 7472 6169 6e74 4d65 7461 6461 7461  nstraintMetadata
+00017df0: 4572 726f 722c 206d 6174 6368 3d65 7272  Error, match=err
+00017e00: 6f72 5f6d 6573 7361 6765 293a 0a20 2020  or_message):.   
+00017e10: 2020 2020 2020 2020 2052 616e 6765 2e5f           Range._
+00017e20: 7661 6c69 6461 7465 5f6d 6574 6164 6174  validate_metadat
+00017e30: 615f 7370 6563 6966 6963 5f74 6f5f 636f  a_specific_to_co
+00017e40: 6e73 7472 6169 6e74 280a 2020 2020 2020  nstraint(.      
+00017e50: 2020 2020 2020 2020 2020 6d65 7461 6461            metada
+00017e60: 7461 2c0a 2020 2020 2020 2020 2020 2020  ta,.            
+00017e70: 2020 2020 6869 6768 5f63 6f6c 756d 6e5f      high_column_
+00017e80: 6e61 6d65 3d27 6127 2c0a 2020 2020 2020  name='a',.      
+00017e90: 2020 2020 2020 2020 2020 6c6f 775f 636f            low_co
+00017ea0: 6c75 6d6e 5f6e 616d 653d 2762 272c 0a20  lumn_name='b',. 
+00017eb0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+00017ec0: 6964 646c 655f 636f 6c75 6d6e 5f6e 616d  iddle_column_nam
+00017ed0: 653d 2763 270a 2020 2020 2020 2020 2020  e='c'.          
+00017ee0: 2020 290a 0a20 2020 2064 6566 2074 6573    )..    def tes
+00017ef0: 745f 5f76 616c 6964 6174 655f 6d65 7461  t__validate_meta
+00017f00: 6461 7461 5f73 7065 6369 6669 635f 746f  data_specific_to
+00017f10: 5f63 6f6e 7374 7261 696e 745f 6e75 6d65  _constraint_nume
+00017f20: 7269 6361 6c28 7365 6c66 293a 0a20 2020  rical(self):.   
+00017f30: 2020 2020 2022 2222 5465 7374 2074 6865       """Test the
+00017f40: 2060 605f 7661 6c69 6461 7465 5f6d 6574   ``_validate_met
+00017f50: 6164 6174 615f 7370 6563 6966 6963 5f74  adata_specific_t
+00017f60: 6f5f 636f 6e73 7472 6169 6e74 6060 2077  o_constraint`` w
+00017f70: 6974 6820 6e75 6d65 7269 6361 6c2e 0a0a  ith numerical...
+00017f80: 2020 2020 2020 2020 4966 2074 6865 2060          If the `
+00017f90: 6068 6967 685f 636f 6c75 6d6e 5f6e 616d  `high_column_nam
+00017fa0: 6560 602c 2060 606d 6964 646c 655f 636f  e``, ``middle_co
+00017fb0: 6c75 6d6e 5f6e 616d 6560 6020 616e 6420  lumn_name`` and 
+00017fc0: 6060 6c6f 775f 636f 6c75 6d6e 5f6e 616d  ``low_column_nam
+00017fd0: 6560 600a 2020 2020 2020 2020 6172 6520  e``.        are 
+00017fe0: 6e75 6d65 7269 6361 6c2c 2074 6865 6e20  numerical, then 
+00017ff0: 7468 6520 7661 6c69 6461 7469 6f6e 2073  the validation s
+00018000: 686f 756c 6420 6e6f 7420 7261 6973 6520  hould not raise 
+00018010: 616e 2065 7272 6f72 2e0a 0a20 2020 2020  an error...     
+00018020: 2020 2049 6e70 7574 3a0a 2020 2020 2020     Input:.      
+00018030: 2020 2020 2020 2d20 4d65 7461 6461 7461        - Metadata
+00018040: 2077 6974 6820 7364 7479 7065 7320 7365   with sdtypes se
+00018050: 7420 746f 206e 756d 6572 6963 616c 2066  t to numerical f
+00018060: 6f72 2074 6865 2068 6967 682c 206d 6964  or the high, mid
+00018070: 646c 6520 616e 6420 6c6f 7720 636f 6c75  dle and low colu
+00018080: 6d6e 2e0a 2020 2020 2020 2020 2222 220a  mn..        """.
+00018090: 2020 2020 2020 2020 2320 5365 7475 700a          # Setup.
+000180a0: 2020 2020 2020 2020 6d65 7461 6461 7461          metadata
+000180b0: 203d 204d 6f63 6b28 290a 2020 2020 2020   = Mock().      
+000180c0: 2020 6d65 7461 6461 7461 2e63 6f6c 756d    metadata.colum
+000180d0: 6e73 203d 207b 0a20 2020 2020 2020 2020  ns = {.         
+000180e0: 2020 2027 6127 3a20 7b27 7364 7479 7065     'a': {'sdtype
+000180f0: 273a 2027 6e75 6d65 7269 6361 6c27 7d2c  ': 'numerical'},
+00018100: 0a20 2020 2020 2020 2020 2020 2027 6227  .            'b'
+00018110: 3a20 7b27 7364 7479 7065 273a 2027 6e75  : {'sdtype': 'nu
+00018120: 6d65 7269 6361 6c27 7d2c 0a20 2020 2020  merical'},.     
+00018130: 2020 2020 2020 2027 6327 3a20 7b27 7364         'c': {'sd
+00018140: 7479 7065 273a 2027 6e75 6d65 7269 6361  type': 'numerica
+00018150: 6c27 7d0a 2020 2020 2020 2020 7d0a 0a20  l'}.        }.. 
+00018160: 2020 2020 2020 2023 2052 756e 0a20 2020         # Run.   
+00018170: 2020 2020 2052 616e 6765 2e5f 7661 6c69       Range._vali
+00018180: 6461 7465 5f6d 6574 6164 6174 615f 7370  date_metadata_sp
+00018190: 6563 6966 6963 5f74 6f5f 636f 6e73 7472  ecific_to_constr
+000181a0: 6169 6e74 280a 2020 2020 2020 2020 2020  aint(.          
+000181b0: 2020 6d65 7461 6461 7461 2c0a 2020 2020    metadata,.    
+000181c0: 2020 2020 2020 2020 6869 6768 5f63 6f6c          high_col
+000181d0: 756d 6e5f 6e61 6d65 3d27 6127 2c0a 2020  umn_name='a',.  
+000181e0: 2020 2020 2020 2020 2020 6c6f 775f 636f            low_co
+000181f0: 6c75 6d6e 5f6e 616d 653d 2762 272c 0a20  lumn_name='b',. 
+00018200: 2020 2020 2020 2020 2020 206d 6964 646c             middl
+00018210: 655f 636f 6c75 6d6e 5f6e 616d 653d 2763  e_column_name='c
+00018220: 270a 2020 2020 2020 2020 290a 0a20 2020  '.        )..   
+00018230: 2064 6566 2074 6573 745f 5f76 616c 6964   def test__valid
+00018240: 6174 655f 6d65 7461 6461 7461 5f73 7065  ate_metadata_spe
+00018250: 6369 6669 635f 746f 5f63 6f6e 7374 7261  cific_to_constra
+00018260: 696e 745f 6e75 6d65 7269 6361 6c5f 6572  int_numerical_er
+00018270: 726f 7228 7365 6c66 293a 0a20 2020 2020  ror(self):.     
+00018280: 2020 2022 2222 5465 7374 2074 6865 2060     """Test the `
+00018290: 605f 7661 6c69 6461 7465 5f6d 6574 6164  `_validate_metad
+000182a0: 6174 615f 7370 6563 6966 6963 5f74 6f5f  ata_specific_to_
+000182b0: 636f 6e73 7472 6169 6e74 6060 2077 6974  constraint`` wit
+000182c0: 6820 6e75 6d65 7269 6361 6c2e 0a0a 2020  h numerical...  
+000182d0: 2020 2020 2020 4966 2074 6865 2060 6068        If the ``h
+000182e0: 6967 685f 636f 6c75 6d6e 5f6e 616d 6560  igh_column_name`
+000182f0: 602c 2060 606d 6964 646c 655f 636f 6c75  `, ``middle_colu
+00018300: 6d6e 5f6e 616d 6560 6020 616e 6420 6060  mn_name`` and ``
+00018310: 6c6f 775f 636f 6c75 6d6e 5f6e 616d 6560  low_column_name`
+00018320: 600a 2020 2020 2020 2020 6172 6520 6e6f  `.        are no
+00018330: 7420 616c 6c20 6e75 6d65 7269 6361 6c2c  t all numerical,
+00018340: 2074 6865 6e20 7468 6520 7661 6c69 6461   then the valida
+00018350: 7469 6f6e 2073 686f 756c 6420 7261 6973  tion should rais
+00018360: 6520 616e 2065 7272 6f72 2e0a 0a20 2020  e an error...   
+00018370: 2020 2020 2049 6e70 7574 3a0a 2020 2020       Input:.    
+00018380: 2020 2020 2020 2020 2d20 4d65 7461 6461          - Metada
+00018390: 7461 2077 6974 6820 7364 7479 7065 7320  ta with sdtypes 
+000183a0: 7365 7420 746f 206e 756d 6572 6963 616c  set to numerical
+000183b0: 2066 6f72 2074 6865 2068 6967 6820 616e   for the high an
+000183c0: 6420 6c6f 7720 636f 6c75 6d6e 0a20 2020  d low column.   
+000183d0: 2020 2020 2020 2020 2062 7574 206e 6f74           but not
+000183e0: 2074 6865 206d 6964 646c 652e 0a20 2020   the middle..   
+000183f0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00018400: 2023 2053 6574 7570 0a20 2020 2020 2020   # Setup.       
+00018410: 206d 6574 6164 6174 6120 3d20 4d6f 636b   metadata = Mock
+00018420: 2829 0a20 2020 2020 2020 206d 6574 6164  ().        metad
+00018430: 6174 612e 636f 6c75 6d6e 7320 3d20 7b0a  ata.columns = {.
+00018440: 2020 2020 2020 2020 2020 2020 2761 273a              'a':
+00018450: 207b 2773 6474 7970 6527 3a20 276e 756d   {'sdtype': 'num
+00018460: 6572 6963 616c 277d 2c0a 2020 2020 2020  erical'},.      
+00018470: 2020 2020 2020 2762 273a 207b 2773 6474        'b': {'sdt
+00018480: 7970 6527 3a20 276e 756d 6572 6963 616c  ype': 'numerical
+00018490: 277d 2c0a 2020 2020 2020 2020 2020 2020  '},.            
+000184a0: 2763 273a 207b 2773 6474 7970 6527 3a20  'c': {'sdtype': 
+000184b0: 2764 6174 6574 696d 6527 7d0a 2020 2020  'datetime'}.    
+000184c0: 2020 2020 7d0a 0a20 2020 2020 2020 2023      }..        #
+000184d0: 2052 756e 0a20 2020 2020 2020 2065 7272   Run.        err
+000184e0: 6f72 5f6d 6573 7361 6765 203d 2072 652e  or_message = re.
+000184f0: 6573 6361 7065 280a 2020 2020 2020 2020  escape(.        
+00018500: 2020 2020 2741 2052 616e 6765 2063 6f6e      'A Range con
+00018510: 7374 7261 696e 7420 6973 2062 6569 6e67  straint is being
+00018520: 2061 7070 6c69 6564 2074 6f20 636f 6c75   applied to colu
+00018530: 6d6e 7320 7769 7468 206d 6973 6d61 7463  mns with mismatc
+00018540: 6865 6420 7364 7479 7065 7320 270a 2020  hed sdtypes '.  
+00018550: 2020 2020 2020 2020 2020 225b 2761 272c            "['a',
+00018560: 2027 6327 2c20 2762 275d 2e20 416c 6c20   'c', 'b']. All 
+00018570: 636f 6c75 6d6e 7320 6d75 7374 2062 6520  columns must be 
+00018580: 6569 7468 6572 206e 756d 6572 6963 616c  either numerical
+00018590: 206f 7220 6461 7465 7469 6d65 2e22 0a20   or datetime.". 
+000185a0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+000185b0: 2077 6974 6820 7079 7465 7374 2e72 6169   with pytest.rai
+000185c0: 7365 7328 436f 6e73 7472 6169 6e74 4d65  ses(ConstraintMe
+000185d0: 7461 6461 7461 4572 726f 722c 206d 6174  tadataError, mat
+000185e0: 6368 3d65 7272 6f72 5f6d 6573 7361 6765  ch=error_message
+000185f0: 293a 0a20 2020 2020 2020 2020 2020 2052  ):.            R
+00018600: 616e 6765 2e5f 7661 6c69 6461 7465 5f6d  ange._validate_m
+00018610: 6574 6164 6174 615f 7370 6563 6966 6963  etadata_specific
+00018620: 5f74 6f5f 636f 6e73 7472 6169 6e74 280a  _to_constraint(.
+00018630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018640: 6d65 7461 6461 7461 2c0a 2020 2020 2020  metadata,.      
+00018650: 2020 2020 2020 2020 2020 6869 6768 5f63            high_c
+00018660: 6f6c 756d 6e5f 6e61 6d65 3d27 6127 2c0a  olumn_name='a',.
+00018670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018680: 6c6f 775f 636f 6c75 6d6e 5f6e 616d 653d  low_column_name=
+00018690: 2762 272c 0a20 2020 2020 2020 2020 2020  'b',.           
+000186a0: 2020 2020 206d 6964 646c 655f 636f 6c75       middle_colu
+000186b0: 6d6e 5f6e 616d 653d 2763 270a 2020 2020  mn_name='c'.    
+000186c0: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
+000186d0: 6566 2074 6573 745f 5f5f 696e 6974 5f5f  ef test___init__
+000186e0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+000186f0: 2222 2254 6573 7420 7468 6520 6060 5261  """Test the ``Ra
+00018700: 6e67 652e 5f5f 696e 6974 5f5f 6060 206d  nge.__init__`` m
+00018710: 6574 686f 642e 0a0a 2020 2020 2020 2020  ethod...        
+00018720: 5468 6520 696e 7374 616e 6365 2073 686f  The instance sho
+00018730: 756c 6420 636f 6e74 6169 6e20 7468 6520  uld contain the 
+00018740: 6e61 6d65 206f 6620 7468 6520 7468 7265  name of the thre
+00018750: 6520 7061 7373 6564 2063 6f6c 756d 6e73  e passed columns
+00018760: 2061 6e64 2061 6c73 6f0a 2020 2020 2020   and also.      
+00018770: 2020 7573 6520 616e 206f 7065 7261 746f    use an operato
+00018780: 7220 6060 3c60 6020 6966 2060 6073 7472  r ``<`` if ``str
+00018790: 6963 745f 626f 756e 6461 7269 6573 6060  ict_boundaries``
+000187a0: 2069 7320 6060 5472 7565 6060 2062 7920   is ``True`` by 
+000187b0: 6465 6661 756c 742e 0a20 2020 2020 2020  default..       
+000187c0: 2049 6e70 7574 3a0a 2020 2020 2020 2020   Input:.        
+000187d0: 2020 2020 2d20 5468 7265 6520 636f 6c75      - Three colu
+000187e0: 6d6e 206e 616d 6573 2e0a 2020 2020 2020  mn names..      
+000187f0: 2020 2222 220a 2020 2020 2020 2020 2320    """.        # 
+00018800: 5275 6e0a 2020 2020 2020 2020 696e 7374  Run.        inst
+00018810: 616e 6365 203d 2052 616e 6765 2827 6167  ance = Range('ag
+00018820: 655f 7768 656e 5f6a 6f69 6e65 6427 2c20  e_when_joined', 
+00018830: 2763 7572 7265 6e74 5f61 6765 272c 2027  'current_age', '
+00018840: 7265 7469 7265 6d65 6e74 5f61 6765 2729  retirement_age')
+00018850: 0a0a 2020 2020 2020 2020 2320 4173 7365  ..        # Asse
+00018860: 7274 0a20 2020 2020 2020 2061 7373 6572  rt.        asser
+00018870: 7420 696e 7374 616e 6365 2e6c 6f77 5f63  t instance.low_c
+00018880: 6f6c 756d 6e5f 6e61 6d65 203d 3d20 2761  olumn_name == 'a
+00018890: 6765 5f77 6865 6e5f 6a6f 696e 6564 270a  ge_when_joined'.
+000188a0: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
+000188b0: 6e73 7461 6e63 652e 6d69 6464 6c65 5f63  nstance.middle_c
+000188c0: 6f6c 756d 6e5f 6e61 6d65 203d 3d20 2763  olumn_name == 'c
+000188d0: 7572 7265 6e74 5f61 6765 270a 2020 2020  urrent_age'.    
+000188e0: 2020 2020 6173 7365 7274 2069 6e73 7461      assert insta
+000188f0: 6e63 652e 6869 6768 5f63 6f6c 756d 6e5f  nce.high_column_
+00018900: 6e61 6d65 203d 3d20 2772 6574 6972 656d  name == 'retirem
+00018910: 656e 745f 6167 6527 0a20 2020 2020 2020  ent_age'.       
+00018920: 2061 7373 6572 7420 696e 7374 616e 6365   assert instance
+00018930: 2e5f 6f70 6572 6174 6f72 203d 3d20 6f70  ._operator == op
+00018940: 6572 6174 6f72 2e6c 740a 0a20 2020 2064  erator.lt..    d
+00018950: 6566 2074 6573 745f 5f5f 696e 6974 5f5f  ef test___init__
+00018960: 7374 7269 6374 5f62 6f75 6e64 6172 6965  strict_boundarie
+00018970: 735f 6661 6c73 6528 7365 6c66 293a 0a20  s_false(self):. 
+00018980: 2020 2020 2020 2022 2222 5465 7374 2074         """Test t
+00018990: 6865 2060 6052 616e 6765 2e5f 5f69 6e69  he ``Range.__ini
+000189a0: 745f 5f60 6020 6d65 7468 6f64 2e0a 0a20  t__`` method... 
+000189b0: 2020 2020 2020 2054 6573 7420 7468 6520         Test the 
+000189c0: 6060 5f5f 696e 6974 5f5f 6060 206d 6574  ``__init__`` met
+000189d0: 686f 6420 7768 656e 2060 6073 7472 6963  hod when ``stric
+000189e0: 745f 626f 756e 6461 7269 6573 6060 2069  t_boundaries`` i
+000189f0: 7320 6060 4661 6c73 6560 602e 0a0a 2020  s ``False``...  
+00018a00: 2020 2020 2020 496e 7075 743a 0a20 2020        Input:.   
+00018a10: 2020 2020 2020 2020 202d 2054 6872 6565           - Three
+00018a20: 2063 6f6c 756d 6e20 6e61 6d65 732e 0a20   column names.. 
+00018a30: 2020 2020 2020 2020 2020 202d 2060 6073             - ``s
+00018a40: 7472 6963 745f 626f 756e 6461 7269 6573  trict_boundaries
+00018a50: 3d46 616c 7365 6060 2e0a 0a20 2020 2020  =False``...     
+00018a60: 2020 2053 6964 6520 4566 6665 6374 3a0a     Side Effect:.
+00018a70: 2020 2020 2020 2020 2020 2020 2d20 6060              - ``
+00018a80: 696e 7374 616e 6365 2e5f 6f70 6572 6174  instance._operat
+00018a90: 6f72 6060 2073 686f 756c 6420 6265 2060  or`` should be `
+00018aa0: 606f 7065 7261 746f 722e 6c65 6060 0a20  `operator.le``. 
+00018ab0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00018ac0: 2020 2023 2052 756e 0a20 2020 2020 2020     # Run.       
+00018ad0: 2069 6e73 7461 6e63 6520 3d20 5261 6e67   instance = Rang
+00018ae0: 6528 0a20 2020 2020 2020 2020 2020 2027  e(.            '
+00018af0: 6167 655f 7768 656e 5f6a 6f69 6e65 6427  age_when_joined'
+00018b00: 2c0a 2020 2020 2020 2020 2020 2020 2763  ,.            'c
+00018b10: 7572 7265 6e74 5f61 6765 272c 0a20 2020  urrent_age',.   
+00018b20: 2020 2020 2020 2020 2027 7265 7469 7265           'retire
+00018b30: 6d65 6e74 5f61 6765 272c 0a20 2020 2020  ment_age',.     
+00018b40: 2020 2020 2020 2073 7472 6963 745f 626f         strict_bo
+00018b50: 756e 6461 7269 6573 3d46 616c 7365 0a20  undaries=False. 
+00018b60: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+00018b70: 2020 2320 4173 7365 7274 0a20 2020 2020    # Assert.     
+00018b80: 2020 2061 7373 6572 7420 696e 7374 616e     assert instan
+00018b90: 6365 2e6c 6f77 5f63 6f6c 756d 6e5f 6e61  ce.low_column_na
+00018ba0: 6d65 203d 3d20 2761 6765 5f77 6865 6e5f  me == 'age_when_
+00018bb0: 6a6f 696e 6564 270a 2020 2020 2020 2020  joined'.        
+00018bc0: 6173 7365 7274 2069 6e73 7461 6e63 652e  assert instance.
+00018bd0: 6d69 6464 6c65 5f63 6f6c 756d 6e5f 6e61  middle_column_na
+00018be0: 6d65 203d 3d20 2763 7572 7265 6e74 5f61  me == 'current_a
+00018bf0: 6765 270a 2020 2020 2020 2020 6173 7365  ge'.        asse
+00018c00: 7274 2069 6e73 7461 6e63 652e 6869 6768  rt instance.high
+00018c10: 5f63 6f6c 756d 6e5f 6e61 6d65 203d 3d20  _column_name == 
+00018c20: 2772 6574 6972 656d 656e 745f 6167 6527  'retirement_age'
+00018c30: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00018c40: 696e 7374 616e 6365 2e5f 6f70 6572 6174  instance._operat
+00018c50: 6f72 203d 3d20 6f70 6572 6174 6f72 2e6c  or == operator.l
+00018c60: 650a 0a20 2020 2064 6566 2074 6573 745f  e..    def test_
+00018c70: 5f67 6574 5f69 735f 6461 7465 7469 6d65  _get_is_datetime
+00018c80: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00018c90: 2222 2254 6573 7420 7468 6174 2074 6865  """Test that the
+00018ca0: 206d 6574 686f 6420 6465 7465 6374 7320   method detects 
+00018cb0: 7768 6574 6865 7220 6f72 206e 6f74 2074  whether or not t
+00018cc0: 6865 2060 6064 6174 6160 6020 6973 2060  he ``data`` is `
+00018cd0: 6064 6174 6574 696d 6560 602e 0a0a 2020  `datetime``...  
+00018ce0: 2020 2020 2020 5468 6973 206d 6574 686f        This metho
+00018cf0: 6420 7368 6f75 6c64 2064 6574 6563 7420  d should detect 
+00018d00: 7768 6574 6865 7220 6f72 206e 6f74 2074  whether or not t
+00018d10: 6865 2064 6174 6120 6973 2060 6064 6174  he data is ``dat
+00018d20: 6574 696d 6560 6020 616e 6420 6966 2069  etime`` and if i
+00018d30: 6e20 6361 7365 2073 6f6d 6520 6973 0a20  n case some is. 
+00018d40: 2020 2020 2020 2062 7574 206f 7468 6572         but other
+00018d50: 2069 7320 6e6f 742c 2072 6169 7365 7320   is not, raises 
+00018d60: 616e 2065 7272 6f72 2e0a 0a20 2020 2020  an error...     
+00018d70: 2020 2053 6574 7570 3a0a 2020 2020 2020     Setup:.      
+00018d80: 2020 2020 2020 2d20 4372 6561 7465 2061        - Create a
+00018d90: 2070 642e 4461 7461 4672 616d 6520 7769   pd.DataFrame wi
+00018da0: 7468 2074 6872 6565 2063 6f6c 756d 6e73  th three columns
+00018db0: 2074 6861 7420 6172 6520 6461 7465 7469   that are dateti
+00018dc0: 6d65 2064 6174 612e 0a20 2020 2020 2020  me data..       
+00018dd0: 2020 2020 202d 2049 6e73 7461 6e63 6520       - Instance 
+00018de0: 6f66 2060 6052 616e 6765 6060 2063 6f6e  of ``Range`` con
+00018df0: 7374 7261 696e 7420 7769 7468 2074 686f  straint with tho
+00018e00: 7365 2074 6872 6565 2063 6f6c 756d 6e20  se three column 
+00018e10: 6e61 6d65 732e 0a0a 2020 2020 2020 2020  names...        
+00018e20: 496e 7075 743a 0a20 2020 2020 2020 2020  Input:.         
+00018e30: 2020 202d 2070 642e 4461 7461 4672 616d     - pd.DataFram
+00018e40: 6520 7769 7468 2060 606a 6f69 6e5f 6461  e with ``join_da
+00018e50: 7465 6060 2c20 6060 7072 6f6d 6f74 696f  te``, ``promotio
+00018e60: 6e5f 6461 7465 6060 2c20 6060 7265 7469  n_date``, ``reti
+00018e70: 7265 6d65 6e74 5f64 6174 6560 6020 636f  rement_date`` co
+00018e80: 6c75 6d6e 732e 0a0a 2020 2020 2020 2020  lumns...        
+00018e90: 4f75 7470 7574 3a0a 2020 2020 2020 2020  Output:.        
+00018ea0: 2020 2020 2d20 5468 6520 6f75 7470 7574      - The output
+00018eb0: 2073 686f 756c 6420 6265 2054 7275 652e   should be True.
+00018ec0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00018ed0: 2020 2020 2023 2053 6574 7570 0a20 2020       # Setup.   
+00018ee0: 2020 2020 2074 6162 6c65 5f64 6174 6120       table_data 
+00018ef0: 3d20 7064 2e44 6174 6146 7261 6d65 287b  = pd.DataFrame({
+00018f00: 0a20 2020 2020 2020 2020 2020 2027 6a6f  .            'jo
+00018f10: 696e 5f64 6174 6527 3a20 7064 2e74 6f5f  in_date': pd.to_
+00018f20: 6461 7465 7469 6d65 285b 2732 3032 312d  datetime(['2021-
+00018f30: 3032 2d31 3027 2c20 2732 3032 312d 3035  02-10', '2021-05
+00018f40: 2d31 3027 2c20 2732 3032 312d 3038 2d31  -10', '2021-08-1
+00018f50: 3127 5d29 2c0a 2020 2020 2020 2020 2020  1']),.          
+00018f60: 2020 2770 726f 6d6f 7469 6f6e 5f64 6174    'promotion_dat
+00018f70: 6527 3a20 7064 2e74 6f5f 6461 7465 7469  e': pd.to_dateti
+00018f80: 6d65 285b 2732 3032 322d 3035 2d31 3027  me(['2022-05-10'
+00018f90: 2c20 2732 3032 322d 3036 2d31 3027 2c20  , '2022-06-10', 
+00018fa0: 2732 3032 322d 3131 2d31 3727 5d29 2c0a  '2022-11-17']),.
+00018fb0: 2020 2020 2020 2020 2020 2020 2772 6574              'ret
+00018fc0: 6972 656d 656e 745f 6461 7465 273a 2070  irement_date': p
+00018fd0: 642e 746f 5f64 6174 6574 696d 6528 5b27  d.to_datetime(['
+00018fe0: 3230 3530 2d31 302d 3131 272c 2027 3230  2050-10-11', '20
+00018ff0: 3538 2d31 302d 3034 272c 2027 3230 3735  58-10-04', '2075
+00019000: 2d31 312d 3134 275d 290a 2020 2020 2020  -11-14']).      
+00019010: 2020 7d29 0a20 2020 2020 2020 2069 6e73    }).        ins
+00019020: 7461 6e63 6520 3d20 5261 6e67 6528 276a  tance = Range('j
+00019030: 6f69 6e5f 6461 7465 272c 2027 7072 6f6d  oin_date', 'prom
+00019040: 6f74 696f 6e5f 6461 7465 272c 2027 7265  otion_date', 're
+00019050: 7469 7265 6d65 6e74 5f64 6174 6527 290a  tirement_date').
+00019060: 0a20 2020 2020 2020 2023 2052 756e 0a20  .        # Run. 
+00019070: 2020 2020 2020 2069 735f 6461 7465 7469         is_dateti
+00019080: 6d65 203d 2069 6e73 7461 6e63 652e 5f67  me = instance._g
+00019090: 6574 5f69 735f 6461 7465 7469 6d65 2874  et_is_datetime(t
+000190a0: 6162 6c65 5f64 6174 6129 0a0a 2020 2020  able_data)..    
+000190b0: 2020 2020 2320 4173 7365 7274 0a20 2020      # Assert.   
+000190c0: 2020 2020 2061 7373 6572 7420 6973 5f64       assert is_d
+000190d0: 6174 6574 696d 650a 0a20 2020 2064 6566  atetime..    def
+000190e0: 2074 6573 745f 5f67 6574 5f69 735f 6461   test__get_is_da
+000190f0: 7465 7469 6d65 5f6e 6f5f 6461 7465 7469  tetime_no_dateti
+00019100: 6d65 7328 7365 6c66 293a 0a20 2020 2020  mes(self):.     
+00019110: 2020 2022 2222 5465 7374 2074 6861 7420     """Test that 
+00019120: 7468 6520 6d65 7468 6f64 2064 6574 6563  the method detec
+00019130: 7473 2077 6865 7468 6572 206f 7220 6e6f  ts whether or no
+00019140: 7420 7468 6520 6060 6461 7461 6060 2069  t the ``data`` i
+00019150: 7320 6060 6461 7465 7469 6d65 6060 2e0a  s ``datetime``..
+00019160: 0a20 2020 2020 2020 2054 6869 7320 6d65  .        This me
+00019170: 7468 6f64 2073 686f 756c 6420 6465 7465  thod should dete
+00019180: 6374 2077 6865 7468 6572 206f 7220 6e6f  ct whether or no
+00019190: 7420 7468 6520 6461 7461 2069 7320 6060  t the data is ``
+000191a0: 6461 7465 7469 6d65 6060 2061 6e64 2069  datetime`` and i
+000191b0: 6620 696e 2063 6173 6520 736f 6d65 2069  f in case some i
+000191c0: 730a 2020 2020 2020 2020 6275 7420 6f74  s.        but ot
+000191d0: 6865 7220 6973 206e 6f74 2c20 7261 6973  her is not, rais
+000191e0: 6573 2061 6e20 6572 726f 722e 0a0a 2020  es an error...  
+000191f0: 2020 2020 2020 5365 7475 703a 0a20 2020        Setup:.   
+00019200: 2020 2020 2020 2020 202d 2043 7265 6174           - Creat
+00019210: 6520 6120 7064 2e44 6174 6146 7261 6d65  e a pd.DataFrame
+00019220: 2077 6974 6820 7468 7265 6520 636f 6c75   with three colu
+00019230: 6d6e 7320 7468 6174 2064 6f20 6e6f 7420  mns that do not 
+00019240: 636f 6e74 6169 6e20 6461 7465 7469 6d65  contain datetime
+00019250: 2064 6174 612e 0a20 2020 2020 2020 2020   data..         
+00019260: 2020 202d 2049 6e73 7461 6e63 6520 6f66     - Instance of
+00019270: 2060 6052 616e 6765 6060 2063 6f6e 7374   ``Range`` const
+00019280: 7261 696e 7420 7769 7468 2074 686f 7365  raint with those
+00019290: 2074 6872 6565 2063 6f6c 756d 6e20 6e61   three column na
+000192a0: 6d65 732e 0a0a 2020 2020 2020 2020 496e  mes...        In
+000192b0: 7075 743a 0a20 2020 2020 2020 2020 2020  put:.           
+000192c0: 202d 2070 642e 4461 7461 4672 616d 6520   - pd.DataFrame 
+000192d0: 7769 7468 2060 6061 6765 5f77 6865 6e5f  with ``age_when_
+000192e0: 6a6f 696e 6564 6060 2c20 6060 6375 7272  joined``, ``curr
+000192f0: 656e 745f 6167 6560 602c 2060 6072 6574  ent_age``, ``ret
+00019300: 6972 656d 656e 745f 6167 6560 6020 636f  irement_age`` co
+00019310: 6c75 6d6e 732e 0a0a 2020 2020 2020 2020  lumns...        
+00019320: 4f75 7470 7574 3a0a 2020 2020 2020 2020  Output:.        
+00019330: 2020 2020 2d20 5468 6520 6f75 7470 7574      - The output
+00019340: 2073 686f 756c 6420 6265 2066 616c 7365   should be false
+00019350: 2073 696e 6365 2061 6c6c 2074 6865 2064   since all the d
+00019360: 6174 6120 6973 2060 6069 6e74 6060 2e0a  ata is ``int``..
+00019370: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00019380: 2020 2020 2320 5365 7475 700a 2020 2020      # Setup.    
+00019390: 2020 2020 7461 626c 655f 6461 7461 203d      table_data =
+000193a0: 2070 642e 4461 7461 4672 616d 6528 7b0a   pd.DataFrame({.
+000193b0: 2020 2020 2020 2020 2020 2020 2761 6765              'age
+000193c0: 5f77 6865 6e5f 6a6f 696e 6564 273a 205b  _when_joined': [
+000193d0: 3138 2c20 3139 2c20 3230 5d2c 0a20 2020  18, 19, 20],.   
+000193e0: 2020 2020 2020 2020 2027 6375 7272 656e           'curren
+000193f0: 745f 6167 6527 3a20 5b32 312c 2032 322c  t_age': [21, 22,
+00019400: 2032 355d 2c0a 2020 2020 2020 2020 2020   25],.          
+00019410: 2020 2772 6574 6972 656d 656e 745f 6167    'retirement_ag
+00019420: 6527 3a20 5b36 352c 2036 382c 2037 355d  e': [65, 68, 75]
+00019430: 0a20 2020 2020 2020 207d 290a 2020 2020  .        }).    
+00019440: 2020 2020 696e 7374 616e 6365 203d 2052      instance = R
+00019450: 616e 6765 2827 6167 655f 7768 656e 5f6a  ange('age_when_j
+00019460: 6f69 6e65 6427 2c20 2763 7572 7265 6e74  oined', 'current
+00019470: 5f61 6765 272c 2027 7265 7469 7265 6d65  _age', 'retireme
+00019480: 6e74 5f61 6765 2729 0a0a 2020 2020 2020  nt_age')..      
+00019490: 2020 2320 5275 6e0a 2020 2020 2020 2020    # Run.        
+000194a0: 6973 5f64 6174 6574 696d 6520 3d20 696e  is_datetime = in
+000194b0: 7374 616e 6365 2e5f 6765 745f 6973 5f64  stance._get_is_d
+000194c0: 6174 6574 696d 6528 7461 626c 655f 6461  atetime(table_da
+000194d0: 7461 290a 0a20 2020 2020 2020 2023 2041  ta)..        # A
+000194e0: 7373 6572 740a 2020 2020 2020 2020 6173  ssert.        as
+000194f0: 7365 7274 206e 6f74 2069 735f 6461 7465  sert not is_date
+00019500: 7469 6d65 0a0a 2020 2020 6465 6620 7465  time..    def te
+00019510: 7374 5f5f 6765 745f 6973 5f64 6174 6574  st__get_is_datet
+00019520: 696d 655f 7261 6973 6573 5f61 6e5f 6572  ime_raises_an_er
+00019530: 726f 7228 7365 6c66 293a 0a20 2020 2020  ror(self):.     
+00019540: 2020 2022 2222 5465 7374 2074 6861 7420     """Test that 
+00019550: 7468 6520 6d65 7468 6f64 2064 6574 6563  the method detec
+00019560: 7473 2077 6865 7468 6572 206f 7220 6e6f  ts whether or no
+00019570: 7420 7468 6520 6060 6461 7461 6060 2069  t the ``data`` i
+00019580: 7320 6060 6461 7465 7469 6d65 6060 2e0a  s ``datetime``..
+00019590: 0a20 2020 2020 2020 2054 6869 7320 6d65  .        This me
+000195a0: 7468 6f64 2073 686f 756c 6420 6465 7465  thod should dete
+000195b0: 6374 2077 6865 7468 6572 206f 7220 6e6f  ct whether or no
+000195c0: 7420 7468 6520 6461 7461 2069 7320 6060  t the data is ``
+000195d0: 6461 7465 7469 6d65 6060 2061 6e64 2069  datetime`` and i
+000195e0: 6620 696e 2063 6173 6520 736f 6d65 2069  f in case some i
+000195f0: 730a 2020 2020 2020 2020 6275 7420 6f74  s.        but ot
+00019600: 6865 7220 6973 206e 6f74 2c20 7261 6973  her is not, rais
+00019610: 6573 2061 6e20 6572 726f 722e 0a0a 2020  es an error...  
+00019620: 2020 2020 2020 5365 7475 703a 0a20 2020        Setup:.   
+00019630: 2020 2020 2020 2020 202d 2043 7265 6174           - Creat
+00019640: 6520 6120 7064 2e44 6174 6146 7261 6d65  e a pd.DataFrame
+00019650: 2077 6974 6820 7468 7265 6520 636f 6c75   with three colu
+00019660: 6d6e 7320 7468 6174 2063 6f6e 7461 696e  mns that contain
+00019670: 2062 6f74 6820 6461 7465 7469 6d65 2061   both datetime a
+00019680: 6e64 206e 6f6e 0a20 2020 2020 2020 2020  nd non.         
+00019690: 2020 2020 2064 6174 6574 696d 6520 6461       datetime da
+000196a0: 7461 2e0a 2020 2020 2020 2020 2020 2020  ta..            
+000196b0: 2d20 496e 7374 616e 6365 206f 6620 6060  - Instance of ``
+000196c0: 5261 6e67 6560 6020 636f 6e73 7472 6169  Range`` constrai
+000196d0: 6e74 2077 6974 6820 7468 6f73 6520 7468  nt with those th
+000196e0: 7265 6520 636f 6c75 6d6e 206e 616d 6573  ree column names
+000196f0: 2e0a 0a20 2020 2020 2020 2049 6e70 7574  ...        Input
+00019700: 3a0a 2020 2020 2020 2020 2020 2020 2d20  :.            - 
+00019710: 7064 2e44 6174 6146 7261 6d65 2077 6974  pd.DataFrame wit
+00019720: 6820 6060 6a6f 696e 5f64 6174 6560 602c  h ``join_date``,
+00019730: 2060 6070 726f 6d6f 7469 6f6e 5f64 6174   ``promotion_dat
+00019740: 6560 602c 2060 6063 7572 7265 6e74 5f61  e``, ``current_a
+00019750: 6765 6060 2063 6f6c 756d 6e73 2e0a 0a20  ge`` columns... 
+00019760: 2020 2020 2020 2053 6964 6520 4566 6665         Side Effe
+00019770: 6374 3a0a 2020 2020 2020 2020 2020 2020  ct:.            
+00019780: 2d20 5661 6c75 6520 6572 726f 7220 7769  - Value error wi
+00019790: 7468 2074 6865 2065 7870 6563 7465 6420  th the expected 
+000197a0: 6d65 7373 6167 6520 7368 6f75 6c64 2062  message should b
+000197b0: 6520 7261 6973 6564 2e0a 2020 2020 2020  e raised..      
+000197c0: 2020 2222 220a 2020 2020 2020 2020 2320    """.        # 
+000197d0: 5365 7475 700a 2020 2020 2020 2020 7461  Setup.        ta
+000197e0: 626c 655f 6461 7461 203d 2070 642e 4461  ble_data = pd.Da
+000197f0: 7461 4672 616d 6528 7b0a 2020 2020 2020  taFrame({.      
+00019800: 2020 2020 2020 276a 6f69 6e5f 6461 7465        'join_date
+00019810: 273a 2070 642e 746f 5f64 6174 6574 696d  ': pd.to_datetim
+00019820: 6528 5b27 3230 3231 2d30 322d 3130 272c  e(['2021-02-10',
+00019830: 2027 3230 3231 2d30 352d 3130 272c 2027   '2021-05-10', '
+00019840: 3230 3231 2d30 382d 3131 275d 292c 0a20  2021-08-11']),. 
+00019850: 2020 2020 2020 2020 2020 2027 7072 6f6d             'prom
+00019860: 6f74 696f 6e5f 6461 7465 273a 2070 642e  otion_date': pd.
+00019870: 746f 5f64 6174 6574 696d 6528 5b27 3230  to_datetime(['20
+00019880: 3232 2d30 352d 3130 272c 2027 3230 3232  22-05-10', '2022
+00019890: 2d30 362d 3130 272c 2027 3230 3232 2d31  -06-10', '2022-1
+000198a0: 312d 3137 275d 292c 0a20 2020 2020 2020  1-17']),.       
+000198b0: 2020 2020 2027 6375 7272 656e 745f 6167       'current_ag
+000198c0: 6527 3a20 5b32 312c 2032 322c 2032 355d  e': [21, 22, 25]
+000198d0: 2c0a 2020 2020 2020 2020 7d29 0a20 2020  ,.        }).   
+000198e0: 2020 2020 2069 6e73 7461 6e63 6520 3d20       instance = 
+000198f0: 5261 6e67 6528 276a 6f69 6e5f 6461 7465  Range('join_date
+00019900: 272c 2027 7072 6f6d 6f74 696f 6e5f 6461  ', 'promotion_da
+00019910: 7465 272c 2027 6375 7272 656e 745f 6167  te', 'current_ag
+00019920: 6527 290a 2020 2020 2020 2020 6578 7065  e').        expe
+00019930: 6374 6564 5f74 6578 7420 3d20 2754 6865  cted_text = 'The
+00019940: 2063 6f6e 7374 7261 696e 7420 636f 6c75   constraint colu
+00019950: 6d6e 2061 6e64 2062 6f75 6e64 7320 6d75  mn and bounds mu
+00019960: 7374 2061 6c6c 2062 6520 6461 7465 7469  st all be dateti
+00019970: 6d65 2e27 0a0a 2020 2020 2020 2020 2320  me.'..        # 
+00019980: 5275 6e0a 2020 2020 2020 2020 7769 7468  Run.        with
+00019990: 2070 7974 6573 742e 7261 6973 6573 2856   pytest.raises(V
+000199a0: 616c 7565 4572 726f 722c 206d 6174 6368  alueError, match
+000199b0: 3d65 7870 6563 7465 645f 7465 7874 293a  =expected_text):
+000199c0: 0a20 2020 2020 2020 2020 2020 2069 6e73  .            ins
+000199d0: 7461 6e63 652e 5f67 6574 5f69 735f 6461  tance._get_is_da
+000199e0: 7465 7469 6d65 2874 6162 6c65 5f64 6174  tetime(table_dat
+000199f0: 6129 0a0a 2020 2020 6465 6620 7465 7374  a)..    def test
+00019a00: 5f5f 6669 7428 7365 6c66 293a 0a20 2020  __fit(self):.   
+00019a10: 2020 2020 2022 2222 5465 7374 2074 6865       """Test the
+00019a20: 2060 605f 6669 7460 6020 6d65 7468 6f64   ``_fit`` method
+00019a30: 206f 6620 6060 5261 6e67 6560 602e 0a0a   of ``Range``...
+00019a40: 2020 2020 2020 2020 5465 7374 2074 6861          Test tha
+00019a50: 7420 7468 6520 6060 5f66 6974 6060 206d  t the ``_fit`` m
+00019a60: 6574 686f 6420 7374 6f72 6573 2074 6865  ethod stores the
+00019a70: 2070 726f 7065 7220 7472 616e 7366 6f72   proper transfor
+00019a80: 6d61 7469 6f6e 2063 6f6c 756d 6e20 6e61  mation column na
+00019a90: 6d65 2061 6e64 0a20 2020 2020 2020 206c  me and.        l
+00019aa0: 6561 726e 7320 7768 6574 6865 7220 7468  earns whether th
+00019ab0: 6520 6461 7461 2069 7320 6060 6461 7465  e data is ``date
+00019ac0: 7469 6d65 6060 6f72 206e 6f74 2061 6e64  time``or not and
+00019ad0: 2069 7427 7320 6060 6474 7970 6560 602e   it's ``dtype``.
+00019ae0: 0a0a 2020 2020 2020 2020 5365 7475 703a  ..        Setup:
+00019af0: 0a20 2020 2020 2020 2020 2020 202d 2043  .            - C
+00019b00: 7265 6174 6520 6120 7064 2e44 6174 6146  reate a pd.DataF
+00019b10: 7261 6d65 2077 6974 6820 7468 7265 6520  rame with three 
+00019b20: 636f 6c75 6d6e 732e 0a20 2020 2020 2020  columns..       
+00019b30: 2020 2020 202d 2049 6e73 7461 6e63 6520       - Instance 
+00019b40: 6f66 2060 6052 616e 6765 6060 2063 6f6e  of ``Range`` con
+00019b50: 7374 7261 696e 7420 7769 7468 2074 686f  straint with tho
+00019b60: 7365 2074 6872 6565 2063 6f6c 756d 6e20  se three column 
+00019b70: 6e61 6d65 732e 0a0a 2020 2020 2020 2020  names...        
+00019b80: 496e 7075 743a 0a20 2020 2020 2020 2020  Input:.         
+00019b90: 2020 202d 2070 642e 4461 7461 4672 616d     - pd.DataFram
+00019ba0: 6520 7769 7468 2060 606a 6f69 6e5f 6461  e with ``join_da
+00019bb0: 7465 6060 2c20 6060 7072 6f6d 6f74 696f  te``, ``promotio
+00019bc0: 6e5f 6461 7465 6060 2c20 6060 6375 7272  n_date``, ``curr
+00019bd0: 656e 745f 6167 6560 6020 636f 6c75 6d6e  ent_age`` column
+00019be0: 732e 0a0a 2020 2020 2020 2020 5369 6465  s...        Side
+00019bf0: 2045 6666 6563 743a 0a20 2020 2020 2020   Effect:.       
+00019c00: 2020 2020 202d 2069 6e73 7461 6e63 6520       - instance 
+00019c10: 6861 7320 6060 5f74 7261 6e73 666f 726d  has ``_transform
+00019c20: 6564 5f63 6f6c 756d 6e60 6020 616e 6420  ed_column`` and 
+00019c30: 6060 5f69 735f 6461 7465 7469 6d65 6060  ``_is_datetime``
+00019c40: 2061 6e64 2060 605f 6474 7970 6560 602e   and ``_dtype``.
+00019c50: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00019c60: 2020 2020 2023 2053 6574 7570 0a20 2020       # Setup.   
+00019c70: 2020 2020 2074 6162 6c65 5f64 6174 6120       table_data 
+00019c80: 3d20 7064 2e44 6174 6146 7261 6d65 287b  = pd.DataFrame({
+00019c90: 0a20 2020 2020 2020 2020 2020 2027 6167  .            'ag
+00019ca0: 655f 7768 656e 5f6a 6f69 6e65 6427 3a20  e_when_joined': 
+00019cb0: 5b31 382c 2031 392c 2032 305d 2c0a 2020  [18, 19, 20],.  
+00019cc0: 2020 2020 2020 2020 2020 2763 7572 7265            'curre
+00019cd0: 6e74 5f61 6765 273a 205b 3231 2c20 3232  nt_age': [21, 22
+00019ce0: 2c20 3235 5d2c 0a20 2020 2020 2020 2020  , 25],.         
+00019cf0: 2020 2027 7265 7469 7265 6d65 6e74 5f61     'retirement_a
+00019d00: 6765 273a 205b 3635 2c20 3638 2c20 3735  ge': [65, 68, 75
+00019d10: 5d2c 0a20 2020 2020 2020 2020 2020 2027  ],.            '
+00019d20: 6375 7272 656e 745f 6167 6523 6167 655f  current_age#age_
+00019d30: 7768 656e 5f6a 6f69 6e65 6423 7265 7469  when_joined#reti
+00019d40: 7265 6d65 6e74 5f61 6765 273a 205b 312c  rement_age': [1,
+00019d50: 2032 2c20 335d 0a20 2020 2020 2020 207d   2, 3].        }
+00019d60: 2c20 6474 7970 653d 6e70 2e69 6e74 3634  , dtype=np.int64
+00019d70: 290a 2020 2020 2020 2020 696e 7374 616e  ).        instan
+00019d80: 6365 203d 2052 616e 6765 2827 6167 655f  ce = Range('age_
+00019d90: 7768 656e 5f6a 6f69 6e65 6427 2c20 2763  when_joined', 'c
+00019da0: 7572 7265 6e74 5f61 6765 272c 2027 7265  urrent_age', 're
+00019db0: 7469 7265 6d65 6e74 5f61 6765 2729 0a0a  tirement_age')..
+00019dc0: 2020 2020 2020 2020 2320 5275 6e0a 2020          # Run.  
+00019dd0: 2020 2020 2020 696e 7374 616e 6365 2e5f        instance._
+00019de0: 6669 7428 7461 626c 655f 6461 7461 290a  fit(table_data).
+00019df0: 0a20 2020 2020 2020 2023 2041 7373 6572  .        # Asser
+00019e00: 740a 2020 2020 2020 2020 6173 7365 7274  t.        assert
+00019e10: 2069 6e73 7461 6e63 652e 5f64 7479 7065   instance._dtype
+00019e20: 203d 3d20 6e70 2e69 6e74 3634 0a20 2020   == np.int64.   
+00019e30: 2020 2020 2061 7373 6572 7420 6e6f 7420       assert not 
+00019e40: 696e 7374 616e 6365 2e5f 6973 5f64 6174  instance._is_dat
+00019e50: 6574 696d 650a 0a20 2020 2064 6566 2074  etime..    def t
+00019e60: 6573 745f 6973 5f76 616c 6964 5f6c 7428  est_is_valid_lt(
+00019e70: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
+00019e80: 2222 5465 7374 2074 6865 2060 6052 616e  ""Test the ``Ran
+00019e90: 6765 2e69 735f 7661 6c69 6460 602e 0a0a  ge.is_valid``...
+00019ea0: 2020 2020 2020 2020 5468 6973 2074 6573          This tes
+00019eb0: 7420 656e 7375 7265 7320 7468 6174 2074  t ensures that t
+00019ec0: 6865 2060 6069 735f 7661 6c69 6460 6020  he ``is_valid`` 
+00019ed0: 6d65 7468 6f64 2077 6f72 6b73 2077 6974  method works wit
+00019ee0: 6820 7468 6520 6f70 6572 6174 6f72 2060  h the operator `
+00019ef0: 603c 6060 0a20 2020 2020 2020 2028 6060  `<``.        (``
+00019f00: 3c60 6029 2061 6e64 2076 616c 6964 6174  <``) and validat
+00019f10: 6573 2074 6861 7420 7468 6520 6060 6d69  es that the ``mi
+00019f20: 6464 6c65 5f63 6f6c 756d 6e5f 6e61 6d65  ddle_column_name
+00019f30: 6060 2069 7320 6265 7477 6565 6e20 6060  `` is between ``
+00019f40: 6c6f 775f 636f 6c75 6d6e 5f6e 616d 6560  low_column_name`
+00019f50: 6020 616e 640a 2020 2020 2020 2020 6060  ` and.        ``
+00019f60: 6869 6768 5f63 6f6c 756d 6e5f 6e61 6d65  high_column_name
+00019f70: 6060 2e0a 0a20 2020 2020 2020 2053 6574  ``...        Set
+00019f80: 7570 3a0a 2020 2020 2020 2020 2020 2020  up:.            
+00019f90: 2d20 4372 6561 7465 2061 2070 642e 4461  - Create a pd.Da
+00019fa0: 7461 4672 616d 6520 7769 7468 2074 6872  taFrame with thr
+00019fb0: 6565 2063 6f6c 756d 6e73 2e0a 2020 2020  ee columns..    
+00019fc0: 2020 2020 2020 2020 2d20 496e 7374 616e          - Instan
+00019fd0: 6365 206f 6620 6060 5261 6e67 6560 6020  ce of ``Range`` 
+00019fe0: 636f 6e73 7472 6169 6e74 2077 6974 6820  constraint with 
+00019ff0: 7468 6f73 6520 7468 7265 6520 636f 6c75  those three colu
+0001a000: 6d6e 206e 616d 6573 2e0a 0a20 2020 2020  mn names...     
+0001a010: 2020 2049 6e70 7574 3a0a 2020 2020 2020     Input:.      
+0001a020: 2020 2020 2020 2d20 7064 2e44 6174 6146        - pd.DataF
+0001a030: 7261 6d65 2077 6974 6820 6060 6167 655f  rame with ``age_
+0001a040: 7768 656e 5f6a 6f69 6e65 6460 602c 2060  when_joined``, `
+0001a050: 6063 7572 7265 6e74 5f61 6765 6060 2c20  `current_age``, 
+0001a060: 6060 7265 7469 7265 6d65 6e74 5f61 6765  ``retirement_age
+0001a070: 6060 2063 6f6c 756d 6e73 2e0a 2020 2020  `` columns..    
+0001a080: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0001a090: 2320 5365 7475 700a 2020 2020 2020 2020  # Setup.        
+0001a0a0: 7461 626c 655f 6461 7461 203d 2070 642e  table_data = pd.
+0001a0b0: 4461 7461 4672 616d 6528 7b0a 2020 2020  DataFrame({.    
+0001a0c0: 2020 2020 2020 2020 2761 6765 5f77 6865          'age_whe
+0001a0d0: 6e5f 6a6f 696e 6564 273a 205b 3138 2c20  n_joined': [18, 
+0001a0e0: 3139 2c20 3230 5d2c 0a20 2020 2020 2020  19, 20],.       
+0001a0f0: 2020 2020 2027 6375 7272 656e 745f 6167       'current_ag
+0001a100: 6527 3a20 5b32 312c 2032 322c 2032 355d  e': [21, 22, 25]
+0001a110: 2c0a 2020 2020 2020 2020 2020 2020 2772  ,.            'r
+0001a120: 6574 6972 656d 656e 745f 6167 6527 3a20  etirement_age': 
+0001a130: 5b36 352c 2036 382c 2037 355d 0a20 2020  [65, 68, 75].   
+0001a140: 2020 2020 207d 290a 2020 2020 2020 2020       }).        
+0001a150: 696e 7374 616e 6365 203d 2052 616e 6765  instance = Range
+0001a160: 2827 6167 655f 7768 656e 5f6a 6f69 6e65  ('age_when_joine
+0001a170: 6427 2c20 2763 7572 7265 6e74 5f61 6765  d', 'current_age
+0001a180: 272c 2027 7265 7469 7265 6d65 6e74 5f61  ', 'retirement_a
+0001a190: 6765 2729 0a0a 2020 2020 2020 2020 2320  ge')..        # 
+0001a1a0: 5275 6e0a 2020 2020 2020 2020 7265 7375  Run.        resu
+0001a1b0: 6c74 203d 2069 6e73 7461 6e63 652e 6973  lt = instance.is
+0001a1c0: 5f76 616c 6964 2874 6162 6c65 5f64 6174  _valid(table_dat
+0001a1d0: 6129 0a0a 2020 2020 2020 2020 2320 4173  a)..        # As
+0001a1e0: 7365 7274 0a20 2020 2020 2020 2061 7373  sert.        ass
+0001a1f0: 6572 7420 616c 6c28 7265 7375 6c74 290a  ert all(result).
+0001a200: 0a20 2020 2064 6566 2074 6573 745f 6973  .    def test_is
+0001a210: 5f76 616c 6964 5f6c 6528 7365 6c66 293a  _valid_le(self):
+0001a220: 0a20 2020 2020 2020 2022 2222 5465 7374  .        """Test
+0001a230: 2074 6865 2060 6052 616e 6765 2e69 735f   the ``Range.is_
+0001a240: 7661 6c69 6460 602e 0a0a 2020 2020 2020  valid``...      
+0001a250: 2020 5468 6973 2074 6573 7420 656e 7375    This test ensu
+0001a260: 7265 7320 7468 6174 2074 6865 2060 6069  res that the ``i
+0001a270: 735f 7661 6c69 6460 6020 6d65 7468 6f64  s_valid`` method
+0001a280: 2077 6f72 6b73 2077 6974 6820 7468 6520   works with the 
+0001a290: 6f70 6572 6174 6f72 0a20 2020 2020 2020  operator.       
+0001a2a0: 2060 603c 3d60 6020 616e 6420 7661 6c69   ``<=`` and vali
+0001a2b0: 6461 7465 7320 7468 6174 2074 6865 2060  dates that the `
+0001a2c0: 606d 6964 646c 655f 636f 6c75 6d6e 5f6e  `middle_column_n
+0001a2d0: 616d 6560 6020 6973 0a20 2020 2020 2020  ame`` is.       
+0001a2e0: 2062 6574 7765 656e 2060 606c 6f77 5f63   between ``low_c
+0001a2f0: 6f6c 756d 6e5f 6e61 6d65 6060 2061 6e64  olumn_name`` and
+0001a300: 2060 6068 6967 685f 636f 6c75 6d6e 5f6e   ``high_column_n
+0001a310: 616d 6560 602e 0a0a 2020 2020 2020 2020  ame``...        
+0001a320: 5365 7475 703a 0a20 2020 2020 2020 2020  Setup:.         
+0001a330: 2020 202d 2043 7265 6174 6520 6120 7064     - Create a pd
+0001a340: 2e44 6174 6146 7261 6d65 2077 6974 6820  .DataFrame with 
+0001a350: 7468 7265 6520 636f 6c75 6d6e 732e 0a20  three columns.. 
+0001a360: 2020 2020 2020 2020 2020 202d 2049 6e73             - Ins
+0001a370: 7461 6e63 6520 6f66 2060 6052 616e 6765  tance of ``Range
+0001a380: 6060 2063 6f6e 7374 7261 696e 7420 7769  `` constraint wi
+0001a390: 7468 2074 686f 7365 2074 6872 6565 2063  th those three c
+0001a3a0: 6f6c 756d 6e20 6e61 6d65 732e 0a0a 2020  olumn names...  
+0001a3b0: 2020 2020 2020 496e 7075 743a 0a20 2020        Input:.   
+0001a3c0: 2020 2020 2020 2020 202d 2070 642e 4461           - pd.Da
+0001a3d0: 7461 4672 616d 6520 7769 7468 2060 6061  taFrame with ``a
+0001a3e0: 6765 5f77 6865 6e5f 6a6f 696e 6564 6060  ge_when_joined``
+0001a3f0: 2c20 6060 6375 7272 656e 745f 6167 6560  , ``current_age`
+0001a400: 602c 2060 6072 6574 6972 656d 656e 745f  `, ``retirement_
+0001a410: 6167 6560 6020 636f 6c75 6d6e 732e 0a20  age`` columns.. 
+0001a420: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0001a430: 2020 2023 2053 6574 7570 0a20 2020 2020     # Setup.     
+0001a440: 2020 2074 6162 6c65 5f64 6174 6120 3d20     table_data = 
+0001a450: 7064 2e44 6174 6146 7261 6d65 287b 0a20  pd.DataFrame({. 
+0001a460: 2020 2020 2020 2020 2020 2027 6167 655f             'age_
+0001a470: 7768 656e 5f6a 6f69 6e65 6427 3a20 5b32  when_joined': [2
+0001a480: 312c 2031 392c 2032 305d 2c0a 2020 2020  1, 19, 20],.    
+0001a490: 2020 2020 2020 2020 2763 7572 7265 6e74          'current
+0001a4a0: 5f61 6765 273a 205b 3231 2c20 3232 2c20  _age': [21, 22, 
+0001a4b0: 3235 5d2c 0a20 2020 2020 2020 2020 2020  25],.           
+0001a4c0: 2027 7265 7469 7265 6d65 6e74 5f61 6765   'retirement_age
+0001a4d0: 273a 205b 3635 2c20 3638 2c20 3735 5d0a  ': [65, 68, 75].
+0001a4e0: 2020 2020 2020 2020 7d29 0a20 2020 2020          }).     
+0001a4f0: 2020 2069 6e73 7461 6e63 6520 3d20 5261     instance = Ra
+0001a500: 6e67 6528 0a20 2020 2020 2020 2020 2020  nge(.           
+0001a510: 2027 6167 655f 7768 656e 5f6a 6f69 6e65   'age_when_joine
+0001a520: 6427 2c0a 2020 2020 2020 2020 2020 2020  d',.            
+0001a530: 2763 7572 7265 6e74 5f61 6765 272c 0a20  'current_age',. 
+0001a540: 2020 2020 2020 2020 2020 2027 7265 7469             'reti
+0001a550: 7265 6d65 6e74 5f61 6765 272c 0a20 2020  rement_age',.   
+0001a560: 2020 2020 2020 2020 2073 7472 6963 745f           strict_
+0001a570: 626f 756e 6461 7269 6573 3d46 616c 7365  boundaries=False
+0001a580: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+0001a590: 2020 2020 2320 5275 6e0a 2020 2020 2020      # Run.      
+0001a5a0: 2020 7265 7375 6c74 203d 2069 6e73 7461    result = insta
+0001a5b0: 6e63 652e 6973 5f76 616c 6964 2874 6162  nce.is_valid(tab
+0001a5c0: 6c65 5f64 6174 6129 0a0a 2020 2020 2020  le_data)..      
+0001a5d0: 2020 2320 4173 7365 7274 0a20 2020 2020    # Assert.     
+0001a5e0: 2020 2061 7373 6572 7420 616c 6c28 7265     assert all(re
+0001a5f0: 7375 6c74 290a 0a20 2020 2064 6566 2074  sult)..    def t
+0001a600: 6573 745f 6973 5f76 616c 6964 5f69 6e76  est_is_valid_inv
+0001a610: 616c 6964 2873 656c 6629 3a0a 2020 2020  alid(self):.    
+0001a620: 2020 2020 2222 2254 6573 7420 7468 6520      """Test the 
+0001a630: 6060 5261 6e67 652e 6973 5f76 616c 6964  ``Range.is_valid
+0001a640: 6060 2e0a 0a20 2020 2020 2020 2054 6869  ``...        Thi
+0001a650: 7320 7465 7374 2065 6e73 7572 6573 2074  s test ensures t
+0001a660: 6861 7420 7468 6520 6060 6973 5f76 616c  hat the ``is_val
+0001a670: 6964 6060 2066 6169 6c73 2077 6865 6e20  id`` fails when 
+0001a680: 7468 6520 6461 7461 2069 7320 6e6f 7420  the data is not 
+0001a690: 696e 2074 6865 2072 616e 6765 2e0a 0a20  in the range... 
+0001a6a0: 2020 2020 2020 2053 6574 7570 3a0a 2020         Setup:.  
+0001a6b0: 2020 2020 2020 2020 2020 2d20 4372 6561            - Crea
+0001a6c0: 7465 2061 2070 642e 4461 7461 4672 616d  te a pd.DataFram
+0001a6d0: 6520 7769 7468 2074 6872 6565 2063 6f6c  e with three col
+0001a6e0: 756d 6e73 2e0a 2020 2020 2020 2020 2020  umns..          
+0001a6f0: 2020 2d20 496e 7374 616e 6365 206f 6620    - Instance of 
+0001a700: 6060 5261 6e67 6560 6020 636f 6e73 7472  ``Range`` constr
+0001a710: 6169 6e74 2077 6974 6820 7468 6f73 6520  aint with those 
+0001a720: 7468 7265 6520 636f 6c75 6d6e 206e 616d  three column nam
+0001a730: 6573 2e0a 0a20 2020 2020 2020 2049 6e70  es...        Inp
+0001a740: 7574 3a0a 2020 2020 2020 2020 2020 2020  ut:.            
+0001a750: 2d20 7064 2e44 6174 6146 7261 6d65 2077  - pd.DataFrame w
+0001a760: 6974 6820 6060 6167 655f 7768 656e 5f6a  ith ``age_when_j
+0001a770: 6f69 6e65 6460 602c 2060 6063 7572 7265  oined``, ``curre
+0001a780: 6e74 5f61 6765 6060 2c20 6060 7265 7469  nt_age``, ``reti
+0001a790: 7265 6d65 6e74 5f61 6765 6060 2063 6f6c  rement_age`` col
+0001a7a0: 756d 6e73 2e0a 2020 2020 2020 2020 2222  umns..        ""
+0001a7b0: 220a 2020 2020 2020 2020 2320 5365 7475  ".        # Setu
+0001a7c0: 700a 2020 2020 2020 2020 7461 626c 655f  p.        table_
+0001a7d0: 6461 7461 203d 2070 642e 4461 7461 4672  data = pd.DataFr
+0001a7e0: 616d 6528 7b0a 2020 2020 2020 2020 2020  ame({.          
+0001a7f0: 2020 2761 6765 5f77 6865 6e5f 6a6f 696e    'age_when_join
+0001a800: 6564 273a 205b 3730 2c20 3139 2c20 3230  ed': [70, 19, 20
+0001a810: 5d2c 0a20 2020 2020 2020 2020 2020 2027  ],.            '
+0001a820: 6375 7272 656e 745f 6167 6527 3a20 5b32  current_age': [2
+0001a830: 312c 2032 322c 2032 355d 2c0a 2020 2020  1, 22, 25],.    
+0001a840: 2020 2020 2020 2020 2772 6574 6972 656d          'retirem
+0001a850: 656e 745f 6167 6527 3a20 5b36 352c 2036  ent_age': [65, 6
+0001a860: 382c 2037 355d 0a20 2020 2020 2020 207d  8, 75].        }
+0001a870: 290a 2020 2020 2020 2020 696e 7374 616e  ).        instan
+0001a880: 6365 203d 2052 616e 6765 280a 2020 2020  ce = Range(.    
+0001a890: 2020 2020 2020 2020 2761 6765 5f77 6865          'age_whe
+0001a8a0: 6e5f 6a6f 696e 6564 272c 0a20 2020 2020  n_joined',.     
+0001a8b0: 2020 2020 2020 2027 6375 7272 656e 745f         'current_
+0001a8c0: 6167 6527 2c0a 2020 2020 2020 2020 2020  age',.          
+0001a8d0: 2020 2772 6574 6972 656d 656e 745f 6167    'retirement_ag
+0001a8e0: 6527 2c0a 2020 2020 2020 2020 2020 2020  e',.            
+0001a8f0: 7374 7269 6374 5f62 6f75 6e64 6172 6965  strict_boundarie
+0001a900: 733d 4661 6c73 650a 2020 2020 2020 2020  s=False.        
+0001a910: 290a 0a20 2020 2020 2020 2023 2052 756e  )..        # Run
+0001a920: 0a20 2020 2020 2020 2072 6573 756c 7420  .        result 
+0001a930: 3d20 696e 7374 616e 6365 2e69 735f 7661  = instance.is_va
+0001a940: 6c69 6428 7461 626c 655f 6461 7461 290a  lid(table_data).
+0001a950: 0a20 2020 2020 2020 2023 2041 7373 6572  .        # Asser
+0001a960: 740a 2020 2020 2020 2020 6173 7365 7274  t.        assert
+0001a970: 206e 6f74 2061 6c6c 2872 6573 756c 7429   not all(result)
+0001a980: 0a0a 2020 2020 6465 6620 7465 7374 5f69  ..    def test_i
+0001a990: 735f 7661 6c69 645f 7769 7468 5f6e 616e  s_valid_with_nan
+0001a9a0: 7328 7365 6c66 293a 0a20 2020 2020 2020  s(self):.       
+0001a9b0: 2022 2222 5465 7374 2074 6865 2060 6052   """Test the ``R
+0001a9c0: 616e 6765 2e69 735f 7661 6c69 6460 6020  ange.is_valid`` 
+0001a9d0: 7768 656e 2074 6865 7265 2061 7265 204e  when there are N
+0001a9e0: 614e 7320 696e 2074 6865 2063 6f6c 756d  aNs in the colum
+0001a9f0: 6e73 2e22 2222 0a0a 2020 2020 2020 2020  ns."""..        
+0001aa00: 2320 5365 7475 700a 2020 2020 2020 2020  # Setup.        
+0001aa10: 7461 626c 655f 6461 7461 5f76 616c 6964  table_data_valid
+0001aa20: 203d 2070 642e 4461 7461 4672 616d 6528   = pd.DataFrame(
+0001aa30: 7b0a 2020 2020 2020 2020 2020 2020 276c  {.            'l
+0001aa40: 6f77 273a 205b 312c 206e 702e 6e61 6e2c  ow': [1, np.nan,
+0001aa50: 2033 2c20 342c 206e 702e 6e61 6e2c 2031   3, 4, np.nan, 1
+0001aa60: 5d2c 0a20 2020 2020 2020 2020 2020 2027  ],.            '
+0001aa70: 6d69 6464 6c65 273a 205b 322c 2033 2c20  middle': [2, 3, 
+0001aa80: 6e70 2e6e 616e 2c20 352c 206e 702e 6e61  np.nan, 5, np.na
+0001aa90: 6e2c 206e 702e 6e61 6e5d 2c0a 2020 2020  n, np.nan],.    
+0001aaa0: 2020 2020 2020 2020 2768 6967 6827 3a20          'high': 
+0001aab0: 5b33 2c20 342c 2035 2c20 6e70 2e6e 616e  [3, 4, 5, np.nan
+0001aac0: 2c20 362c 206e 702e 6e61 6e5d 2c0a 2020  , 6, np.nan],.  
+0001aad0: 2020 2020 2020 7d29 0a20 2020 2020 2020        }).       
+0001aae0: 2074 6162 6c65 5f64 6174 615f 696e 7661   table_data_inva
+0001aaf0: 6c69 6420 3d20 7064 2e44 6174 6146 7261  lid = pd.DataFra
+0001ab00: 6d65 287b 0a20 2020 2020 2020 2020 2020  me({.           
+0001ab10: 2027 6c6f 7727 3a20 5b31 2c20 6e70 2e6e   'low': [1, np.n
+0001ab20: 616e 2c20 332c 2034 2c20 6e70 2e6e 616e  an, 3, 4, np.nan
+0001ab30: 2c20 315d 2c0a 2020 2020 2020 2020 2020  , 1],.          
+0001ab40: 2020 276d 6964 646c 6527 3a20 5b32 2c20    'middle': [2, 
+0001ab50: 332c 206e 702e 6e61 6e2c 2035 2c20 6e70  3, np.nan, 5, np
+0001ab60: 2e6e 616e 2c20 6e70 2e6e 616e 5d2c 0a20  .nan, np.nan],. 
+0001ab70: 2020 2020 2020 2020 2020 2027 6869 6768             'high
+0001ab80: 273a 205b 332c 2034 2c20 322c 206e 702e  ': [3, 4, 2, np.
+0001ab90: 6e61 6e2c 2036 2c20 6e70 2e6e 616e 5d2c  nan, 6, np.nan],
+0001aba0: 0a20 2020 2020 2020 207d 290a 0a20 2020  .        })..   
+0001abb0: 2020 2020 2069 6e73 7461 6e63 6520 3d20       instance = 
+0001abc0: 5261 6e67 6528 276c 6f77 272c 2027 6d69  Range('low', 'mi
+0001abd0: 6464 6c65 272c 2027 6869 6768 2729 0a0a  ddle', 'high')..
+0001abe0: 2020 2020 2020 2020 2320 5275 6e0a 2020          # Run.  
+0001abf0: 2020 2020 2020 7265 7375 6c74 5f76 616c        result_val
+0001ac00: 6964 203d 2069 6e73 7461 6e63 652e 6973  id = instance.is
+0001ac10: 5f76 616c 6964 2874 6162 6c65 5f64 6174  _valid(table_dat
+0001ac20: 615f 7661 6c69 6429 0a20 2020 2020 2020  a_valid).       
+0001ac30: 2072 6573 756c 745f 696e 7661 6c69 6420   result_invalid 
+0001ac40: 3d20 696e 7374 616e 6365 2e69 735f 7661  = instance.is_va
+0001ac50: 6c69 6428 7461 626c 655f 6461 7461 5f69  lid(table_data_i
+0001ac60: 6e76 616c 6964 290a 0a20 2020 2020 2020  nvalid)..       
+0001ac70: 2065 7870 6563 7465 645f 7661 6c69 6420   expected_valid 
+0001ac80: 3d20 7064 2e53 6572 6965 7328 5b54 7275  = pd.Series([Tru
+0001ac90: 655d 202a 2036 290a 2020 2020 2020 2020  e] * 6).        
+0001aca0: 6578 7065 6374 6564 5f69 6e76 616c 6964  expected_invalid
+0001acb0: 203d 2070 642e 5365 7269 6573 285b 5472   = pd.Series([Tr
+0001acc0: 7565 2c20 5472 7565 2c20 4661 6c73 652c  ue, True, False,
+0001acd0: 2054 7275 652c 2054 7275 652c 2054 7275   True, True, Tru
+0001ace0: 655d 290a 0a20 2020 2020 2020 2023 2041  e])..        # A
+0001acf0: 7373 6572 740a 2020 2020 2020 2020 7064  ssert.        pd
+0001ad00: 2e74 6573 7469 6e67 2e61 7373 6572 745f  .testing.assert_
+0001ad10: 7365 7269 6573 5f65 7175 616c 2872 6573  series_equal(res
+0001ad20: 756c 745f 7661 6c69 642c 2065 7870 6563  ult_valid, expec
+0001ad30: 7465 645f 7661 6c69 6429 0a20 2020 2020  ted_valid).     
+0001ad40: 2020 2070 642e 7465 7374 696e 672e 6173     pd.testing.as
+0001ad50: 7365 7274 5f73 6572 6965 735f 6571 7561  sert_series_equa
+0001ad60: 6c28 7265 7375 6c74 5f69 6e76 616c 6964  l(result_invalid
+0001ad70: 2c20 6578 7065 6374 6564 5f69 6e76 616c  , expected_inval
+0001ad80: 6964 290a 0a20 2020 2064 6566 2074 6573  id)..    def tes
+0001ad90: 745f 5f74 7261 6e73 666f 726d 2873 656c  t__transform(sel
+0001ada0: 6629 3a0a 2020 2020 2020 2020 2222 2254  f):.        """T
+0001adb0: 6573 7420 7468 6520 6060 5f74 7261 6e73  est the ``_trans
+0001adc0: 666f 726d 6060 206d 6574 686f 6420 666f  form`` method fo
+0001add0: 7220 6060 5261 6e67 6560 602e 2222 220a  r ``Range``.""".
+0001ade0: 2020 2020 2020 2020 2320 5365 7475 700a          # Setup.
+0001adf0: 2020 2020 2020 2020 696e 7374 616e 6365          instance
+0001ae00: 203d 2052 616e 6765 2827 6127 2c20 2762   = Range('a', 'b
+0001ae10: 272c 2027 6327 290a 2020 2020 2020 2020  ', 'c').        
+0001ae20: 696e 7374 616e 6365 2e6c 6f77 5f64 6966  instance.low_dif
+0001ae30: 665f 636f 6c75 6d6e 5f6e 616d 6520 3d20  f_column_name = 
+0001ae40: 2761 2362 270a 2020 2020 2020 2020 696e  'a#b'.        in
+0001ae50: 7374 616e 6365 2e68 6967 685f 6469 6666  stance.high_diff
+0001ae60: 5f63 6f6c 756d 6e5f 6e61 6d65 203d 2027  _column_name = '
+0001ae70: 6223 6327 0a0a 2020 2020 2020 2020 2320  b#c'..        # 
+0001ae80: 5275 6e0a 2020 2020 2020 2020 7461 626c  Run.        tabl
+0001ae90: 655f 6461 7461 203d 2070 642e 4461 7461  e_data = pd.Data
+0001aea0: 4672 616d 6528 7b0a 2020 2020 2020 2020  Frame({.        
+0001aeb0: 2020 2020 2761 273a 205b 312c 2032 2c20      'a': [1, 2, 
+0001aec0: 335d 2c0a 2020 2020 2020 2020 2020 2020  3],.            
+0001aed0: 2762 273a 205b 322c 2035 2c20 355d 2c0a  'b': [2, 5, 5],.
+0001aee0: 2020 2020 2020 2020 2020 2020 2763 273a              'c':
+0001aef0: 205b 362c 2038 2c20 3130 5d2c 0a20 2020   [6, 8, 10],.   
+0001af00: 2020 2020 207d 290a 0a20 2020 2020 2020       })..       
+0001af10: 206f 7574 203d 2069 6e73 7461 6e63 652e   out = instance.
+0001af20: 5f74 7261 6e73 666f 726d 2874 6162 6c65  _transform(table
+0001af30: 5f64 6174 6129 0a0a 2020 2020 2020 2020  _data)..        
+0001af40: 2320 4173 7365 7274 0a20 2020 2020 2020  # Assert.       
+0001af50: 2065 7870 6563 7465 645f 6f75 7420 3d20   expected_out = 
+0001af60: 7064 2e44 6174 6146 7261 6d65 287b 0a20  pd.DataFrame({. 
+0001af70: 2020 2020 2020 2020 2020 2027 6127 3a20             'a': 
+0001af80: 5b31 2c20 322c 2033 5d2c 0a20 2020 2020  [1, 2, 3],.     
+0001af90: 2020 2020 2020 2027 6123 6227 3a20 5b6e         'a#b': [n
+0001afa0: 702e 6c6f 6728 3229 2c20 6e70 2e6c 6f67  p.log(2), np.log
+0001afb0: 2834 292c 206e 702e 6c6f 6728 3329 5d2c  (4), np.log(3)],
+0001afc0: 0a20 2020 2020 2020 2020 2020 2027 6223  .            'b#
+0001afd0: 6327 3a20 5b6e 702e 6c6f 6728 3529 2c20  c': [np.log(5), 
+0001afe0: 6e70 2e6c 6f67 2834 292c 206e 702e 6c6f  np.log(4), np.lo
+0001aff0: 6728 3629 5d2c 0a20 2020 2020 2020 207d  g(6)],.        }
+0001b000: 290a 2020 2020 2020 2020 7064 2e74 6573  ).        pd.tes
+0001b010: 7469 6e67 2e61 7373 6572 745f 6672 616d  ting.assert_fram
+0001b020: 655f 6571 7561 6c28 6f75 742c 2065 7870  e_equal(out, exp
+0001b030: 6563 7465 645f 6f75 7429 0a0a 2020 2020  ected_out)..    
+0001b040: 6465 6620 7465 7374 5f72 6576 6572 7365  def test_reverse
+0001b050: 5f74 7261 6e73 666f 726d 2873 656c 6629  _transform(self)
+0001b060: 3a0a 2020 2020 2020 2020 2222 2254 6573  :.        """Tes
+0001b070: 7420 7468 6520 6060 7265 7665 7273 655f  t the ``reverse_
+0001b080: 7472 616e 7366 6f72 6d60 6020 6d65 7468  transform`` meth
+0001b090: 6f64 2066 6f72 2060 6052 616e 6765 6060  od for ``Range``
+0001b0a0: 2e22 2222 0a20 2020 2020 2020 2023 2053  .""".        # S
+0001b0b0: 6574 7570 0a20 2020 2020 2020 2074 6162  etup.        tab
+0001b0c0: 6c65 5f64 6174 6120 3d20 7064 2e44 6174  le_data = pd.Dat
+0001b0d0: 6146 7261 6d65 287b 0a20 2020 2020 2020  aFrame({.       
+0001b0e0: 2020 2020 2027 6127 3a20 5b31 2c20 322c       'a': [1, 2,
+0001b0f0: 2033 5d2c 0a20 2020 2020 2020 2020 2020   3],.           
+0001b100: 2027 6227 3a20 5b32 2c20 352c 2035 5d2c   'b': [2, 5, 5],
+0001b110: 0a20 2020 2020 2020 2020 2020 2027 6327  .            'c'
+0001b120: 3a20 5b36 2c20 382c 2031 305d 2c0a 2020  : [6, 8, 10],.  
+0001b130: 2020 2020 2020 7d29 0a0a 2020 2020 2020        })..      
+0001b140: 2020 7472 616e 7366 6f72 6d65 645f 6461    transformed_da
+0001b150: 7461 203d 2070 642e 4461 7461 4672 616d  ta = pd.DataFram
+0001b160: 6528 7b0a 2020 2020 2020 2020 2020 2020  e({.            
+0001b170: 2761 273a 205b 312c 2032 2c20 335d 2c0a  'a': [1, 2, 3],.
+0001b180: 2020 2020 2020 2020 2020 2020 2761 2362              'a#b
+0001b190: 273a 205b 6e70 2e6c 6f67 2832 292c 206e  ': [np.log(2), n
+0001b1a0: 702e 6c6f 6728 3429 2c20 6e70 2e6c 6f67  p.log(4), np.log
+0001b1b0: 2833 295d 2c0a 2020 2020 2020 2020 2020  (3)],.          
+0001b1c0: 2020 2762 2363 273a 205b 6e70 2e6c 6f67    'b#c': [np.log
+0001b1d0: 2835 292c 206e 702e 6c6f 6728 3429 2c20  (5), np.log(4), 
+0001b1e0: 6e70 2e6c 6f67 2836 295d 2c0a 2020 2020  np.log(6)],.    
+0001b1f0: 2020 2020 7d29 0a20 2020 2020 2020 2069      }).        i
+0001b200: 6e73 7461 6e63 6520 3d20 5261 6e67 6528  nstance = Range(
+0001b210: 2761 272c 2027 6227 2c20 2763 2729 0a0a  'a', 'b', 'c')..
+0001b220: 2020 2020 2020 2020 2320 5275 6e0a 2020          # Run.  
+0001b230: 2020 2020 2020 696e 7374 616e 6365 2e66        instance.f
+0001b240: 6974 2874 6162 6c65 5f64 6174 6129 0a20  it(table_data). 
+0001b250: 2020 2020 2020 206f 7574 203d 2069 6e73         out = ins
+0001b260: 7461 6e63 652e 7265 7665 7273 655f 7472  tance.reverse_tr
+0001b270: 616e 7366 6f72 6d28 7472 616e 7366 6f72  ansform(transfor
+0001b280: 6d65 645f 6461 7461 290a 0a20 2020 2020  med_data)..     
+0001b290: 2020 2023 2041 7373 6572 740a 2020 2020     # Assert.    
+0001b2a0: 2020 2020 7064 2e74 6573 7469 6e67 2e61      pd.testing.a
+0001b2b0: 7373 6572 745f 6672 616d 655f 6571 7561  ssert_frame_equa
+0001b2c0: 6c28 7461 626c 655f 6461 7461 2c20 6f75  l(table_data, ou
+0001b2d0: 7429 0a0a 2020 2020 6465 6620 7465 7374  t)..    def test
+0001b2e0: 5f72 6576 6572 7365 5f74 7261 6e73 666f  _reverse_transfo
+0001b2f0: 726d 5f69 735f 6461 7465 7469 6d65 2873  rm_is_datetime(s
+0001b300: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
+0001b310: 2254 6573 7420 7468 6520 6060 7265 7665  "Test the ``reve
+0001b320: 7273 655f 7472 616e 7366 6f72 6d60 6020  rse_transform`` 
+0001b330: 6d65 7468 6f64 2066 6f72 2060 6052 616e  method for ``Ran
+0001b340: 6765 6060 2077 6974 6820 6461 7465 7469  ge`` with dateti
+0001b350: 6d65 2e22 2222 0a20 2020 2020 2020 2023  me.""".        #
+0001b360: 2053 6574 7570 0a20 2020 2020 2020 2074   Setup.        t
+0001b370: 6162 6c65 5f64 6174 6120 3d20 7064 2e44  able_data = pd.D
+0001b380: 6174 6146 7261 6d65 287b 0a20 2020 2020  ataFrame({.     
+0001b390: 2020 2020 2020 2027 6127 3a20 7064 2e74         'a': pd.t
+0001b3a0: 6f5f 6461 7465 7469 6d65 285b 2732 3032  o_datetime(['202
+0001b3b0: 302d 3031 2d30 3154 3030 3a30 303a 3030  0-01-01T00:00:00
+0001b3c0: 272c 2027 3230 3230 2d30 312d 3032 5430  ', '2020-01-02T0
+0001b3d0: 303a 3030 3a30 3027 5d29 2c0a 2020 2020  0:00:00']),.    
+0001b3e0: 2020 2020 2020 2020 2762 273a 2070 642e          'b': pd.
+0001b3f0: 746f 5f64 6174 6574 696d 6528 5b27 3230  to_datetime(['20
+0001b400: 3230 2d30 312d 3031 5430 303a 3030 3a30  20-01-01T00:00:0
+0001b410: 3127 2c20 2732 3032 302d 3031 2d30 3254  1', '2020-01-02T
+0001b420: 3030 3a30 303a 3031 275d 292c 0a20 2020  00:00:01']),.   
+0001b430: 2020 2020 2020 2020 2027 6327 3a20 7064           'c': pd
+0001b440: 2e74 6f5f 6461 7465 7469 6d65 285b 2732  .to_datetime(['2
+0001b450: 3032 302d 3031 2d30 3154 3030 3a30 303a  020-01-01T00:00:
+0001b460: 3032 272c 2027 3230 3230 2d30 312d 3032  02', '2020-01-02
+0001b470: 5430 303a 3030 3a30 3227 5d29 2c0a 2020  T00:00:02']),.  
+0001b480: 2020 2020 2020 7d29 0a0a 2020 2020 2020        })..      
+0001b490: 2020 7472 616e 7366 6f72 6d65 645f 6461    transformed_da
+0001b4a0: 7461 203d 2070 642e 4461 7461 4672 616d  ta = pd.DataFram
+0001b4b0: 6528 7b0a 2020 2020 2020 2020 2020 2020  e({.            
+0001b4c0: 2761 273a 2070 642e 746f 5f64 6174 6574  'a': pd.to_datet
+0001b4d0: 696d 6528 5b27 3230 3230 2d30 312d 3031  ime(['2020-01-01
+0001b4e0: 5430 303a 3030 3a30 3027 2c20 2732 3032  T00:00:00', '202
+0001b4f0: 302d 3031 2d30 3254 3030 3a30 303a 3030  0-01-02T00:00:00
+0001b500: 275d 292c 0a20 2020 2020 2020 2020 2020  ']),.           
+0001b510: 2027 6123 6227 3a20 5b6e 702e 6c6f 6728   'a#b': [np.log(
+0001b520: 315f 3030 305f 3030 305f 3030 3129 2c20  1_000_000_001), 
+0001b530: 6e70 2e6c 6f67 2831 5f30 3030 5f30 3030  np.log(1_000_000
+0001b540: 5f30 3031 295d 2c0a 2020 2020 2020 2020  _001)],.        
+0001b550: 2020 2020 2762 2363 273a 205b 6e70 2e6c      'b#c': [np.l
+0001b560: 6f67 2831 5f30 3030 5f30 3030 5f30 3031  og(1_000_000_001
+0001b570: 292c 206e 702e 6c6f 6728 315f 3030 305f  ), np.log(1_000_
+0001b580: 3030 305f 3030 3129 5d2c 0a20 2020 2020  000_001)],.     
+0001b590: 2020 207d 290a 0a20 2020 2020 2020 2069     })..        i
+0001b5a0: 6e73 7461 6e63 6520 3d20 5261 6e67 6528  nstance = Range(
+0001b5b0: 2761 272c 2027 6227 2c20 2763 2729 0a0a  'a', 'b', 'c')..
+0001b5c0: 2020 2020 2020 2020 2320 5275 6e0a 2020          # Run.  
+0001b5d0: 2020 2020 2020 696e 7374 616e 6365 2e66        instance.f
+0001b5e0: 6974 2874 6162 6c65 5f64 6174 6129 0a20  it(table_data). 
+0001b5f0: 2020 2020 2020 206f 7574 203d 2069 6e73         out = ins
+0001b600: 7461 6e63 652e 7265 7665 7273 655f 7472  tance.reverse_tr
+0001b610: 616e 7366 6f72 6d28 7472 616e 7366 6f72  ansform(transfor
+0001b620: 6d65 645f 6461 7461 290a 0a20 2020 2020  med_data)..     
+0001b630: 2020 2023 2041 7373 6572 740a 2020 2020     # Assert.    
+0001b640: 2020 2020 7064 2e74 6573 7469 6e67 2e61      pd.testing.a
+0001b650: 7373 6572 745f 6672 616d 655f 6571 7561  ssert_frame_equa
+0001b660: 6c28 7461 626c 655f 6461 7461 2c20 6f75  l(table_data, ou
+0001b670: 7429 0a0a 0a63 6c61 7373 2054 6573 7453  t)...class TestS
+0001b680: 6361 6c61 7252 616e 6765 2829 3a0a 0a20  calarRange():.. 
+0001b690: 2020 2064 6566 2074 6573 745f 5f76 616c     def test__val
+0001b6a0: 6964 6174 655f 696e 7075 7473 2873 656c  idate_inputs(sel
+0001b6b0: 6629 3a0a 2020 2020 2020 2020 2222 2254  f):.        """T
+0001b6c0: 6573 7420 7468 6520 6060 5363 616c 6172  est the ``Scalar
+0001b6d0: 5261 6e67 652e 5f76 616c 6964 6174 655f  Range._validate_
+0001b6e0: 696e 7075 7473 6060 206d 6574 686f 642e  inputs`` method.
+0001b6f0: 0a0a 2020 2020 2020 2020 496e 7075 743a  ..        Input:
+0001b700: 0a20 2020 2020 2020 202d 2020 496e 636f  .        -  Inco
+0001b710: 7272 6563 7420 7061 7261 6d65 7465 7273  rrect parameters
+0001b720: 2066 6f72 2074 6865 206d 6574 686f 640a   for the method.
+0001b730: 2020 2020 2020 2020 5261 6973 6573 3a0a          Raises:.
+0001b740: 2020 2020 2020 2020 2d20 4c69 7374 206f          - List o
+0001b750: 6620 5661 6c75 6545 7272 6f72 730a 2020  f ValueErrors.  
+0001b760: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0001b770: 2020 2320 5275 6e20 2f20 4173 7365 7274    # Run / Assert
+0001b780: 0a20 2020 2020 2020 2077 6974 6820 7079  .        with py
+0001b790: 7465 7374 2e72 6169 7365 7328 4167 6772  test.raises(Aggr
+0001b7a0: 6567 6174 6543 6f6e 7374 7261 696e 7473  egateConstraints
+0001b7b0: 4572 726f 7229 2061 7320 6572 726f 723a  Error) as error:
+0001b7c0: 0a20 2020 2020 2020 2020 2020 2053 6361  .            Sca
+0001b7d0: 6c61 7252 616e 6765 2e5f 7661 6c69 6461  larRange._valida
+0001b7e0: 7465 5f69 6e70 7574 7328 6e6f 745f 6869  te_inputs(not_hi
+0001b7f0: 6768 5f63 6f6c 756d 6e3d 4e6f 6e65 2c20  gh_column=None, 
+0001b800: 6e6f 745f 6c6f 775f 636f 6c75 6d6e 3d4e  not_low_column=N
+0001b810: 6f6e 6529 0a0a 2020 2020 2020 2020 6572  one)..        er
+0001b820: 725f 6d73 6720 3d20 280a 2020 2020 2020  r_msg = (.      
+0001b830: 2020 2020 2020 7227 4d69 7373 696e 6720        r'Missing 
+0001b840: 7265 7175 6972 6564 2076 616c 7565 7320  required values 
+0001b850: 7b28 2e2a 297d 2069 6e20 6120 5363 616c  {(.*)} in a Scal
+0001b860: 6172 5261 6e67 6520 636f 6e73 7472 6169  arRange constrai
+0001b870: 6e74 2e27 0a20 2020 2020 2020 2020 2020  nt.'.           
+0001b880: 2072 275c 6e5c 6e49 6e76 616c 6964 2076   r'\n\nInvalid v
+0001b890: 616c 7565 7320 7b28 2e2a 297d 2061 7265  alues {(.*)} are
+0001b8a0: 2070 7265 7365 6e74 2069 6e20 6120 5363   present in a Sc
+0001b8b0: 616c 6172 5261 6e67 6520 636f 6e73 7472  alarRange constr
+0001b8c0: 6169 6e74 2e27 0a20 2020 2020 2020 2029  aint.'.        )
+0001b8d0: 0a20 2020 2020 2020 2067 726f 7570 7320  .        groups 
+0001b8e0: 3d20 7265 2e73 6561 7263 6828 6572 725f  = re.search(err_
+0001b8f0: 6d73 672c 2073 7472 2865 7272 6f72 2e76  msg, str(error.v
+0001b900: 616c 7565 2929 0a20 2020 2020 2020 2061  alue)).        a
+0001b910: 7373 6572 7420 6772 6f75 7073 2069 7320  ssert groups is 
+0001b920: 6e6f 7420 4e6f 6e65 0a20 2020 2020 2020  not None.       
+0001b930: 2061 7373 6572 7420 7365 7428 6576 616c   assert set(eval
+0001b940: 2867 726f 7570 732e 6772 6f75 7028 3129  (groups.group(1)
+0001b950: 2929 203d 3d20 7b27 6c6f 775f 7661 6c75  )) == {'low_valu
+0001b960: 6527 2c20 2768 6967 685f 7661 6c75 6527  e', 'high_value'
+0001b970: 2c20 2763 6f6c 756d 6e5f 6e61 6d65 277d  , 'column_name'}
+0001b980: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+0001b990: 7365 7428 6576 616c 2867 726f 7570 732e  set(eval(groups.
+0001b9a0: 6772 6f75 7028 3229 2929 203d 3d20 7b27  group(2))) == {'
+0001b9b0: 6e6f 745f 6869 6768 5f63 6f6c 756d 6e27  not_high_column'
+0001b9c0: 2c20 276e 6f74 5f6c 6f77 5f63 6f6c 756d  , 'not_low_colum
+0001b9d0: 6e27 7d0a 0a20 2020 2064 6566 2074 6573  n'}..    def tes
+0001b9e0: 745f 5f76 616c 6964 6174 655f 6d65 7461  t__validate_meta
+0001b9f0: 6461 7461 5f63 6f6c 756d 6e73 2873 656c  data_columns(sel
+0001ba00: 6629 3a0a 2020 2020 2020 2020 2222 2254  f):.        """T
+0001ba10: 6573 7420 7468 6520 6060 5f76 616c 6964  est the ``_valid
+0001ba20: 6174 655f 6d65 7461 6461 7461 5f63 6f6c  ate_metadata_col
+0001ba30: 756d 6e73 6060 206d 6574 686f 642e 0a0a  umns`` method...
+0001ba40: 2020 2020 2020 2020 5468 6520 636f 6c75          The colu
+0001ba50: 6d6e 2070 6173 7365 6420 696e 2063 6f6c  mn passed in col
+0001ba60: 756d 6e5f 6e61 6d65 2073 686f 756c 6420  umn_name should 
+0001ba70: 6265 2069 6e20 7468 6520 6d65 7461 6461  be in the metada
+0001ba80: 7461 2e0a 0a20 2020 2020 2020 2049 6e70  ta...        Inp
+0001ba90: 7574 3a0a 2020 2020 2020 2020 2020 2020  ut:.            
+0001baa0: 2d20 636f 6c75 6d6e 5f6e 616d 6520 7468  - column_name th
+0001bab0: 6174 2069 7320 696e 2074 6865 206d 6574  at is in the met
+0001bac0: 6164 6174 612e 0a0a 2020 2020 2020 2020  adata...        
+0001bad0: 5369 6465 2065 6666 6563 743a 0a20 2020  Side effect:.   
+0001bae0: 2020 2020 2020 2020 202d 204e 6f20 6572           - No er
+0001baf0: 726f 7220 7368 6f75 6c64 2062 6520 7261  ror should be ra
+0001bb00: 6973 6564 2e0a 2020 2020 2020 2020 2222  ised..        ""
+0001bb10: 220a 2020 2020 2020 2020 2320 5365 7475  ".        # Setu
+0001bb20: 700a 2020 2020 2020 2020 6d65 7461 6461  p.        metada
+0001bb30: 7461 203d 204d 6f63 6b28 290a 2020 2020  ta = Mock().    
+0001bb40: 2020 2020 6d65 7461 6461 7461 2e63 6f6c      metadata.col
+0001bb50: 756d 6e73 203d 207b 2761 273a 2031 2c20  umns = {'a': 1, 
+0001bb60: 2762 273a 2032 7d0a 0a20 2020 2020 2020  'b': 2}..       
+0001bb70: 2023 2052 756e 0a20 2020 2020 2020 2053   # Run.        S
+0001bb80: 6361 6c61 7252 616e 6765 2e5f 7661 6c69  calarRange._vali
+0001bb90: 6461 7465 5f6d 6574 6164 6174 615f 636f  date_metadata_co
+0001bba0: 6c75 6d6e 7328 6d65 7461 6461 7461 2c20  lumns(metadata, 
+0001bbb0: 636f 6c75 6d6e 5f6e 616d 653d 2761 2729  column_name='a')
+0001bbc0: 0a0a 2020 2020 6465 6620 7465 7374 5f5f  ..    def test__
+0001bbd0: 7661 6c69 6461 7465 5f6d 6574 6164 6174  validate_metadat
+0001bbe0: 615f 636f 6c75 6d6e 735f 7261 6973 6573  a_columns_raises
+0001bbf0: 5f65 7272 6f72 2873 656c 6629 3a0a 2020  _error(self):.  
+0001bc00: 2020 2020 2020 2222 2254 6573 7420 7468        """Test th
+0001bc10: 6520 6060 5f76 616c 6964 6174 655f 6d65  e ``_validate_me
+0001bc20: 7461 6461 7461 5f63 6f6c 756d 6e73 6060  tadata_columns``
+0001bc30: 206d 6574 686f 6427 7320 6572 726f 7220   method's error 
+0001bc40: 636f 6e64 6974 696f 6e2e 0a0a 2020 2020  condition...    
+0001bc50: 2020 2020 4966 2063 6f6c 756d 6e5f 6e61      If column_na
+0001bc60: 6d65 2069 7320 6e6f 7420 696e 2074 6865  me is not in the
+0001bc70: 206d 6574 6164 6174 612c 2061 6e20 6572   metadata, an er
+0001bc80: 726f 7220 7368 6f75 6c64 2062 6520 7261  ror should be ra
+0001bc90: 6973 6564 2e0a 0a20 2020 2020 2020 2049  ised...        I
+0001bca0: 6e70 7574 3a0a 2020 2020 2020 2020 2020  nput:.          
+0001bcb0: 2020 2d20 636f 6c75 6d6e 5f6e 616d 6520    - column_name 
+0001bcc0: 7468 6174 2069 7320 6e6f 7420 696e 2074  that is not in t
+0001bcd0: 6865 206d 6574 6164 6174 612e 0a0a 2020  he metadata...  
+0001bce0: 2020 2020 2020 5369 6465 2065 6666 6563        Side effec
+0001bcf0: 743a 0a20 2020 2020 2020 2020 2020 202d  t:.            -
+0001bd00: 2043 6f6e 7374 7261 696e 744d 6574 6164   ConstraintMetad
+0001bd10: 6174 6145 7272 6f72 2073 686f 756c 6420  ataError should 
+0001bd20: 6265 2072 6169 7365 642e 0a20 2020 2020  be raised..     
+0001bd30: 2020 2022 2222 0a20 2020 2020 2020 2023     """.        #
+0001bd40: 2053 6574 7570 0a20 2020 2020 2020 206d   Setup.        m
+0001bd50: 6574 6164 6174 6120 3d20 4d6f 636b 2829  etadata = Mock()
+0001bd60: 0a20 2020 2020 2020 206d 6574 6164 6174  .        metadat
+0001bd70: 612e 636f 6c75 6d6e 7320 3d20 7b27 6127  a.columns = {'a'
+0001bd80: 3a20 312c 2027 6227 3a20 327d 0a0a 2020  : 1, 'b': 2}..  
+0001bd90: 2020 2020 2020 2320 5275 6e0a 2020 2020        # Run.    
+0001bda0: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
+0001bdb0: 6520 3d20 7265 2e65 7363 6170 6528 0a20  e = re.escape(. 
+0001bdc0: 2020 2020 2020 2020 2020 2027 4120 5363             'A Sc
+0001bdd0: 616c 6172 5261 6e67 6520 636f 6e73 7472  alarRange constr
+0001bde0: 6169 6e74 2069 7320 6265 696e 6720 6170  aint is being ap
+0001bdf0: 706c 6965 6420 746f 2069 6e76 616c 6964  plied to invalid
+0001be00: 2063 6f6c 756d 6e20 6e61 6d65 7320 270a   column names '.
+0001be10: 2020 2020 2020 2020 2020 2020 227b 2763              "{'c
+0001be20: 277d 2e20 5468 6520 636f 6c75 6d6e 7320  '}. The columns 
+0001be30: 6d75 7374 2065 7869 7374 2069 6e20 7468  must exist in th
+0001be40: 6520 7461 626c 652e 220a 2020 2020 2020  e table.".      
+0001be50: 2020 290a 2020 2020 2020 2020 7769 7468    ).        with
+0001be60: 2070 7974 6573 742e 7261 6973 6573 2843   pytest.raises(C
+0001be70: 6f6e 7374 7261 696e 744d 6574 6164 6174  onstraintMetadat
+0001be80: 6145 7272 6f72 2c20 6d61 7463 683d 6572  aError, match=er
+0001be90: 726f 725f 6d65 7373 6167 6529 3a0a 2020  ror_message):.  
+0001bea0: 2020 2020 2020 2020 2020 5363 616c 6172            Scalar
+0001beb0: 5261 6e67 652e 5f76 616c 6964 6174 655f  Range._validate_
+0001bec0: 6d65 7461 6461 7461 5f63 6f6c 756d 6e73  metadata_columns
+0001bed0: 286d 6574 6164 6174 612c 2063 6f6c 756d  (metadata, colum
+0001bee0: 6e5f 6e61 6d65 3d27 6327 290a 0a20 2020  n_name='c')..   
+0001bef0: 2064 6566 2074 6573 745f 5f76 616c 6964   def test__valid
+0001bf00: 6174 655f 6d65 7461 6461 7461 5f73 7065  ate_metadata_spe
+0001bf10: 6369 6669 635f 746f 5f63 6f6e 7374 7261  cific_to_constra
+0001bf20: 696e 745f 6e75 6d65 7269 6361 6c28 7365  int_numerical(se
+0001bf30: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+0001bf40: 5465 7374 2074 6865 2060 605f 7661 6c69  Test the ``_vali
+0001bf50: 6461 7465 5f6d 6574 6164 6174 615f 7370  date_metadata_sp
+0001bf60: 6563 6966 6963 5f74 6f5f 636f 6e73 7472  ecific_to_constr
+0001bf70: 6169 6e74 6060 206d 6574 686f 642e 0a0a  aint`` method...
+0001bf80: 2020 2020 2020 2020 4966 2074 6865 2063          If the c
+0001bf90: 6f6c 756d 6e5f 6e61 6d65 2068 6173 2061  olumn_name has a
+0001bfa0: 6e20 7364 7479 7065 206f 6620 6e75 6d65  n sdtype of nume
+0001bfb0: 7269 6361 6c2c 2061 6e64 2074 6865 2068  rical, and the h
+0001bfc0: 6967 685f 7661 6c75 650a 2020 2020 2020  igh_value.      
+0001bfd0: 2020 616e 6420 6c6f 775f 7661 6c75 6520    and low_value 
+0001bfe0: 6172 6520 696e 7473 206f 7220 666c 6f61  are ints or floa
+0001bff0: 7473 2c20 7468 656e 206e 6f20 6572 726f  ts, then no erro
+0001c000: 7220 7368 6f75 6c64 2062 6520 7261 6973  r should be rais
+0001c010: 6564 2e0a 0a20 2020 2020 2020 2053 6574  ed...        Set
+0001c020: 7570 3a0a 2020 2020 2020 2020 2020 2020  up:.            
+0001c030: 2d20 4d65 7461 6461 7461 2077 6974 6820  - Metadata with 
+0001c040: 7468 6520 7364 7479 7065 2073 6574 2074  the sdtype set t
+0001c050: 6f20 6e75 6d65 7269 6361 6c2e 0a0a 2020  o numerical...  
+0001c060: 2020 2020 2020 496e 7075 743a 0a20 2020        Input:.   
+0001c070: 2020 2020 2020 2020 202d 2054 6865 2063           - The c
+0001c080: 6f6c 756d 6e20 6e61 6d65 2061 6e64 2062  olumn name and b
+0001c090: 6f74 6820 6869 6768 5f76 616c 7565 2061  oth high_value a
+0001c0a0: 6e64 206c 6f77 5f76 616c 7565 2073 6574  nd low_value set
+0001c0b0: 2074 6f20 6120 6e75 6d62 6572 2e0a 2020   to a number..  
+0001c0c0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0001c0d0: 2020 2320 5365 7475 700a 2020 2020 2020    # Setup.      
+0001c0e0: 2020 6d65 7461 6461 7461 203d 204d 6f63    metadata = Moc
+0001c0f0: 6b28 290a 2020 2020 2020 2020 6d65 7461  k().        meta
+0001c100: 6461 7461 2e63 6f6c 756d 6e73 203d 207b  data.columns = {
+0001c110: 2761 273a 207b 2773 6474 7970 6527 3a20  'a': {'sdtype': 
+0001c120: 276e 756d 6572 6963 616c 277d 7d0a 0a20  'numerical'}}.. 
+0001c130: 2020 2020 2020 2023 2052 756e 0a20 2020         # Run.   
+0001c140: 2020 2020 2053 6361 6c61 7252 616e 6765       ScalarRange
+0001c150: 2e5f 7661 6c69 6461 7465 5f6d 6574 6164  ._validate_metad
+0001c160: 6174 615f 7370 6563 6966 6963 5f74 6f5f  ata_specific_to_
+0001c170: 636f 6e73 7472 6169 6e74 280a 2020 2020  constraint(.    
+0001c180: 2020 2020 2020 2020 6d65 7461 6461 7461          metadata
+0001c190: 2c0a 2020 2020 2020 2020 2020 2020 636f  ,.            co
+0001c1a0: 6c75 6d6e 5f6e 616d 653d 2761 272c 0a20  lumn_name='a',. 
+0001c1b0: 2020 2020 2020 2020 2020 2068 6967 685f             high_
+0001c1c0: 7661 6c75 653d 3130 2c0a 2020 2020 2020  value=10,.      
+0001c1d0: 2020 2020 2020 6c6f 775f 7661 6c75 653d        low_value=
+0001c1e0: 350a 2020 2020 2020 2020 290a 0a20 2020  5.        )..   
+0001c1f0: 2064 6566 2074 6573 745f 5f76 616c 6964   def test__valid
+0001c200: 6174 655f 6d65 7461 6461 7461 5f73 7065  ate_metadata_spe
+0001c210: 6369 6669 635f 746f 5f63 6f6e 7374 7261  cific_to_constra
+0001c220: 696e 745f 6e75 6d65 7269 6361 6c5f 6869  int_numerical_hi
+0001c230: 6768 5f6e 6f74 5f6e 756d 6572 6963 616c  gh_not_numerical
+0001c240: 5f65 7272 6f72 2873 656c 6629 3a0a 2020  _error(self):.  
+0001c250: 2020 2020 2020 2222 2254 6573 7420 7468        """Test th
+0001c260: 6520 6060 5f76 616c 6964 6174 655f 6d65  e ``_validate_me
+0001c270: 7461 6461 7461 5f73 7065 6369 6669 635f  tadata_specific_
+0001c280: 746f 5f63 6f6e 7374 7261 696e 7460 6020  to_constraint`` 
+0001c290: 6d65 7468 6f64 2e0a 0a20 2020 2020 2020  method...       
+0001c2a0: 2049 6620 7468 6520 636f 6c75 6d6e 5f6e   If the column_n
+0001c2b0: 616d 6520 6861 7320 616e 2073 6474 7970  ame has an sdtyp
+0001c2c0: 6520 6f66 206e 756d 6572 6963 616c 2c20  e of numerical, 
+0001c2d0: 616e 6420 7468 6520 6869 6768 5f76 616c  and the high_val
+0001c2e0: 7565 0a20 2020 2020 2020 2069 7320 6e6f  ue.        is no
+0001c2f0: 7420 616e 2069 6e74 206f 7220 666c 6f61  t an int or floa
+0001c300: 742c 2074 6865 6e20 616e 2065 7272 6f72  t, then an error
+0001c310: 2073 686f 756c 6420 6265 2072 6169 7365   should be raise
+0001c320: 642e 0a0a 2020 2020 2020 2020 5365 7475  d...        Setu
+0001c330: 703a 0a20 2020 2020 2020 2020 2020 202d  p:.            -
+0001c340: 204d 6574 6164 6174 6120 7769 7468 2074   Metadata with t
+0001c350: 6865 2073 6474 7970 6520 7365 7420 746f  he sdtype set to
+0001c360: 206e 756d 6572 6963 616c 2e0a 0a20 2020   numerical...   
+0001c370: 2020 2020 2049 6e70 7574 3a0a 2020 2020       Input:.    
+0001c380: 2020 2020 2020 2020 2d20 5468 6520 636f          - The co
+0001c390: 6c75 6d6e 206e 616d 652c 206c 6f77 5f76  lumn name, low_v
+0001c3a0: 616c 7565 2073 6574 2074 6f20 6120 6e75  alue set to a nu
+0001c3b0: 6d62 6572 2061 6e64 2068 6967 685f 7661  mber and high_va
+0001c3c0: 6c75 6520 7365 7420 746f 2061 2073 7472  lue set to a str
+0001c3d0: 696e 672e 0a20 2020 2020 2020 2022 2222  ing..        """
+0001c3e0: 0a20 2020 2020 2020 2023 2053 6574 7570  .        # Setup
+0001c3f0: 0a20 2020 2020 2020 206d 6574 6164 6174  .        metadat
+0001c400: 6120 3d20 4d6f 636b 2829 0a20 2020 2020  a = Mock().     
+0001c410: 2020 206d 6574 6164 6174 612e 636f 6c75     metadata.colu
+0001c420: 6d6e 7320 3d20 7b27 6127 3a20 7b27 7364  mns = {'a': {'sd
+0001c430: 7479 7065 273a 2027 6e75 6d65 7269 6361  type': 'numerica
+0001c440: 6c27 7d7d 0a0a 2020 2020 2020 2020 2320  l'}}..        # 
+0001c450: 5275 6e0a 2020 2020 2020 2020 6572 726f  Run.        erro
+0001c460: 725f 6d65 7373 6167 6520 3d20 2242 6f74  r_message = "Bot
+0001c470: 6820 2768 6967 685f 7661 6c75 6527 2061  h 'high_value' a
+0001c480: 6e64 2027 6c6f 775f 7661 6c75 6527 206d  nd 'low_value' m
+0001c490: 7573 7420 6265 2069 6e74 7320 6f72 2066  ust be ints or f
+0001c4a0: 6c6f 6174 7322 0a20 2020 2020 2020 2077  loats".        w
+0001c4b0: 6974 6820 7079 7465 7374 2e72 6169 7365  ith pytest.raise
+0001c4c0: 7328 436f 6e73 7472 6169 6e74 4d65 7461  s(ConstraintMeta
+0001c4d0: 6461 7461 4572 726f 722c 206d 6174 6368  dataError, match
+0001c4e0: 3d65 7272 6f72 5f6d 6573 7361 6765 293a  =error_message):
+0001c4f0: 0a20 2020 2020 2020 2020 2020 2053 6361  .            Sca
+0001c500: 6c61 7252 616e 6765 2e5f 7661 6c69 6461  larRange._valida
+0001c510: 7465 5f6d 6574 6164 6174 615f 7370 6563  te_metadata_spec
+0001c520: 6966 6963 5f74 6f5f 636f 6e73 7472 6169  ific_to_constrai
+0001c530: 6e74 280a 2020 2020 2020 2020 2020 2020  nt(.            
+0001c540: 2020 2020 6d65 7461 6461 7461 2c0a 2020      metadata,.  
+0001c550: 2020 2020 2020 2020 2020 2020 2020 636f                co
+0001c560: 6c75 6d6e 5f6e 616d 653d 2761 272c 0a20  lumn_name='a',. 
+0001c570: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+0001c580: 6f77 5f76 616c 7565 3d35 2c0a 2020 2020  ow_value=5,.    
+0001c590: 2020 2020 2020 2020 2020 2020 6869 6768              high
+0001c5a0: 5f76 616c 7565 3d27 3130 270a 2020 2020  _value='10'.    
+0001c5b0: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
+0001c5c0: 6566 2074 6573 745f 5f76 616c 6964 6174  ef test__validat
+0001c5d0: 655f 6d65 7461 6461 7461 5f73 7065 6369  e_metadata_speci
+0001c5e0: 6669 635f 746f 5f63 6f6e 7374 7261 696e  fic_to_constrain
+0001c5f0: 745f 6e75 6d65 7269 6361 6c5f 6c6f 775f  t_numerical_low_
+0001c600: 6e6f 745f 6e75 6d65 7269 6361 6c5f 6572  not_numerical_er
+0001c610: 726f 7228 7365 6c66 293a 0a20 2020 2020  ror(self):.     
+0001c620: 2020 2022 2222 5465 7374 2074 6865 2060     """Test the `
+0001c630: 605f 7661 6c69 6461 7465 5f6d 6574 6164  `_validate_metad
+0001c640: 6174 615f 7370 6563 6966 6963 5f74 6f5f  ata_specific_to_
+0001c650: 636f 6e73 7472 6169 6e74 6060 206d 6574  constraint`` met
+0001c660: 686f 642e 0a0a 2020 2020 2020 2020 4966  hod...        If
+0001c670: 2074 6865 2063 6f6c 756d 6e5f 6e61 6d65   the column_name
+0001c680: 2068 6173 2061 6e20 7364 7479 7065 206f   has an sdtype o
+0001c690: 6620 6e75 6d65 7269 6361 6c2c 2061 6e64  f numerical, and
+0001c6a0: 2074 6865 206c 6f77 5f76 616c 7565 0a20   the low_value. 
+0001c6b0: 2020 2020 2020 2069 7320 6e6f 7420 616e         is not an
+0001c6c0: 2069 6e74 206f 7220 666c 6f61 742c 2074   int or float, t
+0001c6d0: 6865 6e20 616e 2065 7272 6f72 2073 686f  hen an error sho
+0001c6e0: 756c 6420 6265 2072 6169 7365 642e 0a0a  uld be raised...
+0001c6f0: 2020 2020 2020 2020 5365 7475 703a 0a20          Setup:. 
+0001c700: 2020 2020 2020 2020 2020 202d 204d 6574             - Met
+0001c710: 6164 6174 6120 7769 7468 2074 6865 2073  adata with the s
+0001c720: 6474 7970 6520 7365 7420 746f 206e 756d  dtype set to num
+0001c730: 6572 6963 616c 2e0a 0a20 2020 2020 2020  erical...       
+0001c740: 2049 6e70 7574 3a0a 2020 2020 2020 2020   Input:.        
+0001c750: 2020 2020 2d20 5468 6520 636f 6c75 6d6e      - The column
+0001c760: 206e 616d 652c 2068 6967 685f 7661 6c75   name, high_valu
+0001c770: 6520 7365 7420 746f 2061 206e 756d 6265  e set to a numbe
+0001c780: 7220 616e 6420 6c6f 775f 7661 6c75 6520  r and low_value 
+0001c790: 7365 7420 746f 2061 2073 7472 696e 672e  set to a string.
+0001c7a0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0001c7b0: 2020 2020 2023 2053 6574 7570 0a20 2020       # Setup.   
+0001c7c0: 2020 2020 206d 6574 6164 6174 6120 3d20       metadata = 
+0001c7d0: 4d6f 636b 2829 0a20 2020 2020 2020 206d  Mock().        m
+0001c7e0: 6574 6164 6174 612e 636f 6c75 6d6e 7320  etadata.columns 
+0001c7f0: 3d20 7b27 6127 3a20 7b27 7364 7479 7065  = {'a': {'sdtype
+0001c800: 273a 2027 6e75 6d65 7269 6361 6c27 7d7d  ': 'numerical'}}
+0001c810: 0a0a 2020 2020 2020 2020 2320 5275 6e0a  ..        # Run.
+0001c820: 2020 2020 2020 2020 6572 726f 725f 6d65          error_me
+0001c830: 7373 6167 6520 3d20 2242 6f74 6820 2768  ssage = "Both 'h
+0001c840: 6967 685f 7661 6c75 6527 2061 6e64 2027  igh_value' and '
+0001c850: 6c6f 775f 7661 6c75 6527 206d 7573 7420  low_value' must 
+0001c860: 6265 2069 6e74 7320 6f72 2066 6c6f 6174  be ints or float
+0001c870: 7322 0a20 2020 2020 2020 2077 6974 6820  s".        with 
+0001c880: 7079 7465 7374 2e72 6169 7365 7328 436f  pytest.raises(Co
+0001c890: 6e73 7472 6169 6e74 4d65 7461 6461 7461  nstraintMetadata
+0001c8a0: 4572 726f 722c 206d 6174 6368 3d65 7272  Error, match=err
+0001c8b0: 6f72 5f6d 6573 7361 6765 293a 0a20 2020  or_message):.   
+0001c8c0: 2020 2020 2020 2020 2053 6361 6c61 7252           ScalarR
+0001c8d0: 616e 6765 2e5f 7661 6c69 6461 7465 5f6d  ange._validate_m
+0001c8e0: 6574 6164 6174 615f 7370 6563 6966 6963  etadata_specific
+0001c8f0: 5f74 6f5f 636f 6e73 7472 6169 6e74 280a  _to_constraint(.
+0001c900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c910: 6d65 7461 6461 7461 2c0a 2020 2020 2020  metadata,.      
+0001c920: 2020 2020 2020 2020 2020 636f 6c75 6d6e            column
+0001c930: 5f6e 616d 653d 2761 272c 0a20 2020 2020  _name='a',.     
+0001c940: 2020 2020 2020 2020 2020 206c 6f77 5f76             low_v
+0001c950: 616c 7565 3d27 3527 2c0a 2020 2020 2020  alue='5',.      
+0001c960: 2020 2020 2020 2020 2020 6869 6768 5f76            high_v
+0001c970: 616c 7565 3d31 300a 2020 2020 2020 2020  alue=10.        
+0001c980: 2020 2020 290a 0a20 2020 2040 7061 7463      )..    @patc
+0001c990: 6828 2773 6476 2e63 6f6e 7374 7261 696e  h('sdv.constrain
+0001c9a0: 7473 2e74 6162 756c 6172 2e6d 6174 6368  ts.tabular.match
+0001c9b0: 6573 5f64 6174 6574 696d 655f 666f 726d  es_datetime_form
+0001c9c0: 6174 2729 0a20 2020 2064 6566 2074 6573  at').    def tes
+0001c9d0: 745f 5f76 616c 6964 6174 655f 6d65 7461  t__validate_meta
+0001c9e0: 6461 7461 5f73 7065 6369 6669 635f 746f  data_specific_to
+0001c9f0: 5f63 6f6e 7374 7261 696e 745f 6461 7465  _constraint_date
+0001ca00: 7469 6d65 2873 656c 662c 2064 6174 6574  time(self, datet
+0001ca10: 696d 655f 666f 726d 6174 5f6d 6f63 6b29  ime_format_mock)
+0001ca20: 3a0a 2020 2020 2020 2020 2222 2254 6573  :.        """Tes
+0001ca30: 7420 7468 6520 6060 5f76 616c 6964 6174  t the ``_validat
+0001ca40: 655f 6d65 7461 6461 7461 5f73 7065 6369  e_metadata_speci
+0001ca50: 6669 635f 746f 5f63 6f6e 7374 7261 696e  fic_to_constrain
+0001ca60: 7460 6020 6d65 7468 6f64 2e0a 0a20 2020  t`` method...   
+0001ca70: 2020 2020 2049 6620 7468 6520 636f 6c75       If the colu
+0001ca80: 6d6e 5f6e 616d 6520 6861 7320 616e 2073  mn_name has an s
+0001ca90: 6474 7970 6520 6f66 2064 6174 6574 696d  dtype of datetim
+0001caa0: 652c 2061 6e64 2062 6f74 6820 7468 6520  e, and both the 
+0001cab0: 6869 6768 5f76 616c 7565 2061 6e64 206c  high_value and l
+0001cac0: 6f77 5f76 616c 7565 0a20 2020 2020 2020  ow_value.       
+0001cad0: 2061 7265 2064 6174 6574 696d 6520 7374   are datetime st
+0001cae0: 7269 6e67 7320 7468 6174 206d 6174 6368  rings that match
+0001caf0: 2074 6865 2066 6f72 6d61 742c 2074 6865   the format, the
+0001cb00: 6e20 6e6f 2065 7272 6f72 2073 686f 756c  n no error shoul
+0001cb10: 6420 6265 2072 6169 7365 642e 0a0a 2020  d be raised...  
+0001cb20: 2020 2020 2020 5365 7475 703a 0a20 2020        Setup:.   
+0001cb30: 2020 2020 2020 2020 202d 204d 6574 6164           - Metad
+0001cb40: 6174 6120 7769 7468 2074 6865 2073 6474  ata with the sdt
+0001cb50: 7970 6520 7365 7420 746f 2064 6174 6574  ype set to datet
+0001cb60: 696d 6520 616e 6420 6120 6461 7465 7469  ime and a dateti
+0001cb70: 6d65 5f66 6f72 6d61 742e 0a20 2020 2020  me_format..     
+0001cb80: 2020 2020 2020 202d 204d 6f63 6b20 7468         - Mock th
+0001cb90: 6520 6060 6d61 7463 6865 735f 6461 7465  e ``matches_date
+0001cba0: 7469 6d65 5f66 6f72 6d61 7460 6020 6675  time_format`` fu
+0001cbb0: 6e63 7469 6f6e 2074 6f20 7265 7475 726e  nction to return
+0001cbc0: 2054 7275 652e 0a0a 2020 2020 2020 2020   True...        
+0001cbd0: 496e 7075 743a 0a20 2020 2020 2020 2020  Input:.         
+0001cbe0: 2020 202d 2054 6865 2063 6f6c 756d 6e20     - The column 
+0001cbf0: 6e61 6d65 2061 6e64 2062 6f74 6820 6c6f  name and both lo
+0001cc00: 775f 7661 6c75 6520 616e 6420 6869 6768  w_value and high
+0001cc10: 5f76 616c 7565 2073 6574 2074 6f20 6120  _value set to a 
+0001cc20: 6461 7465 7469 6d65 206f 6620 7468 650a  datetime of the.
+0001cc30: 2020 2020 2020 2020 2020 2020 7269 6768              righ
+0001cc40: 7420 666f 726d 6174 2e0a 2020 2020 2020  t format..      
+0001cc50: 2020 2222 220a 2020 2020 2020 2020 2320    """.        # 
+0001cc60: 5365 7475 700a 2020 2020 2020 2020 6d65  Setup.        me
+0001cc70: 7461 6461 7461 203d 204d 6f63 6b28 290a  tadata = Mock().
+0001cc80: 2020 2020 2020 2020 6d65 7461 6461 7461          metadata
+0001cc90: 2e63 6f6c 756d 6e73 203d 207b 2761 273a  .columns = {'a':
+0001cca0: 207b 2773 6474 7970 6527 3a20 2764 6174   {'sdtype': 'dat
+0001ccb0: 6574 696d 6527 2c20 2764 6174 6574 696d  etime', 'datetim
+0001ccc0: 655f 666f 726d 6174 273a 2027 6d2f 642f  e_format': 'm/d/
+0001ccd0: 7927 7d7d 0a20 2020 2020 2020 2064 6174  y'}}.        dat
+0001cce0: 6574 696d 655f 666f 726d 6174 5f6d 6f63  etime_format_moc
+0001ccf0: 6b2e 7265 7475 726e 5f76 616c 7565 203d  k.return_value =
+0001cd00: 2054 7275 650a 0a20 2020 2020 2020 2023   True..        #
+0001cd10: 2052 756e 0a20 2020 2020 2020 2053 6361   Run.        Sca
+0001cd20: 6c61 7252 616e 6765 2e5f 7661 6c69 6461  larRange._valida
+0001cd30: 7465 5f6d 6574 6164 6174 615f 7370 6563  te_metadata_spec
+0001cd40: 6966 6963 5f74 6f5f 636f 6e73 7472 6169  ific_to_constrai
+0001cd50: 6e74 280a 2020 2020 2020 2020 2020 2020  nt(.            
+0001cd60: 6d65 7461 6461 7461 2c0a 2020 2020 2020  metadata,.      
+0001cd70: 2020 2020 2020 636f 6c75 6d6e 5f6e 616d        column_nam
+0001cd80: 653d 2761 272c 0a20 2020 2020 2020 2020  e='a',.         
+0001cd90: 2020 206c 6f77 5f76 616c 7565 3d27 312f     low_value='1/
+0001cda0: 312f 3230 3230 272c 0a20 2020 2020 2020  1/2020',.       
+0001cdb0: 2020 2020 2068 6967 685f 7661 6c75 653d       high_value=
+0001cdc0: 2731 2f33 302f 3230 3230 270a 2020 2020  '1/30/2020'.    
+0001cdd0: 2020 2020 290a 0a20 2020 2040 7061 7463      )..    @patc
+0001cde0: 6828 2773 6476 2e63 6f6e 7374 7261 696e  h('sdv.constrain
+0001cdf0: 7473 2e74 6162 756c 6172 2e6d 6174 6368  ts.tabular.match
+0001ce00: 6573 5f64 6174 6574 696d 655f 666f 726d  es_datetime_form
+0001ce10: 6174 2729 0a20 2020 2064 6566 2074 6573  at').    def tes
+0001ce20: 745f 5f76 616c 6964 6174 655f 6d65 7461  t__validate_meta
+0001ce30: 6461 7461 5f73 7065 6369 6669 635f 746f  data_specific_to
+0001ce40: 5f63 6f6e 7374 7261 696e 745f 6869 6768  _constraint_high
+0001ce50: 5f64 6174 6574 696d 655f 6572 726f 7228  _datetime_error(
+0001ce60: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0001ce70: 662c 2064 6174 6574 696d 655f 666f 726d  f, datetime_form
+0001ce80: 6174 5f6d 6f63 6b29 3a0a 2020 2020 2020  at_mock):.      
+0001ce90: 2020 2222 2254 6573 7420 7468 6520 6060    """Test the ``
+0001cea0: 5f76 616c 6964 6174 655f 6d65 7461 6461  _validate_metada
+0001ceb0: 7461 5f73 7065 6369 6669 635f 746f 5f63  ta_specific_to_c
+0001cec0: 6f6e 7374 7261 696e 7460 6020 6d65 7468  onstraint`` meth
+0001ced0: 6f64 2e0a 0a20 2020 2020 2020 2049 6620  od...        If 
+0001cee0: 7468 6520 636f 6c75 6d6e 5f6e 616d 6520  the column_name 
+0001cef0: 6861 7320 616e 2073 6474 7970 6520 6f66  has an sdtype of
+0001cf00: 2064 6174 6574 696d 652c 2061 6e64 2074   datetime, and t
+0001cf10: 6865 2068 6967 685f 7661 6c75 650a 2020  he high_value.  
+0001cf20: 2020 2020 2020 6973 2061 2064 6174 6574        is a datet
+0001cf30: 696d 6520 7374 7269 6e67 2074 6861 7420  ime string that 
+0001cf40: 646f 6573 6e27 7420 6d61 7463 6820 7468  doesn't match th
+0001cf50: 6520 666f 726d 6174 2c20 7468 656e 2061  e format, then a
+0001cf60: 6e20 6572 726f 7220 7368 6f75 6c64 2062  n error should b
+0001cf70: 6520 7261 6973 6564 2e0a 0a20 2020 2020  e raised...     
+0001cf80: 2020 2053 6574 7570 3a0a 2020 2020 2020     Setup:.      
+0001cf90: 2020 2020 2020 2d20 4d65 7461 6461 7461        - Metadata
+0001cfa0: 2077 6974 6820 7468 6520 7364 7479 7065   with the sdtype
+0001cfb0: 2073 6574 2074 6f20 6461 7465 7469 6d65   set to datetime
+0001cfc0: 2061 6e64 2061 2064 6174 6574 696d 655f   and a datetime_
+0001cfd0: 666f 726d 6174 2e0a 2020 2020 2020 2020  format..        
+0001cfe0: 2020 2020 2d20 4d6f 636b 2074 6865 2060      - Mock the `
+0001cff0: 606d 6174 6368 6573 5f64 6174 6574 696d  `matches_datetim
+0001d000: 655f 666f 726d 6174 6060 2066 756e 6374  e_format`` funct
+0001d010: 696f 6e20 746f 2072 6574 7572 6e20 4661  ion to return Fa
+0001d020: 6c73 652c 2074 6865 6e20 5472 7565 2e0a  lse, then True..
+0001d030: 0a20 2020 2020 2020 2049 6e70 7574 3a0a  .        Input:.
+0001d040: 2020 2020 2020 2020 2020 2020 2d20 5468              - Th
+0001d050: 6520 636f 6c75 6d6e 206e 616d 652c 2061  e column name, a
+0001d060: 206c 6f77 5f76 616c 7565 2073 6574 2074   low_value set t
+0001d070: 6f20 6120 6461 7465 7469 6d65 206f 6620  o a datetime of 
+0001d080: 7468 6520 7269 6768 7420 666f 726d 6174  the right format
+0001d090: 2061 6e64 0a20 2020 2020 2020 2020 2020   and.           
+0001d0a0: 2061 2068 6967 685f 7661 6c75 6520 7365   a high_value se
+0001d0b0: 7420 746f 2061 2064 6174 6574 696d 6520  t to a datetime 
+0001d0c0: 6f66 2074 6865 2077 726f 6e67 2066 6f72  of the wrong for
+0001d0d0: 6d61 742e 0a0a 2020 2020 2020 2020 5369  mat...        Si
+0001d0e0: 6465 2065 6666 6563 743a 0a20 2020 2020  de effect:.     
+0001d0f0: 2020 2020 2020 202d 2041 2043 6f6e 7374         - A Const
+0001d100: 7261 696e 744d 6574 6164 6174 6145 7272  raintMetadataErr
+0001d110: 6f72 2073 686f 756c 6420 6265 2072 6169  or should be rai
+0001d120: 7365 642e 0a20 2020 2020 2020 2022 2222  sed..        """
+0001d130: 0a20 2020 2020 2020 2023 2053 6574 7570  .        # Setup
+0001d140: 0a20 2020 2020 2020 206d 6574 6164 6174  .        metadat
+0001d150: 6120 3d20 4d6f 636b 2829 0a20 2020 2020  a = Mock().     
+0001d160: 2020 206d 6574 6164 6174 612e 636f 6c75     metadata.colu
+0001d170: 6d6e 7320 3d20 7b27 6127 3a20 7b27 7364  mns = {'a': {'sd
+0001d180: 7479 7065 273a 2027 6461 7465 7469 6d65  type': 'datetime
+0001d190: 272c 2027 6461 7465 7469 6d65 5f66 6f72  ', 'datetime_for
+0001d1a0: 6d61 7427 3a20 276d 2f64 2f79 277d 7d0a  mat': 'm/d/y'}}.
+0001d1b0: 2020 2020 2020 2020 6461 7465 7469 6d65          datetime
+0001d1c0: 5f66 6f72 6d61 745f 6d6f 636b 2e73 6964  _format_mock.sid
+0001d1d0: 655f 6566 6665 6374 203d 205b 4661 6c73  e_effect = [Fals
+0001d1e0: 652c 2054 7275 655d 0a0a 2020 2020 2020  e, True]..      
+0001d1f0: 2020 2320 5275 6e0a 2020 2020 2020 2020    # Run.        
+0001d200: 6572 726f 725f 6d65 7373 6167 6520 3d20  error_message = 
+0001d210: 280a 2020 2020 2020 2020 2020 2020 2242  (.            "B
+0001d220: 6f74 6820 2768 6967 685f 7661 6c75 6527  oth 'high_value'
+0001d230: 2061 6e64 2027 6c6f 775f 7661 6c75 6527   and 'low_value'
+0001d240: 206d 7573 7420 6265 2061 2064 6174 6574   must be a datet
+0001d250: 696d 6520 7374 7269 6e67 206f 6620 7468  ime string of th
+0001d260: 6520 7269 6768 7420 666f 726d 6174 220a  e right format".
+0001d270: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0001d280: 2020 7769 7468 2070 7974 6573 742e 7261    with pytest.ra
+0001d290: 6973 6573 2843 6f6e 7374 7261 696e 744d  ises(ConstraintM
+0001d2a0: 6574 6164 6174 6145 7272 6f72 2c20 6d61  etadataError, ma
+0001d2b0: 7463 683d 6572 726f 725f 6d65 7373 6167  tch=error_messag
+0001d2c0: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
+0001d2d0: 5363 616c 6172 5261 6e67 652e 5f76 616c  ScalarRange._val
+0001d2e0: 6964 6174 655f 6d65 7461 6461 7461 5f73  idate_metadata_s
+0001d2f0: 7065 6369 6669 635f 746f 5f63 6f6e 7374  pecific_to_const
+0001d300: 7261 696e 7428 0a20 2020 2020 2020 2020  raint(.         
+0001d310: 2020 2020 2020 206d 6574 6164 6174 612c         metadata,
+0001d320: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001d330: 2063 6f6c 756d 6e5f 6e61 6d65 3d27 6127   column_name='a'
+0001d340: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001d350: 2020 6869 6768 5f76 616c 7565 3d27 312f    high_value='1/
+0001d360: 312f 3230 3139 272c 0a20 2020 2020 2020  1/2019',.       
+0001d370: 2020 2020 2020 2020 206c 6f77 5f76 616c           low_val
+0001d380: 7565 3d27 312d 312d 3230 3230 270a 2020  ue='1-1-2020'.  
+0001d390: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+0001d3a0: 2040 7061 7463 6828 2773 6476 2e63 6f6e   @patch('sdv.con
+0001d3b0: 7374 7261 696e 7473 2e74 6162 756c 6172  straints.tabular
+0001d3c0: 2e6d 6174 6368 6573 5f64 6174 6574 696d  .matches_datetim
+0001d3d0: 655f 666f 726d 6174 2729 0a20 2020 2064  e_format').    d
+0001d3e0: 6566 2074 6573 745f 5f76 616c 6964 6174  ef test__validat
+0001d3f0: 655f 6d65 7461 6461 7461 5f73 7065 6369  e_metadata_speci
+0001d400: 6669 635f 746f 5f63 6f6e 7374 7261 696e  fic_to_constrain
+0001d410: 745f 6c6f 775f 6461 7465 7469 6d65 5f65  t_low_datetime_e
+0001d420: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+0001d430: 2020 7365 6c66 2c20 6461 7465 7469 6d65    self, datetime
+0001d440: 5f66 6f72 6d61 745f 6d6f 636b 293a 0a20  _format_mock):. 
+0001d450: 2020 2020 2020 2022 2222 5465 7374 2074         """Test t
+0001d460: 6865 2060 605f 7661 6c69 6461 7465 5f6d  he ``_validate_m
+0001d470: 6574 6164 6174 615f 7370 6563 6966 6963  etadata_specific
+0001d480: 5f74 6f5f 636f 6e73 7472 6169 6e74 6060  _to_constraint``
+0001d490: 206d 6574 686f 642e 0a0a 2020 2020 2020   method...      
+0001d4a0: 2020 4966 2074 6865 2063 6f6c 756d 6e5f    If the column_
+0001d4b0: 6e61 6d65 2068 6173 2061 6e20 7364 7479  name has an sdty
+0001d4c0: 7065 206f 6620 6461 7465 7469 6d65 2c20  pe of datetime, 
+0001d4d0: 616e 6420 7468 6520 6c6f 775f 7661 6c75  and the low_valu
+0001d4e0: 650a 2020 2020 2020 2020 6973 2061 2064  e.        is a d
+0001d4f0: 6174 6574 696d 6520 7374 7269 6e67 2074  atetime string t
+0001d500: 6861 7420 646f 6573 6e27 7420 6d61 7463  hat doesn't matc
+0001d510: 6820 7468 6520 666f 726d 6174 2c20 7468  h the format, th
+0001d520: 656e 2061 6e20 6572 726f 7220 7368 6f75  en an error shou
+0001d530: 6c64 2062 6520 7261 6973 6564 2e0a 0a20  ld be raised... 
+0001d540: 2020 2020 2020 2053 6574 7570 3a0a 2020         Setup:.  
+0001d550: 2020 2020 2020 2020 2020 2d20 4d65 7461            - Meta
+0001d560: 6461 7461 2077 6974 6820 7468 6520 7364  data with the sd
+0001d570: 7479 7065 2073 6574 2074 6f20 6461 7465  type set to date
+0001d580: 7469 6d65 2061 6e64 2061 2064 6174 6574  time and a datet
+0001d590: 696d 655f 666f 726d 6174 2e0a 2020 2020  ime_format..    
+0001d5a0: 2020 2020 2020 2020 2d20 4d6f 636b 2074          - Mock t
+0001d5b0: 6865 2060 606d 6174 6368 6573 5f64 6174  he ``matches_dat
+0001d5c0: 6574 696d 655f 666f 726d 6174 6060 2066  etime_format`` f
+0001d5d0: 756e 6374 696f 6e20 746f 2072 6574 7572  unction to retur
+0001d5e0: 6e20 5472 7565 2c20 7468 656e 2046 616c  n True, then Fal
+0001d5f0: 7365 2e0a 0a20 2020 2020 2020 2049 6e70  se...        Inp
+0001d600: 7574 3a0a 2020 2020 2020 2020 2020 2020  ut:.            
+0001d610: 2d20 5468 6520 636f 6c75 6d6e 206e 616d  - The column nam
+0001d620: 652c 2061 206c 6f77 5f76 616c 7565 2073  e, a low_value s
+0001d630: 6574 2074 6f20 6120 6461 7465 7469 6d65  et to a datetime
+0001d640: 206f 6620 7468 6520 7772 6f6e 6720 666f   of the wrong fo
+0001d650: 726d 6174 2061 6e64 0a20 2020 2020 2020  rmat and.       
+0001d660: 2020 2020 2061 2068 6967 685f 7661 6c75       a high_valu
+0001d670: 6520 7365 7420 746f 2061 2064 6174 6574  e set to a datet
+0001d680: 696d 6520 6f66 2074 6865 2072 6967 6874  ime of the right
+0001d690: 2066 6f72 6d61 742e 0a0a 2020 2020 2020   format...      
+0001d6a0: 2020 5369 6465 2065 6666 6563 743a 0a20    Side effect:. 
+0001d6b0: 2020 2020 2020 2020 2020 202d 2041 2043             - A C
+0001d6c0: 6f6e 7374 7261 696e 744d 6574 6164 6174  onstraintMetadat
+0001d6d0: 6145 7272 6f72 2073 686f 756c 6420 6265  aError should be
+0001d6e0: 2072 6169 7365 642e 0a20 2020 2020 2020   raised..       
+0001d6f0: 2022 2222 0a20 2020 2020 2020 2023 2053   """.        # S
+0001d700: 6574 7570 0a20 2020 2020 2020 206d 6574  etup.        met
+0001d710: 6164 6174 6120 3d20 4d6f 636b 2829 0a20  adata = Mock(). 
+0001d720: 2020 2020 2020 206d 6574 6164 6174 612e         metadata.
+0001d730: 636f 6c75 6d6e 7320 3d20 7b27 6127 3a20  columns = {'a': 
+0001d740: 7b27 7364 7479 7065 273a 2027 6461 7465  {'sdtype': 'date
+0001d750: 7469 6d65 272c 2027 6461 7465 7469 6d65  time', 'datetime
+0001d760: 5f66 6f72 6d61 7427 3a20 276d 2f64 2f79  _format': 'm/d/y
+0001d770: 277d 7d0a 2020 2020 2020 2020 6461 7465  '}}.        date
+0001d780: 7469 6d65 5f66 6f72 6d61 745f 6d6f 636b  time_format_mock
+0001d790: 2e73 6964 655f 6566 6665 6374 203d 205b  .side_effect = [
+0001d7a0: 5472 7565 2c20 4661 6c73 655d 0a0a 2020  True, False]..  
+0001d7b0: 2020 2020 2020 2320 5275 6e0a 2020 2020        # Run.    
+0001d7c0: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
+0001d7d0: 6520 3d20 280a 2020 2020 2020 2020 2020  e = (.          
+0001d7e0: 2020 2242 6f74 6820 2768 6967 685f 7661    "Both 'high_va
+0001d7f0: 6c75 6527 2061 6e64 2027 6c6f 775f 7661  lue' and 'low_va
+0001d800: 6c75 6527 206d 7573 7420 6265 2061 2064  lue' must be a d
+0001d810: 6174 6574 696d 6520 7374 7269 6e67 206f  atetime string o
+0001d820: 6620 7468 6520 7269 6768 7420 666f 726d  f the right form
+0001d830: 6174 220a 2020 2020 2020 2020 290a 2020  at".        ).  
+0001d840: 2020 2020 2020 7769 7468 2070 7974 6573        with pytes
+0001d850: 742e 7261 6973 6573 2843 6f6e 7374 7261  t.raises(Constra
+0001d860: 696e 744d 6574 6164 6174 6145 7272 6f72  intMetadataError
+0001d870: 2c20 6d61 7463 683d 6572 726f 725f 6d65  , match=error_me
+0001d880: 7373 6167 6529 3a0a 2020 2020 2020 2020  ssage):.        
+0001d890: 2020 2020 5363 616c 6172 5261 6e67 652e      ScalarRange.
+0001d8a0: 5f76 616c 6964 6174 655f 6d65 7461 6461  _validate_metada
+0001d8b0: 7461 5f73 7065 6369 6669 635f 746f 5f63  ta_specific_to_c
+0001d8c0: 6f6e 7374 7261 696e 7428 0a20 2020 2020  onstraint(.     
+0001d8d0: 2020 2020 2020 2020 2020 206d 6574 6164             metad
+0001d8e0: 6174 612c 0a20 2020 2020 2020 2020 2020  ata,.           
+0001d8f0: 2020 2020 2063 6f6c 756d 6e5f 6e61 6d65       column_name
+0001d900: 3d27 6127 2c0a 2020 2020 2020 2020 2020  ='a',.          
+0001d910: 2020 2020 2020 6869 6768 5f76 616c 7565        high_value
+0001d920: 3d27 312d 312d 3230 3139 272c 0a20 2020  ='1-1-2019',.   
+0001d930: 2020 2020 2020 2020 2020 2020 206c 6f77               low
+0001d940: 5f76 616c 7565 3d27 312f 312f 3230 3230  _value='1/1/2020
+0001d950: 270a 2020 2020 2020 2020 2020 2020 290a  '.            ).
+0001d960: 0a20 2020 2064 6566 2074 6573 745f 5f76  .    def test__v
+0001d970: 616c 6964 6174 655f 6d65 7461 6461 7461  alidate_metadata
+0001d980: 5f73 7065 6369 6669 635f 746f 5f63 6f6e  _specific_to_con
+0001d990: 7374 7261 696e 745f 6261 645f 7479 7065  straint_bad_type
+0001d9a0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+0001d9b0: 2222 2254 6573 7420 7468 6520 6060 5f76  """Test the ``_v
+0001d9c0: 616c 6964 6174 655f 6d65 7461 6461 7461  alidate_metadata
+0001d9d0: 5f73 7065 6369 6669 635f 746f 5f63 6f6e  _specific_to_con
+0001d9e0: 7374 7261 696e 7460 6020 6d65 7468 6f64  straint`` method
+0001d9f0: 2e0a 0a20 2020 2020 2020 2049 6620 7468  ...        If th
+0001da00: 6520 636f 6c75 6d6e 5f6e 616d 6520 6861  e column_name ha
+0001da10: 7320 616e 2073 6474 7970 6520 7468 6174  s an sdtype that
+0001da20: 2069 7320 6e6f 7420 6120 6461 7465 7469   is not a dateti
+0001da30: 6d65 2073 7472 696e 672c 2069 6e74 206f  me string, int o
+0001da40: 720a 2020 2020 2020 2020 666c 6f61 7420  r.        float 
+0001da50: 7468 656e 2061 6e20 6572 726f 7220 7368  then an error sh
+0001da60: 6f75 6c64 2062 6520 7261 6973 6564 2e0a  ould be raised..
+0001da70: 0a20 2020 2020 2020 2053 6574 7570 3a0a  .        Setup:.
+0001da80: 2020 2020 2020 2020 2020 2020 2d20 4d65              - Me
+0001da90: 7461 6461 7461 2077 6974 6820 7468 6520  tadata with the 
+0001daa0: 7364 7479 7065 2073 6574 2074 6f20 6361  sdtype set to ca
+0001dab0: 7465 676f 7269 6361 6c2e 0a0a 2020 2020  tegorical...    
+0001dac0: 2020 2020 496e 7075 743a 0a20 2020 2020      Input:.     
+0001dad0: 2020 2020 2020 202d 2054 6865 2063 6f6c         - The col
+0001dae0: 756d 6e20 6e61 6d65 2c20 7265 6c61 7469  umn name, relati
+0001daf0: 6f6e 2061 6e64 2076 616c 7565 2e0a 0a20  on and value... 
+0001db00: 2020 2020 2020 2053 6964 6520 6566 6665         Side effe
+0001db10: 6374 3a0a 2020 2020 2020 2020 2020 2020  ct:.            
+0001db20: 2d20 4120 436f 6e73 7472 6169 6e74 4d65  - A ConstraintMe
+0001db30: 7461 6461 7461 4572 726f 7220 7368 6f75  tadataError shou
+0001db40: 6c64 2062 6520 7261 6973 6564 2e0a 2020  ld be raised..  
+0001db50: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0001db60: 2020 2320 5365 7475 700a 2020 2020 2020    # Setup.      
+0001db70: 2020 6d65 7461 6461 7461 203d 204d 6f63    metadata = Moc
+0001db80: 6b28 290a 2020 2020 2020 2020 6d65 7461  k().        meta
+0001db90: 6461 7461 2e63 6f6c 756d 6e73 203d 207b  data.columns = {
+0001dba0: 2761 273a 207b 2773 6474 7970 6527 3a20  'a': {'sdtype': 
+0001dbb0: 2763 6174 6567 6f72 6963 616c 277d 7d0a  'categorical'}}.
+0001dbc0: 0a20 2020 2020 2020 2023 2052 756e 0a20  .        # Run. 
+0001dbd0: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
+0001dbe0: 7361 6765 203d 2028 0a20 2020 2020 2020  sage = (.       
+0001dbf0: 2020 2020 2027 4120 5363 616c 6172 5261       'A ScalarRa
+0001dc00: 6e67 6520 636f 6e73 7472 6169 6e74 2069  nge constraint i
+0001dc10: 7320 6265 696e 6720 6170 706c 6965 6420  s being applied 
+0001dc20: 746f 2063 6f6c 756d 6e73 2077 6974 6820  to columns with 
+0001dc30: 6d69 736d 6174 6368 6564 2073 6474 7970  mismatched sdtyp
+0001dc40: 6573 2e20 270a 2020 2020 2020 2020 2020  es. '.          
+0001dc50: 2020 274e 756d 6572 6963 616c 2063 6f6c    'Numerical col
+0001dc60: 756d 6e73 206d 7573 7420 6265 2063 6f6d  umns must be com
+0001dc70: 7061 7265 6420 746f 2069 6e74 6567 6572  pared to integer
+0001dc80: 206f 7220 666c 6f61 7420 7661 6c75 6573   or float values
+0001dc90: 2e20 270a 2020 2020 2020 2020 2020 2020  . '.            
+0001dca0: 2744 6174 6574 696d 6573 2063 6f6c 756d  'Datetimes colum
+0001dcb0: 6e20 6d75 7374 2062 6520 636f 6d70 6172  n must be compar
+0001dcc0: 6564 2074 6f20 6461 7465 7469 6d65 2073  ed to datetime s
+0001dcd0: 7472 696e 6773 2e27 0a20 2020 2020 2020  trings.'.       
+0001dce0: 2029 0a20 2020 2020 2020 2077 6974 6820   ).        with 
+0001dcf0: 7079 7465 7374 2e72 6169 7365 7328 436f  pytest.raises(Co
+0001dd00: 6e73 7472 6169 6e74 4d65 7461 6461 7461  nstraintMetadata
+0001dd10: 4572 726f 722c 206d 6174 6368 3d65 7272  Error, match=err
+0001dd20: 6f72 5f6d 6573 7361 6765 293a 0a20 2020  or_message):.   
+0001dd30: 2020 2020 2020 2020 2053 6361 6c61 7252           ScalarR
+0001dd40: 616e 6765 2e5f 7661 6c69 6461 7465 5f6d  ange._validate_m
+0001dd50: 6574 6164 6174 615f 7370 6563 6966 6963  etadata_specific
+0001dd60: 5f74 6f5f 636f 6e73 7472 6169 6e74 280a  _to_constraint(.
+0001dd70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001dd80: 6d65 7461 6461 7461 2c0a 2020 2020 2020  metadata,.      
+0001dd90: 2020 2020 2020 2020 2020 636f 6c75 6d6e            column
+0001dda0: 5f6e 616d 653d 2761 272c 0a20 2020 2020  _name='a',.     
+0001ddb0: 2020 2020 2020 2020 2020 2068 6967 685f             high_
+0001ddc0: 7661 6c75 653d 2731 3027 2c0a 2020 2020  value='10',.    
+0001ddd0: 2020 2020 2020 2020 2020 2020 6c6f 775f              low_
+0001dde0: 7661 6c75 653d 2737 270a 2020 2020 2020  value='7'.      
+0001ddf0: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
+0001de00: 2074 6573 745f 5f76 616c 6964 6174 655f   test__validate_
+0001de10: 696e 6974 5f69 6e70 7574 7328 7365 6c66  init_inputs(self
+0001de20: 293a 0a20 2020 2020 2020 2022 2222 5465  ):.        """Te
+0001de30: 7374 2074 6865 2060 605f 7661 6c69 6461  st the ``_valida
+0001de40: 7465 5f69 6e69 745f 696e 7075 7473 6060  te_init_inputs``
+0001de50: 206d 6574 686f 642e 0a0a 2020 2020 2020   method...      
+0001de60: 2020 5468 6520 6d65 7468 6f64 2073 686f    The method sho
+0001de70: 756c 6420 7261 6973 6520 616e 2065 7272  uld raise an err
+0001de80: 6f72 2069 6620 7468 6520 696e 7075 7473  or if the inputs
+0001de90: 2061 7265 206e 6f74 2076 616c 6964 2e0a   are not valid..
+0001dea0: 0a20 2020 2020 2020 2053 6574 7570 3a0a  .        Setup:.
+0001deb0: 2020 2020 2020 2020 2020 2020 2d20 6c6f              - lo
+0001dec0: 775f 7661 6c75 6520 6173 2061 2073 7472  w_value as a str
+0001ded0: 696e 6720 6e6f 7420 7265 7072 6573 656e  ing not represen
+0001dee0: 7469 6e67 2061 2064 6174 6574 696d 652e  ting a datetime.
+0001def0: 0a20 2020 2020 2020 2020 2020 202d 2068  .            - h
+0001df00: 6967 685f 7661 6c75 6520 6173 2061 2069  igh_value as a i
+0001df10: 6e74 2e0a 0a20 2020 2020 2020 2053 6964  nt...        Sid
+0001df20: 6520 4566 6665 6374 733a 0a20 2020 2020  e Effects:.     
+0001df30: 2020 2020 2020 2041 2076 616c 7565 2065         A value e
+0001df40: 7272 6f72 2073 686f 756c 6420 6265 2072  rror should be r
+0001df50: 6169 7365 642e 0a20 2020 2020 2020 2022  aised..        "
+0001df60: 2222 0a20 2020 2020 2020 2023 2053 6574  "".        # Set
+0001df70: 7570 0a20 2020 2020 2020 206c 6f77 5f76  up.        low_v
+0001df80: 616c 7565 203d 2027 6162 6327 0a20 2020  alue = 'abc'.   
+0001df90: 2020 2020 2068 6967 685f 7661 6c75 6520       high_value 
+0001dfa0: 3d20 320a 0a20 2020 2020 2020 2023 2052  = 2..        # R
+0001dfb0: 756e 202f 2041 7373 6572 740a 2020 2020  un / Assert.    
+0001dfc0: 2020 2020 6572 726f 725f 6d73 6720 3d20      error_msg = 
+0001dfd0: 280a 2020 2020 2020 2020 2020 2020 2760  (.            '`
+0001dfe0: 606c 6f77 5f76 616c 7565 6060 2061 6e64  `low_value`` and
+0001dff0: 2060 6068 6967 685f 7661 6c75 6560 6020   ``high_value`` 
+0001e000: 6d75 7374 2062 6520 6120 6e75 6d62 6572  must be a number
+0001e010: 206f 7220 6120 7374 7269 6e67 2074 6861   or a string tha
+0001e020: 7420 270a 2020 2020 2020 2020 2020 2020  t '.            
+0001e030: 2772 6570 7265 7365 6e74 7320 6120 6461  'represents a da
+0001e040: 7465 7469 6d65 2e27 0a20 2020 2020 2020  tetime.'.       
+0001e050: 2029 0a20 2020 2020 2020 2077 6974 6820   ).        with 
+0001e060: 7079 7465 7374 2e72 6169 7365 7328 5661  pytest.raises(Va
+0001e070: 6c75 6545 7272 6f72 2c20 6d61 7463 683d  lueError, match=
+0001e080: 6572 726f 725f 6d73 6729 3a0a 2020 2020  error_msg):.    
+0001e090: 2020 2020 2020 2020 5363 616c 6172 5261          ScalarRa
+0001e0a0: 6e67 652e 5f76 616c 6964 6174 655f 696e  nge._validate_in
+0001e0b0: 6974 5f69 6e70 7574 7328 6c6f 775f 7661  it_inputs(low_va
+0001e0c0: 6c75 652c 2068 6967 685f 7661 6c75 6529  lue, high_value)
+0001e0d0: 0a0a 2020 2020 6465 6620 7465 7374 5f5f  ..    def test__
+0001e0e0: 7661 6c69 6461 7465 5f69 6e69 745f 696e  validate_init_in
+0001e0f0: 7075 7473 5f64 6174 6574 696d 6573 5f6e  puts_datetimes_n
+0001e100: 6f74 5f73 7472 696e 6773 2873 656c 6629  ot_strings(self)
+0001e110: 3a0a 2020 2020 2020 2020 2222 2254 6573  :.        """Tes
+0001e120: 7420 7468 6520 6060 5f76 616c 6964 6174  t the ``_validat
+0001e130: 655f 696e 6974 5f69 6e70 7574 7360 6020  e_init_inputs`` 
+0001e140: 6d65 7468 6f64 2e0a 0a20 2020 2020 2020  method...       
+0001e150: 2054 6865 206d 6574 686f 6420 7368 6f75   The method shou
+0001e160: 6c64 2072 6169 7365 2061 6e20 6572 726f  ld raise an erro
+0001e170: 7220 6966 2074 6865 2064 6174 6574 696d  r if the datetim
+0001e180: 6573 2061 7265 206e 6f74 2072 6570 7265  es are not repre
+0001e190: 7365 6e74 6564 2061 7320 7374 7269 6e67  sented as string
+0001e1a0: 2e0a 0a20 2020 2020 2020 2053 6574 7570  ...        Setup
+0001e1b0: 3a0a 2020 2020 2020 2020 2020 2020 2d20  :.            - 
+0001e1c0: 6c6f 775f 7661 6c75 6520 6173 2060 6070  low_value as ``p
+0001e1d0: 642e 6461 7465 7469 6d65 6060 0a20 2020  d.datetime``.   
+0001e1e0: 2020 2020 2020 2020 202d 2068 6967 685f           - high_
+0001e1f0: 7661 6c75 6520 6173 2060 6070 642e 6461  value as ``pd.da
+0001e200: 7465 7469 6d65 6060 0a0a 2020 2020 2020  tetime``..      
+0001e210: 2020 5369 6465 2045 6666 6563 7473 3a0a    Side Effects:.
+0001e220: 2020 2020 2020 2020 2020 2020 4120 7661              A va
+0001e230: 6c75 6520 6572 726f 7220 7368 6f75 6c64  lue error should
+0001e240: 2062 6520 7261 6973 6564 2e0a 2020 2020   be raised..    
+0001e250: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0001e260: 2320 5365 7475 700a 2020 2020 2020 2020  # Setup.        
+0001e270: 6c6f 775f 7661 6c75 6520 3d20 7064 2e74  low_value = pd.t
+0001e280: 6f5f 6461 7465 7469 6d65 2827 3230 3231  o_datetime('2021
+0001e290: 2d30 322d 3032 2729 0a20 2020 2020 2020  -02-02').       
+0001e2a0: 2068 6967 685f 7661 6c75 6520 3d20 7064   high_value = pd
+0001e2b0: 2e74 6f5f 6461 7465 7469 6d65 2827 3230  .to_datetime('20
+0001e2c0: 3231 2d30 322d 3032 2729 0a0a 2020 2020  21-02-02')..    
+0001e2d0: 2020 2020 2320 5275 6e20 2f20 4173 7365      # Run / Asse
+0001e2e0: 7274 0a20 2020 2020 2020 2077 6974 6820  rt.        with 
+0001e2f0: 7079 7465 7374 2e72 6169 7365 7328 5661  pytest.raises(Va
+0001e300: 6c75 6545 7272 6f72 2c20 6d61 7463 683d  lueError, match=
+0001e310: 2744 6174 6574 696d 6520 6d75 7374 2062  'Datetime must b
+0001e320: 6520 7265 7072 6573 656e 7465 6420 6173  e represented as
+0001e330: 2061 2073 7472 696e 672e 2729 3a0a 2020   a string.'):.  
+0001e340: 2020 2020 2020 2020 2020 5363 616c 6172            Scalar
+0001e350: 5261 6e67 652e 5f76 616c 6964 6174 655f  Range._validate_
+0001e360: 696e 6974 5f69 6e70 7574 7328 6c6f 775f  init_inputs(low_
+0001e370: 7661 6c75 652c 2068 6967 685f 7661 6c75  value, high_valu
+0001e380: 6529 0a0a 2020 2020 6465 6620 7465 7374  e)..    def test
+0001e390: 5f5f 5f69 6e69 745f 5f28 7365 6c66 293a  ___init__(self):
+0001e3a0: 0a20 2020 2020 2020 2022 2222 5465 7374  .        """Test
+0001e3b0: 2074 6865 2060 6053 6361 6c61 7252 616e   the ``ScalarRan
+0001e3c0: 6765 2e5f 5f69 6e69 745f 5f60 6020 6d65  ge.__init__`` me
+0001e3d0: 7468 6f64 2e0a 0a20 2020 2020 2020 2054  thod...        T
+0001e3e0: 6865 2069 6e73 7461 6e63 6520 7368 6f75  he instance shou
+0001e3f0: 6c64 2063 6f6e 7461 696e 2074 6865 206e  ld contain the n
+0001e400: 616d 6520 6f66 2074 6865 2074 6872 6565  ame of the three
+0001e410: 2070 6173 7365 6420 636f 6c75 6d6e 7320   passed columns 
+0001e420: 616e 6420 616c 736f 0a20 2020 2020 2020  and also.       
+0001e430: 2075 7365 2061 6e20 6f70 6572 6174 6f72   use an operator
+0001e440: 2060 603c 6060 2069 6620 6060 7374 7269   ``<`` if ``stri
+0001e450: 6374 5f62 6f75 6e64 6172 6965 7360 6020  ct_boundaries`` 
+0001e460: 6973 2060 6054 7275 6560 6020 6279 2064  is ``True`` by d
+0001e470: 6566 6175 6c74 2e0a 2020 2020 2020 2020  efault..        
+0001e480: 496e 7075 743a 0a20 2020 2020 2020 2020  Input:.         
+0001e490: 2020 202d 2043 6f6c 756d 6e20 6e61 6d65     - Column name
+0001e4a0: 2e0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
+0001e4b0: 4c6f 7765 7220 7661 6c75 652e 0a20 2020  Lower value..   
+0001e4c0: 2020 2020 2020 2020 202d 2048 6967 6820           - High 
+0001e4d0: 7661 6c75 652e 0a20 2020 2020 2020 2022  value..        "
+0001e4e0: 2222 0a20 2020 2020 2020 2023 2052 756e  "".        # Run
+0001e4f0: 0a20 2020 2020 2020 2069 6e73 7461 6e63  .        instanc
+0001e500: 6520 3d20 5363 616c 6172 5261 6e67 6528  e = ScalarRange(
+0001e510: 636f 6c75 6d6e 5f6e 616d 653d 2761 6765  column_name='age
+0001e520: 5f77 6865 6e5f 6a6f 696e 6564 272c 206c  _when_joined', l
+0001e530: 6f77 5f76 616c 7565 3d31 382c 2068 6967  ow_value=18, hig
+0001e540: 685f 7661 6c75 653d 3238 290a 0a20 2020  h_value=28)..   
+0001e550: 2020 2020 2023 2041 7373 6572 740a 2020       # Assert.  
+0001e560: 2020 2020 2020 6173 7365 7274 2069 6e73        assert ins
+0001e570: 7461 6e63 652e 5f63 6f6c 756d 6e5f 6e61  tance._column_na
+0001e580: 6d65 203d 3d20 2761 6765 5f77 6865 6e5f  me == 'age_when_
+0001e590: 6a6f 696e 6564 270a 2020 2020 2020 2020  joined'.        
+0001e5a0: 6173 7365 7274 2069 6e73 7461 6e63 652e  assert instance.
+0001e5b0: 5f6c 6f77 5f76 616c 7565 203d 3d20 3138  _low_value == 18
+0001e5c0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+0001e5d0: 696e 7374 616e 6365 2e5f 6869 6768 5f76  instance._high_v
+0001e5e0: 616c 7565 203d 3d20 3238 0a20 2020 2020  alue == 28.     
+0001e5f0: 2020 2061 7373 6572 7420 696e 7374 616e     assert instan
+0001e600: 6365 2e5f 6f70 6572 6174 6f72 203d 3d20  ce._operator == 
+0001e610: 6f70 6572 6174 6f72 2e6c 740a 0a20 2020  operator.lt..   
+0001e620: 2064 6566 2074 6573 745f 5f5f 696e 6974   def test___init
+0001e630: 5f5f 7374 7269 6374 5f62 6f75 6e64 6172  __strict_boundar
+0001e640: 6965 735f 6661 6c73 6528 7365 6c66 293a  ies_false(self):
+0001e650: 0a20 2020 2020 2020 2022 2222 5465 7374  .        """Test
+0001e660: 2074 6865 2060 6053 6361 6c61 7252 616e   the ``ScalarRan
+0001e670: 6765 2e5f 5f69 6e69 745f 5f60 6020 6d65  ge.__init__`` me
+0001e680: 7468 6f64 2e0a 0a20 2020 2020 2020 2054  thod...        T
+0001e690: 6573 7420 7468 6520 6060 5f5f 696e 6974  est the ``__init
+0001e6a0: 5f5f 6060 206d 6574 686f 6420 7768 656e  __`` method when
+0001e6b0: 2060 6073 7472 6963 745f 626f 756e 6461   ``strict_bounda
+0001e6c0: 7269 6573 6060 2069 7320 6060 4661 6c73  ries`` is ``Fals
+0001e6d0: 6560 602e 0a0a 2020 2020 2020 2020 496e  e``...        In
+0001e6e0: 7075 743a 0a20 2020 2020 2020 2020 2020  put:.           
+0001e6f0: 202d 2054 6872 6565 2063 6f6c 756d 6e20   - Three column 
+0001e700: 6e61 6d65 732e 0a20 2020 2020 2020 2020  names..         
+0001e710: 2020 202d 2060 6073 7472 6963 745f 626f     - ``strict_bo
+0001e720: 756e 6461 7269 6573 3d46 616c 7365 6060  undaries=False``
+0001e730: 2e0a 0a20 2020 2020 2020 2053 6964 6520  ...        Side 
+0001e740: 4566 6665 6374 3a0a 2020 2020 2020 2020  Effect:.        
+0001e750: 2020 2020 2d20 6060 696e 7374 616e 6365      - ``instance
+0001e760: 2e5f 6f70 6572 6174 6f72 6060 2073 686f  ._operator`` sho
+0001e770: 756c 6420 6265 2060 606f 7065 7261 746f  uld be ``operato
+0001e780: 722e 6c65 6060 0a20 2020 2020 2020 2022  r.le``.        "
+0001e790: 2222 0a20 2020 2020 2020 2023 2052 756e  "".        # Run
+0001e7a0: 0a20 2020 2020 2020 2069 6e73 7461 6e63  .        instanc
+0001e7b0: 6520 3d20 5363 616c 6172 5261 6e67 6528  e = ScalarRange(
+0001e7c0: 2761 6765 5f77 6865 6e5f 6a6f 696e 6564  'age_when_joined
+0001e7d0: 272c 2031 382c 2032 382c 2073 7472 6963  ', 18, 28, stric
+0001e7e0: 745f 626f 756e 6461 7269 6573 3d46 616c  t_boundaries=Fal
+0001e7f0: 7365 290a 0a20 2020 2020 2020 2023 2041  se)..        # A
+0001e800: 7373 6572 740a 2020 2020 2020 2020 6173  ssert.        as
+0001e810: 7365 7274 2069 6e73 7461 6e63 652e 5f63  sert instance._c
+0001e820: 6f6c 756d 6e5f 6e61 6d65 203d 3d20 2761  olumn_name == 'a
+0001e830: 6765 5f77 6865 6e5f 6a6f 696e 6564 270a  ge_when_joined'.
+0001e840: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
+0001e850: 6e73 7461 6e63 652e 5f6c 6f77 5f76 616c  nstance._low_val
+0001e860: 7565 203d 3d20 3138 0a20 2020 2020 2020  ue == 18.       
+0001e870: 2061 7373 6572 7420 696e 7374 616e 6365   assert instance
+0001e880: 2e5f 6869 6768 5f76 616c 7565 203d 3d20  ._high_value == 
+0001e890: 3238 0a20 2020 2020 2020 2061 7373 6572  28.        asser
+0001e8a0: 7420 696e 7374 616e 6365 2e5f 6f70 6572  t instance._oper
+0001e8b0: 6174 6f72 203d 3d20 6f70 6572 6174 6f72  ator == operator
+0001e8c0: 2e6c 650a 0a20 2020 2064 6566 2074 6573  .le..    def tes
+0001e8d0: 745f 5f67 6574 5f69 735f 6461 7465 7469  t__get_is_dateti
+0001e8e0: 6d65 2873 656c 6629 3a0a 2020 2020 2020  me(self):.      
+0001e8f0: 2020 2222 2254 6573 7420 7468 6174 2074    """Test that t
+0001e900: 6865 206d 6574 686f 6420 6465 7465 6374  he method detect
+0001e910: 7320 7768 6574 6865 7220 6f72 206e 6f74  s whether or not
+0001e920: 2074 6865 2060 6064 6174 6160 6020 6973   the ``data`` is
+0001e930: 2060 6064 6174 6574 696d 6560 602e 0a0a   ``datetime``...
+0001e940: 2020 2020 2020 2020 5468 6973 206d 6574          This met
+0001e950: 686f 6420 7368 6f75 6c64 2064 6574 6563  hod should detec
+0001e960: 7420 7768 6574 6865 7220 6f72 206e 6f74  t whether or not
+0001e970: 2074 6865 2064 6174 6120 6973 2060 6064   the data is ``d
+0001e980: 6174 6574 696d 6560 6020 616e 6420 6966  atetime`` and if
+0001e990: 2069 6e20 6361 7365 2073 6f6d 6520 6973   in case some is
+0001e9a0: 0a20 2020 2020 2020 2062 7574 206f 7468  .        but oth
+0001e9b0: 6572 2069 7320 6e6f 742c 2072 6169 7365  er is not, raise
+0001e9c0: 7320 616e 2065 7272 6f72 2e0a 0a20 2020  s an error...   
+0001e9d0: 2020 2020 2053 6574 7570 3a0a 2020 2020       Setup:.    
+0001e9e0: 2020 2020 2020 2020 2d20 4372 6561 7465          - Create
+0001e9f0: 2061 2070 642e 4461 7461 4672 616d 6520   a pd.DataFrame 
+0001ea00: 7769 7468 2061 2063 6f6c 756d 6e20 7468  with a column th
+0001ea10: 6174 2063 6f6e 7461 696e 7320 6461 7465  at contains date
+0001ea20: 7469 6d65 2064 6174 612e 0a20 2020 2020  time data..     
+0001ea30: 2020 2020 2020 202d 2049 6e73 7461 6e63         - Instanc
+0001ea40: 6520 6f66 2060 6053 6361 6c61 7252 616e  e of ``ScalarRan
+0001ea50: 6765 6060 2063 6f6e 7374 7261 696e 7420  ge`` constraint 
+0001ea60: 7769 7468 206c 6f77 2061 6e64 2068 6967  with low and hig
+0001ea70: 6820 6173 2064 6174 6574 696d 6520 2874  h as datetime (t
+0001ea80: 696d 6573 7461 6d70 7329 2e0a 0a20 2020  imestamps)...   
+0001ea90: 2020 2020 2049 6e70 7574 3a0a 2020 2020       Input:.    
+0001eaa0: 2020 2020 2020 2020 2d20 7064 2e44 6174          - pd.Dat
+0001eab0: 6146 7261 6d65 2077 6974 6820 6060 7072  aFrame with ``pr
+0001eac0: 6f6d 6f74 696f 6e5f 6461 7465 6060 2063  omotion_date`` c
+0001ead0: 6f6c 756d 6e2e 0a0a 2020 2020 2020 2020  olumn...        
+0001eae0: 4f75 7470 7574 3a0a 2020 2020 2020 2020  Output:.        
+0001eaf0: 2020 2020 2d20 5468 6520 6f75 7470 7574      - The output
+0001eb00: 2073 686f 756c 6420 6265 2054 7275 652e   should be True.
+0001eb10: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0001eb20: 2020 2020 2023 2053 6574 7570 0a20 2020       # Setup.   
+0001eb30: 2020 2020 2074 6162 6c65 5f64 6174 6120       table_data 
+0001eb40: 3d20 7064 2e44 6174 6146 7261 6d65 287b  = pd.DataFrame({
+0001eb50: 0a20 2020 2020 2020 2020 2020 2027 7072  .            'pr
+0001eb60: 6f6d 6f74 696f 6e5f 6461 7465 273a 2070  omotion_date': p
+0001eb70: 642e 746f 5f64 6174 6574 696d 6528 5b27  d.to_datetime(['
+0001eb80: 3230 3232 2d30 352d 3130 272c 2027 3230  2022-05-10', '20
+0001eb90: 3232 2d30 362d 3130 272c 2027 3230 3232  22-06-10', '2022
+0001eba0: 2d31 312d 3137 275d 292c 0a20 2020 2020  -11-17']),.     
+0001ebb0: 2020 207d 290a 2020 2020 2020 2020 696e     }).        in
+0001ebc0: 7374 616e 6365 203d 2053 6361 6c61 7252  stance = ScalarR
+0001ebd0: 616e 6765 2827 7072 6f6d 6f74 696f 6e5f  ange('promotion_
+0001ebe0: 6461 7465 272c 2027 3230 3231 2d30 322d  date', '2021-02-
+0001ebf0: 3130 272c 2027 3230 3530 2d31 302d 3131  10', '2050-10-11
+0001ec00: 2729 0a0a 2020 2020 2020 2020 2320 5275  ')..        # Ru
+0001ec10: 6e0a 2020 2020 2020 2020 6973 5f64 6174  n.        is_dat
+0001ec20: 6574 696d 6520 3d20 696e 7374 616e 6365  etime = instance
+0001ec30: 2e5f 6765 745f 6973 5f64 6174 6574 696d  ._get_is_datetim
+0001ec40: 6528 7461 626c 655f 6461 7461 290a 0a20  e(table_data).. 
+0001ec50: 2020 2020 2020 2023 2041 7373 6572 740a         # Assert.
+0001ec60: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
+0001ec70: 735f 6461 7465 7469 6d65 0a0a 2020 2020  s_datetime..    
+0001ec80: 6465 6620 7465 7374 5f5f 6765 745f 6973  def test__get_is
+0001ec90: 5f64 6174 6574 696d 655f 6e6f 5f64 6174  _datetime_no_dat
+0001eca0: 6574 696d 6573 2873 656c 6629 3a0a 2020  etimes(self):.  
+0001ecb0: 2020 2020 2020 2222 2254 6573 7420 7468        """Test th
+0001ecc0: 6174 2074 6865 206d 6574 686f 6420 6465  at the method de
+0001ecd0: 7465 6374 7320 7768 6574 6865 7220 6f72  tects whether or
+0001ece0: 206e 6f74 2074 6865 2060 6064 6174 6160   not the ``data`
+0001ecf0: 6020 6973 2060 6064 6174 6574 696d 6560  ` is ``datetime`
+0001ed00: 602e 0a0a 2020 2020 2020 2020 5468 6973  `...        This
+0001ed10: 206d 6574 686f 6420 7368 6f75 6c64 2064   method should d
+0001ed20: 6574 6563 7420 7768 6574 6865 7220 6f72  etect whether or
+0001ed30: 206e 6f74 2074 6865 2064 6174 6120 6973   not the data is
+0001ed40: 2060 6064 6174 6574 696d 6560 6020 616e   ``datetime`` an
+0001ed50: 6420 6966 2069 6e20 6361 7365 2073 6f6d  d if in case som
+0001ed60: 6520 6973 0a20 2020 2020 2020 2062 7574  e is.        but
+0001ed70: 206f 7468 6572 2069 7320 6e6f 742c 2072   other is not, r
+0001ed80: 6169 7365 7320 616e 2065 7272 6f72 2e0a  aises an error..
+0001ed90: 0a20 2020 2020 2020 2053 6574 7570 3a0a  .        Setup:.
+0001eda0: 2020 2020 2020 2020 2020 2020 2d20 4372              - Cr
+0001edb0: 6561 7465 2061 2070 642e 4461 7461 4672  eate a pd.DataFr
+0001edc0: 616d 6520 7769 7468 2061 2063 6f6c 756d  ame with a colum
+0001edd0: 6e20 7468 6174 2069 7320 6e6f 7420 6461  n that is not da
+0001ede0: 7461 7469 6d65 2e0a 2020 2020 2020 2020  tatime..        
+0001edf0: 2020 2020 2d20 496e 7374 616e 6365 206f      - Instance o
+0001ee00: 6620 6060 5363 616c 6172 5261 6e67 6560  f ``ScalarRange`
+0001ee10: 6020 636f 6e73 7472 6169 6e74 2077 6974  ` constraint wit
+0001ee20: 6820 6c6f 7720 616e 6420 6869 6768 2061  h low and high a
+0001ee30: 7320 696e 7465 6765 7273 2e0a 0a20 2020  s integers...   
+0001ee40: 2020 2020 2049 6e70 7574 3a0a 2020 2020       Input:.    
+0001ee50: 2020 2020 2020 2020 2d20 7064 2e44 6174          - pd.Dat
+0001ee60: 6146 7261 6d65 2077 6974 6820 6060 6375  aFrame with ``cu
+0001ee70: 7272 656e 745f 6167 6560 600a 0a20 2020  rrent_age``..   
+0001ee80: 2020 2020 204f 7574 7075 743a 0a20 2020       Output:.   
+0001ee90: 2020 2020 2020 2020 202d 2054 6865 206f           - The o
+0001eea0: 7574 7075 7420 7368 6f75 6c64 2062 6520  utput should be 
+0001eeb0: 6661 6c73 6520 7369 6e63 6520 616c 6c20  false since all 
+0001eec0: 7468 6520 6461 7461 2069 7320 6060 696e  the data is ``in
+0001eed0: 7460 602e 0a20 2020 2020 2020 2022 2222  t``..        """
+0001eee0: 0a20 2020 2020 2020 2023 2053 6574 7570  .        # Setup
+0001eef0: 0a20 2020 2020 2020 2074 6162 6c65 5f64  .        table_d
+0001ef00: 6174 6120 3d20 7064 2e44 6174 6146 7261  ata = pd.DataFra
+0001ef10: 6d65 287b 2763 7572 7265 6e74 5f61 6765  me({'current_age
+0001ef20: 273a 205b 3231 2c20 3232 2c20 3235 5d7d  ': [21, 22, 25]}
+0001ef30: 290a 2020 2020 2020 2020 696e 7374 616e  ).        instan
+0001ef40: 6365 203d 2053 6361 6c61 7252 616e 6765  ce = ScalarRange
+0001ef50: 2827 6375 7272 656e 745f 6167 6527 2c20  ('current_age', 
+0001ef60: 3231 2c20 3330 290a 0a20 2020 2020 2020  21, 30)..       
+0001ef70: 2023 2052 756e 0a20 2020 2020 2020 2069   # Run.        i
+0001ef80: 735f 6461 7465 7469 6d65 203d 2069 6e73  s_datetime = ins
+0001ef90: 7461 6e63 652e 5f67 6574 5f69 735f 6461  tance._get_is_da
+0001efa0: 7465 7469 6d65 2874 6162 6c65 5f64 6174  tetime(table_dat
+0001efb0: 6129 0a0a 2020 2020 2020 2020 2320 4173  a)..        # As
+0001efc0: 7365 7274 0a20 2020 2020 2020 2061 7373  sert.        ass
+0001efd0: 6572 7420 6e6f 7420 6973 5f64 6174 6574  ert not is_datet
+0001efe0: 696d 650a 0a20 2020 2064 6566 2074 6573  ime..    def tes
+0001eff0: 745f 5f67 6574 5f69 735f 6461 7465 7469  t__get_is_dateti
+0001f000: 6d65 5f72 6169 7365 735f 616e 5f65 7272  me_raises_an_err
+0001f010: 6f72 2873 656c 6629 3a0a 2020 2020 2020  or(self):.      
+0001f020: 2020 2222 2254 6573 7420 7468 6174 2074    """Test that t
+0001f030: 6865 206d 6574 686f 6420 6465 7465 6374  he method detect
+0001f040: 7320 7768 6574 6865 7220 6f72 206e 6f74  s whether or not
+0001f050: 2074 6865 2060 6064 6174 6160 6020 6973   the ``data`` is
+0001f060: 2060 6064 6174 6574 696d 6560 602e 0a0a   ``datetime``...
+0001f070: 2020 2020 2020 2020 5468 6973 206d 6574          This met
+0001f080: 686f 6420 7368 6f75 6c64 2064 6574 6563  hod should detec
+0001f090: 7420 7768 6574 6865 7220 6f72 206e 6f74  t whether or not
+0001f0a0: 2074 6865 2064 6174 6120 6973 2060 6064   the data is ``d
+0001f0b0: 6174 6574 696d 6560 6020 616e 6420 6966  atetime`` and if
+0001f0c0: 2069 6e20 6361 7365 2073 6f6d 6520 6973   in case some is
+0001f0d0: 0a20 2020 2020 2020 2062 7574 206f 7468  .        but oth
+0001f0e0: 6572 2069 7320 6e6f 742c 2072 6169 7365  er is not, raise
+0001f0f0: 7320 616e 2065 7272 6f72 2e0a 0a20 2020  s an error...   
+0001f100: 2020 2020 2053 6574 7570 3a0a 2020 2020       Setup:.    
+0001f110: 2020 2020 2020 2020 2d20 4372 6561 7465          - Create
+0001f120: 2061 2070 642e 4461 7461 4672 616d 6520   a pd.DataFrame 
+0001f130: 7769 7468 2061 2063 6f6c 756d 6e20 7468  with a column th
+0001f140: 6174 2063 6f6e 7461 696e 7320 6461 7465  at contains date
+0001f150: 7469 6d65 2064 6174 612e 0a20 2020 2020  time data..     
+0001f160: 2020 2020 2020 202d 2049 6e73 7461 6e63         - Instanc
+0001f170: 6520 6f66 2060 6053 6361 6c61 7252 616e  e of ``ScalarRan
+0001f180: 6765 6060 2063 6f6e 7374 7261 696e 7420  ge`` constraint 
+0001f190: 7769 7468 206c 6f77 2061 6e64 2068 6967  with low and hig
+0001f1a0: 6820 6173 2069 6e74 6567 6572 732e 0a0a  h as integers...
+0001f1b0: 2020 2020 2020 2020 496e 7075 743a 0a20          Input:. 
+0001f1c0: 2020 2020 2020 2020 2020 202d 2070 642e             - pd.
+0001f1d0: 4461 7461 4672 616d 6520 7769 7468 2020  DataFrame with  
+0001f1e0: 6060 7072 6f6d 6f74 696f 6e5f 6461 7465  ``promotion_date
+0001f1f0: 6060 2e0a 0a20 2020 2020 2020 204f 7574  ``...        Out
+0001f200: 7075 743a 0a20 2020 2020 2020 2020 2020  put:.           
+0001f210: 202d 2054 6865 206f 7574 7075 7420 7368   - The output sh
+0001f220: 6f75 6c64 2062 6520 6661 6c73 6520 7369  ould be false si
+0001f230: 6e63 6520 616c 6c20 7468 6520 6461 7461  nce all the data
+0001f240: 2069 7320 6060 696e 7460 602e 0a20 2020   is ``int``..   
+0001f250: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0001f260: 2023 2053 6574 7570 0a20 2020 2020 2020   # Setup.       
+0001f270: 2074 6162 6c65 5f64 6174 6120 3d20 7064   table_data = pd
+0001f280: 2e44 6174 6146 7261 6d65 287b 0a20 2020  .DataFrame({.   
+0001f290: 2020 2020 2020 2020 2027 7072 6f6d 6f74           'promot
+0001f2a0: 696f 6e5f 6461 7465 273a 2070 642e 746f  ion_date': pd.to
+0001f2b0: 5f64 6174 6574 696d 6528 5b27 3230 3232  _datetime(['2022
+0001f2c0: 2d30 352d 3130 272c 2027 3230 3232 2d30  -05-10', '2022-0
+0001f2d0: 362d 3130 272c 2027 3230 3232 2d31 312d  6-10', '2022-11-
+0001f2e0: 3137 275d 292c 0a20 2020 2020 2020 207d  17']),.        }
+0001f2f0: 290a 2020 2020 2020 2020 696e 7374 616e  ).        instan
+0001f300: 6365 203d 2053 6361 6c61 7252 616e 6765  ce = ScalarRange
+0001f310: 2827 7072 6f6d 6f74 696f 6e5f 6461 7465  ('promotion_date
+0001f320: 272c 2031 382c 2032 3529 0a20 2020 2020  ', 18, 25).     
+0001f330: 2020 2065 7870 6563 7465 645f 7465 7874     expected_text
+0001f340: 203d 2027 5468 6520 636f 6e73 7472 6169   = 'The constrai
+0001f350: 6e74 2063 6f6c 756d 6e20 616e 6420 626f  nt column and bo
+0001f360: 756e 6473 206d 7573 7420 616c 6c20 6265  unds must all be
+0001f370: 2064 6174 6574 696d 652e 270a 0a20 2020   datetime.'..   
+0001f380: 2020 2020 2023 2052 756e 0a20 2020 2020       # Run.     
+0001f390: 2020 2077 6974 6820 7079 7465 7374 2e72     with pytest.r
+0001f3a0: 6169 7365 7328 5661 6c75 6545 7272 6f72  aises(ValueError
+0001f3b0: 2c20 6d61 7463 683d 6578 7065 6374 6564  , match=expected
+0001f3c0: 5f74 6578 7429 3a0a 2020 2020 2020 2020  _text):.        
+0001f3d0: 2020 2020 696e 7374 616e 6365 2e5f 6765      instance._ge
+0001f3e0: 745f 6973 5f64 6174 6574 696d 6528 7461  t_is_datetime(ta
+0001f3f0: 626c 655f 6461 7461 290a 0a20 2020 2064  ble_data)..    d
+0001f400: 6566 2074 6573 745f 5f67 6574 5f64 6966  ef test__get_dif
+0001f410: 665f 636f 6c75 6d6e 5f6e 616d 6528 7365  f_column_name(se
+0001f420: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+0001f430: 5465 7374 2074 6865 2060 6053 6361 6c61  Test the ``Scala
+0001f440: 7252 616e 6765 2e5f 6765 745f 6469 6666  rRange._get_diff
+0001f450: 5f63 6f6c 756d 6e5f 6e61 6d65 6060 206d  _column_name`` m
+0001f460: 6574 686f 642e 0a0a 2020 2020 2020 2020  ethod...        
+0001f470: 5468 6973 206d 6574 686f 6420 7368 6f75  This method shou
+0001f480: 6c64 2072 6574 7572 6e20 7468 6520 6e61  ld return the na
+0001f490: 6d65 2066 6f72 2074 6865 206e 6577 2060  me for the new `
+0001f4a0: 6074 7261 6e73 666f 726d 5f63 6f6c 756d  `transform_colum
+0001f4b0: 6e60 602e 0a0a 2020 2020 2020 2020 5365  n``...        Se
+0001f4c0: 7475 703a 0a20 2020 2020 2020 2020 2020  tup:.           
+0001f4d0: 202d 2043 7265 6174 6520 6120 7064 2e44   - Create a pd.D
+0001f4e0: 6174 6146 7261 6d65 2e0a 2020 2020 2020  ataFrame..      
+0001f4f0: 2020 2020 2020 2d20 496e 7374 616e 6365        - Instance
+0001f500: 206f 6620 6060 5363 616c 6172 5261 6e67   of ``ScalarRang
+0001f510: 6560 6020 636f 6e73 7472 6169 6e74 2e0a  e`` constraint..
+0001f520: 0a20 2020 2020 2020 2049 6e70 7574 3a0a  .        Input:.
+0001f530: 2020 2020 2020 2020 2020 2020 2d20 7064              - pd
+0001f540: 2e44 6174 6146 7261 6d65 2077 6974 6820  .DataFrame with 
+0001f550: 6060 6375 7272 656e 745f 6167 6560 6020  ``current_age`` 
+0001f560: 636f 6c75 6d6e 2e0a 0a20 2020 2020 2020  column...       
+0001f570: 204f 7574 7075 743a 0a20 2020 2020 2020   Output:.       
+0001f580: 2020 2020 202d 2054 6865 2063 6f6c 756d       - The colum
+0001f590: 6e20 6e61 6d65 2063 6f6e 6361 7465 6e61  n name concatena
+0001f5a0: 7465 6420 7769 7468 2060 6023 6060 2066  ted with ``#`` f
+0001f5b0: 6f6c 6c6f 7765 6420 6279 2074 6865 2060  ollowed by the `
+0001f5c0: 606c 6f77 6060 2061 6e64 2060 6068 6967  `low`` and ``hig
+0001f5d0: 6860 6020 7661 6c75 6573 2e0a 2020 2020  h`` values..    
+0001f5e0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0001f5f0: 2320 5365 7475 700a 2020 2020 2020 2020  # Setup.        
+0001f600: 7461 626c 655f 6461 7461 203d 2070 642e  table_data = pd.
+0001f610: 4461 7461 4672 616d 6528 7b0a 2020 2020  DataFrame({.    
+0001f620: 2020 2020 2020 2020 2763 7572 7265 6e74          'current
+0001f630: 5f61 6765 273a 205b 3231 2c20 3232 2c20  _age': [21, 22, 
+0001f640: 3235 5d2c 0a20 2020 2020 2020 2020 2020  25],.           
+0001f650: 2027 6375 7272 656e 745f 6167 6523 3138   'current_age#18
+0001f660: 2333 3527 3a20 5b31 2c20 322c 2033 5d0a  #35': [1, 2, 3].
+0001f670: 2020 2020 2020 2020 7d29 0a20 2020 2020          }).     
+0001f680: 2020 2069 6e73 7461 6e63 6520 3d20 5363     instance = Sc
+0001f690: 616c 6172 5261 6e67 6528 2763 7572 7265  alarRange('curre
+0001f6a0: 6e74 5f61 6765 272c 2031 382c 2033 3529  nt_age', 18, 35)
+0001f6b0: 0a0a 2020 2020 2020 2020 2320 5275 6e0a  ..        # Run.
+0001f6c0: 2020 2020 2020 2020 7472 616e 7366 6f72          transfor
+0001f6d0: 6d65 645f 636f 6c75 6d6e 5f6e 616d 6520  med_column_name 
+0001f6e0: 3d20 696e 7374 616e 6365 2e5f 6765 745f  = instance._get_
+0001f6f0: 6469 6666 5f63 6f6c 756d 6e5f 6e61 6d65  diff_column_name
+0001f700: 2874 6162 6c65 5f64 6174 6129 0a0a 2020  (table_data)..  
+0001f710: 2020 2020 2020 2320 4173 7365 7274 0a20        # Assert. 
+0001f720: 2020 2020 2020 2061 7373 6572 7420 7472         assert tr
+0001f730: 616e 7366 6f72 6d65 645f 636f 6c75 6d6e  ansformed_column
+0001f740: 5f6e 616d 6520 3d3d 2027 6375 7272 656e  _name == 'curren
+0001f750: 745f 6167 6523 2331 3823 2333 3527 0a0a  t_age##18##35'..
+0001f760: 2020 2020 6465 6620 7465 7374 5f5f 6669      def test__fi
+0001f770: 7428 7365 6c66 293a 0a20 2020 2020 2020  t(self):.       
+0001f780: 2022 2222 5465 7374 2074 6865 2060 605f   """Test the ``_
+0001f790: 6669 7460 6020 6d65 7468 6f64 206f 6620  fit`` method of 
+0001f7a0: 6060 5363 616c 6172 5261 6e67 6560 602e  ``ScalarRange``.
+0001f7b0: 0a0a 2020 2020 2020 2020 5465 7374 2074  ..        Test t
+0001f7c0: 6861 7420 7468 6520 6060 5f66 6974 6060  hat the ``_fit``
+0001f7d0: 206d 6574 686f 6420 7374 6f72 6573 2074   method stores t
+0001f7e0: 6865 2070 726f 7065 7220 7472 616e 7366  he proper transf
+0001f7f0: 6f72 6d61 7469 6f6e 2063 6f6c 756d 6e20  ormation column 
+0001f800: 6e61 6d65 2061 6e64 0a20 2020 2020 2020  name and.       
+0001f810: 206c 6561 726e 7320 7768 6574 6865 7220   learns whether 
+0001f820: 7468 6520 6461 7461 2069 7320 6060 6461  the data is ``da
+0001f830: 7465 7469 6d65 6060 6f72 206e 6f74 2061  tetime``or not a
+0001f840: 6e64 2069 7427 7320 6060 6474 7970 6560  nd it's ``dtype`
+0001f850: 602e 0a0a 2020 2020 2020 2020 5365 7475  `...        Setu
+0001f860: 703a 0a20 2020 2020 2020 2020 2020 202d  p:.            -
+0001f870: 2043 7265 6174 6520 6120 7064 2e44 6174   Create a pd.Dat
+0001f880: 6146 7261 6d65 2077 6974 6820 6120 636f  aFrame with a co
+0001f890: 6c75 6d6e 2e0a 2020 2020 2020 2020 2020  lumn..          
+0001f8a0: 2020 2d20 496e 7374 616e 6365 206f 6620    - Instance of 
+0001f8b0: 6060 5363 616c 6172 5261 6e67 6560 6020  ``ScalarRange`` 
+0001f8c0: 636f 6e73 7472 6169 6e74 2077 6974 6820  constraint with 
+0001f8d0: 7468 6f73 6520 7468 7265 6520 636f 6c75  those three colu
+0001f8e0: 6d6e 206e 616d 6573 2e0a 0a20 2020 2020  mn names...     
+0001f8f0: 2020 2049 6e70 7574 3a0a 2020 2020 2020     Input:.      
+0001f900: 2020 2020 2020 2d20 7064 2e44 6174 6146        - pd.DataF
+0001f910: 7261 6d65 2077 6974 6820 6060 6375 7272  rame with ``curr
+0001f920: 656e 745f 6167 6560 6020 636f 6c75 6d6e  ent_age`` column
+0001f930: 732e 0a0a 2020 2020 2020 2020 5369 6465  s...        Side
+0001f940: 2045 6666 6563 743a 0a20 2020 2020 2020   Effect:.       
+0001f950: 2020 2020 202d 2069 6e73 7461 6e63 6520       - instance 
+0001f960: 6861 7320 6060 5f74 7261 6e73 666f 726d  has ``_transform
+0001f970: 6564 5f63 6f6c 756d 6e60 6020 616e 6420  ed_column`` and 
+0001f980: 6060 5f69 735f 6461 7465 7469 6d65 6060  ``_is_datetime``
+0001f990: 2061 6e64 2060 605f 6474 7970 6560 602e   and ``_dtype``.
+0001f9a0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0001f9b0: 2020 2020 2023 2053 6574 7570 0a20 2020       # Setup.   
+0001f9c0: 2020 2020 2074 6162 6c65 5f64 6174 6120       table_data 
+0001f9d0: 3d20 7064 2e44 6174 6146 7261 6d65 287b  = pd.DataFrame({
+0001f9e0: 2763 7572 7265 6e74 5f61 6765 273a 205b  'current_age': [
+0001f9f0: 3231 2c20 3232 2c20 3235 5d7d 290a 2020  21, 22, 25]}).  
+0001fa00: 2020 2020 2020 696e 7374 616e 6365 203d        instance =
+0001fa10: 2053 6361 6c61 7252 616e 6765 2827 6375   ScalarRange('cu
+0001fa20: 7272 656e 745f 6167 6527 2c20 3138 2c20  rrent_age', 18, 
+0001fa30: 3230 290a 0a20 2020 2020 2020 2023 2052  20)..        # R
+0001fa40: 756e 0a20 2020 2020 2020 2069 6e73 7461  un.        insta
+0001fa50: 6e63 652e 5f66 6974 2874 6162 6c65 5f64  nce._fit(table_d
+0001fa60: 6174 6129 0a0a 2020 2020 2020 2020 2320  ata)..        # 
+0001fa70: 4173 7365 7274 0a20 2020 2020 2020 2061  Assert.        a
+0001fa80: 7373 6572 7420 6e6f 7420 696e 7374 616e  ssert not instan
+0001fa90: 6365 2e5f 6973 5f64 6174 6574 696d 650a  ce._is_datetime.
+0001faa0: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
+0001fab0: 6e73 7461 6e63 652e 5f74 7261 6e73 666f  nstance._transfo
+0001fac0: 726d 6564 5f63 6f6c 756d 6e20 3d3d 2027  rmed_column == '
+0001fad0: 6375 7272 656e 745f 6167 6523 3138 2332  current_age#18#2
+0001fae0: 3027 0a0a 2020 2020 6465 6620 7465 7374  0'..    def test
+0001faf0: 5f5f 6669 745f 6461 7465 7469 6d65 2873  __fit_datetime(s
+0001fb00: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
+0001fb10: 2254 6573 7420 7468 6520 6060 5f66 6974  "Test the ``_fit
+0001fb20: 6060 206d 6574 686f 6420 6f66 2060 6053  `` method of ``S
+0001fb30: 6361 6c61 7252 616e 6765 6060 2077 6865  calarRange`` whe
+0001fb40: 6e20 6669 7474 696e 6720 7769 7468 2060  n fitting with `
+0001fb50: 6064 6174 6574 696d 6560 6020 6461 7461  `datetime`` data
+0001fb60: 2e0a 0a20 2020 2020 2020 2053 6574 7570  ...        Setup
+0001fb70: 3a0a 2020 2020 2020 2020 2020 2020 2d20  :.            - 
+0001fb80: 7461 626c 655f 6461 7461 2077 6974 6820  table_data with 
+0001fb90: 6461 7465 7469 6d65 732e 0a0a 2020 2020  datetimes...    
+0001fba0: 2020 2020 5369 6465 2045 6666 6563 7473      Side Effects
+0001fbb0: 3a0a 2020 2020 2020 2020 2020 2020 2d20  :.            - 
+0001fbc0: 5468 6520 6060 696e 7374 616e 6365 2e5f  The ``instance._
+0001fbd0: 6c6f 775f 7661 6c75 6560 6020 616e 6420  low_value`` and 
+0001fbe0: 6060 c3ac 6e73 7461 6e63 652e 5f68 6967  ``..nstance._hig
+0001fbf0: 685f 7661 6c75 6560 6020 6861 7665 2062  h_value`` have b
+0001fc00: 6565 6e20 636f 6e76 6572 7465 640a 2020  een converted.  
+0001fc10: 2020 2020 2020 2020 2020 2020 746f 2060              to `
+0001fc20: 6070 642e 6461 7465 7469 6d65 6060 0a20  `pd.datetime``. 
+0001fc30: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0001fc40: 2020 2023 2053 6574 7570 0a20 2020 2020     # Setup.     
+0001fc50: 2020 2074 6162 6c65 5f64 6174 6120 3d20     table_data = 
+0001fc60: 7064 2e44 6174 6146 7261 6d65 287b 0a20  pd.DataFrame({. 
+0001fc70: 2020 2020 2020 2020 2020 2027 6368 6563             'chec
+0001fc80: 6b69 6e27 3a20 5b0a 2020 2020 2020 2020  kin': [.        
+0001fc90: 2020 2020 2020 2020 7064 2e74 6f5f 6461          pd.to_da
+0001fca0: 7465 7469 6d65 2827 3230 3232 2d30 352d  tetime('2022-05-
+0001fcb0: 3036 2729 2c0a 2020 2020 2020 2020 2020  06'),.          
+0001fcc0: 2020 2020 2020 7064 2e74 6f5f 6461 7465        pd.to_date
+0001fcd0: 7469 6d65 2827 3230 3232 2d30 352d 3037  time('2022-05-07
+0001fce0: 2729 2c0a 2020 2020 2020 2020 2020 2020  '),.            
+0001fcf0: 2020 2020 7064 2e74 6f5f 6461 7465 7469      pd.to_dateti
+0001fd00: 6d65 2827 3230 3232 2d30 352d 3038 2729  me('2022-05-08')
+0001fd10: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001fd20: 2020 7064 2e74 6f5f 6461 7465 7469 6d65    pd.to_datetime
+0001fd30: 2827 3230 3232 2d30 352d 3039 2729 2c0a  ('2022-05-09'),.
+0001fd40: 2020 2020 2020 2020 2020 2020 5d0a 2020              ].  
+0001fd50: 2020 2020 2020 7d29 0a20 2020 2020 2020        }).       
+0001fd60: 2069 6e73 7461 6e63 6520 3d20 5363 616c   instance = Scal
+0001fd70: 6172 5261 6e67 6528 2763 6865 636b 696e  arRange('checkin
+0001fd80: 272c 2027 3230 3232 2d30 352d 3035 272c  ', '2022-05-05',
+0001fd90: 2027 3230 3232 2d30 362d 3031 2729 0a0a   '2022-06-01')..
+0001fda0: 2020 2020 2020 2020 2320 5275 6e0a 2020          # Run.  
+0001fdb0: 2020 2020 2020 696e 7374 616e 6365 2e5f        instance._
+0001fdc0: 6669 7428 7461 626c 655f 6461 7461 290a  fit(table_data).
+0001fdd0: 0a20 2020 2020 2020 2023 2041 7373 6572  .        # Asser
+0001fde0: 740a 2020 2020 2020 2020 6173 7365 7274  t.        assert
+0001fdf0: 2069 6e73 7461 6e63 652e 5f69 735f 6461   instance._is_da
+0001fe00: 7465 7469 6d65 0a20 2020 2020 2020 2061  tetime.        a
+0001fe10: 7373 6572 7420 696e 7374 616e 6365 2e5f  ssert instance._
+0001fe20: 7472 616e 7366 6f72 6d65 645f 636f 6c75  transformed_colu
+0001fe30: 6d6e 203d 3d20 2763 6865 636b 696e 2332  mn == 'checkin#2
+0001fe40: 3032 322d 3035 2d30 3523 3230 3232 2d30  022-05-05#2022-0
+0001fe50: 362d 3031 270a 2020 2020 2020 2020 6173  6-01'.        as
+0001fe60: 7365 7274 2069 6e73 7461 6e63 652e 5f6c  sert instance._l
+0001fe70: 6f77 5f76 616c 7565 203d 3d20 7064 2e74  ow_value == pd.t
+0001fe80: 6f5f 6461 7465 7469 6d65 2827 3230 3232  o_datetime('2022
+0001fe90: 2d30 352d 3035 2729 0a20 2020 2020 2020  -05-05').       
+0001fea0: 2061 7373 6572 7420 696e 7374 616e 6365   assert instance
+0001feb0: 2e5f 6869 6768 5f76 616c 7565 203d 3d20  ._high_value == 
+0001fec0: 7064 2e74 6f5f 6461 7465 7469 6d65 2827  pd.to_datetime('
+0001fed0: 3230 3232 2d30 362d 3031 2729 0a0a 2020  2022-06-01')..  
+0001fee0: 2020 6465 6620 7465 7374 5f69 735f 7661    def test_is_va
+0001fef0: 6c69 645f 6c74 2873 656c 6629 3a0a 2020  lid_lt(self):.  
+0001ff00: 2020 2020 2020 2222 2254 6573 7420 7468        """Test th
+0001ff10: 6520 6060 5363 616c 6172 5261 6e67 652e  e ``ScalarRange.
+0001ff20: 6973 5f76 616c 6964 6060 2e0a 0a20 2020  is_valid``...   
+0001ff30: 2020 2020 2054 6869 7320 7465 7374 2065       This test e
+0001ff40: 6e73 7572 6573 2074 6861 7420 7468 6520  nsures that the 
+0001ff50: 6060 6973 5f76 616c 6964 6060 206d 6574  ``is_valid`` met
+0001ff60: 686f 6420 776f 726b 7320 7769 7468 2074  hod works with t
+0001ff70: 6865 206f 7065 7261 746f 7220 6060 3c60  he operator ``<`
+0001ff80: 600a 2020 2020 2020 2020 2860 603c 6060  `.        (``<``
+0001ff90: 2920 616e 6420 7661 6c69 6461 7465 7320  ) and validates 
+0001ffa0: 7468 6174 2074 6865 2060 6063 6f6c 756d  that the ``colum
+0001ffb0: 6e5f 6e61 6d65 6060 2069 7320 6265 7477  n_name`` is betw
+0001ffc0: 6565 6e20 6060 6c6f 775f 7661 6c75 6560  een ``low_value`
+0001ffd0: 6020 616e 640a 2020 2020 2020 2020 6060  ` and.        ``
+0001ffe0: 6869 6768 5f76 616c 7565 6060 2e0a 0a20  high_value``... 
+0001fff0: 2020 2020 2020 2053 6574 7570 3a0a 2020         Setup:.  
+00020000: 2020 2020 2020 2020 2020 2d20 4372 6561            - Crea
+00020010: 7465 2061 2070 642e 4461 7461 4672 616d  te a pd.DataFram
+00020020: 652e 0a20 2020 2020 2020 2020 2020 202d  e..            -
+00020030: 2049 6e73 7461 6e63 6520 6f66 2060 6053   Instance of ``S
+00020040: 6361 6c61 7252 616e 6765 6060 2063 6f6e  calarRange`` con
+00020050: 7374 7261 696e 7420 7769 7468 206c 6f77  straint with low
+00020060: 2061 6e64 2068 6967 6820 7661 6c75 6573   and high values
+00020070: 2074 6861 7420 6172 6520 7769 7468 696e   that are within
+00020080: 2074 6865 0a20 2020 2020 2020 2020 2020   the.           
+00020090: 2020 2065 7870 6563 7465 6420 7261 6e67     expected rang
+000200a0: 652e 0a0a 2020 2020 2020 2020 496e 7075  e...        Inpu
+000200b0: 743a 0a20 2020 2020 2020 2020 2020 202d  t:.            -
+000200c0: 2070 642e 4461 7461 4672 616d 6520 7769   pd.DataFrame wi
+000200d0: 7468 2060 6063 7572 7265 6e74 5f61 6765  th ``current_age
+000200e0: 6060 2063 6f6c 756d 6e2e 0a20 2020 2020  `` column..     
+000200f0: 2020 2022 2222 0a20 2020 2020 2020 2023     """.        #
+00020100: 2053 6574 7570 0a20 2020 2020 2020 2074   Setup.        t
+00020110: 6162 6c65 5f64 6174 6120 3d20 7064 2e44  able_data = pd.D
+00020120: 6174 6146 7261 6d65 287b 2763 7572 7265  ataFrame({'curre
+00020130: 6e74 5f61 6765 273a 205b 3231 2c20 3232  nt_age': [21, 22
+00020140: 2c20 3235 5d7d 290a 2020 2020 2020 2020  , 25]}).        
+00020150: 696e 7374 616e 6365 203d 2053 6361 6c61  instance = Scala
+00020160: 7252 616e 6765 2827 6375 7272 656e 745f  rRange('current_
+00020170: 6167 6527 2c20 3230 2c20 3236 290a 0a20  age', 20, 26).. 
+00020180: 2020 2020 2020 2023 2052 756e 0a20 2020         # Run.   
+00020190: 2020 2020 2072 6573 756c 7420 3d20 696e       result = in
+000201a0: 7374 616e 6365 2e69 735f 7661 6c69 6428  stance.is_valid(
+000201b0: 7461 626c 655f 6461 7461 290a 0a20 2020  table_data)..   
+000201c0: 2020 2020 2023 2041 7373 6572 740a 2020       # Assert.  
+000201d0: 2020 2020 2020 6173 7365 7274 2061 6c6c        assert all
+000201e0: 2872 6573 756c 7429 0a0a 2020 2020 6465  (result)..    de
+000201f0: 6620 7465 7374 5f69 735f 7661 6c69 645f  f test_is_valid_
+00020200: 6c65 2873 656c 6629 3a0a 2020 2020 2020  le(self):.      
+00020210: 2020 2222 2254 6573 7420 7468 6520 6060    """Test the ``
+00020220: 5363 616c 6172 5261 6e67 652e 6973 5f76  ScalarRange.is_v
+00020230: 616c 6964 6060 2e0a 0a20 2020 2020 2020  alid``...       
+00020240: 2054 6869 7320 7465 7374 2065 6e73 7572   This test ensur
+00020250: 6573 2074 6861 7420 7468 6520 6060 6973  es that the ``is
+00020260: 5f76 616c 6964 6060 206d 6574 686f 6420  _valid`` method 
+00020270: 776f 726b 7320 7769 7468 2074 6865 206f  works with the o
+00020280: 7065 7261 746f 720a 2020 2020 2020 2020  perator.        
+00020290: 6060 3c3d 6060 2061 6e64 2076 616c 6964  ``<=`` and valid
+000202a0: 6174 6573 2074 6861 7420 7468 6520 6060  ates that the ``
+000202b0: 636f 6c75 6d6e 5f6e 616d 6560 6020 6973  column_name`` is
+000202c0: 0a20 2020 2020 2020 2062 6574 7765 656e  .        between
+000202d0: 2060 606c 6f77 5f76 616c 7565 6060 2061   ``low_value`` a
+000202e0: 6e64 2060 6068 6967 685f 7661 6c75 6560  nd ``high_value`
+000202f0: 602e 0a0a 2020 2020 2020 2020 5365 7475  `...        Setu
+00020300: 703a 0a20 2020 2020 2020 2020 2020 202d  p:.            -
+00020310: 2043 7265 6174 6520 6120 7064 2e44 6174   Create a pd.Dat
+00020320: 6146 7261 6d65 2e0a 2020 2020 2020 2020  aFrame..        
+00020330: 2020 2020 2d20 496e 7374 616e 6365 206f      - Instance o
+00020340: 6620 6060 5363 616c 6172 5261 6e67 6560  f ``ScalarRange`
+00020350: 6020 636f 6e73 7472 6169 6e74 2077 6974  ` constraint wit
+00020360: 6820 6c6f 7720 616e 6420 6869 6768 2076  h low and high v
+00020370: 616c 7565 7320 7468 6174 2061 7265 2077  alues that are w
+00020380: 6974 6869 6e20 7468 650a 2020 2020 2020  ithin the.      
+00020390: 2020 2020 2020 2020 6578 7065 6374 6564          expected
+000203a0: 2072 616e 6765 2061 6e64 2075 7369 6e67   range and using
+000203b0: 2060 6073 7472 6963 745f 626f 756e 6461   ``strict_bounda
+000203c0: 7269 6573 6060 2061 7320 6060 4661 6c73  ries`` as ``Fals
+000203d0: 6560 602e 0a0a 2020 2020 2020 2020 496e  e``...        In
+000203e0: 7075 743a 0a20 2020 2020 2020 2020 2020  put:.           
+000203f0: 202d 2070 642e 4461 7461 4672 616d 6520   - pd.DataFrame 
+00020400: 7769 7468 2060 6063 7572 7265 6e74 5f61  with ``current_a
+00020410: 6765 6060 2063 6f6c 756d 6e2e 0a20 2020  ge`` column..   
+00020420: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00020430: 2023 2053 6574 7570 0a20 2020 2020 2020   # Setup.       
+00020440: 2074 6162 6c65 5f64 6174 6120 3d20 7064   table_data = pd
+00020450: 2e44 6174 6146 7261 6d65 287b 2763 7572  .DataFrame({'cur
+00020460: 7265 6e74 5f61 6765 273a 205b 3231 2c20  rent_age': [21, 
+00020470: 3232 2c20 3235 5d7d 290a 2020 2020 2020  22, 25]}).      
+00020480: 2020 696e 7374 616e 6365 203d 2053 6361    instance = Sca
+00020490: 6c61 7252 616e 6765 2827 6375 7272 656e  larRange('curren
+000204a0: 745f 6167 6527 2c20 3231 2c20 3235 2c20  t_age', 21, 25, 
+000204b0: 7374 7269 6374 5f62 6f75 6e64 6172 6965  strict_boundarie
+000204c0: 733d 4661 6c73 6529 0a0a 2020 2020 2020  s=False)..      
+000204d0: 2020 2320 5275 6e0a 2020 2020 2020 2020    # Run.        
+000204e0: 7265 7375 6c74 203d 2069 6e73 7461 6e63  result = instanc
+000204f0: 652e 6973 5f76 616c 6964 2874 6162 6c65  e.is_valid(table
+00020500: 5f64 6174 6129 0a0a 2020 2020 2020 2020  _data)..        
+00020510: 2320 4173 7365 7274 0a20 2020 2020 2020  # Assert.       
+00020520: 2061 7373 6572 7420 616c 6c28 7265 7375   assert all(resu
+00020530: 6c74 290a 0a20 2020 2064 6566 2074 6573  lt)..    def tes
+00020540: 745f 6973 5f76 616c 6964 5f69 6e76 616c  t_is_valid_inval
+00020550: 6964 2873 656c 6629 3a0a 2020 2020 2020  id(self):.      
+00020560: 2020 2222 2254 6573 7420 7468 6520 6060    """Test the ``
+00020570: 5363 616c 6172 5261 6e67 652e 6973 5f76  ScalarRange.is_v
+00020580: 616c 6964 6060 2e0a 0a20 2020 2020 2020  alid``...       
+00020590: 2054 6869 7320 7465 7374 2065 6e73 7572   This test ensur
+000205a0: 6573 2074 6861 7420 7468 6520 6060 6973  es that the ``is
+000205b0: 5f76 616c 6964 6060 2066 6169 6c73 2077  _valid`` fails w
+000205c0: 6865 6e20 7468 6520 6461 7461 2069 7320  hen the data is 
+000205d0: 6e6f 7420 696e 2074 6865 2072 616e 6765  not in the range
+000205e0: 2e0a 0a20 2020 2020 2020 2053 6574 7570  ...        Setup
+000205f0: 3a0a 2020 2020 2020 2020 2020 2020 2d20  :.            - 
+00020600: 4372 6561 7465 2061 2070 642e 4461 7461  Create a pd.Data
+00020610: 4672 616d 6520 7769 7468 2060 6063 7572  Frame with ``cur
+00020620: 7265 6e74 5f61 6765 6060 2063 6f6c 756d  rent_age`` colum
+00020630: 6e2e 0a20 2020 2020 2020 2020 2020 202d  n..            -
+00020640: 2049 6e73 7461 6e63 6520 6f66 2060 6053   Instance of ``S
+00020650: 6361 6c61 7252 616e 6765 6060 2063 6f6e  calarRange`` con
+00020660: 7374 7261 696e 7420 7769 7468 2060 606c  straint with ``l
+00020670: 6f77 5f76 616c 7565 6060 2068 6967 6865  ow_value`` highe
+00020680: 7220 7468 616e 2074 6865 0a20 2020 2020  r than the.     
+00020690: 2020 2020 2020 2020 206c 6f77 2076 616c           low val
+000206a0: 7565 2069 6e20 6060 6375 7272 656e 745f  ue in ``current_
+000206b0: 6167 6560 6020 616e 6420 6869 6768 2076  age`` and high v
+000206c0: 616c 7565 206c 6f77 6572 2074 6861 6e20  alue lower than 
+000206d0: 7468 6520 6869 6768 6572 2076 616c 7565  the higher value
+000206e0: 2069 6e20 7468 650a 2020 2020 2020 2020   in the.        
+000206f0: 2020 2020 2020 6060 6375 7272 656e 745f        ``current_
+00020700: 6167 6560 602e 0a0a 2020 2020 2020 2020  age``...        
+00020710: 496e 7075 743a 0a20 2020 2020 2020 2020  Input:.         
+00020720: 2020 202d 2070 642e 4461 7461 4672 616d     - pd.DataFram
+00020730: 6520 7769 7468 2060 6063 7572 7265 6e74  e with ``current
+00020740: 5f61 6765 6060 2063 6f6c 756d 6e2e 0a20  _age`` column.. 
+00020750: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00020760: 2020 2023 2053 6574 7570 0a20 2020 2020     # Setup.     
+00020770: 2020 2074 6162 6c65 5f64 6174 6120 3d20     table_data = 
+00020780: 7064 2e44 6174 6146 7261 6d65 287b 2763  pd.DataFrame({'c
+00020790: 7572 7265 6e74 5f61 6765 273a 205b 3231  urrent_age': [21
+000207a0: 2c20 3232 2c20 3235 5d7d 290a 2020 2020  , 22, 25]}).    
+000207b0: 2020 2020 696e 7374 616e 6365 203d 2053      instance = S
+000207c0: 6361 6c61 7252 616e 6765 2827 6375 7272  calarRange('curr
+000207d0: 656e 745f 6167 6527 2c20 3238 2c20 3138  ent_age', 28, 18
+000207e0: 2c20 7374 7269 6374 5f62 6f75 6e64 6172  , strict_boundar
+000207f0: 6965 733d 4661 6c73 6529 0a0a 2020 2020  ies=False)..    
+00020800: 2020 2020 2320 5275 6e0a 2020 2020 2020      # Run.      
+00020810: 2020 7265 7375 6c74 203d 2069 6e73 7461    result = insta
+00020820: 6e63 652e 6973 5f76 616c 6964 2874 6162  nce.is_valid(tab
+00020830: 6c65 5f64 6174 6129 0a0a 2020 2020 2020  le_data)..      
+00020840: 2020 2320 4173 7365 7274 0a20 2020 2020    # Assert.     
+00020850: 2020 2061 7373 6572 7420 6e6f 7420 616c     assert not al
+00020860: 6c28 7265 7375 6c74 290a 0a20 2020 2040  l(result)..    @
+00020870: 7061 7463 6828 2773 6476 2e63 6f6e 7374  patch('sdv.const
+00020880: 7261 696e 7473 2e74 6162 756c 6172 2e6c  raints.tabular.l
+00020890: 6f67 6974 2729 0a20 2020 2064 6566 2074  ogit').    def t
+000208a0: 6573 745f 5f74 7261 6e73 666f 726d 2873  est__transform(s
+000208b0: 656c 662c 206d 6f63 6b5f 6c6f 6769 7429  elf, mock_logit)
+000208c0: 3a0a 2020 2020 2020 2020 2222 2254 6573  :.        """Tes
+000208d0: 7420 7468 6520 6060 5363 616c 6172 5261  t the ``ScalarRa
+000208e0: 6e67 652e 5f74 7261 6e73 666f 726d 6060  nge._transform``
+000208f0: 206d 6574 686f 642e 0a0a 2020 2020 2020   method...      
+00020900: 2020 4974 2069 7320 6578 7065 6374 6564    It is expected
+00020910: 2074 6f20 6372 6561 7465 2061 206e 6577   to create a new
+00020920: 2063 6f6c 756d 6e20 7369 6d69 6c61 7220   column similar 
+00020930: 746f 2074 6865 2063 6f6e 7374 7261 696e  to the constrain
+00020940: 7420 6060 636f 6c75 6d6e 6060 2c20 616e  t ``column``, an
+00020950: 6420 7468 656e 0a20 2020 2020 2020 2073  d then.        s
+00020960: 6361 6c65 2061 6e64 2061 7070 6c79 2061  cale and apply a
+00020970: 206c 6f67 6974 2066 756e 6374 696f 6e20   logit function 
+00020980: 746f 2074 6861 7420 636f 6c75 6d6e 2e0a  to that column..
+00020990: 0a20 2020 2020 2020 204d 6f63 6b3a 0a20  .        Mock:. 
+000209a0: 2020 2020 2020 2020 2020 202d 206d 6f63             - moc
+000209b0: 6b20 7468 6520 6c6f 6769 7420 6675 6e63  k the logit func
+000209c0: 7469 6f6e 2e0a 2020 2020 2020 2020 496e  tion..        In
+000209d0: 7075 743a 0a20 2020 2020 2020 2020 2020  put:.           
+000209e0: 202d 2070 642e 4461 7461 4672 616d 6520   - pd.DataFrame 
+000209f0: 7769 7468 2060 6063 7572 7265 6e74 5f61  with ``current_a
+00020a00: 6765 6060 2063 6f6c 756d 6e2e 0a0a 2020  ge`` column...  
+00020a10: 2020 2020 2020 4f75 7470 7574 3a0a 2020        Output:.  
+00020a20: 2020 2020 2020 2020 2020 2d20 7064 2e44            - pd.D
+00020a30: 6174 6146 7261 6d65 2077 6974 6820 7468  ataFrame with th
+00020a40: 6520 7472 616e 7366 6f72 6d65 6420 6060  e transformed ``
+00020a50: 6375 7272 656e 745f 6167 6560 602e 0a20  current_age``.. 
+00020a60: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00020a70: 2020 2023 2053 6574 7570 0a20 2020 2020     # Setup.     
+00020a80: 2020 2074 6162 6c65 5f64 6174 6120 3d20     table_data = 
+00020a90: 7064 2e44 6174 6146 7261 6d65 287b 2763  pd.DataFrame({'c
+00020aa0: 7572 7265 6e74 5f61 6765 273a 205b 3231  urrent_age': [21
+00020ab0: 2c20 3232 2c20 3235 5d7d 290a 2020 2020  , 22, 25]}).    
+00020ac0: 2020 2020 696e 7374 616e 6365 203d 2053      instance = S
+00020ad0: 6361 6c61 7252 616e 6765 2827 6375 7272  calarRange('curr
+00020ae0: 656e 745f 6167 6527 2c20 3230 2c20 3238  ent_age', 20, 28
+00020af0: 290a 2020 2020 2020 2020 6d6f 636b 5f6c  ).        mock_l
+00020b00: 6f67 6974 2e72 6574 7572 6e5f 7661 6c75  ogit.return_valu
+00020b10: 6520 3d20 5b31 2c20 322c 2033 5d0a 0a20  e = [1, 2, 3].. 
+00020b20: 2020 2020 2020 2023 2052 756e 0a20 2020         # Run.   
+00020b30: 2020 2020 2069 6e73 7461 6e63 652e 6669       instance.fi
+00020b40: 7428 7461 626c 655f 6461 7461 290a 2020  t(table_data).  
+00020b50: 2020 2020 2020 6f75 7420 3d20 696e 7374        out = inst
+00020b60: 616e 6365 2e5f 7472 616e 7366 6f72 6d28  ance._transform(
+00020b70: 7461 626c 655f 6461 7461 290a 0a20 2020  table_data)..   
+00020b80: 2020 2020 2023 2041 7373 6572 740a 2020       # Assert.  
+00020b90: 2020 2020 2020 6578 7065 6374 6564 5f6f        expected_o
+00020ba0: 7574 203d 2070 642e 4461 7461 4672 616d  ut = pd.DataFram
+00020bb0: 6528 7b27 6375 7272 656e 745f 6167 6523  e({'current_age#
+00020bc0: 3230 2332 3827 3a20 5b31 2c20 322c 2033  20#28': [1, 2, 3
+00020bd0: 5d7d 290a 2020 2020 2020 2020 7064 2e74  ]}).        pd.t
+00020be0: 6573 7469 6e67 2e61 7373 6572 745f 6672  esting.assert_fr
+00020bf0: 616d 655f 6571 7561 6c28 6578 7065 6374  ame_equal(expect
+00020c00: 6564 5f6f 7574 2c20 6f75 7429 0a0a 2020  ed_out, out)..  
+00020c10: 2020 4070 6174 6368 2827 7364 762e 636f    @patch('sdv.co
+00020c20: 6e73 7472 6169 6e74 732e 7461 6275 6c61  nstraints.tabula
+00020c30: 722e 7369 676d 6f69 6427 290a 2020 2020  r.sigmoid').    
+00020c40: 6465 6620 7465 7374 5f72 6576 6572 7365  def test_reverse
+00020c50: 5f74 7261 6e73 666f 726d 2873 656c 662c  _transform(self,
+00020c60: 206d 6f63 6b5f 7369 676d 6f69 6429 3a0a   mock_sigmoid):.
+00020c70: 2020 2020 2020 2020 2222 2254 6573 7420          """Test 
+00020c80: 7468 6520 6060 7265 7665 7273 655f 7472  the ``reverse_tr
+00020c90: 616e 7366 6f72 6d60 6020 6d65 7468 6f64  ansform`` method
+00020ca0: 2066 6f72 2060 6053 6361 6c61 7252 616e   for ``ScalarRan
+00020cb0: 6765 6060 2e0a 0a20 2020 2020 2020 2049  ge``...        I
+00020cc0: 7420 6973 2065 7870 6563 7465 6420 746f  t is expected to
+00020cd0: 2072 6563 6f76 6572 2074 6865 206f 7269   recover the ori
+00020ce0: 6769 6e61 6c20 7461 626c 6520 7768 6963  ginal table whic
+00020cf0: 6820 7761 7320 7472 616e 7366 6f72 6d65  h was transforme
+00020d00: 642c 2062 7574 2077 6974 6820 6469 6666  d, but with diff
+00020d10: 6572 656e 740a 2020 2020 2020 2020 636f  erent.        co
+00020d20: 6c75 6d6e 206f 7264 6572 2e20 4974 2064  lumn order. It d
+00020d30: 6f65 7320 736f 2062 7920 6170 706c 7969  oes so by applyi
+00020d40: 6e67 2061 2073 6967 6d6f 6964 2074 6f20  ng a sigmoid to 
+00020d50: 7468 6520 7472 616e 7366 6f72 6d65 6420  the transformed 
+00020d60: 636f 6c75 6d6e 2061 6e64 2074 6865 6e0a  column and then.
+00020d70: 2020 2020 2020 2020 7363 616c 696e 6720          scaling 
+00020d80: 6974 2062 6163 6b20 746f 2074 6865 206f  it back to the o
+00020d90: 7269 6769 6e61 6c20 7370 6163 652e 2049  riginal space. I
+00020da0: 7420 616c 736f 2072 6570 6c61 6365 7320  t also replaces 
+00020db0: 7468 6520 7472 616e 7366 6f72 6d65 6420  the transformed 
+00020dc0: 636f 6c75 6d6e 2077 6974 680a 2020 2020  column with.    
+00020dd0: 2020 2020 616e 2065 7175 616c 2063 6f6c      an equal col
+00020de0: 756d 6e20 6275 7420 7769 7468 2074 6865  umn but with the
+00020df0: 206f 7269 6769 6e61 6c20 6e61 6d65 2e0a   original name..
+00020e00: 0a20 2020 2020 2020 204d 6f63 6b3a 0a20  .        Mock:. 
+00020e10: 2020 2020 2020 2020 2020 202d 204d 6f63             - Moc
+00020e20: 6b20 7468 6520 7369 676d 6f69 6420 6675  k the sigmoid fu
+00020e30: 6e63 7469 6f6e 2e0a 0a20 2020 2020 2020  nction...       
+00020e40: 2053 6574 7570 3a0a 2020 2020 2020 2020   Setup:.        
+00020e50: 2020 2020 2d20 4f72 6967 696e 616c 2074      - Original t
+00020e60: 6162 6c65 2064 6174 612e 0a20 2020 2020  able data..     
+00020e70: 2020 2020 2020 202d 2041 6e20 6578 7065         - An expe
+00020e80: 6374 6564 2074 7261 6e73 666f 726d 6564  cted transformed
+00020e90: 2064 6174 612e 0a20 2020 2020 2020 2020   data..         
+00020ea0: 2020 202d 2049 6e73 7461 6e63 6520 6f66     - Instance of
+00020eb0: 2053 6361 6c61 7252 616e 6765 2063 6f6e   ScalarRange con
+00020ec0: 7374 7261 696e 742e 0a0a 2020 2020 2020  straint...      
+00020ed0: 2020 4f75 7470 7574 3a0a 2020 2020 2020    Output:.      
+00020ee0: 2020 2020 2020 2d20 4120 7064 2e44 6174        - A pd.Dat
+00020ef0: 6146 7261 6d65 2063 6f6e 7461 696e 696e  aFrame containin
+00020f00: 6720 7468 6520 6f72 6967 696e 616c 2064  g the original d
+00020f10: 6174 612e 0a20 2020 2020 2020 2022 2222  ata..        """
+00020f20: 0a20 2020 2020 2020 2023 2053 6574 7570  .        # Setup
+00020f30: 0a20 2020 2020 2020 2074 6162 6c65 5f64  .        table_d
+00020f40: 6174 6120 3d20 7064 2e44 6174 6146 7261  ata = pd.DataFra
+00020f50: 6d65 287b 2763 7572 7265 6e74 5f61 6765  me({'current_age
+00020f60: 273a 205b 3231 2c20 3232 2c20 3235 5d7d  ': [21, 22, 25]}
+00020f70: 290a 2020 2020 2020 2020 7472 616e 7366  ).        transf
+00020f80: 6f72 6d65 645f 6461 7461 203d 2070 642e  ormed_data = pd.
+00020f90: 4461 7461 4672 616d 6528 7b27 6375 7272  DataFrame({'curr
+00020fa0: 656e 745f 6167 6523 3230 2332 3827 3a20  ent_age#20#28': 
+00020fb0: 5b31 2c20 322c 2033 5d7d 290a 2020 2020  [1, 2, 3]}).    
+00020fc0: 2020 2020 6d6f 636b 5f73 6967 6d6f 6964      mock_sigmoid
+00020fd0: 2e72 6574 7572 6e5f 7661 6c75 6520 3d20  .return_value = 
+00020fe0: 7064 2e53 6572 6965 7328 5b32 312c 2032  pd.Series([21, 2
+00020ff0: 322c 2032 355d 290a 2020 2020 2020 2020  2, 25]).        
+00021000: 696e 7374 616e 6365 203d 2053 6361 6c61  instance = Scala
+00021010: 7252 616e 6765 2827 6375 7272 656e 745f  rRange('current_
+00021020: 6167 6527 2c20 3230 2c20 3238 290a 0a20  age', 20, 28).. 
+00021030: 2020 2020 2020 2023 2052 756e 0a20 2020         # Run.   
+00021040: 2020 2020 2069 6e73 7461 6e63 652e 6669       instance.fi
+00021050: 7428 7461 626c 655f 6461 7461 290a 2020  t(table_data).  
+00021060: 2020 2020 2020 6f75 7420 3d20 696e 7374        out = inst
+00021070: 616e 6365 2e72 6576 6572 7365 5f74 7261  ance.reverse_tra
+00021080: 6e73 666f 726d 2874 7261 6e73 666f 726d  nsform(transform
+00021090: 6564 5f64 6174 6129 0a0a 2020 2020 2020  ed_data)..      
+000210a0: 2020 2320 4173 7365 7274 0a20 2020 2020    # Assert.     
+000210b0: 2020 2070 642e 7465 7374 696e 672e 6173     pd.testing.as
+000210c0: 7365 7274 5f66 7261 6d65 5f65 7175 616c  sert_frame_equal
+000210d0: 2874 6162 6c65 5f64 6174 612c 206f 7574  (table_data, out
+000210e0: 290a 2020 2020 2020 2020 6d6f 636b 5f73  ).        mock_s
+000210f0: 6967 6d6f 6964 2e61 7373 6572 745f 6361  igmoid.assert_ca
+00021100: 6c6c 6564 5f6f 6e63 6528 290a 0a20 2020  lled_once()..   
+00021110: 2040 7061 7463 6828 2773 6476 2e63 6f6e   @patch('sdv.con
+00021120: 7374 7261 696e 7473 2e74 6162 756c 6172  straints.tabular
+00021130: 2e70 6427 290a 2020 2020 4070 6174 6368  .pd').    @patch
+00021140: 2827 7364 762e 636f 6e73 7472 6169 6e74  ('sdv.constraint
+00021150: 732e 7461 6275 6c61 722e 7369 676d 6f69  s.tabular.sigmoi
+00021160: 6427 290a 2020 2020 6465 6620 7465 7374  d').    def test
+00021170: 5f72 6576 6572 7365 5f74 7261 6e73 666f  _reverse_transfo
+00021180: 726d 5f69 735f 6461 7465 7469 6d65 2873  rm_is_datetime(s
+00021190: 656c 662c 206d 6f63 6b5f 7369 676d 6f69  elf, mock_sigmoi
+000211a0: 642c 206d 6f63 6b5f 7064 293a 0a20 2020  d, mock_pd):.   
+000211b0: 2020 2020 2022 2222 5465 7374 2074 6865       """Test the
+000211c0: 2060 6072 6576 6572 7365 5f74 7261 6e73   ``reverse_trans
+000211d0: 666f 726d 6060 206d 6574 686f 6420 666f  form`` method fo
+000211e0: 7220 6060 5363 616c 6172 5261 6e67 6560  r ``ScalarRange`
+000211f0: 602e 0a0a 2020 2020 2020 2020 5768 656e  `...        When
+00021200: 2060 6069 6e73 7461 6e63 652e 5f69 735f   ``instance._is_
+00021210: 6461 7465 7469 6d65 6060 2069 7320 6060  datetime`` is ``
+00021220: 5472 7565 6060 2c20 7468 6520 6461 7461  True``, the data
+00021230: 2073 686f 756c 6420 6265 2063 6f6e 7665   should be conve
+00021240: 7274 6564 0a20 2020 2020 2020 2074 6f20  rted.        to 
+00021250: 6060 7061 6e64 6173 2e74 6f5f 6461 7465  ``pandas.to_date
+00021260: 7469 6d65 6060 2e0a 0a20 2020 2020 2020  time``...       
+00021270: 204d 6f63 6b3a 0a20 2020 2020 2020 2020   Mock:.         
+00021280: 2020 202d 204d 6f63 6b20 7468 6520 7369     - Mock the si
+00021290: 676d 6f69 6420 6675 6e63 7469 6f6e 2e0a  gmoid function..
+000212a0: 2020 2020 2020 2020 2020 2020 2d20 4d6f              - Mo
+000212b0: 636b 2070 616e 6461 732e 0a0a 2020 2020  ck pandas...    
+000212c0: 2020 2020 5365 7475 703a 0a20 2020 2020      Setup:.     
+000212d0: 2020 2020 2020 202d 204f 7269 6769 6e61         - Origina
+000212e0: 6c20 7461 626c 6520 6461 7461 2e0a 2020  l table data..  
+000212f0: 2020 2020 2020 2020 2020 2d20 416e 2065            - An e
+00021300: 7870 6563 7465 6420 7472 616e 7366 6f72  xpected transfor
+00021310: 6d65 6420 6461 7461 2e0a 2020 2020 2020  med data..      
+00021320: 2020 2020 2020 2d20 496e 7374 616e 6365        - Instance
+00021330: 206f 6620 5363 616c 6172 5261 6e67 6520   of ScalarRange 
+00021340: 636f 6e73 7472 6169 6e74 2e0a 0a20 2020  constraint...   
+00021350: 2020 2020 204f 7574 7075 743a 0a20 2020       Output:.   
+00021360: 2020 2020 2020 2020 202d 2041 2070 642e           - A pd.
+00021370: 4461 7461 4672 616d 6520 636f 6e74 6169  DataFrame contai
+00021380: 6e69 6e67 2074 6865 206f 7269 6769 6e61  ning the origina
+00021390: 6c20 6461 7461 2e0a 0a20 2020 2020 2020  l data...       
+000213a0: 2053 6964 6520 4566 6665 6374 733a 0a20   Side Effects:. 
+000213b0: 2020 2020 2020 2020 2020 202d 2060 606d             - ``m
+000213c0: 6f63 6b5f 7064 6060 2068 6173 2074 6f20  ock_pd`` has to 
+000213d0: 6265 2063 616c 6c65 6420 6f6e 6365 2e0a  be called once..
+000213e0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+000213f0: 2020 2020 2320 5365 7475 700a 2020 2020      # Setup.    
+00021400: 2020 2020 7472 616e 7366 6f72 6d65 645f      transformed_
+00021410: 6461 7461 203d 2070 642e 4461 7461 4672  data = pd.DataFr
+00021420: 616d 6528 7b27 6375 7272 656e 745f 6167  ame({'current_ag
+00021430: 6523 3230 2332 3827 3a20 5b31 2c20 322c  e#20#28': [1, 2,
+00021440: 2033 5d7d 290a 2020 2020 2020 2020 6d6f   3]}).        mo
+00021450: 636b 5f73 6967 6d6f 6964 2e72 6574 7572  ck_sigmoid.retur
+00021460: 6e5f 7661 6c75 6520 3d20 7064 2e53 6572  n_value = pd.Ser
+00021470: 6965 7328 5b32 312c 2032 322c 2032 355d  ies([21, 22, 25]
+00021480: 290a 2020 2020 2020 2020 696e 7374 616e  ).        instan
+00021490: 6365 203d 2053 6361 6c61 7252 616e 6765  ce = ScalarRange
+000214a0: 2827 6375 7272 656e 745f 6167 6527 2c20  ('current_age', 
+000214b0: 3230 2c20 3238 290a 2020 2020 2020 2020  20, 28).        
+000214c0: 696e 7374 616e 6365 2e5f 7472 616e 7366  instance._transf
+000214d0: 6f72 6d65 645f 636f 6c75 6d6e 203d 2027  ormed_column = '
+000214e0: 6375 7272 656e 745f 6167 6523 3230 2332  current_age#20#2
+000214f0: 3827 0a20 2020 2020 2020 2069 6e73 7461  8'.        insta
+00021500: 6e63 652e 5f69 735f 6461 7465 7469 6d65  nce._is_datetime
+00021510: 203d 2054 7275 650a 2020 2020 2020 2020   = True.        
+00021520: 6d6f 636b 5f70 642e 746f 5f64 6174 6574  mock_pd.to_datet
+00021530: 696d 652e 7369 6465 5f65 6666 6563 7420  ime.side_effect 
+00021540: 3d20 6c61 6d62 6461 2078 3a20 7064 2e74  = lambda x: pd.t
+00021550: 6f5f 6461 7465 7469 6d65 2827 3230 3231  o_datetime('2021
+00021560: 2d30 322d 3032 2031 303a 3130 3a35 3927  -02-02 10:10:59'
+00021570: 290a 0a20 2020 2020 2020 2023 2052 756e  )..        # Run
+00021580: 0a20 2020 2020 2020 206f 7574 7075 7420  .        output 
+00021590: 3d20 696e 7374 616e 6365 2e72 6576 6572  = instance.rever
+000215a0: 7365 5f74 7261 6e73 666f 726d 2874 7261  se_transform(tra
+000215b0: 6e73 666f 726d 6564 5f64 6174 6129 0a0a  nsformed_data)..
+000215c0: 2020 2020 2020 2020 2320 4173 7365 7274          # Assert
+000215d0: 0a20 2020 2020 2020 2065 7870 6563 7465  .        expecte
+000215e0: 645f 6f75 7470 7574 203d 2070 642e 4461  d_output = pd.Da
+000215f0: 7461 4672 616d 6528 7b0a 2020 2020 2020  taFrame({.      
+00021600: 2020 2020 2020 2763 7572 7265 6e74 5f61        'current_a
+00021610: 6765 273a 205b 0a20 2020 2020 2020 2020  ge': [.         
+00021620: 2020 2020 2020 2070 642e 746f 5f64 6174         pd.to_dat
+00021630: 6574 696d 6528 2732 3032 312d 3032 2d30  etime('2021-02-0
+00021640: 3220 3130 3a31 303a 3539 2729 2c0a 2020  2 10:10:59'),.  
+00021650: 2020 2020 2020 2020 2020 2020 2020 7064                pd
+00021660: 2e74 6f5f 6461 7465 7469 6d65 2827 3230  .to_datetime('20
+00021670: 3231 2d30 322d 3032 2031 303a 3130 3a35  21-02-02 10:10:5
+00021680: 3927 292c 0a20 2020 2020 2020 2020 2020  9'),.           
+00021690: 2020 2020 2070 642e 746f 5f64 6174 6574       pd.to_datet
+000216a0: 696d 6528 2732 3032 312d 3032 2d30 3220  ime('2021-02-02 
+000216b0: 3130 3a31 303a 3539 2729 2c0a 2020 2020  10:10:59'),.    
+000216c0: 2020 2020 2020 2020 5d0a 2020 2020 2020          ].      
+000216d0: 2020 7d29 0a20 2020 2020 2020 2070 642e    }).        pd.
+000216e0: 7465 7374 696e 672e 6173 7365 7274 5f66  testing.assert_f
+000216f0: 7261 6d65 5f65 7175 616c 2865 7870 6563  rame_equal(expec
+00021700: 7465 645f 6f75 7470 7574 2c20 6f75 7470  ted_output, outp
+00021710: 7574 290a 2020 2020 2020 2020 6d6f 636b  ut).        mock
+00021720: 5f73 6967 6d6f 6964 2e61 7373 6572 745f  _sigmoid.assert_
+00021730: 6361 6c6c 6564 5f6f 6e63 6528 290a 2020  called_once().  
+00021740: 2020 2020 2020 6173 7365 7274 206d 6f63        assert moc
+00021750: 6b5f 7064 2e74 6f5f 6461 7465 7469 6d65  k_pd.to_datetime
+00021760: 2e63 616c 6c5f 636f 756e 7420 3d3d 2031  .call_count == 1
+00021770: 0a0a 0a63 6c61 7373 2054 6573 744f 6e65  ...class TestOne
+00021780: 486f 7445 6e63 6f64 696e 6728 293a 0a0a  HotEncoding():..
+00021790: 2020 2020 6465 6620 7465 7374 5f5f 7661      def test__va
+000217a0: 6c69 6461 7465 5f69 6e70 7574 7328 7365  lidate_inputs(se
+000217b0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+000217c0: 5465 7374 2074 6865 2060 604f 6e65 486f  Test the ``OneHo
+000217d0: 7445 6e63 6f64 696e 672e 5f76 616c 6964  tEncoding._valid
+000217e0: 6174 655f 696e 7075 7473 6060 206d 6574  ate_inputs`` met
+000217f0: 686f 642e 0a0a 2020 2020 2020 2020 496e  hod...        In
+00021800: 7075 743a 0a20 2020 2020 2020 202d 2020  put:.        -  
+00021810: 496e 636f 7272 6563 7420 7061 7261 6d65  Incorrect parame
+00021820: 7465 7273 2066 6f72 2074 6865 206d 6574  ters for the met
+00021830: 686f 640a 2020 2020 2020 2020 5261 6973  hod.        Rais
+00021840: 6573 3a0a 2020 2020 2020 2020 2d20 4c69  es:.        - Li
+00021850: 7374 206f 6620 5661 6c75 6545 7272 6f72  st of ValueError
+00021860: 730a 2020 2020 2020 2020 2222 220a 2020  s.        """.  
+00021870: 2020 2020 2020 2320 5275 6e20 2f20 4173        # Run / As
+00021880: 7365 7274 0a20 2020 2020 2020 2077 6974  sert.        wit
+00021890: 6820 7079 7465 7374 2e72 6169 7365 7328  h pytest.raises(
+000218a0: 4167 6772 6567 6174 6543 6f6e 7374 7261  AggregateConstra
+000218b0: 696e 7473 4572 726f 7229 2061 7320 6572  intsError) as er
+000218c0: 726f 723a 0a20 2020 2020 2020 2020 2020  ror:.           
+000218d0: 204f 6e65 486f 7445 6e63 6f64 696e 672e   OneHotEncoding.
+000218e0: 5f76 616c 6964 6174 655f 696e 7075 7473  _validate_inputs
+000218f0: 286e 6f74 5f63 6f6c 756d 6e5f 6e61 6d65  (not_column_name
+00021900: 733d 4e6f 6e65 2c20 736f 6d65 7468 696e  s=None, somethin
+00021910: 675f 656c 7365 3d4e 6f6e 6529 0a0a 2020  g_else=None)..  
+00021920: 2020 2020 2020 6572 725f 6d73 6720 3d20        err_msg = 
+00021930: 280a 2020 2020 2020 2020 2020 2020 7227  (.            r'
+00021940: 4d69 7373 696e 6720 7265 7175 6972 6564  Missing required
+00021950: 2076 616c 7565 7320 7b28 2e2a 297d 2069   values {(.*)} i
+00021960: 6e20 6120 4f6e 6548 6f74 456e 636f 6469  n a OneHotEncodi
+00021970: 6e67 2063 6f6e 7374 7261 696e 742e 270a  ng constraint.'.
+00021980: 2020 2020 2020 2020 2020 2020 7227 5c6e              r'\n
+00021990: 5c6e 496e 7661 6c69 6420 7661 6c75 6573  \nInvalid values
+000219a0: 207b 282e 2a29 7d20 6172 6520 7072 6573   {(.*)} are pres
+000219b0: 656e 7420 696e 2061 204f 6e65 486f 7445  ent in a OneHotE
+000219c0: 6e63 6f64 696e 6720 636f 6e73 7472 6169  ncoding constrai
+000219d0: 6e74 2e27 0a20 2020 2020 2020 2029 0a20  nt.'.        ). 
+000219e0: 2020 2020 2020 2067 726f 7570 7320 3d20         groups = 
+000219f0: 7265 2e73 6561 7263 6828 6572 725f 6d73  re.search(err_ms
+00021a00: 672c 2073 7472 2865 7272 6f72 2e76 616c  g, str(error.val
+00021a10: 7565 2929 0a20 2020 2020 2020 2061 7373  ue)).        ass
+00021a20: 6572 7420 6772 6f75 7073 2069 7320 6e6f  ert groups is no
+00021a30: 7420 4e6f 6e65 0a20 2020 2020 2020 2061  t None.        a
+00021a40: 7373 6572 7420 7374 7228 6576 616c 2867  ssert str(eval(g
+00021a50: 726f 7570 732e 6772 6f75 7028 3129 2929  roups.group(1)))
+00021a60: 203d 3d20 2763 6f6c 756d 6e5f 6e61 6d65   == 'column_name
+00021a70: 7327 0a20 2020 2020 2020 2061 7373 6572  s'.        asser
+00021a80: 7420 7365 7428 6576 616c 2867 726f 7570  t set(eval(group
+00021a90: 732e 6772 6f75 7028 3229 2929 203d 3d20  s.group(2))) == 
+00021aa0: 7b27 6e6f 745f 636f 6c75 6d6e 5f6e 616d  {'not_column_nam
+00021ab0: 6573 272c 2027 736f 6d65 7468 696e 675f  es', 'something_
+00021ac0: 656c 7365 277d 0a0a 2020 2020 6465 6620  else'}..    def 
+00021ad0: 7465 7374 5f5f 7661 6c69 6461 7465 5f6d  test__validate_m
+00021ae0: 6574 6164 6174 615f 636f 6c75 6d6e 7328  etadata_columns(
+00021af0: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
+00021b00: 2222 5465 7374 2074 6865 2060 605f 7661  ""Test the ``_va
+00021b10: 6c69 6461 7465 5f6d 6574 6164 6174 615f  lidate_metadata_
+00021b20: 636f 6c75 6d6e 7360 6020 6d65 7468 6f64  columns`` method
+00021b30: 2e0a 0a20 2020 2020 2020 2041 6c6c 206f  ...        All o
+00021b40: 6620 7468 6520 636f 6c75 6d6e 7320 7061  f the columns pa
+00021b50: 7373 6564 2069 6e20 636f 6c75 6d6e 5f6e  ssed in column_n
+00021b60: 616d 6573 2073 686f 756c 6420 6265 2069  ames should be i
+00021b70: 6e20 7468 6520 6d65 7461 6461 7461 2e0a  n the metadata..
+00021b80: 0a20 2020 2020 2020 2049 6e70 7574 3a0a  .        Input:.
+00021b90: 2020 2020 2020 2020 2020 2020 2d20 636f              - co
+00021ba0: 6c75 6d6e 5f6e 616d 6573 2077 6974 6820  lumn_names with 
+00021bb0: 636f 6c75 6d6e 7320 7468 6174 2061 7265  columns that are
+00021bc0: 2061 6c6c 2069 6e20 7468 6520 6d65 7461   all in the meta
+00021bd0: 6461 7461 2e0a 0a20 2020 2020 2020 2053  data...        S
+00021be0: 6964 6520 6566 6665 6374 3a0a 2020 2020  ide effect:.    
+00021bf0: 2020 2020 2020 2020 2d20 4e6f 2065 7272          - No err
+00021c00: 6f72 2073 686f 756c 6420 6265 2072 6169  or should be rai
+00021c10: 7365 642e 0a20 2020 2020 2020 2022 2222  sed..        """
+00021c20: 0a20 2020 2020 2020 2023 2053 6574 7570  .        # Setup
+00021c30: 0a20 2020 2020 2020 206d 6574 6164 6174  .        metadat
+00021c40: 6120 3d20 4d6f 636b 2829 0a20 2020 2020  a = Mock().     
+00021c50: 2020 206d 6574 6164 6174 612e 636f 6c75     metadata.colu
+00021c60: 6d6e 7320 3d20 7b27 6127 3a20 312c 2027  mns = {'a': 1, '
+00021c70: 6227 3a20 327d 0a0a 2020 2020 2020 2020  b': 2}..        
+00021c80: 2320 5275 6e0a 2020 2020 2020 2020 4f6e  # Run.        On
+00021c90: 6548 6f74 456e 636f 6469 6e67 2e5f 7661  eHotEncoding._va
+00021ca0: 6c69 6461 7465 5f6d 6574 6164 6174 615f  lidate_metadata_
+00021cb0: 636f 6c75 6d6e 7328 6d65 7461 6461 7461  columns(metadata
+00021cc0: 2c20 636f 6c75 6d6e 5f6e 616d 6573 3d5b  , column_names=[
+00021cd0: 2761 272c 2027 6227 5d29 0a0a 2020 2020  'a', 'b'])..    
+00021ce0: 6465 6620 7465 7374 5f5f 7661 6c69 6461  def test__valida
+00021cf0: 7465 5f6d 6574 6164 6174 615f 636f 6c75  te_metadata_colu
+00021d00: 6d6e 735f 7261 6973 6573 5f65 7272 6f72  mns_raises_error
+00021d10: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00021d20: 2222 2254 6573 7420 7468 6520 6060 5f76  """Test the ``_v
+00021d30: 616c 6964 6174 655f 6d65 7461 6461 7461  alidate_metadata
+00021d40: 5f63 6f6c 756d 6e73 6060 206d 6574 686f  _columns`` metho
+00021d50: 6427 7320 6572 726f 7220 636f 6e64 6974  d's error condit
+00021d60: 696f 6e2e 0a0a 2020 2020 2020 2020 4966  ion...        If
+00021d70: 2061 6e79 2063 6f6c 756d 6e73 2069 6e20   any columns in 
+00021d80: 636f 6c75 6d6e 5f6e 616d 6573 2061 7265  column_names are
+00021d90: 206e 6f74 2069 6e20 7468 6520 6d65 7461   not in the meta
+00021da0: 6461 7461 2c20 616e 2065 7272 6f72 2073  data, an error s
+00021db0: 686f 756c 6420 6265 2072 6169 7365 642e  hould be raised.
+00021dc0: 0a0a 2020 2020 2020 2020 496e 7075 743a  ..        Input:
+00021dd0: 0a20 2020 2020 2020 2020 2020 202d 2063  .            - c
+00021de0: 6f6c 756d 6e5f 6e61 6d65 7320 7468 6174  olumn_names that
+00021df0: 2063 6f6e 7461 696e 7320 6120 636f 6c75   contains a colu
+00021e00: 6d6e 206e 6f74 2069 6e20 7468 6520 6d65  mn not in the me
+00021e10: 7461 6461 7461 2e0a 0a20 2020 2020 2020  tadata...       
+00021e20: 2053 6964 6520 6566 6665 6374 3a0a 2020   Side effect:.  
+00021e30: 2020 2020 2020 2020 2020 2d20 436f 6e73            - Cons
+00021e40: 7472 6169 6e74 4d65 7461 6461 7461 4572  traintMetadataEr
+00021e50: 726f 7220 7368 6f75 6c64 2062 6520 7261  ror should be ra
+00021e60: 6973 6564 2e0a 2020 2020 2020 2020 2222  ised..        ""
+00021e70: 220a 2020 2020 2020 2020 2320 5365 7475  ".        # Setu
+00021e80: 700a 2020 2020 2020 2020 6d65 7461 6461  p.        metada
+00021e90: 7461 203d 204d 6f63 6b28 290a 2020 2020  ta = Mock().    
+00021ea0: 2020 2020 6d65 7461 6461 7461 2e63 6f6c      metadata.col
+00021eb0: 756d 6e73 203d 207b 2761 273a 2031 2c20  umns = {'a': 1, 
+00021ec0: 2762 273a 2032 7d0a 0a20 2020 2020 2020  'b': 2}..       
+00021ed0: 2023 2052 756e 0a20 2020 2020 2020 2065   # Run.        e
+00021ee0: 7272 6f72 5f6d 6573 7361 6765 203d 2072  rror_message = r
+00021ef0: 652e 6573 6361 7065 280a 2020 2020 2020  e.escape(.      
+00021f00: 2020 2020 2020 2741 204f 6e65 486f 7445        'A OneHotE
+00021f10: 6e63 6f64 696e 6720 636f 6e73 7472 6169  ncoding constrai
+00021f20: 6e74 2069 7320 6265 696e 6720 6170 706c  nt is being appl
+00021f30: 6965 6420 746f 2069 6e76 616c 6964 2063  ied to invalid c
+00021f40: 6f6c 756d 6e20 6e61 6d65 7320 270a 2020  olumn names '.  
+00021f50: 2020 2020 2020 2020 2020 227b 2763 277d            "{'c'}
+00021f60: 2e20 5468 6520 636f 6c75 6d6e 7320 6d75  . The columns mu
+00021f70: 7374 2065 7869 7374 2069 6e20 7468 6520  st exist in the 
+00021f80: 7461 626c 652e 220a 2020 2020 2020 2020  table.".        
+00021f90: 290a 2020 2020 2020 2020 7769 7468 2070  ).        with p
+00021fa0: 7974 6573 742e 7261 6973 6573 2843 6f6e  ytest.raises(Con
+00021fb0: 7374 7261 696e 744d 6574 6164 6174 6145  straintMetadataE
+00021fc0: 7272 6f72 2c20 6d61 7463 683d 6572 726f  rror, match=erro
+00021fd0: 725f 6d65 7373 6167 6529 3a0a 2020 2020  r_message):.    
+00021fe0: 2020 2020 2020 2020 4f6e 6548 6f74 456e          OneHotEn
+00021ff0: 636f 6469 6e67 2e5f 7661 6c69 6461 7465  coding._validate
+00022000: 5f6d 6574 6164 6174 615f 636f 6c75 6d6e  _metadata_column
+00022010: 7328 6d65 7461 6461 7461 2c20 636f 6c75  s(metadata, colu
+00022020: 6d6e 5f6e 616d 6573 3d5b 2761 272c 2027  mn_names=['a', '
+00022030: 6327 5d29 0a0a 2020 2020 6465 6620 7465  c'])..    def te
+00022040: 7374 5f72 6576 6572 7365 5f74 7261 6e73  st_reverse_trans
+00022050: 666f 726d 2873 656c 6629 3a0a 2020 2020  form(self):.    
+00022060: 2020 2020 2222 2254 6573 7420 7468 6520      """Test the 
+00022070: 6060 4f6e 6548 6f74 456e 636f 6469 6e67  ``OneHotEncoding
+00022080: 2e72 6576 6572 7365 5f74 7261 6e73 666f  .reverse_transfo
+00022090: 726d 6060 206d 6574 686f 642e 0a0a 2020  rm`` method...  
+000220a0: 2020 2020 2020 4974 2069 7320 6578 7065        It is expe
+000220b0: 6374 6564 2074 6f2c 2066 6f72 2065 6163  cted to, for eac
+000220c0: 6820 6f66 2074 6865 2061 7070 726f 7072  h of the appropr
+000220d0: 6961 7465 2072 6f77 732c 2073 6574 2074  iate rows, set t
+000220e0: 6865 2063 6f6c 756d 6e0a 2020 2020 2020  he column.      
+000220f0: 2020 7769 7468 2074 6865 206c 6172 6765    with the large
+00022100: 7374 2076 616c 7565 2074 6f20 6f6e 6520  st value to one 
+00022110: 616e 6420 7365 7420 616c 6c20 6f74 6865  and set all othe
+00022120: 7220 636f 6c75 6d6e 7320 746f 207a 6572  r columns to zer
+00022130: 6f2e 0a0a 2020 2020 2020 2020 496e 7075  o...        Inpu
+00022140: 743a 0a20 2020 2020 2020 202d 2054 6162  t:.        - Tab
+00022150: 6c65 2064 6174 6120 7769 7468 2061 6e79  le data with any
+00022160: 206e 756d 6265 7273 2028 7061 6e64 6173   numbers (pandas
+00022170: 2e44 6174 6146 7261 6d65 290a 2020 2020  .DataFrame).    
+00022180: 2020 2020 4f75 7470 7574 3a0a 2020 2020      Output:.    
+00022190: 2020 2020 2d20 5461 626c 6520 6461 7461      - Table data
+000221a0: 2077 6865 7265 2074 6865 2061 7070 726f   where the appro
+000221b0: 7072 6961 7465 2072 6f77 7320 6172 6520  priate rows are 
+000221c0: 6f6e 6520 686f 7420 2870 616e 6461 732e  one hot (pandas.
+000221d0: 4461 7461 4672 616d 6529 0a20 2020 2020  DataFrame).     
+000221e0: 2020 2022 2222 0a20 2020 2020 2020 2023     """.        #
+000221f0: 2053 6574 7570 0a20 2020 2020 2020 2069   Setup.        i
+00022200: 6e73 7461 6e63 6520 3d20 4f6e 6548 6f74  nstance = OneHot
+00022210: 456e 636f 6469 6e67 2863 6f6c 756d 6e5f  Encoding(column_
+00022220: 6e61 6d65 733d 5b27 6127 2c20 2762 275d  names=['a', 'b']
+00022230: 290a 0a20 2020 2020 2020 2023 2052 756e  )..        # Run
+00022240: 0a20 2020 2020 2020 2074 6162 6c65 5f64  .        table_d
+00022250: 6174 6120 3d20 7064 2e44 6174 6146 7261  ata = pd.DataFra
+00022260: 6d65 287b 0a20 2020 2020 2020 2020 2020  me({.           
+00022270: 2027 6127 3a20 5b30 2e31 2c20 302e 352c   'a': [0.1, 0.5,
+00022280: 2030 2e38 5d2c 0a20 2020 2020 2020 2020   0.8],.         
+00022290: 2020 2027 6227 3a20 5b30 2e38 2c20 302e     'b': [0.8, 0.
+000222a0: 312c 2030 2e39 5d2c 0a20 2020 2020 2020  1, 0.9],.       
+000222b0: 2020 2020 2027 6327 3a20 5b31 2c20 322c       'c': [1, 2,
+000222c0: 2033 5d0a 2020 2020 2020 2020 7d29 0a20   3].        }). 
+000222d0: 2020 2020 2020 206f 7574 203d 2069 6e73         out = ins
+000222e0: 7461 6e63 652e 7265 7665 7273 655f 7472  tance.reverse_tr
+000222f0: 616e 7366 6f72 6d28 7461 626c 655f 6461  ansform(table_da
+00022300: 7461 290a 0a20 2020 2020 2020 2023 2041  ta)..        # A
+00022310: 7373 6572 740a 2020 2020 2020 2020 6578  ssert.        ex
+00022320: 7065 6374 6564 5f6f 7574 203d 2070 642e  pected_out = pd.
+00022330: 4461 7461 4672 616d 6528 7b0a 2020 2020  DataFrame({.    
+00022340: 2020 2020 2020 2020 2761 273a 205b 302e          'a': [0.
+00022350: 302c 2031 2e30 2c20 302e 305d 2c0a 2020  0, 1.0, 0.0],.  
+00022360: 2020 2020 2020 2020 2020 2762 273a 205b            'b': [
+00022370: 312e 302c 2030 2e30 2c20 312e 305d 2c0a  1.0, 0.0, 1.0],.
+00022380: 2020 2020 2020 2020 2020 2020 2763 273a              'c':
+00022390: 205b 312c 2032 2c20 335d 0a20 2020 2020   [1, 2, 3].     
+000223a0: 2020 207d 290a 2020 2020 2020 2020 7064     }).        pd
+000223b0: 2e74 6573 7469 6e67 2e61 7373 6572 745f  .testing.assert_
+000223c0: 6672 616d 655f 6571 7561 6c28 6578 7065  frame_equal(expe
+000223d0: 6374 6564 5f6f 7574 2c20 6f75 7429 0a0a  cted_out, out)..
+000223e0: 2020 2020 6465 6620 7465 7374 5f69 735f      def test_is_
+000223f0: 7661 6c69 6428 7365 6c66 293a 0a20 2020  valid(self):.   
+00022400: 2020 2020 2022 2222 5465 7374 2074 6865       """Test the
+00022410: 2060 604f 6e65 486f 7445 6e63 6f64 696e   ``OneHotEncodin
+00022420: 672e 6973 5f76 616c 6964 6060 206d 6574  g.is_valid`` met
+00022430: 686f 642e 0a0a 2020 2020 2020 2020 6060  hod...        ``
+00022440: 5472 7565 6060 2077 6865 6e20 666f 7220  True`` when for 
+00022450: 7468 6520 726f 7773 2077 6865 7265 2074  the rows where t
+00022460: 6865 2064 6174 6120 6973 206f 6e65 2068  he data is one h
+00022470: 6f74 2c20 6060 4661 6c73 6560 6020 6f74  ot, ``False`` ot
+00022480: 6865 7277 6973 652e 0a0a 2020 2020 2020  herwise...      
+00022490: 2020 496e 7075 743a 0a20 2020 2020 2020    Input:.       
+000224a0: 202d 2054 6162 6c65 2064 6174 6120 2870   - Table data (p
+000224b0: 616e 6461 732e 4461 7461 4672 616d 6529  andas.DataFrame)
+000224c0: 2063 6f6e 7461 696e 696e 6720 6f6e 6520   containing one 
+000224d0: 7661 6c69 6420 636f 6c75 6d6e 2c20 6f6e  valid column, on
+000224e0: 6520 636f 6c75 6d6e 2077 6974 6820 6120  e column with a 
+000224f0: 7375 6d20 6c65 7373 0a20 2020 2020 2020  sum less.       
+00022500: 2074 6861 6e20 312c 206f 6e65 2063 6f6c   than 1, one col
+00022510: 756d 6e20 7769 7468 2061 2073 756d 2067  umn with a sum g
+00022520: 7265 6174 6572 2074 6861 6e20 312c 206f  reater than 1, o
+00022530: 6e65 2063 6f6c 756d 6e20 7769 7468 2068  ne column with h
+00022540: 616c 7665 7320 6164 6469 6e67 2074 6f20  alves adding to 
+00022550: 6f6e 6520 616e 6420 6f6e 650a 2020 2020  one and one.    
+00022560: 2020 2020 636f 6c75 6d6e 2077 6974 6820      column with 
+00022570: 6e61 6e73 2e0a 2020 2020 2020 2020 4f75  nans..        Ou
+00022580: 7470 7574 3a0a 2020 2020 2020 2020 2d20  tput:.        - 
+00022590: 5365 7269 6573 206f 6620 6060 5472 7565  Series of ``True
+000225a0: 6060 2061 6e64 2060 6046 616c 7365 6060  `` and ``False``
+000225b0: 2076 616c 7565 7320 2870 616e 6461 732e   values (pandas.
+000225c0: 5365 7269 6573 290a 2020 2020 2020 2020  Series).        
+000225d0: 2222 220a 2020 2020 2020 2020 2320 5365  """.        # Se
+000225e0: 7475 700a 2020 2020 2020 2020 696e 7374  tup.        inst
+000225f0: 616e 6365 203d 204f 6e65 486f 7445 6e63  ance = OneHotEnc
+00022600: 6f64 696e 6728 636f 6c75 6d6e 5f6e 616d  oding(column_nam
+00022610: 6573 3d5b 2761 272c 2027 6227 2c20 2763  es=['a', 'b', 'c
+00022620: 275d 290a 0a20 2020 2020 2020 2023 2052  '])..        # R
+00022630: 756e 0a20 2020 2020 2020 2074 6162 6c65  un.        table
+00022640: 5f64 6174 6120 3d20 7064 2e44 6174 6146  _data = pd.DataF
+00022650: 7261 6d65 287b 0a20 2020 2020 2020 2020  rame({.         
+00022660: 2020 2027 6127 3a20 5b31 2e30 2c20 312e     'a': [1.0, 1.
+00022670: 302c 2030 2e30 2c20 302e 352c 2031 2e30  0, 0.0, 0.5, 1.0
+00022680: 5d2c 0a20 2020 2020 2020 2020 2020 2027  ],.            '
+00022690: 6227 3a20 5b30 2e30 2c20 312e 302c 2030  b': [0.0, 1.0, 0
+000226a0: 2e30 2c20 302e 352c 2030 2e30 5d2c 0a20  .0, 0.5, 0.0],. 
+000226b0: 2020 2020 2020 2020 2020 2027 6327 3a20             'c': 
+000226c0: 5b30 2e30 2c20 322e 302c 2030 2e30 2c20  [0.0, 2.0, 0.0, 
+000226d0: 302e 302c 206e 702e 6e61 6e5d 2c0a 2020  0.0, np.nan],.  
+000226e0: 2020 2020 2020 2020 2020 2764 273a 205b            'd': [
+000226f0: 312c 2032 2c20 332c 2034 2c20 355d 0a20  1, 2, 3, 4, 5]. 
+00022700: 2020 2020 2020 207d 290a 2020 2020 2020         }).      
+00022710: 2020 6f75 7420 3d20 696e 7374 616e 6365    out = instance
+00022720: 2e69 735f 7661 6c69 6428 7461 626c 655f  .is_valid(table_
+00022730: 6461 7461 290a 0a20 2020 2020 2020 2023  data)..        #
+00022740: 2041 7373 6572 740a 2020 2020 2020 2020   Assert.        
+00022750: 6578 7065 6374 6564 5f6f 7574 203d 2070  expected_out = p
+00022760: 642e 5365 7269 6573 285b 5472 7565 2c20  d.Series([True, 
+00022770: 4661 6c73 652c 2046 616c 7365 2c20 4661  False, False, Fa
+00022780: 6c73 652c 2046 616c 7365 5d29 0a20 2020  lse, False]).   
+00022790: 2020 2020 2070 642e 7465 7374 696e 672e       pd.testing.
+000227a0: 6173 7365 7274 5f73 6572 6965 735f 6571  assert_series_eq
+000227b0: 7561 6c28 6578 7065 6374 6564 5f6f 7574  ual(expected_out
+000227c0: 2c20 6f75 7429 0a0a 0a63 6c61 7373 2054  , out)...class T
+000227d0: 6573 7455 6e69 7175 6528 293a 0a0a 2020  estUnique():..  
+000227e0: 2020 6465 6620 7465 7374 5f5f 7661 6c69    def test__vali
+000227f0: 6461 7465 5f69 6e70 7574 7328 7365 6c66  date_inputs(self
+00022800: 293a 0a20 2020 2020 2020 2022 2222 5465  ):.        """Te
+00022810: 7374 2074 6865 2060 6055 6e69 7175 652e  st the ``Unique.
+00022820: 5f76 616c 6964 6174 655f 696e 7075 7473  _validate_inputs
+00022830: 6060 206d 6574 686f 642e 0a0a 2020 2020  `` method...    
+00022840: 2020 2020 496e 7075 743a 0a20 2020 2020      Input:.     
+00022850: 2020 202d 2020 496e 636f 7272 6563 7420     -  Incorrect 
+00022860: 6172 6775 6d65 6e74 7320 666f 7220 7468  arguments for th
+00022870: 6520 6d65 7468 6f64 0a20 2020 2020 2020  e method.       
+00022880: 2052 6169 7365 733a 0a20 2020 2020 2020   Raises:.       
+00022890: 202d 204c 6973 7420 6f66 2056 616c 7565   - List of Value
+000228a0: 4572 726f 7273 0a20 2020 2020 2020 2022  Errors.        "
+000228b0: 2222 0a20 2020 2020 2020 2023 2052 756e  "".        # Run
+000228c0: 202f 2041 7373 6572 740a 2020 2020 2020   / Assert.      
+000228d0: 2020 7769 7468 2070 7974 6573 742e 7261    with pytest.ra
+000228e0: 6973 6573 2841 6767 7265 6761 7465 436f  ises(AggregateCo
+000228f0: 6e73 7472 6169 6e74 7345 7272 6f72 2920  nstraintsError) 
+00022900: 6173 2065 7272 6f72 3a0a 2020 2020 2020  as error:.      
+00022910: 2020 2020 2020 556e 6971 7565 2e5f 7661        Unique._va
+00022920: 6c69 6461 7465 5f69 6e70 7574 7328 6e6f  lidate_inputs(no
+00022930: 745f 636f 6c75 6d6e 5f6e 616d 6573 3d4e  t_column_names=N
+00022940: 6f6e 652c 2073 6f6d 6574 6869 6e67 5f65  one, something_e
+00022950: 6c73 653d 4e6f 6e65 290a 0a20 2020 2020  lse=None)..     
+00022960: 2020 2065 7272 5f6d 7367 203d 2028 0a20     err_msg = (. 
+00022970: 2020 2020 2020 2020 2020 2072 274d 6973             r'Mis
+00022980: 7369 6e67 2072 6571 7569 7265 6420 7661  sing required va
+00022990: 6c75 6573 207b 282e 2a29 7d20 696e 2061  lues {(.*)} in a
+000229a0: 2055 6e69 7175 6520 636f 6e73 7472 6169   Unique constrai
+000229b0: 6e74 2e27 0a20 2020 2020 2020 2020 2020  nt.'.           
+000229c0: 2072 275c 6e5c 6e49 6e76 616c 6964 2076   r'\n\nInvalid v
+000229d0: 616c 7565 7320 7b28 2e2a 297d 2061 7265  alues {(.*)} are
+000229e0: 2070 7265 7365 6e74 2069 6e20 6120 556e   present in a Un
+000229f0: 6971 7565 2063 6f6e 7374 7261 696e 742e  ique constraint.
+00022a00: 270a 2020 2020 2020 2020 290a 2020 2020  '.        ).    
+00022a10: 2020 2020 6772 6f75 7073 203d 2072 652e      groups = re.
+00022a20: 7365 6172 6368 2865 7272 5f6d 7367 2c20  search(err_msg, 
+00022a30: 7374 7228 6572 726f 722e 7661 6c75 6529  str(error.value)
+00022a40: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
+00022a50: 2067 726f 7570 7320 6973 206e 6f74 204e   groups is not N
+00022a60: 6f6e 650a 2020 2020 2020 2020 6173 7365  one.        asse
+00022a70: 7274 2073 7472 2865 7661 6c28 6772 6f75  rt str(eval(grou
+00022a80: 7073 2e67 726f 7570 2831 2929 2920 3d3d  ps.group(1))) ==
+00022a90: 2027 636f 6c75 6d6e 5f6e 616d 6573 270a   'column_names'.
+00022aa0: 2020 2020 2020 2020 6173 7365 7274 2073          assert s
+00022ab0: 6574 2865 7661 6c28 6772 6f75 7073 2e67  et(eval(groups.g
+00022ac0: 726f 7570 2832 2929 2920 3d3d 207b 276e  roup(2))) == {'n
+00022ad0: 6f74 5f63 6f6c 756d 6e5f 6e61 6d65 7327  ot_column_names'
+00022ae0: 2c20 2773 6f6d 6574 6869 6e67 5f65 6c73  , 'something_els
+00022af0: 6527 7d0a 0a20 2020 2064 6566 2074 6573  e'}..    def tes
+00022b00: 745f 5f76 616c 6964 6174 655f 6d65 7461  t__validate_meta
+00022b10: 6461 7461 5f63 6f6c 756d 6e73 2873 656c  data_columns(sel
+00022b20: 6629 3a0a 2020 2020 2020 2020 2222 2254  f):.        """T
+00022b30: 6573 7420 7468 6520 6060 5f76 616c 6964  est the ``_valid
+00022b40: 6174 655f 6d65 7461 6461 7461 5f63 6f6c  ate_metadata_col
+00022b50: 756d 6e73 6060 206d 6574 686f 642e 0a0a  umns`` method...
+00022b60: 2020 2020 2020 2020 416c 6c20 6f66 2074          All of t
+00022b70: 6865 2063 6f6c 756d 6e73 2070 6173 7365  he columns passe
+00022b80: 6420 696e 2063 6f6c 756d 6e5f 6e61 6d65  d in column_name
+00022b90: 7320 7368 6f75 6c64 2062 6520 696e 2074  s should be in t
+00022ba0: 6865 206d 6574 6164 6174 612e 0a0a 2020  he metadata...  
+00022bb0: 2020 2020 2020 496e 7075 743a 0a20 2020        Input:.   
+00022bc0: 2020 2020 2020 2020 202d 2063 6f6c 756d           - colum
+00022bd0: 6e5f 6e61 6d65 7320 7769 7468 2063 6f6c  n_names with col
+00022be0: 756d 6e73 2074 6861 7420 6172 6520 616c  umns that are al
+00022bf0: 6c20 696e 2074 6865 206d 6574 6164 6174  l in the metadat
+00022c00: 612e 0a0a 2020 2020 2020 2020 5369 6465  a...        Side
+00022c10: 2065 6666 6563 743a 0a20 2020 2020 2020   effect:.       
+00022c20: 2020 2020 202d 204e 6f20 6572 726f 7220       - No error 
+00022c30: 7368 6f75 6c64 2062 6520 7261 6973 6564  should be raised
+00022c40: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+00022c50: 2020 2020 2020 2320 5365 7475 700a 2020        # Setup.  
+00022c60: 2020 2020 2020 6d65 7461 6461 7461 203d        metadata =
+00022c70: 204d 6f63 6b28 290a 2020 2020 2020 2020   Mock().        
+00022c80: 6d65 7461 6461 7461 2e63 6f6c 756d 6e73  metadata.columns
+00022c90: 203d 207b 2761 273a 2031 2c20 2762 273a   = {'a': 1, 'b':
+00022ca0: 2032 7d0a 0a20 2020 2020 2020 2023 2052   2}..        # R
+00022cb0: 756e 0a20 2020 2020 2020 2055 6e69 7175  un.        Uniqu
+00022cc0: 652e 5f76 616c 6964 6174 655f 6d65 7461  e._validate_meta
+00022cd0: 6461 7461 5f63 6f6c 756d 6e73 286d 6574  data_columns(met
+00022ce0: 6164 6174 612c 2063 6f6c 756d 6e5f 6e61  adata, column_na
+00022cf0: 6d65 733d 5b27 6127 2c20 2762 275d 290a  mes=['a', 'b']).
+00022d00: 0a20 2020 2064 6566 2074 6573 745f 5f76  .    def test__v
+00022d10: 616c 6964 6174 655f 6d65 7461 6461 7461  alidate_metadata
+00022d20: 5f63 6f6c 756d 6e73 5f72 6169 7365 735f  _columns_raises_
+00022d30: 6572 726f 7228 7365 6c66 293a 0a20 2020  error(self):.   
+00022d40: 2020 2020 2022 2222 5465 7374 2074 6865       """Test the
+00022d50: 2060 605f 7661 6c69 6461 7465 5f6d 6574   ``_validate_met
+00022d60: 6164 6174 615f 636f 6c75 6d6e 7360 6020  adata_columns`` 
+00022d70: 6d65 7468 6f64 2773 2065 7272 6f72 2063  method's error c
+00022d80: 6f6e 6469 7469 6f6e 2e0a 0a20 2020 2020  ondition...     
+00022d90: 2020 2049 6620 616e 7920 636f 6c75 6d6e     If any column
+00022da0: 7320 696e 2063 6f6c 756d 6e5f 6e61 6d65  s in column_name
+00022db0: 7320 6172 6520 6e6f 7420 696e 2074 6865  s are not in the
+00022dc0: 206d 6574 6164 6174 612c 2061 6e20 6572   metadata, an er
+00022dd0: 726f 7220 7368 6f75 6c64 2062 6520 7261  ror should be ra
+00022de0: 6973 6564 2e0a 0a20 2020 2020 2020 2049  ised...        I
+00022df0: 6e70 7574 3a0a 2020 2020 2020 2020 2020  nput:.          
+00022e00: 2020 2d20 636f 6c75 6d6e 5f6e 616d 6573    - column_names
+00022e10: 2074 6861 7420 636f 6e74 6169 6e73 2061   that contains a
+00022e20: 2063 6f6c 756d 6e20 6e6f 7420 696e 2074   column not in t
+00022e30: 6865 206d 6574 6164 6174 612e 0a0a 2020  he metadata...  
+00022e40: 2020 2020 2020 5369 6465 2065 6666 6563        Side effec
+00022e50: 743a 0a20 2020 2020 2020 2020 2020 202d  t:.            -
+00022e60: 2043 6f6e 7374 7261 696e 744d 6574 6164   ConstraintMetad
+00022e70: 6174 6145 7272 6f72 2073 686f 756c 6420  ataError should 
+00022e80: 6265 2072 6169 7365 642e 0a20 2020 2020  be raised..     
+00022e90: 2020 2022 2222 0a20 2020 2020 2020 2023     """.        #
+00022ea0: 2053 6574 7570 0a20 2020 2020 2020 206d   Setup.        m
+00022eb0: 6574 6164 6174 6120 3d20 4d6f 636b 2829  etadata = Mock()
+00022ec0: 0a20 2020 2020 2020 206d 6574 6164 6174  .        metadat
+00022ed0: 612e 636f 6c75 6d6e 7320 3d20 7b27 6127  a.columns = {'a'
+00022ee0: 3a20 312c 2027 6227 3a20 327d 0a0a 2020  : 1, 'b': 2}..  
+00022ef0: 2020 2020 2020 2320 5275 6e0a 2020 2020        # Run.    
+00022f00: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
+00022f10: 6520 3d20 7265 2e65 7363 6170 6528 0a20  e = re.escape(. 
+00022f20: 2020 2020 2020 2020 2020 2027 4120 556e             'A Un
+00022f30: 6971 7565 2063 6f6e 7374 7261 696e 7420  ique constraint 
+00022f40: 6973 2062 6569 6e67 2061 7070 6c69 6564  is being applied
+00022f50: 2074 6f20 696e 7661 6c69 6420 636f 6c75   to invalid colu
+00022f60: 6d6e 206e 616d 6573 2027 0a20 2020 2020  mn names '.     
+00022f70: 2020 2020 2020 2022 7b27 6327 7d2e 2054         "{'c'}. T
+00022f80: 6865 2063 6f6c 756d 6e73 206d 7573 7420  he columns must 
+00022f90: 6578 6973 7420 696e 2074 6865 2074 6162  exist in the tab
+00022fa0: 6c65 2e22 0a20 2020 2020 2020 2029 0a20  le.".        ). 
+00022fb0: 2020 2020 2020 2077 6974 6820 7079 7465         with pyte
+00022fc0: 7374 2e72 6169 7365 7328 436f 6e73 7472  st.raises(Constr
+00022fd0: 6169 6e74 4d65 7461 6461 7461 4572 726f  aintMetadataErro
+00022fe0: 722c 206d 6174 6368 3d65 7272 6f72 5f6d  r, match=error_m
+00022ff0: 6573 7361 6765 293a 0a20 2020 2020 2020  essage):.       
+00023000: 2020 2020 2055 6e69 7175 652e 5f76 616c       Unique._val
+00023010: 6964 6174 655f 6d65 7461 6461 7461 5f63  idate_metadata_c
+00023020: 6f6c 756d 6e73 286d 6574 6164 6174 612c  olumns(metadata,
+00023030: 2063 6f6c 756d 6e5f 6e61 6d65 733d 5b27   column_names=['
+00023040: 6127 2c20 2763 275d 290a 0a20 2020 2064  a', 'c'])..    d
+00023050: 6566 2074 6573 745f 5f76 616c 6964 6174  ef test__validat
+00023060: 655f 6d65 7461 6461 7461 5f73 7065 6369  e_metadata_speci
+00023070: 6669 635f 746f 5f63 6f6e 7374 7261 696e  fic_to_constrain
+00023080: 7428 7365 6c66 293a 0a20 2020 2020 2020  t(self):.       
+00023090: 2022 2222 5465 7374 2074 6865 2060 605f   """Test the ``_
+000230a0: 7661 6c69 6461 7465 5f6d 6574 6164 6174  validate_metadat
+000230b0: 615f 7370 6563 6966 6963 5f74 6f5f 636f  a_specific_to_co
+000230c0: 6e73 7472 6169 6e74 6060 2e0a 0a20 2020  nstraint``...   
+000230d0: 2020 2020 2049 6620 6174 206c 6561 7374       If at least
+000230e0: 206f 6e65 206f 6620 7468 6520 636f 6c75   one of the colu
+000230f0: 6d6e 7320 696e 2060 6063 6f6c 756d 6e5f  mns in ``column_
+00023100: 6e61 6d65 7360 6020 6973 206e 6f74 2061  names`` is not a
+00023110: 206b 6579 2c20 6e6f 2065 7272 6f72 2073   key, no error s
+00023120: 686f 756c 640a 2020 2020 2020 2020 6265  hould.        be
+00023130: 2072 6169 7365 642e 0a0a 2020 2020 2020   raised...      
+00023140: 2020 496e 7075 743a 0a20 2020 2020 2020    Input:.       
+00023150: 2020 2020 202d 204d 6574 6164 6174 6120       - Metadata 
+00023160: 7769 7468 2070 7269 6d61 7279 2061 6e64  with primary and
+00023170: 2061 6c74 6572 6e61 7465 206b 6579 732e   alternate keys.
+00023180: 0a20 2020 2020 2020 2020 2020 202d 2043  .            - C
+00023190: 6f6c 756d 6e20 6e61 6d65 7320 7769 7468  olumn names with
+000231a0: 206c 6973 7420 6f66 2063 6f6c 756d 6e73   list of columns
+000231b0: 2064 6966 6665 7265 6e74 2068 7461 6e20   different htan 
+000231c0: 7468 6520 7072 696d 6172 7920 6b65 7920  the primary key 
+000231d0: 616e 6420 616c 7465 726e 6174 6520 6b65  and alternate ke
+000231e0: 7973 2e0a 2020 2020 2020 2020 2222 220a  ys..        """.
+000231f0: 2020 2020 2020 2020 2320 5365 7475 700a          # Setup.
+00023200: 2020 2020 2020 2020 6d65 7461 6461 7461          metadata
+00023210: 203d 204d 6f63 6b28 290a 2020 2020 2020   = Mock().      
+00023220: 2020 6d65 7461 6461 7461 2e70 7269 6d61    metadata.prima
+00023230: 7279 5f6b 6579 203d 2027 6127 0a20 2020  ry_key = 'a'.   
+00023240: 2020 2020 206d 6574 6164 6174 612e 616c       metadata.al
+00023250: 7465 726e 6174 655f 6b65 7973 203d 205b  ternate_keys = [
+00023260: 2762 272c 2027 6327 5d0a 0a20 2020 2020  'b', 'c']..     
+00023270: 2020 2023 2052 756e 0a20 2020 2020 2020     # Run.       
+00023280: 2055 6e69 7175 652e 5f76 616c 6964 6174   Unique._validat
+00023290: 655f 6d65 7461 6461 7461 5f73 7065 6369  e_metadata_speci
+000232a0: 6669 635f 746f 5f63 6f6e 7374 7261 696e  fic_to_constrain
+000232b0: 7428 0a20 2020 2020 2020 2020 2020 206d  t(.            m
+000232c0: 6574 6164 6174 612c 0a20 2020 2020 2020  etadata,.       
+000232d0: 2020 2020 2063 6f6c 756d 6e5f 6e61 6d65       column_name
+000232e0: 733d 5b27 6127 2c20 2762 272c 2027 6427  s=['a', 'b', 'd'
+000232f0: 5d0a 2020 2020 2020 2020 290a 0a20 2020  ].        )..   
+00023300: 2064 6566 2074 6573 745f 5f76 616c 6964   def test__valid
+00023310: 6174 655f 6d65 7461 6461 7461 5f73 7065  ate_metadata_spe
+00023320: 6369 6669 635f 746f 5f63 6f6e 7374 7261  cific_to_constra
+00023330: 696e 745f 6572 726f 7228 7365 6c66 293a  int_error(self):
+00023340: 0a20 2020 2020 2020 2022 2222 5465 7374  .        """Test
+00023350: 2074 6865 2060 605f 7661 6c69 6461 7465   the ``_validate
+00023360: 5f6d 6574 6164 6174 615f 7370 6563 6966  _metadata_specif
+00023370: 6963 5f74 6f5f 636f 6e73 7472 6169 6e74  ic_to_constraint
+00023380: 6060 2e0a 0a20 2020 2020 2020 2049 6620  ``...        If 
+00023390: 616c 6c20 6f66 2074 6865 2063 6f6c 756d  all of the colum
+000233a0: 6e73 2069 6e20 6060 636f 6c75 6d6e 5f6e  ns in ``column_n
+000233b0: 616d 6573 6060 2061 7265 206b 6579 732c  ames`` are keys,
+000233c0: 2061 6e20 6572 726f 7220 7368 6f75 6c64   an error should
+000233d0: 0a20 2020 2020 2020 2062 6520 7261 6973  .        be rais
+000233e0: 6564 2e0a 0a20 2020 2020 2020 2049 6e70  ed...        Inp
+000233f0: 7574 3a0a 2020 2020 2020 2020 2020 2020  ut:.            
+00023400: 2d20 4d65 7461 6461 7461 2077 6974 6820  - Metadata with 
+00023410: 7072 696d 6172 7920 616e 6420 616c 7465  primary and alte
+00023420: 726e 6174 6520 6b65 7973 2e0a 2020 2020  rnate keys..    
+00023430: 2020 2020 2020 2020 2d20 436f 6c75 6d6e          - Column
+00023440: 206e 616d 6573 2077 6974 6820 6c69 7374   names with list
+00023450: 206f 6620 636f 6c75 6d6e 7320 6469 6666   of columns diff
+00023460: 6572 656e 7420 6874 616e 2074 6865 2070  erent htan the p
+00023470: 7269 6d61 7279 206b 6579 2061 6e64 2061  rimary key and a
+00023480: 6c74 6572 6e61 7465 206b 6579 732e 0a20  lternate keys.. 
+00023490: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+000234a0: 2020 2023 2053 6574 7570 0a20 2020 2020     # Setup.     
+000234b0: 2020 206d 6574 6164 6174 6120 3d20 4d6f     metadata = Mo
+000234c0: 636b 2829 0a20 2020 2020 2020 206d 6574  ck().        met
+000234d0: 6164 6174 612e 7072 696d 6172 795f 6b65  adata.primary_ke
+000234e0: 7920 3d20 2761 270a 2020 2020 2020 2020  y = 'a'.        
+000234f0: 6d65 7461 6461 7461 2e61 6c74 6572 6e61  metadata.alterna
+00023500: 7465 5f6b 6579 7320 3d20 5b28 2762 272c  te_keys = [('b',
+00023510: 2027 6327 292c 2027 6427 5d0a 0a20 2020   'c'), 'd']..   
+00023520: 2020 2020 2023 2052 756e 0a20 2020 2020       # Run.     
+00023530: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
+00023540: 203d 2072 652e 6573 6361 7065 280a 2020   = re.escape(.  
+00023550: 2020 2020 2020 2020 2020 2241 2055 6e69            "A Uni
+00023560: 7175 6520 636f 6e73 7472 6169 6e74 2069  que constraint i
+00023570: 7320 6265 696e 6720 6170 706c 6965 6420  s being applied 
+00023580: 746f 2063 6f6c 756d 6e73 2027 5b27 6127  to columns '['a'
+00023590: 2c20 2762 272c 2027 6327 5d27 2e20 220a  , 'b', 'c']'. ".
+000235a0: 2020 2020 2020 2020 2020 2020 2754 6865              'The
+000235b0: 7365 2063 6f6c 756d 6e73 2061 7265 2061  se columns are a
+000235c0: 6c72 6561 6479 2061 206b 6579 2066 6f72  lready a key for
+000235d0: 2074 6861 7420 7461 626c 652e 270a 2020   that table.'.  
+000235e0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+000235f0: 7769 7468 2070 7974 6573 742e 7261 6973  with pytest.rais
+00023600: 6573 2843 6f6e 7374 7261 696e 744d 6574  es(ConstraintMet
+00023610: 6164 6174 6145 7272 6f72 2c20 6d61 7463  adataError, matc
+00023620: 683d 6572 726f 725f 6d65 7373 6167 6529  h=error_message)
+00023630: 3a0a 2020 2020 2020 2020 2020 2020 556e  :.            Un
+00023640: 6971 7565 2e5f 7661 6c69 6461 7465 5f6d  ique._validate_m
+00023650: 6574 6164 6174 615f 7370 6563 6966 6963  etadata_specific
+00023660: 5f74 6f5f 636f 6e73 7472 6169 6e74 280a  _to_constraint(.
+00023670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023680: 6d65 7461 6461 7461 2c0a 2020 2020 2020  metadata,.      
+00023690: 2020 2020 2020 2020 2020 636f 6c75 6d6e            column
+000236a0: 5f6e 616d 6573 3d5b 2761 272c 2027 6227  _names=['a', 'b'
+000236b0: 2c20 2763 275d 0a20 2020 2020 2020 2020  , 'c'].         
+000236c0: 2020 2029 0a0a 2020 2020 6465 6620 7465     )..    def te
+000236d0: 7374 5f5f 5f69 6e69 745f 5f28 7365 6c66  st___init__(self
+000236e0: 293a 0a20 2020 2020 2020 2022 2222 5465  ):.        """Te
+000236f0: 7374 2074 6865 2060 6055 6e69 7175 652e  st the ``Unique.
+00023700: 5f5f 696e 6974 5f5f 6060 206d 6574 686f  __init__`` metho
+00023710: 642e 0a0a 2020 2020 2020 2020 5468 6520  d...        The 
+00023720: 6060 636f 6c75 6d6e 5f6e 616d 6573 6060  ``column_names``
+00023730: 2073 686f 756c 6420 6265 2073 6574 2074   should be set t
+00023740: 6f20 7468 6f73 6520 7072 6f76 6964 6564  o those provided
+00023750: 2e0a 0a20 2020 2020 2020 2049 6e70 7574  ...        Input
+00023760: 3a0a 2020 2020 2020 2020 2d20 636f 6c75  :.        - colu
+00023770: 6d6e 206e 616d 6573 2074 6f20 6b65 6570  mn names to keep
+00023780: 2075 6e69 7175 652e 0a20 2020 2020 2020   unique..       
+00023790: 204f 7574 7075 743a 0a20 2020 2020 2020   Output:.       
+000237a0: 202d 2049 6e73 7461 6e63 6520 7769 7468   - Instance with
+000237b0: 2060 6063 6f6c 756d 6e5f 6e61 6d65 7360   ``column_names`
+000237c0: 6020 7365 742e 0a20 2020 2020 2020 2022  ` set..        "
+000237d0: 2222 0a20 2020 2020 2020 2023 2052 756e  "".        # Run
+000237e0: 0a20 2020 2020 2020 2069 6e73 7461 6e63  .        instanc
+000237f0: 6520 3d20 556e 6971 7565 2863 6f6c 756d  e = Unique(colum
+00023800: 6e5f 6e61 6d65 733d 5b27 6127 2c20 2762  n_names=['a', 'b
+00023810: 275d 290a 0a20 2020 2020 2020 2023 2041  '])..        # A
+00023820: 7373 6572 740a 2020 2020 2020 2020 6173  ssert.        as
+00023830: 7365 7274 2069 6e73 7461 6e63 652e 636f  sert instance.co
+00023840: 6c75 6d6e 5f6e 616d 6573 203d 3d20 5b27  lumn_names == ['
+00023850: 6127 2c20 2762 275d 0a0a 2020 2020 6465  a', 'b']..    de
+00023860: 6620 7465 7374 5f69 735f 7661 6c69 6428  f test_is_valid(
+00023870: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
+00023880: 2222 5465 7374 2074 6865 2060 6055 6e69  ""Test the ``Uni
+00023890: 7175 652e 6973 5f76 616c 6964 6060 206d  que.is_valid`` m
+000238a0: 6574 686f 642e 0a0a 2020 2020 2020 2020  ethod...        
+000238b0: 5468 6973 206d 6574 686f 6420 7368 6f75  This method shou
+000238c0: 6c64 2072 6574 7572 6e20 6120 7064 2e53  ld return a pd.S
+000238d0: 6572 6965 7320 7768 6572 6520 7468 6520  eries where the 
+000238e0: 696e 6465 780a 2020 2020 2020 2020 6f66  index.        of
+000238f0: 2074 6865 2066 6972 7374 206f 6363 7572   the first occur
+00023900: 656e 6365 206f 6620 6120 756e 6971 7565  ence of a unique
+00023910: 2063 6f6d 6269 6e61 7469 6f6e 206f 6620   combination of 
+00023920: 6060 696e 7374 616e 6365 2e63 6f6c 756d  ``instance.colum
+00023930: 6e5f 6e61 6d65 7360 600a 2020 2020 2020  n_names``.      
+00023940: 2020 6973 2073 6574 2074 6f20 6060 5472    is set to ``Tr
+00023950: 7565 6060 2c20 616e 6420 6576 6572 7920  ue``, and every 
+00023960: 6f74 6865 7220 6f63 6375 7265 6e63 6520  other occurence 
+00023970: 6973 2073 6574 2074 6f20 6060 4661 6c73  is set to ``Fals
+00023980: 6560 602e 0a0a 2020 2020 2020 2020 496e  e``...        In
+00023990: 7075 743a 0a20 2020 2020 2020 202d 2044  put:.        - D
+000239a0: 6174 6146 7261 6d65 2077 6974 6820 6d75  ataFrame with mu
+000239b0: 6c74 6970 6c65 206f 6620 7468 6520 7361  ltiple of the sa
+000239c0: 6d65 2063 6f6d 6269 6e61 7469 6f6e 7320  me combinations 
+000239d0: 6f66 2063 6f6c 756d 6e73 2e0a 2020 2020  of columns..    
+000239e0: 2020 2020 4f75 7470 7574 3a0a 2020 2020      Output:.    
+000239f0: 2020 2020 2d20 5365 7269 6573 2077 6974      - Series wit
+00023a00: 6820 7468 6520 696e 6465 7820 6f66 2074  h the index of t
+00023a10: 6865 2066 6972 7374 206f 6363 7572 656e  he first occuren
+00023a20: 6365 7320 7365 7420 746f 2060 6054 7275  ces set to ``Tru
+00023a30: 6560 602e 0a20 2020 2020 2020 2022 2222  e``..        """
+00023a40: 0a20 2020 2020 2020 2023 2053 6574 7570  .        # Setup
+00023a50: 0a20 2020 2020 2020 2069 6e73 7461 6e63  .        instanc
+00023a60: 6520 3d20 556e 6971 7565 2863 6f6c 756d  e = Unique(colum
+00023a70: 6e5f 6e61 6d65 733d 5b27 6127 2c20 2762  n_names=['a', 'b
+00023a80: 272c 2027 6327 5d29 0a0a 2020 2020 2020  ', 'c'])..      
+00023a90: 2020 2320 5275 6e0a 2020 2020 2020 2020    # Run.        
+00023aa0: 6461 7461 203d 2070 642e 4461 7461 4672  data = pd.DataFr
+00023ab0: 616d 6528 7b0a 2020 2020 2020 2020 2020  ame({.          
+00023ac0: 2020 2761 273a 205b 312c 2031 2c20 322c    'a': [1, 1, 2,
+00023ad0: 2032 2c20 332c 2034 5d2c 0a20 2020 2020   2, 3, 4],.     
+00023ae0: 2020 2020 2020 2027 6227 3a20 5b35 2c20         'b': [5, 
+00023af0: 352c 2036 2c20 362c 2037 2c20 385d 2c0a  5, 6, 6, 7, 8],.
+00023b00: 2020 2020 2020 2020 2020 2020 2763 273a              'c':
+00023b10: 205b 392c 2039 2c20 3130 2c20 3130 2c20   [9, 9, 10, 10, 
+00023b20: 3132 2c20 3133 5d0a 2020 2020 2020 2020  12, 13].        
+00023b30: 7d29 0a20 2020 2020 2020 2076 616c 6964  }).        valid
+00023b40: 203d 2069 6e73 7461 6e63 652e 6973 5f76   = instance.is_v
+00023b50: 616c 6964 2864 6174 6129 0a0a 2020 2020  alid(data)..    
+00023b60: 2020 2020 2320 4173 7365 7274 0a20 2020      # Assert.   
+00023b70: 2020 2020 2065 7870 6563 7465 6420 3d20       expected = 
+00023b80: 7064 2e53 6572 6965 7328 5b54 7275 652c  pd.Series([True,
+00023b90: 2046 616c 7365 2c20 5472 7565 2c20 4661   False, True, Fa
+00023ba0: 6c73 652c 2054 7275 652c 2054 7275 655d  lse, True, True]
+00023bb0: 290a 2020 2020 2020 2020 7064 2e74 6573  ).        pd.tes
+00023bc0: 7469 6e67 2e61 7373 6572 745f 7365 7269  ting.assert_seri
+00023bd0: 6573 5f65 7175 616c 2876 616c 6964 2c20  es_equal(valid, 
+00023be0: 6578 7065 6374 6564 290a 0a20 2020 2064  expected)..    d
+00023bf0: 6566 2074 6573 745f 6973 5f76 616c 6964  ef test_is_valid
+00023c00: 5f63 7573 746f 6d5f 696e 6465 785f 7361  _custom_index_sa
+00023c10: 6d65 5f76 616c 7565 7328 7365 6c66 293a  me_values(self):
+00023c20: 0a20 2020 2020 2020 2022 2222 5465 7374  .        """Test
+00023c30: 2074 6865 2060 6055 6e69 7175 652e 6973   the ``Unique.is
+00023c40: 5f76 616c 6964 6060 206d 6574 686f 642e  _valid`` method.
+00023c50: 0a0a 2020 2020 2020 2020 5468 6973 206d  ..        This m
+00023c60: 6574 686f 6420 7368 6f75 6c64 2072 6574  ethod should ret
+00023c70: 7572 6e20 6120 7064 2e53 6572 6965 7320  urn a pd.Series 
+00023c80: 7768 6572 6520 7468 6520 696e 6465 780a  where the index.
+00023c90: 2020 2020 2020 2020 6f66 2074 6865 2066          of the f
+00023ca0: 6972 7374 206f 6363 7572 656e 6365 206f  irst occurence o
+00023cb0: 6620 6120 756e 6971 7565 2063 6f6d 6269  f a unique combi
+00023cc0: 6e61 7469 6f6e 206f 6620 6060 696e 7374  nation of ``inst
+00023cd0: 616e 6365 2e63 6f6c 756d 6e5f 6e61 6d65  ance.column_name
+00023ce0: 7360 600a 2020 2020 2020 2020 6973 2073  s``.        is s
+00023cf0: 6574 2074 6f20 6060 5472 7565 6060 2c20  et to ``True``, 
+00023d00: 616e 6420 6576 6572 7920 6f74 6865 7220  and every other 
+00023d10: 6f63 6375 7265 6e63 6520 6973 2073 6574  occurence is set
+00023d20: 2074 6f20 6060 4661 6c73 6560 602e 0a0a   to ``False``...
+00023d30: 2020 2020 2020 2020 496e 7075 743a 0a20          Input:. 
+00023d40: 2020 2020 2020 202d 2044 6174 6146 7261         - DataFra
+00023d50: 6d65 2077 6974 6820 6d75 6c74 6970 6c65  me with multiple
+00023d60: 206f 6620 7468 6520 7361 6d65 2063 6f6d   of the same com
+00023d70: 6269 6e61 7469 6f6e 7320 6f66 2063 6f6c  binations of col
+00023d80: 756d 6e73 2e0a 2020 2020 2020 2020 2d20  umns..        - 
+00023d90: 4461 7461 4672 616d 6520 6861 7320 6120  DataFrame has a 
+00023da0: 6375 7374 6f6d 2069 6e64 6578 2063 6f6c  custom index col
+00023db0: 756d 6e20 7768 6963 6820 6973 2073 6574  umn which is set
+00023dc0: 2074 6f20 3020 666f 7220 726f 7773 2e0a   to 0 for rows..
+00023dd0: 2020 2020 2020 2020 4f75 7470 7574 3a0a          Output:.
+00023de0: 2020 2020 2020 2020 2d20 5365 7269 6573          - Series
+00023df0: 2077 6974 6820 7468 6520 696e 6465 7820   with the index 
+00023e00: 6f66 2074 6865 2066 6972 7374 206f 6363  of the first occ
+00023e10: 7572 656e 6365 7320 7365 7420 746f 2060  urences set to `
+00023e20: 6054 7275 6560 602e 0a20 2020 2020 2020  `True``..       
+00023e30: 2047 6974 6875 6220 4973 7375 653a 0a20   Github Issue:. 
+00023e40: 2020 2020 2020 202d 2050 726f 626c 656d         - Problem
+00023e50: 2069 7320 6465 7363 7269 6265 6420 696e   is described in
+00023e60: 3a20 6874 7470 733a 2f2f 6769 7468 7562  : https://github
+00023e70: 2e63 6f6d 2f73 6476 2d64 6576 2f53 4456  .com/sdv-dev/SDV
+00023e80: 2f69 7373 7565 732f 3631 360a 2020 2020  /issues/616.    
+00023e90: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00023ea0: 2320 5365 7475 700a 2020 2020 2020 2020  # Setup.        
+00023eb0: 696e 7374 616e 6365 203d 2055 6e69 7175  instance = Uniqu
+00023ec0: 6528 636f 6c75 6d6e 5f6e 616d 6573 3d5b  e(column_names=[
+00023ed0: 2761 272c 2027 6227 2c20 2763 275d 290a  'a', 'b', 'c']).
+00023ee0: 0a20 2020 2020 2020 2023 2052 756e 0a20  .        # Run. 
+00023ef0: 2020 2020 2020 2064 6174 6120 3d20 7064         data = pd
+00023f00: 2e44 6174 6146 7261 6d65 287b 0a20 2020  .DataFrame({.   
+00023f10: 2020 2020 2020 2020 2027 6127 3a20 5b31           'a': [1
+00023f20: 2c20 312c 2032 2c20 322c 2033 5d2c 0a20  , 1, 2, 2, 3],. 
+00023f30: 2020 2020 2020 2020 2020 2027 6227 3a20             'b': 
+00023f40: 5b35 2c20 352c 2036 2c20 362c 2037 5d2c  [5, 5, 6, 6, 7],
+00023f50: 0a20 2020 2020 2020 2020 2020 2027 6327  .            'c'
+00023f60: 3a20 5b38 2c20 382c 2039 2c20 392c 2031  : [8, 8, 9, 9, 1
+00023f70: 305d 0a20 2020 2020 2020 207d 2c20 696e  0].        }, in
+00023f80: 6465 783d 5b30 2c20 302c 2030 2c20 302c  dex=[0, 0, 0, 0,
+00023f90: 2030 5d29 0a20 2020 2020 2020 2076 616c   0]).        val
+00023fa0: 6964 203d 2069 6e73 7461 6e63 652e 6973  id = instance.is
+00023fb0: 5f76 616c 6964 2864 6174 6129 0a0a 2020  _valid(data)..  
+00023fc0: 2020 2020 2020 2320 4173 7365 7274 0a20        # Assert. 
+00023fd0: 2020 2020 2020 2065 7870 6563 7465 6420         expected 
+00023fe0: 3d20 7064 2e53 6572 6965 7328 5b54 7275  = pd.Series([Tru
+00023ff0: 652c 2046 616c 7365 2c20 5472 7565 2c20  e, False, True, 
+00024000: 4661 6c73 652c 2054 7275 655d 2c20 696e  False, True], in
+00024010: 6465 783d 5b30 2c20 302c 2030 2c20 302c  dex=[0, 0, 0, 0,
+00024020: 2030 5d29 0a20 2020 2020 2020 2070 642e   0]).        pd.
+00024030: 7465 7374 696e 672e 6173 7365 7274 5f73  testing.assert_s
+00024040: 6572 6965 735f 6571 7561 6c28 7661 6c69  eries_equal(vali
+00024050: 642c 2065 7870 6563 7465 6429 0a0a 2020  d, expected)..  
+00024060: 2020 6465 6620 7465 7374 5f69 735f 7661    def test_is_va
+00024070: 6c69 645f 6375 7374 6f6d 5f69 6e64 6578  lid_custom_index
+00024080: 5f6e 6f74 5f73 6f72 7465 6428 7365 6c66  _not_sorted(self
+00024090: 293a 0a20 2020 2020 2020 2022 2222 5465  ):.        """Te
+000240a0: 7374 2074 6865 2060 6055 6e69 7175 652e  st the ``Unique.
+000240b0: 6973 5f76 616c 6964 6060 206d 6574 686f  is_valid`` metho
+000240c0: 642e 0a0a 2020 2020 2020 2020 5468 6973  d...        This
+000240d0: 206d 6574 686f 6420 7368 6f75 6c64 2072   method should r
+000240e0: 6574 7572 6e20 6120 7064 2e53 6572 6965  eturn a pd.Serie
+000240f0: 7320 7768 6572 6520 7468 6520 696e 6465  s where the inde
+00024100: 780a 2020 2020 2020 2020 6f66 2074 6865  x.        of the
+00024110: 2066 6972 7374 206f 6363 7572 656e 6365   first occurence
+00024120: 206f 6620 6120 756e 6971 7565 2063 6f6d   of a unique com
+00024130: 6269 6e61 7469 6f6e 206f 6620 6060 696e  bination of ``in
+00024140: 7374 616e 6365 2e63 6f6c 756d 6e5f 6e61  stance.column_na
+00024150: 6d65 7360 600a 2020 2020 2020 2020 6973  mes``.        is
+00024160: 2073 6574 2074 6f20 6060 5472 7565 6060   set to ``True``
+00024170: 2c20 616e 6420 6576 6572 7920 6f74 6865  , and every othe
+00024180: 7220 6f63 6375 7265 6e63 6520 6973 2073  r occurence is s
+00024190: 6574 2074 6f20 6060 4661 6c73 6560 602e  et to ``False``.
+000241a0: 0a0a 2020 2020 2020 2020 496e 7075 743a  ..        Input:
+000241b0: 0a20 2020 2020 2020 202d 2044 6174 6146  .        - DataF
+000241c0: 7261 6d65 2077 6974 6820 6d75 6c74 6970  rame with multip
+000241d0: 6c65 206f 6620 7468 6520 7361 6d65 2063  le of the same c
+000241e0: 6f6d 6269 6e61 7469 6f6e 7320 6f66 2063  ombinations of c
+000241f0: 6f6c 756d 6e73 2e0a 2020 2020 2020 2020  olumns..        
+00024200: 2d20 4461 7461 4672 616d 6520 6861 7320  - DataFrame has 
+00024210: 6120 6375 7374 6f6d 2069 6e64 6578 2063  a custom index c
+00024220: 6f6c 756d 6e20 7768 6963 6820 6973 2073  olumn which is s
+00024230: 6574 2069 6e20 616e 2075 6e73 6f72 7465  et in an unsorte
+00024240: 6420 7761 792e 0a20 2020 2020 2020 204f  d way..        O
+00024250: 7574 7075 743a 0a20 2020 2020 2020 202d  utput:.        -
+00024260: 2053 6572 6965 7320 7769 7468 2074 6865   Series with the
+00024270: 2069 6e64 6578 206f 6620 7468 6520 6669   index of the fi
+00024280: 7273 7420 6f63 6375 7265 6e63 6573 2073  rst occurences s
+00024290: 6574 2074 6f20 6060 5472 7565 6060 2e0a  et to ``True``..
+000242a0: 2020 2020 2020 2020 4769 7468 7562 2049          Github I
+000242b0: 7373 7565 3a0a 2020 2020 2020 2020 2d20  ssue:.        - 
+000242c0: 5072 6f62 6c65 6d20 6973 2064 6573 6372  Problem is descr
+000242d0: 6962 6564 2069 6e3a 2068 7474 7073 3a2f  ibed in: https:/
+000242e0: 2f67 6974 6875 622e 636f 6d2f 7364 762d  /github.com/sdv-
+000242f0: 6465 762f 5344 562f 6973 7375 6573 2f36  dev/SDV/issues/6
+00024300: 3137 0a20 2020 2020 2020 2022 2222 0a20  17.        """. 
+00024310: 2020 2020 2020 2023 2053 6574 7570 0a20         # Setup. 
+00024320: 2020 2020 2020 2069 6e73 7461 6e63 6520         instance 
+00024330: 3d20 556e 6971 7565 2863 6f6c 756d 6e5f  = Unique(column_
+00024340: 6e61 6d65 733d 5b27 6127 2c20 2762 272c  names=['a', 'b',
+00024350: 2027 6327 5d29 0a0a 2020 2020 2020 2020   'c'])..        
+00024360: 2320 5275 6e0a 2020 2020 2020 2020 6461  # Run.        da
+00024370: 7461 203d 2070 642e 4461 7461 4672 616d  ta = pd.DataFram
+00024380: 6528 7b0a 2020 2020 2020 2020 2020 2020  e({.            
+00024390: 2761 273a 205b 312c 2031 2c20 322c 2032  'a': [1, 1, 2, 2
+000243a0: 2c20 335d 2c0a 2020 2020 2020 2020 2020  , 3],.          
+000243b0: 2020 2762 273a 205b 352c 2035 2c20 362c    'b': [5, 5, 6,
+000243c0: 2036 2c20 375d 2c0a 2020 2020 2020 2020   6, 7],.        
+000243d0: 2020 2020 2763 273a 205b 382c 2038 2c20      'c': [8, 8, 
+000243e0: 392c 2039 2c20 3130 5d0a 2020 2020 2020  9, 9, 10].      
+000243f0: 2020 7d2c 2069 6e64 6578 3d5b 322c 2031    }, index=[2, 1
+00024400: 2c20 332c 2035 2c20 345d 290a 2020 2020  , 3, 5, 4]).    
+00024410: 2020 2020 7661 6c69 6420 3d20 696e 7374      valid = inst
+00024420: 616e 6365 2e69 735f 7661 6c69 6428 6461  ance.is_valid(da
+00024430: 7461 290a 0a20 2020 2020 2020 2023 2041  ta)..        # A
+00024440: 7373 6572 740a 2020 2020 2020 2020 6578  ssert.        ex
+00024450: 7065 6374 6564 203d 2070 642e 5365 7269  pected = pd.Seri
+00024460: 6573 285b 5472 7565 2c20 4661 6c73 652c  es([True, False,
+00024470: 2054 7275 652c 2046 616c 7365 2c20 5472   True, False, Tr
+00024480: 7565 5d2c 2069 6e64 6578 3d5b 322c 2031  ue], index=[2, 1
+00024490: 2c20 332c 2035 2c20 345d 290a 2020 2020  , 3, 5, 4]).    
+000244a0: 2020 2020 7064 2e74 6573 7469 6e67 2e61      pd.testing.a
+000244b0: 7373 6572 745f 7365 7269 6573 5f65 7175  ssert_series_equ
+000244c0: 616c 2876 616c 6964 2c20 6578 7065 6374  al(valid, expect
+000244d0: 6564 290a 0a20 2020 2064 6566 2074 6573  ed)..    def tes
+000244e0: 745f 6973 5f76 616c 6964 5f6f 6e65 5f63  t_is_valid_one_c
+000244f0: 6f6c 756d 6e5f 6375 7374 6f6d 5f69 6e64  olumn_custom_ind
+00024500: 6578 5f6e 6f74 5f73 6f72 7465 6428 7365  ex_not_sorted(se
+00024510: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+00024520: 5465 7374 2074 6865 2060 6055 6e69 7175  Test the ``Uniqu
+00024530: 652e 6973 5f76 616c 6964 6060 206d 6574  e.is_valid`` met
+00024540: 686f 642e 0a0a 2020 2020 2020 2020 5468  hod...        Th
+00024550: 6973 206d 6574 686f 6420 7368 6f75 6c64  is method should
+00024560: 2072 6574 7572 6e20 6120 7064 2e53 6572   return a pd.Ser
+00024570: 6965 7320 7768 6572 6520 7468 6520 696e  ies where the in
+00024580: 6465 780a 2020 2020 2020 2020 6f66 2074  dex.        of t
+00024590: 6865 2066 6972 7374 206f 6363 7572 656e  he first occuren
+000245a0: 6365 206f 6620 6120 756e 6971 7565 2076  ce of a unique v
+000245b0: 616c 7565 206f 6620 6060 7365 6c66 2e63  alue of ``self.c
+000245c0: 6f6c 756d 6e5f 6e61 6d65 7360 600a 2020  olumn_names``.  
+000245d0: 2020 2020 2020 6973 2073 6574 2074 6f20        is set to 
+000245e0: 6060 5472 7565 6060 2c20 616e 6420 6576  ``True``, and ev
+000245f0: 6572 7920 6f74 6865 7220 6f63 6375 7265  ery other occure
+00024600: 6e63 6520 6973 2073 6574 2074 6f20 6060  nce is set to ``
+00024610: 4661 6c73 6560 602e 0a0a 2020 2020 2020  False``...      
+00024620: 2020 496e 7075 743a 0a20 2020 2020 2020    Input:.       
+00024630: 202d 2044 6174 6146 7261 6d65 2077 6974   - DataFrame wit
+00024640: 6820 6d75 6c74 6970 6c65 206f 6363 7572  h multiple occur
+00024650: 656e 6365 7320 6f66 2074 6865 2073 616d  ences of the sam
+00024660: 6520 7661 6c75 6520 6f66 2074 6865 0a20  e value of the. 
+00024670: 2020 2020 2020 206f 6e65 2063 6f6c 756d         one colum
+00024680: 6e20 696e 2060 6069 6e73 7461 6e63 652e  n in ``instance.
+00024690: 636f 6c75 6d6e 7360 602e 0a20 2020 2020  columns``..     
+000246a0: 2020 202d 2044 6174 6146 7261 6d65 2068     - DataFrame h
+000246b0: 6173 2061 2063 7573 746f 6d20 696e 6465  as a custom inde
+000246c0: 7820 636f 6c75 6d6e 2077 6869 6368 2069  x column which i
+000246d0: 7320 7365 7420 696e 2061 6e20 756e 736f  s set in an unso
+000246e0: 7274 6564 2077 6179 2e0a 2020 2020 2020  rted way..      
+000246f0: 2020 4f75 7470 7574 3a0a 2020 2020 2020    Output:.      
+00024700: 2020 2d20 5365 7269 6573 2077 6974 6820    - Series with 
+00024710: 7468 6520 696e 6465 7820 6f66 2074 6865  the index of the
+00024720: 2066 6972 7374 206f 6363 7572 656e 6365   first occurence
+00024730: 7320 7365 7420 746f 2060 6054 7275 6560  s set to ``True`
+00024740: 602e 0a20 2020 2020 2020 2047 6974 6875  `..        Githu
+00024750: 6220 4973 7375 653a 0a20 2020 2020 2020  b Issue:.       
+00024760: 202d 2050 726f 626c 656d 2069 7320 6465   - Problem is de
+00024770: 7363 7269 6265 6420 696e 3a20 6874 7470  scribed in: http
+00024780: 733a 2f2f 6769 7468 7562 2e63 6f6d 2f73  s://github.com/s
+00024790: 6476 2d64 6576 2f53 4456 2f69 7373 7565  dv-dev/SDV/issue
+000247a0: 732f 3631 370a 2020 2020 2020 2020 2222  s/617.        ""
+000247b0: 220a 2020 2020 2020 2020 2320 5365 7475  ".        # Setu
+000247c0: 700a 2020 2020 2020 2020 696e 7374 616e  p.        instan
+000247d0: 6365 203d 2055 6e69 7175 6528 636f 6c75  ce = Unique(colu
+000247e0: 6d6e 5f6e 616d 6573 3d27 6127 290a 0a20  mn_names='a').. 
+000247f0: 2020 2020 2020 2023 2052 756e 0a20 2020         # Run.   
+00024800: 2020 2020 2064 6174 6120 3d20 7064 2e44       data = pd.D
+00024810: 6174 6146 7261 6d65 287b 0a20 2020 2020  ataFrame({.     
+00024820: 2020 2020 2020 2027 6127 3a20 5b31 2c20         'a': [1, 
+00024830: 312c 2031 2c20 322c 2033 2c20 325d 2c0a  1, 1, 2, 3, 2],.
+00024840: 2020 2020 2020 2020 2020 2020 2762 273a              'b':
+00024850: 205b 312c 2032 2c20 332c 2034 2c20 352c   [1, 2, 3, 4, 5,
+00024860: 2036 5d2c 0a20 2020 2020 2020 2020 2020   6],.           
+00024870: 2027 6327 3a20 5b46 616c 7365 2c20 4661   'c': [False, Fa
+00024880: 6c73 652c 2054 7275 652c 2046 616c 7365  lse, True, False
+00024890: 2c20 4661 6c73 652c 2054 7275 655d 0a20  , False, True]. 
+000248a0: 2020 2020 2020 207d 2c20 696e 6465 783d         }, index=
+000248b0: 5b32 2c20 312c 2033 2c20 352c 2034 2c20  [2, 1, 3, 5, 4, 
+000248c0: 365d 290a 2020 2020 2020 2020 7661 6c69  6]).        vali
+000248d0: 6420 3d20 696e 7374 616e 6365 2e69 735f  d = instance.is_
+000248e0: 7661 6c69 6428 6461 7461 290a 0a20 2020  valid(data)..   
+000248f0: 2020 2020 2023 2041 7373 6572 740a 2020       # Assert.  
+00024900: 2020 2020 2020 6578 7065 6374 6564 203d        expected =
+00024910: 2070 642e 5365 7269 6573 285b 5472 7565   pd.Series([True
+00024920: 2c20 4661 6c73 652c 2046 616c 7365 2c20  , False, False, 
+00024930: 5472 7565 2c20 5472 7565 2c20 4661 6c73  True, True, Fals
+00024940: 655d 2c20 696e 6465 783d 5b32 2c20 312c  e], index=[2, 1,
+00024950: 2033 2c20 352c 2034 2c20 365d 290a 2020   3, 5, 4, 6]).  
+00024960: 2020 2020 2020 7064 2e74 6573 7469 6e67        pd.testing
+00024970: 2e61 7373 6572 745f 7365 7269 6573 5f65  .assert_series_e
+00024980: 7175 616c 2876 616c 6964 2c20 6578 7065  qual(valid, expe
+00024990: 6374 6564 290a 0a20 2020 2064 6566 2074  cted)..    def t
+000249a0: 6573 745f 6973 5f76 616c 6964 5f6f 6e65  est_is_valid_one
+000249b0: 5f63 6f6c 756d 6e5f 6375 7374 6f6d 5f69  _column_custom_i
+000249c0: 6e64 6578 5f73 616d 655f 7661 6c75 6573  ndex_same_values
+000249d0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+000249e0: 2222 2254 6573 7420 7468 6520 6060 556e  """Test the ``Un
+000249f0: 6971 7565 2e69 735f 7661 6c69 6460 6020  ique.is_valid`` 
+00024a00: 6d65 7468 6f64 2e0a 0a20 2020 2020 2020  method...       
+00024a10: 2054 6869 7320 6d65 7468 6f64 2073 686f   This method sho
+00024a20: 756c 6420 7265 7475 726e 2061 2070 642e  uld return a pd.
+00024a30: 5365 7269 6573 2077 6865 7265 2074 6865  Series where the
+00024a40: 2069 6e64 6578 0a20 2020 2020 2020 206f   index.        o
+00024a50: 6620 7468 6520 6669 7273 7420 6f63 6375  f the first occu
+00024a60: 7265 6e63 6520 6f66 2061 2075 6e69 7175  rence of a uniqu
+00024a70: 6520 7661 6c75 6520 6f66 2060 6073 656c  e value of ``sel
+00024a80: 662e 636f 6c75 6d6e 5f6e 616d 6573 6060  f.column_names``
+00024a90: 0a20 2020 2020 2020 2069 7320 7365 7420  .        is set 
+00024aa0: 746f 2060 6054 7275 6560 602c 2061 6e64  to ``True``, and
+00024ab0: 2065 7665 7279 206f 7468 6572 206f 6363   every other occ
+00024ac0: 7572 656e 6365 2069 7320 7365 7420 746f  urence is set to
+00024ad0: 2060 6046 616c 7365 6060 2e0a 0a20 2020   ``False``...   
+00024ae0: 2020 2020 2049 6e70 7574 3a0a 2020 2020       Input:.    
+00024af0: 2020 2020 2d20 4461 7461 4672 616d 6520      - DataFrame 
+00024b00: 7769 7468 206d 756c 7469 706c 6520 6f63  with multiple oc
+00024b10: 6375 7265 6e63 6573 206f 6620 7468 6520  curences of the 
+00024b20: 7361 6d65 2076 616c 7565 206f 6620 7468  same value of th
+00024b30: 650a 2020 2020 2020 2020 6f6e 6520 636f  e.        one co
+00024b40: 6c75 6d6e 2069 6e20 6060 696e 7374 616e  lumn in ``instan
+00024b50: 6365 2e63 6f6c 756d 6e73 6060 2e0a 2020  ce.columns``..  
+00024b60: 2020 2020 2020 2d20 4461 7461 4672 616d        - DataFram
+00024b70: 6520 6861 7320 6120 6375 7374 6f6d 2069  e has a custom i
+00024b80: 6e64 6578 2063 6f6c 756d 6e20 7768 6963  ndex column whic
+00024b90: 6820 6973 2073 6574 2074 6f20 3020 666f  h is set to 0 fo
+00024ba0: 7220 726f 7773 2e0a 2020 2020 2020 2020  r rows..        
+00024bb0: 4f75 7470 7574 3a0a 2020 2020 2020 2020  Output:.        
+00024bc0: 2d20 5365 7269 6573 2077 6974 6820 7468  - Series with th
+00024bd0: 6520 696e 6465 7820 6f66 2074 6865 2066  e index of the f
+00024be0: 6972 7374 206f 6363 7572 656e 6365 7320  irst occurences 
+00024bf0: 7365 7420 746f 2060 6054 7275 6560 602e  set to ``True``.
+00024c00: 0a20 2020 2020 2020 2047 6974 6875 6220  .        Github 
+00024c10: 4973 7375 653a 0a20 2020 2020 2020 202d  Issue:.        -
+00024c20: 2050 726f 626c 656d 2069 7320 6465 7363   Problem is desc
+00024c30: 7269 6265 6420 696e 3a20 6874 7470 733a  ribed in: https:
+00024c40: 2f2f 6769 7468 7562 2e63 6f6d 2f73 6476  //github.com/sdv
+00024c50: 2d64 6576 2f53 4456 2f69 7373 7565 732f  -dev/SDV/issues/
+00024c60: 3631 360a 2020 2020 2020 2020 2222 220a  616.        """.
+00024c70: 2020 2020 2020 2020 2320 5365 7475 700a          # Setup.
+00024c80: 2020 2020 2020 2020 696e 7374 616e 6365          instance
+00024c90: 203d 2055 6e69 7175 6528 636f 6c75 6d6e   = Unique(column
+00024ca0: 5f6e 616d 6573 3d27 6127 290a 0a20 2020  _names='a')..   
+00024cb0: 2020 2020 2023 2052 756e 0a20 2020 2020       # Run.     
+00024cc0: 2020 2064 6174 6120 3d20 7064 2e44 6174     data = pd.Dat
+00024cd0: 6146 7261 6d65 287b 0a20 2020 2020 2020  aFrame({.       
+00024ce0: 2020 2020 2027 6127 3a20 5b31 2c20 312c       'a': [1, 1,
+00024cf0: 2031 2c20 322c 2033 2c20 325d 2c0a 2020   1, 2, 3, 2],.  
+00024d00: 2020 2020 2020 2020 2020 2762 273a 205b            'b': [
+00024d10: 312c 2032 2c20 332c 2034 2c20 352c 2036  1, 2, 3, 4, 5, 6
+00024d20: 5d2c 0a20 2020 2020 2020 2020 2020 2027  ],.            '
+00024d30: 6327 3a20 5b46 616c 7365 2c20 4661 6c73  c': [False, Fals
+00024d40: 652c 2054 7275 652c 2046 616c 7365 2c20  e, True, False, 
+00024d50: 4661 6c73 652c 2054 7275 655d 0a20 2020  False, True].   
+00024d60: 2020 2020 207d 2c20 696e 6465 783d 5b30       }, index=[0
+00024d70: 2c20 302c 2030 2c20 302c 2030 2c20 305d  , 0, 0, 0, 0, 0]
+00024d80: 290a 2020 2020 2020 2020 7661 6c69 6420  ).        valid 
+00024d90: 3d20 696e 7374 616e 6365 2e69 735f 7661  = instance.is_va
+00024da0: 6c69 6428 6461 7461 290a 0a20 2020 2020  lid(data)..     
+00024db0: 2020 2023 2041 7373 6572 740a 2020 2020     # Assert.    
+00024dc0: 2020 2020 6578 7065 6374 6564 203d 2070      expected = p
+00024dd0: 642e 5365 7269 6573 285b 5472 7565 2c20  d.Series([True, 
+00024de0: 4661 6c73 652c 2046 616c 7365 2c20 5472  False, False, Tr
+00024df0: 7565 2c20 5472 7565 2c20 4661 6c73 655d  ue, True, False]
+00024e00: 2c20 696e 6465 783d 5b30 2c20 302c 2030  , index=[0, 0, 0
+00024e10: 2c20 302c 2030 2c20 305d 290a 2020 2020  , 0, 0, 0]).    
+00024e20: 2020 2020 7064 2e74 6573 7469 6e67 2e61      pd.testing.a
+00024e30: 7373 6572 745f 7365 7269 6573 5f65 7175  ssert_series_equ
+00024e40: 616c 2876 616c 6964 2c20 6578 7065 6374  al(valid, expect
+00024e50: 6564 290a 0a20 2020 2064 6566 2074 6573  ed)..    def tes
+00024e60: 745f 6973 5f76 616c 6964 5f6f 6e65 5f63  t_is_valid_one_c
+00024e70: 6f6c 756d 6e28 7365 6c66 293a 0a20 2020  olumn(self):.   
+00024e80: 2020 2020 2022 2222 5465 7374 2074 6865       """Test the
+00024e90: 2060 6055 6e69 7175 652e 6973 5f76 616c   ``Unique.is_val
+00024ea0: 6964 6060 206d 6574 686f 642e 0a0a 2020  id`` method...  
+00024eb0: 2020 2020 2020 5468 6973 206d 6574 686f        This metho
+00024ec0: 6420 7368 6f75 6c64 2072 6574 7572 6e20  d should return 
+00024ed0: 6120 7064 2e53 6572 6965 7320 7768 6572  a pd.Series wher
+00024ee0: 6520 7468 6520 696e 6465 780a 2020 2020  e the index.    
+00024ef0: 2020 2020 6f66 2074 6865 2066 6972 7374      of the first
+00024f00: 206f 6363 7572 656e 6365 206f 6620 6120   occurence of a 
+00024f10: 756e 6971 7565 2076 616c 7565 206f 6620  unique value of 
+00024f20: 6060 7365 6c66 2e63 6f6c 756d 6e5f 6e61  ``self.column_na
+00024f30: 6d65 7360 600a 2020 2020 2020 2020 6973  mes``.        is
+00024f40: 2073 6574 2074 6f20 6060 5472 7565 6060   set to ``True``
+00024f50: 2c20 616e 6420 6576 6572 7920 6f74 6865  , and every othe
+00024f60: 7220 6f63 6375 7265 6e63 6520 6973 2073  r occurence is s
+00024f70: 6574 2074 6f20 6060 4661 6c73 6560 602e  et to ``False``.
+00024f80: 0a0a 2020 2020 2020 2020 496e 7075 743a  ..        Input:
+00024f90: 0a20 2020 2020 2020 202d 2044 6174 6146  .        - DataF
+00024fa0: 7261 6d65 2077 6974 6820 6d75 6c74 6970  rame with multip
+00024fb0: 6c65 206f 6363 7572 656e 6365 7320 6f66  le occurences of
+00024fc0: 2074 6865 2073 616d 6520 7661 6c75 6520   the same value 
+00024fd0: 6f66 2074 6865 0a20 2020 2020 2020 206f  of the.        o
+00024fe0: 6e65 2063 6f6c 756d 6e20 696e 2060 6069  ne column in ``i
+00024ff0: 6e73 7461 6e63 652e 636f 6c75 6d6e 7360  nstance.columns`
+00025000: 602e 0a20 2020 2020 2020 204f 7574 7075  `..        Outpu
+00025010: 743a 0a20 2020 2020 2020 202d 2053 6572  t:.        - Ser
+00025020: 6965 7320 7769 7468 2074 6865 2069 6e64  ies with the ind
+00025030: 6578 206f 6620 7468 6520 6669 7273 7420  ex of the first 
+00025040: 6f63 6375 7265 6e63 6573 2073 6574 2074  occurences set t
+00025050: 6f20 6060 5472 7565 6060 2e0a 2020 2020  o ``True``..    
+00025060: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00025070: 2320 5365 7475 700a 2020 2020 2020 2020  # Setup.        
+00025080: 696e 7374 616e 6365 203d 2055 6e69 7175  instance = Uniqu
+00025090: 6528 636f 6c75 6d6e 5f6e 616d 6573 3d27  e(column_names='
+000250a0: 6127 290a 0a20 2020 2020 2020 2023 2052  a')..        # R
+000250b0: 756e 0a20 2020 2020 2020 2064 6174 6120  un.        data 
+000250c0: 3d20 7064 2e44 6174 6146 7261 6d65 287b  = pd.DataFrame({
+000250d0: 0a20 2020 2020 2020 2020 2020 2027 6127  .            'a'
+000250e0: 3a20 5b31 2c20 312c 2031 2c20 322c 2033  : [1, 1, 1, 2, 3
+000250f0: 2c20 325d 2c0a 2020 2020 2020 2020 2020  , 2],.          
+00025100: 2020 2762 273a 205b 312c 2032 2c20 332c    'b': [1, 2, 3,
+00025110: 2034 2c20 352c 2036 5d2c 0a20 2020 2020   4, 5, 6],.     
+00025120: 2020 2020 2020 2027 6327 3a20 5b46 616c         'c': [Fal
+00025130: 7365 2c20 4661 6c73 652c 2054 7275 652c  se, False, True,
+00025140: 2046 616c 7365 2c20 4661 6c73 652c 2054   False, False, T
+00025150: 7275 655d 0a20 2020 2020 2020 207d 290a  rue].        }).
+00025160: 2020 2020 2020 2020 7661 6c69 6420 3d20          valid = 
+00025170: 696e 7374 616e 6365 2e69 735f 7661 6c69  instance.is_vali
+00025180: 6428 6461 7461 290a 0a20 2020 2020 2020  d(data)..       
+00025190: 2023 2041 7373 6572 740a 2020 2020 2020   # Assert.      
+000251a0: 2020 6578 7065 6374 6564 203d 2070 642e    expected = pd.
+000251b0: 5365 7269 6573 285b 5472 7565 2c20 4661  Series([True, Fa
+000251c0: 6c73 652c 2046 616c 7365 2c20 5472 7565  lse, False, True
+000251d0: 2c20 5472 7565 2c20 4661 6c73 655d 290a  , True, False]).
+000251e0: 2020 2020 2020 2020 7064 2e74 6573 7469          pd.testi
+000251f0: 6e67 2e61 7373 6572 745f 7365 7269 6573  ng.assert_series
+00025200: 5f65 7175 616c 2876 616c 6964 2c20 6578  _equal(valid, ex
+00025210: 7065 6374 6564 290a 0a20 2020 2064 6566  pected)..    def
+00025220: 2074 6573 745f 6973 5f76 616c 6964 5f6f   test_is_valid_o
+00025230: 6e65 5f63 6f6c 756d 6e5f 6e61 6e73 2873  ne_column_nans(s
+00025240: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
+00025250: 2254 6573 7420 7468 6520 6060 556e 6971  "Test the ``Uniq
+00025260: 7565 2e69 735f 7661 6c69 6460 6020 6d65  ue.is_valid`` me
+00025270: 7468 6f64 2066 6f72 206f 6e65 2063 6f6c  thod for one col
+00025280: 756d 6e20 7769 7468 206e 616e 732e 0a0a  umn with nans...
+00025290: 2020 2020 2020 2020 5468 6973 206d 6574          This met
+000252a0: 686f 6420 7368 6f75 6c64 2072 6574 7572  hod should retur
+000252b0: 6e20 6120 7064 2e53 6572 6965 7320 7768  n a pd.Series wh
+000252c0: 6572 6520 7468 6520 696e 6465 780a 2020  ere the index.  
+000252d0: 2020 2020 2020 6f66 2074 6865 2066 6972        of the fir
+000252e0: 7374 206f 6363 7572 656e 6365 206f 6620  st occurence of 
+000252f0: 6120 756e 6971 7565 2076 616c 7565 206f  a unique value o
+00025300: 6620 6060 696e 7374 616e 6365 2e63 6f6c  f ``instance.col
+00025310: 756d 6e5f 6e61 6d65 7360 600a 2020 2020  umn_names``.    
+00025320: 2020 2020 6973 2073 6574 2074 6f20 6060      is set to ``
+00025330: 5472 7565 6060 2c20 616e 6420 6576 6572  True``, and ever
+00025340: 7920 6f74 6865 7220 6f63 6375 7265 6e63  y other occurenc
+00025350: 6520 6973 2073 6574 2074 6f20 6060 4661  e is set to ``Fa
+00025360: 6c73 6560 602e 0a20 2020 2020 2020 2060  lse``..        `
+00025370: 604e 6f6e 6560 602c 2060 606e 702e 6e61  `None``, ``np.na
+00025380: 6e60 6020 616e 6420 6060 666c 6f61 7428  n`` and ``float(
+00025390: 276e 616e 2729 6060 2073 686f 756c 6420  'nan')`` should 
+000253a0: 6265 2074 7265 6174 6564 2061 7320 7468  be treated as th
+000253b0: 6520 7361 6d65 2063 6174 6567 6f72 792e  e same category.
+000253c0: 0a0a 2020 2020 2020 2020 496e 7075 743a  ..        Input:
+000253d0: 0a20 2020 2020 2020 202d 2044 6174 6146  .        - DataF
+000253e0: 7261 6d65 2077 6974 6820 736f 6d65 2072  rame with some r
+000253f0: 6570 6561 7465 6420 7661 6c75 6573 2c20  epeated values, 
+00025400: 736f 6d65 206f 6620 7768 6963 6820 6172  some of which ar
+00025410: 6520 6e61 6e27 732e 0a20 2020 2020 2020  e nan's..       
+00025420: 204f 7574 7075 743a 0a20 2020 2020 2020   Output:.       
+00025430: 202d 2053 6572 6965 7320 7769 7468 2074   - Series with t
+00025440: 6865 2069 6e64 6578 206f 6620 7468 6520  he index of the 
+00025450: 6669 7273 7420 6f63 6375 7265 6e63 6573  first occurences
+00025460: 2073 6574 2074 6f20 6060 5472 7565 6060   set to ``True``
+00025470: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+00025480: 2020 2020 2020 2320 5365 7475 700a 2020        # Setup.  
+00025490: 2020 2020 2020 696e 7374 616e 6365 203d        instance =
+000254a0: 2055 6e69 7175 6528 636f 6c75 6d6e 5f6e   Unique(column_n
+000254b0: 616d 6573 3d5b 2761 275d 290a 0a20 2020  ames=['a'])..   
+000254c0: 2020 2020 2023 2052 756e 0a20 2020 2020       # Run.     
+000254d0: 2020 2064 6174 6120 3d20 7064 2e44 6174     data = pd.Dat
+000254e0: 6146 7261 6d65 287b 0a20 2020 2020 2020  aFrame({.       
+000254f0: 2020 2020 2027 6127 3a20 5b31 2c20 4e6f       'a': [1, No
+00025500: 6e65 2c20 322c 206e 702e 6e61 6e2c 2066  ne, 2, np.nan, f
+00025510: 6c6f 6174 2827 6e61 6e27 292c 2031 5d2c  loat('nan'), 1],
+00025520: 0a20 2020 2020 2020 2020 2020 2027 6227  .            'b'
+00025530: 3a20 5b6e 702e 6e61 6e2c 2031 2c20 4e6f  : [np.nan, 1, No
+00025540: 6e65 2c20 666c 6f61 7428 276e 616e 2729  ne, float('nan')
+00025550: 2c20 666c 6f61 7428 276e 616e 2729 2c20  , float('nan'), 
+00025560: 315d 2c0a 2020 2020 2020 2020 7d29 0a20  1],.        }). 
+00025570: 2020 2020 2020 2076 616c 6964 203d 2069         valid = i
+00025580: 6e73 7461 6e63 652e 6973 5f76 616c 6964  nstance.is_valid
+00025590: 2864 6174 6129 0a0a 2020 2020 2020 2020  (data)..        
+000255a0: 2320 4173 7365 7274 0a20 2020 2020 2020  # Assert.       
+000255b0: 2065 7870 6563 7465 6420 3d20 7064 2e53   expected = pd.S
+000255c0: 6572 6965 7328 5b54 7275 652c 2054 7275  eries([True, Tru
+000255d0: 652c 2054 7275 652c 2046 616c 7365 2c20  e, True, False, 
+000255e0: 4661 6c73 652c 2046 616c 7365 5d29 0a20  False, False]). 
+000255f0: 2020 2020 2020 2070 642e 7465 7374 696e         pd.testin
+00025600: 672e 6173 7365 7274 5f73 6572 6965 735f  g.assert_series_
+00025610: 6571 7561 6c28 7661 6c69 642c 2065 7870  equal(valid, exp
+00025620: 6563 7465 6429 0a0a 2020 2020 6465 6620  ected)..    def 
+00025630: 7465 7374 5f69 735f 7661 6c69 645f 6d75  test_is_valid_mu
+00025640: 6c74 6970 6c65 5f63 6f6c 756d 6e73 5f6e  ltiple_columns_n
+00025650: 616e 7328 7365 6c66 293a 0a20 2020 2020  ans(self):.     
+00025660: 2020 2022 2222 5465 7374 2074 6865 2060     """Test the `
+00025670: 6055 6e69 7175 652e 6973 5f76 616c 6964  `Unique.is_valid
+00025680: 6060 206d 6574 686f 6420 666f 7220 6d75  `` method for mu
+00025690: 6c74 6970 6c65 2063 6f6c 756d 6e73 2077  ltiple columns w
+000256a0: 6974 6820 6e61 6e73 2e0a 0a20 2020 2020  ith nans...     
+000256b0: 2020 2054 6869 7320 6d65 7468 6f64 2073     This method s
+000256c0: 686f 756c 6420 7265 7475 726e 2061 2070  hould return a p
+000256d0: 642e 5365 7269 6573 2077 6865 7265 2074  d.Series where t
+000256e0: 6865 2069 6e64 6578 0a20 2020 2020 2020  he index.       
+000256f0: 206f 6620 7468 6520 6669 7273 7420 6f63   of the first oc
+00025700: 6375 7265 6e63 6520 6f66 2061 2075 6e69  curence of a uni
+00025710: 7175 6520 636f 6d62 696e 6174 696f 6e20  que combination 
+00025720: 6f66 2060 6069 6e73 7461 6e63 652e 636f  of ``instance.co
+00025730: 6c75 6d6e 5f6e 616d 6573 6060 0a20 2020  lumn_names``.   
+00025740: 2020 2020 2069 7320 7365 7420 746f 2060       is set to `
+00025750: 6054 7275 6560 602c 2061 6e64 2065 7665  `True``, and eve
+00025760: 7279 206f 7468 6572 206f 6363 7572 656e  ry other occuren
+00025770: 6365 2069 7320 7365 7420 746f 2060 6046  ce is set to ``F
+00025780: 616c 7365 6060 2e0a 2020 2020 2020 2020  alse``..        
+00025790: 6060 4e6f 6e65 6060 2c20 6060 6e70 2e6e  ``None``, ``np.n
+000257a0: 616e 6060 2061 6e64 2060 6066 6c6f 6174  an`` and ``float
+000257b0: 2827 6e61 6e27 2960 6020 7368 6f75 6c64  ('nan')`` should
+000257c0: 2062 6520 7472 6561 7465 6420 6173 2074   be treated as t
+000257d0: 6865 2073 616d 6520 6361 7465 676f 7279  he same category
+000257e0: 2e0a 0a20 2020 2020 2020 2049 6e70 7574  ...        Input
+000257f0: 3a0a 2020 2020 2020 2020 2d20 4461 7461  :.        - Data
+00025800: 4672 616d 6520 7769 7468 206d 756c 7469  Frame with multi
+00025810: 706c 6520 6f66 2074 6865 2073 616d 6520  ple of the same 
+00025820: 636f 6d62 696e 6174 696f 6e73 206f 6620  combinations of 
+00025830: 636f 6c75 6d6e 732c 2073 6f6d 6520 6f66  columns, some of
+00025840: 2077 6869 6368 2061 7265 206e 616e 2773   which are nan's
+00025850: 2e0a 2020 2020 2020 2020 4f75 7470 7574  ..        Output
+00025860: 3a0a 2020 2020 2020 2020 2d20 5365 7269  :.        - Seri
+00025870: 6573 2077 6974 6820 7468 6520 696e 6465  es with the inde
+00025880: 7820 6f66 2074 6865 2066 6972 7374 206f  x of the first o
+00025890: 6363 7572 656e 6365 7320 7365 7420 746f  ccurences set to
+000258a0: 2060 6054 7275 6560 602e 0a20 2020 2020   ``True``..     
+000258b0: 2020 2022 2222 0a20 2020 2020 2020 2023     """.        #
+000258c0: 2053 6574 7570 0a20 2020 2020 2020 2069   Setup.        i
+000258d0: 6e73 7461 6e63 6520 3d20 556e 6971 7565  nstance = Unique
+000258e0: 2863 6f6c 756d 6e5f 6e61 6d65 733d 5b27  (column_names=['
+000258f0: 6127 2c20 2762 275d 290a 0a20 2020 2020  a', 'b'])..     
+00025900: 2020 2023 2052 756e 0a20 2020 2020 2020     # Run.       
+00025910: 2064 6174 6120 3d20 7064 2e44 6174 6146   data = pd.DataF
+00025920: 7261 6d65 287b 0a20 2020 2020 2020 2020  rame({.         
+00025930: 2020 2027 6127 3a20 5b31 2c20 4e6f 6e65     'a': [1, None
+00025940: 2c20 312c 206e 702e 6e61 6e2c 2066 6c6f  , 1, np.nan, flo
+00025950: 6174 2827 6e61 6e27 292c 2031 5d2c 0a20  at('nan'), 1],. 
+00025960: 2020 2020 2020 2020 2020 2027 6227 3a20             'b': 
+00025970: 5b6e 702e 6e61 6e2c 2031 2c20 4e6f 6e65  [np.nan, 1, None
+00025980: 2c20 666c 6f61 7428 276e 616e 2729 2c20  , float('nan'), 
+00025990: 666c 6f61 7428 276e 616e 2729 2c20 315d  float('nan'), 1]
+000259a0: 2c0a 2020 2020 2020 2020 7d29 0a20 2020  ,.        }).   
+000259b0: 2020 2020 2076 616c 6964 203d 2069 6e73       valid = ins
+000259c0: 7461 6e63 652e 6973 5f76 616c 6964 2864  tance.is_valid(d
+000259d0: 6174 6129 0a0a 2020 2020 2020 2020 2320  ata)..        # 
+000259e0: 4173 7365 7274 0a20 2020 2020 2020 2065  Assert.        e
+000259f0: 7870 6563 7465 6420 3d20 7064 2e53 6572  xpected = pd.Ser
+00025a00: 6965 7328 5b54 7275 652c 2054 7275 652c  ies([True, True,
+00025a10: 2046 616c 7365 2c20 5472 7565 2c20 4661   False, True, Fa
+00025a20: 6c73 652c 2054 7275 655d 290a 2020 2020  lse, True]).    
+00025a30: 2020 2020 7064 2e74 6573 7469 6e67 2e61      pd.testing.a
+00025a40: 7373 6572 745f 7365 7269 6573 5f65 7175  ssert_series_equ
+00025a50: 616c 2876 616c 6964 2c20 6578 7065 6374  al(valid, expect
+00025a60: 6564 290a 0a0a 636c 6173 7320 5465 7374  ed)...class Test
+00025a70: 4669 7865 6449 6e63 7265 6d65 6e74 7328  FixedIncrements(
+00025a80: 293a 0a0a 2020 2020 6465 6620 7465 7374  ):..    def test
+00025a90: 5f5f 7661 6c69 6461 7465 5f69 6e70 7574  __validate_input
+00025aa0: 7328 7365 6c66 293a 0a20 2020 2020 2020  s(self):.       
+00025ab0: 2022 2222 5465 7374 2074 6865 2060 6046   """Test the ``F
+00025ac0: 6978 6564 496e 6372 656d 656e 7473 2e5f  ixedIncrements._
+00025ad0: 7661 6c69 6461 7465 5f69 6e70 7574 7360  validate_inputs`
+00025ae0: 6020 6d65 7468 6f64 2e0a 0a20 2020 2020  ` method...     
+00025af0: 2020 2049 6e70 7574 3a0a 2020 2020 2020     Input:.      
+00025b00: 2020 2d20 2049 6e63 6f72 7265 6374 2070    -  Incorrect p
+00025b10: 6172 616d 6574 6572 7320 666f 7220 7468  arameters for th
+00025b20: 6520 6d65 7468 6f64 0a20 2020 2020 2020  e method.       
+00025b30: 2052 6169 7365 733a 0a20 2020 2020 2020   Raises:.       
+00025b40: 202d 204c 6973 7420 6f66 2056 616c 7565   - List of Value
+00025b50: 4572 726f 7273 0a20 2020 2020 2020 2022  Errors.        "
+00025b60: 2222 0a20 2020 2020 2020 2065 7272 5f6d  "".        err_m
+00025b70: 7367 203d 2028 0a20 2020 2020 2020 2020  sg = (.         
+00025b80: 2020 2072 274d 6973 7369 6e67 2072 6571     r'Missing req
+00025b90: 7569 7265 6420 7661 6c75 6573 207b 282e  uired values {(.
+00025ba0: 2a29 7d20 696e 2061 2046 6978 6564 496e  *)} in a FixedIn
+00025bb0: 6372 656d 656e 7473 2063 6f6e 7374 7261  crements constra
+00025bc0: 696e 742e 270a 2020 2020 2020 2020 2020  int.'.          
+00025bd0: 2020 7227 5c6e 5c6e 496e 7661 6c69 6420    r'\n\nInvalid 
+00025be0: 7661 6c75 6573 207b 282e 2a29 7d20 6172  values {(.*)} ar
+00025bf0: 6520 7072 6573 656e 7420 696e 2061 2046  e present in a F
+00025c00: 6978 6564 496e 6372 656d 656e 7473 2063  ixedIncrements c
+00025c10: 6f6e 7374 7261 696e 742e 270a 2020 2020  onstraint.'.    
+00025c20: 2020 2020 2020 2020 7227 5c6e 5c6e 496e          r'\n\nIn
+00025c30: 7661 6c69 6420 696e 6372 656d 656e 7420  valid increment 
+00025c40: 7661 6c75 6520 7b28 2e2a 297d 2069 6e20  value {(.*)} in 
+00025c50: 6120 4669 7865 6449 6e63 7265 6d65 6e74  a FixedIncrement
+00025c60: 7320 636f 6e73 7472 6169 6e74 2e27 0a20  s constraint.'. 
+00025c70: 2020 2020 2020 2020 2020 2027 2049 6e63             ' Inc
+00025c80: 7265 6d65 6e74 7320 6d75 7374 2062 6520  rements must be 
+00025c90: 706f 7369 7469 7665 2069 6e74 6567 6572  positive integer
+00025ca0: 732e 270a 2020 2020 2020 2020 290a 2020  s.'.        ).  
+00025cb0: 2020 2020 2020 2320 5275 6e20 2f20 4173        # Run / As
+00025cc0: 7365 7274 0a20 2020 2020 2020 2077 6974  sert.        wit
+00025cd0: 6820 7079 7465 7374 2e72 6169 7365 7328  h pytest.raises(
+00025ce0: 4167 6772 6567 6174 6543 6f6e 7374 7261  AggregateConstra
+00025cf0: 696e 7473 4572 726f 7229 2061 7320 6572  intsError) as er
+00025d00: 726f 723a 0a20 2020 2020 2020 2020 2020  ror:.           
+00025d10: 2046 6978 6564 496e 6372 656d 656e 7473   FixedIncrements
+00025d20: 2e5f 7661 6c69 6461 7465 5f69 6e70 7574  ._validate_input
+00025d30: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
+00025d40: 2020 206e 6f74 5f63 6f6c 756d 6e5f 6e61     not_column_na
+00025d50: 6d65 3d4e 6f6e 652c 2069 6e63 7265 6d65  me=None, increme
+00025d60: 6e74 5f76 616c 7565 3d2d 312c 2073 6f6d  nt_value=-1, som
+00025d70: 6574 6869 6e67 5f65 6c73 653d 4e6f 6e65  ething_else=None
+00025d80: 290a 0a20 2020 2020 2020 2067 726f 7570  )..        group
+00025d90: 7320 3d20 7265 2e73 6561 7263 6828 6572  s = re.search(er
+00025da0: 725f 6d73 672c 2073 7472 2865 7272 6f72  r_msg, str(error
+00025db0: 2e76 616c 7565 2929 0a20 2020 2020 2020  .value)).       
+00025dc0: 2061 7373 6572 7420 6772 6f75 7073 2069   assert groups i
+00025dd0: 7320 6e6f 7420 4e6f 6e65 0a20 2020 2020  s not None.     
+00025de0: 2020 2061 7373 6572 7420 7374 7228 6576     assert str(ev
+00025df0: 616c 2867 726f 7570 732e 6772 6f75 7028  al(groups.group(
+00025e00: 3129 2929 203d 3d20 2763 6f6c 756d 6e5f  1))) == 'column_
+00025e10: 6e61 6d65 270a 2020 2020 2020 2020 6173  name'.        as
+00025e20: 7365 7274 2073 6574 2865 7661 6c28 6772  sert set(eval(gr
+00025e30: 6f75 7073 2e67 726f 7570 2832 2929 2920  oups.group(2))) 
+00025e40: 3d3d 207b 2773 6f6d 6574 6869 6e67 5f65  == {'something_e
+00025e50: 6c73 6527 2c20 276e 6f74 5f63 6f6c 756d  lse', 'not_colum
+00025e60: 6e5f 6e61 6d65 277d 0a20 2020 2020 2020  n_name'}.       
+00025e70: 2061 7373 6572 7420 696e 7428 6576 616c   assert int(eval
+00025e80: 2867 726f 7570 732e 6772 6f75 7028 3329  (groups.group(3)
+00025e90: 2929 203d 3d20 2d31 0a0a 2020 2020 6465  )) == -1..    de
+00025ea0: 6620 7465 7374 5f5f 7661 6c69 6461 7465  f test__validate
+00025eb0: 5f6d 6574 6164 6174 615f 636f 6c75 6d6e  _metadata_column
+00025ec0: 7328 7365 6c66 293a 0a20 2020 2020 2020  s(self):.       
+00025ed0: 2022 2222 5465 7374 2074 6865 2060 605f   """Test the ``_
+00025ee0: 7661 6c69 6461 7465 5f6d 6574 6164 6174  validate_metadat
+00025ef0: 615f 636f 6c75 6d6e 7360 6020 6d65 7468  a_columns`` meth
+00025f00: 6f64 2e0a 0a20 2020 2020 2020 2054 6865  od...        The
+00025f10: 2063 6f6c 756d 6e20 7061 7373 6564 2069   column passed i
+00025f20: 6e20 636f 6c75 6d6e 5f6e 616d 6520 7368  n column_name sh
+00025f30: 6f75 6c64 2062 6520 696e 2074 6865 206d  ould be in the m
+00025f40: 6574 6164 6174 612e 0a0a 2020 2020 2020  etadata...      
+00025f50: 2020 496e 7075 743a 0a20 2020 2020 2020    Input:.       
+00025f60: 2020 2020 202d 2063 6f6c 756d 6e5f 6e61       - column_na
+00025f70: 6d65 2074 6861 7420 6973 2069 6e20 7468  me that is in th
+00025f80: 6520 6d65 7461 6461 7461 2e0a 0a20 2020  e metadata...   
+00025f90: 2020 2020 2053 6964 6520 6566 6665 6374       Side effect
+00025fa0: 3a0a 2020 2020 2020 2020 2020 2020 2d20  :.            - 
+00025fb0: 4e6f 2065 7272 6f72 2073 686f 756c 6420  No error should 
+00025fc0: 6265 2072 6169 7365 642e 0a20 2020 2020  be raised..     
+00025fd0: 2020 2022 2222 0a20 2020 2020 2020 2023     """.        #
+00025fe0: 2053 6574 7570 0a20 2020 2020 2020 206d   Setup.        m
+00025ff0: 6574 6164 6174 6120 3d20 4d6f 636b 2829  etadata = Mock()
+00026000: 0a20 2020 2020 2020 206d 6574 6164 6174  .        metadat
+00026010: 612e 636f 6c75 6d6e 7320 3d20 7b27 6127  a.columns = {'a'
+00026020: 3a20 312c 2027 6227 3a20 327d 0a0a 2020  : 1, 'b': 2}..  
+00026030: 2020 2020 2020 2320 5275 6e0a 2020 2020        # Run.    
+00026040: 2020 2020 4669 7865 6449 6e63 7265 6d65      FixedIncreme
+00026050: 6e74 732e 5f76 616c 6964 6174 655f 6d65  nts._validate_me
+00026060: 7461 6461 7461 5f63 6f6c 756d 6e73 286d  tadata_columns(m
+00026070: 6574 6164 6174 612c 2063 6f6c 756d 6e5f  etadata, column_
+00026080: 6e61 6d65 3d27 6127 290a 0a20 2020 2064  name='a')..    d
+00026090: 6566 2074 6573 745f 5f76 616c 6964 6174  ef test__validat
+000260a0: 655f 6d65 7461 6461 7461 5f63 6f6c 756d  e_metadata_colum
+000260b0: 6e73 5f72 6169 7365 735f 6572 726f 7228  ns_raises_error(
+000260c0: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
+000260d0: 2222 5465 7374 2074 6865 2060 605f 7661  ""Test the ``_va
+000260e0: 6c69 6461 7465 5f6d 6574 6164 6174 615f  lidate_metadata_
+000260f0: 636f 6c75 6d6e 7360 6020 6d65 7468 6f64  columns`` method
+00026100: 2773 2065 7272 6f72 2063 6f6e 6469 7469  's error conditi
+00026110: 6f6e 2e0a 0a20 2020 2020 2020 2049 6620  on...        If 
+00026120: 636f 6c75 6d6e 5f6e 616d 6520 6973 206e  column_name is n
+00026130: 6f74 2069 6e20 7468 6520 6d65 7461 6461  ot in the metada
+00026140: 7461 2c20 616e 2065 7272 6f72 2073 686f  ta, an error sho
+00026150: 756c 6420 6265 2072 6169 7365 642e 0a0a  uld be raised...
+00026160: 2020 2020 2020 2020 496e 7075 743a 0a20          Input:. 
+00026170: 2020 2020 2020 2020 2020 202d 2063 6f6c             - col
+00026180: 756d 6e5f 6e61 6d65 2074 6861 7420 6973  umn_name that is
+00026190: 206e 6f74 2069 6e20 7468 6520 6d65 7461   not in the meta
+000261a0: 6461 7461 2e0a 0a20 2020 2020 2020 2053  data...        S
+000261b0: 6964 6520 6566 6665 6374 3a0a 2020 2020  ide effect:.    
+000261c0: 2020 2020 2020 2020 2d20 436f 6e73 7472          - Constr
+000261d0: 6169 6e74 4d65 7461 6461 7461 4572 726f  aintMetadataErro
+000261e0: 7220 7368 6f75 6c64 2062 6520 7261 6973  r should be rais
+000261f0: 6564 2e0a 2020 2020 2020 2020 2222 220a  ed..        """.
+00026200: 2020 2020 2020 2020 2320 5365 7475 700a          # Setup.
+00026210: 2020 2020 2020 2020 6d65 7461 6461 7461          metadata
+00026220: 203d 204d 6f63 6b28 290a 2020 2020 2020   = Mock().      
+00026230: 2020 6d65 7461 6461 7461 2e63 6f6c 756d    metadata.colum
+00026240: 6e73 203d 207b 2761 273a 2031 2c20 2762  ns = {'a': 1, 'b
+00026250: 273a 2032 7d0a 0a20 2020 2020 2020 2023  ': 2}..        #
+00026260: 2052 756e 0a20 2020 2020 2020 2065 7272   Run.        err
+00026270: 6f72 5f6d 6573 7361 6765 203d 2072 652e  or_message = re.
+00026280: 6573 6361 7065 280a 2020 2020 2020 2020  escape(.        
+00026290: 2020 2020 2741 2046 6978 6564 496e 6372      'A FixedIncr
+000262a0: 656d 656e 7473 2063 6f6e 7374 7261 696e  ements constrain
+000262b0: 7420 6973 2062 6569 6e67 2061 7070 6c69  t is being appli
+000262c0: 6564 2074 6f20 696e 7661 6c69 6420 636f  ed to invalid co
+000262d0: 6c75 6d6e 206e 616d 6573 2027 0a20 2020  lumn names '.   
+000262e0: 2020 2020 2020 2020 2022 7b27 6327 7d2e           "{'c'}.
+000262f0: 2054 6865 2063 6f6c 756d 6e73 206d 7573   The columns mus
+00026300: 7420 6578 6973 7420 696e 2074 6865 2074  t exist in the t
+00026310: 6162 6c65 2e22 0a20 2020 2020 2020 2029  able.".        )
+00026320: 0a20 2020 2020 2020 2077 6974 6820 7079  .        with py
+00026330: 7465 7374 2e72 6169 7365 7328 436f 6e73  test.raises(Cons
+00026340: 7472 6169 6e74 4d65 7461 6461 7461 4572  traintMetadataEr
+00026350: 726f 722c 206d 6174 6368 3d65 7272 6f72  ror, match=error
+00026360: 5f6d 6573 7361 6765 293a 0a20 2020 2020  _message):.     
+00026370: 2020 2020 2020 2046 6978 6564 496e 6372         FixedIncr
+00026380: 656d 656e 7473 2e5f 7661 6c69 6461 7465  ements._validate
+00026390: 5f6d 6574 6164 6174 615f 636f 6c75 6d6e  _metadata_column
+000263a0: 7328 6d65 7461 6461 7461 2c20 636f 6c75  s(metadata, colu
+000263b0: 6d6e 5f6e 616d 653d 2763 2729 0a0a 2020  mn_name='c')..  
+000263c0: 2020 6465 6620 7465 7374 5f5f 5f69 6e69    def test___ini
+000263d0: 745f 5f28 7365 6c66 293a 0a20 2020 2020  t__(self):.     
+000263e0: 2020 2022 2222 5465 7374 2074 6865 2060     """Test the `
+000263f0: 6046 6978 6564 496e 6372 656d 656e 7473  `FixedIncrements
+00026400: 2e5f 5f69 6e69 745f 5f60 6020 6d65 7468  .__init__`` meth
+00026410: 6f64 2e0a 0a20 2020 2020 2020 2054 6865  od...        The
+00026420: 2060 6063 6f6c 756d 6e5f 6e61 6d65 6060   ``column_name``
+00026430: 2061 6e64 2060 6069 6e63 7265 6d65 6e74   and ``increment
+00026440: 5f76 616c 7565 6060 2069 6e73 7461 6e63  _value`` instanc
+00026450: 6520 7661 7269 6162 6c65 7320 7368 6f75  e variables shou
+00026460: 6c64 2062 6520 7365 742e 0a0a 2020 2020  ld be set...    
+00026470: 2020 2020 496e 7075 743a 0a20 2020 2020      Input:.     
+00026480: 2020 2020 2020 202d 2063 6f6c 756d 6e20         - column 
+00026490: 6e61 6d65 2061 7320 6120 7374 7269 6e67  name as a string
+000264a0: 2e0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
+000264b0: 696e 6372 656d 656e 745f 7661 6c75 6520  increment_value 
+000264c0: 6173 2061 6e20 696e 742e 0a0a 2020 2020  as an int...    
+000264d0: 2020 2020 4578 7065 6374 6564 2062 6568      Expected beh
+000264e0: 6176 696f 723a 0a20 2020 2020 2020 2020  avior:.         
+000264f0: 2020 202d 2049 6e73 7461 6e63 6520 7769     - Instance wi
+00026500: 7468 2060 6063 6f6c 756d 6e5f 6e61 6d65  th ``column_name
+00026510: 6060 2061 6e64 2060 6069 6e63 7265 6d65  `` and ``increme
+00026520: 6e74 5f76 616c 7565 6060 2073 6574 2e0a  nt_value`` set..
+00026530: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00026540: 2020 2020 2320 5275 6e0a 2020 2020 2020      # Run.      
+00026550: 2020 696e 7374 616e 6365 203d 2046 6978    instance = Fix
+00026560: 6564 496e 6372 656d 656e 7473 2863 6f6c  edIncrements(col
+00026570: 756d 6e5f 6e61 6d65 3d27 636f 6c75 6d6e  umn_name='column
+00026580: 272c 2069 6e63 7265 6d65 6e74 5f76 616c  ', increment_val
+00026590: 7565 3d35 290a 0a20 2020 2020 2020 2023  ue=5)..        #
+000265a0: 2041 7373 6572 740a 2020 2020 2020 2020   Assert.        
+000265b0: 6173 7365 7274 2069 6e73 7461 6e63 652e  assert instance.
+000265c0: 636f 6c75 6d6e 5f6e 616d 6520 3d3d 2027  column_name == '
+000265d0: 636f 6c75 6d6e 270a 2020 2020 2020 2020  column'.        
+000265e0: 6173 7365 7274 2069 6e73 7461 6e63 652e  assert instance.
+000265f0: 696e 6372 656d 656e 745f 7661 6c75 6520  increment_value 
+00026600: 3d3d 2035 0a20 2020 2020 2020 2061 7373  == 5.        ass
+00026610: 6572 7420 696e 7374 616e 6365 2e63 6f6e  ert instance.con
+00026620: 7374 7261 696e 745f 636f 6c75 6d6e 7320  straint_columns 
+00026630: 3d3d 2028 2763 6f6c 756d 6e27 2c20 290a  == ('column', ).
+00026640: 0a20 2020 2064 6566 2074 6573 745f 5f5f  .    def test___
+00026650: 696e 6974 5f5f 5f69 6e63 7265 6d65 6e74  init___increment
+00026660: 5f76 616c 7565 5f69 735f 6e65 6761 7469  _value_is_negati
+00026670: 7665 5f6e 756d 6265 7228 7365 6c66 293a  ve_number(self):
+00026680: 0a20 2020 2020 2020 2022 2222 5465 7374  .        """Test
+00026690: 2074 6865 2060 6046 6978 6564 496e 6372   the ``FixedIncr
+000266a0: 656d 656e 7473 2e5f 5f69 6e69 745f 5f20  ements.__init__ 
+000266b0: 6d65 7468 6f64 2077 6974 6820 6120 6e65  method with a ne
+000266c0: 6761 7469 7665 2069 6e63 7265 6d65 6e74  gative increment
+000266d0: 2e0a 0a20 2020 2020 2020 2049 6620 7468  ...        If th
+000266e0: 6520 6060 696e 6372 656d 656e 745f 7661  e ``increment_va
+000266f0: 6c75 6560 6020 6973 206c 6573 7320 7468  lue`` is less th
+00026700: 616e 206f 7220 6571 7561 6c20 746f 2030  an or equal to 0
+00026710: 2c20 7468 656e 2061 6e20 6572 726f 7220  , then an error 
+00026720: 7368 6f75 6c64 2062 6520 7261 6973 6564  should be raised
+00026730: 2e0a 0a20 2020 2020 2020 2049 6e70 7574  ...        Input
+00026740: 3a0a 2020 2020 2020 2020 2020 2020 2d20  :.            - 
+00026750: 636f 6c75 6d6e 206e 616d 6520 6173 2061  column name as a
+00026760: 2073 7472 696e 672e 0a20 2020 2020 2020   string..       
+00026770: 2020 2020 202d 2069 6e63 7265 6d65 6e74       - increment
+00026780: 5f76 616c 7565 2061 7320 2d31 0a0a 2020  _value as -1..  
+00026790: 2020 2020 2020 4578 7065 6374 6564 2062        Expected b
+000267a0: 6568 6176 696f 723a 0a20 2020 2020 2020  ehavior:.       
+000267b0: 2020 2020 202d 2060 6056 616c 7565 4572       - ``ValueEr
+000267c0: 726f 7260 6020 7368 6f75 6c64 2062 6520  ror`` should be 
+000267d0: 7261 6973 6564 2e0a 2020 2020 2020 2020  raised..        
+000267e0: 2222 220a 2020 2020 2020 2020 2320 5275  """.        # Ru
+000267f0: 6e20 2f20 4173 7365 7274 0a20 2020 2020  n / Assert.     
+00026800: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
+00026810: 203d 2027 5468 6520 696e 6372 656d 656e   = 'The incremen
+00026820: 745f 7661 6c75 6520 6d75 7374 2062 6520  t_value must be 
+00026830: 6772 6561 7465 7220 7468 616e 2030 2e27  greater than 0.'
+00026840: 0a20 2020 2020 2020 2077 6974 6820 7079  .        with py
+00026850: 7465 7374 2e72 6169 7365 7328 5661 6c75  test.raises(Valu
+00026860: 6545 7272 6f72 2c20 6d61 7463 683d 6572  eError, match=er
+00026870: 726f 725f 6d65 7373 6167 6529 3a0a 2020  ror_message):.  
+00026880: 2020 2020 2020 2020 2020 4669 7865 6449            FixedI
+00026890: 6e63 7265 6d65 6e74 7328 636f 6c75 6d6e  ncrements(column
+000268a0: 5f6e 616d 653d 2763 6f6c 756d 6e27 2c20  _name='column', 
+000268b0: 696e 6372 656d 656e 745f 7661 6c75 653d  increment_value=
+000268c0: 2d31 290a 0a20 2020 2064 6566 2074 6573  -1)..    def tes
+000268d0: 745f 5f5f 696e 6974 5f5f 5f69 6e63 7265  t___init___incre
+000268e0: 6d65 6e74 5f76 616c 7565 5f69 735f 6465  ment_value_is_de
+000268f0: 6369 6d61 6c28 7365 6c66 293a 0a20 2020  cimal(self):.   
+00026900: 2020 2020 2022 2222 5465 7374 2074 6865       """Test the
+00026910: 2060 6046 6978 6564 496e 6372 656d 656e   ``FixedIncremen
+00026920: 7473 2e5f 5f69 6e69 745f 5f20 6d65 7468  ts.__init__ meth
+00026930: 6f64 2077 6974 6820 6120 6465 6369 6d61  od with a decima
+00026940: 6c20 6173 2061 6e20 696e 6372 656d 656e  l as an incremen
+00026950: 742e 0a0a 2020 2020 2020 2020 4966 2074  t...        If t
+00026960: 6865 2060 6069 6e63 7265 6d65 6e74 5f76  he ``increment_v
+00026970: 616c 7565 6060 2069 7320 6e6f 7420 6120  alue`` is not a 
+00026980: 7768 6f6c 6520 6e75 6d62 6572 2c20 7468  whole number, th
+00026990: 656e 2061 6e20 6572 726f 7220 7368 6f75  en an error shou
+000269a0: 6c64 2062 6520 7261 6973 6564 2e0a 0a20  ld be raised... 
+000269b0: 2020 2020 2020 2049 6e70 7574 3a0a 2020         Input:.  
+000269c0: 2020 2020 2020 2020 2020 2d20 636f 6c75            - colu
+000269d0: 6d6e 206e 616d 6520 6173 2061 2073 7472  mn name as a str
+000269e0: 696e 672e 0a20 2020 2020 2020 2020 2020  ing..           
+000269f0: 202d 2069 6e63 7265 6d65 6e74 5f76 616c   - increment_val
+00026a00: 7565 2061 7320 312e 350a 0a20 2020 2020  ue as 1.5..     
+00026a10: 2020 2045 7870 6563 7465 6420 6265 6861     Expected beha
+00026a20: 7669 6f72 3a0a 2020 2020 2020 2020 2020  vior:.          
+00026a30: 2020 2d20 6060 5661 6c75 6545 7272 6f72    - ``ValueError
+00026a40: 6060 2073 686f 756c 6420 6265 2072 6169  `` should be rai
+00026a50: 7365 642e 0a20 2020 2020 2020 2022 2222  sed..        """
+00026a60: 0a20 2020 2020 2020 2023 2052 756e 202f  .        # Run /
+00026a70: 2041 7373 6572 740a 2020 2020 2020 2020   Assert.        
+00026a80: 6572 726f 725f 6d65 7373 6167 6520 3d20  error_message = 
+00026a90: 2754 6865 2069 6e63 7265 6d65 6e74 5f76  'The increment_v
+00026aa0: 616c 7565 206d 7573 7420 6265 2061 2077  alue must be a w
+00026ab0: 686f 6c65 206e 756d 6265 722e 270a 2020  hole number.'.  
+00026ac0: 2020 2020 2020 7769 7468 2070 7974 6573        with pytes
+00026ad0: 742e 7261 6973 6573 2856 616c 7565 4572  t.raises(ValueEr
+00026ae0: 726f 722c 206d 6174 6368 3d65 7272 6f72  ror, match=error
+00026af0: 5f6d 6573 7361 6765 293a 0a20 2020 2020  _message):.     
+00026b00: 2020 2020 2020 2046 6978 6564 496e 6372         FixedIncr
+00026b10: 656d 656e 7473 2863 6f6c 756d 6e5f 6e61  ements(column_na
+00026b20: 6d65 3d27 636f 6c75 6d6e 272c 2069 6e63  me='column', inc
+00026b30: 7265 6d65 6e74 5f76 616c 7565 3d31 2e35  rement_value=1.5
+00026b40: 290a 0a20 2020 2064 6566 2074 6573 745f  )..    def test_
+00026b50: 5f66 6974 2873 656c 6629 3a0a 2020 2020  _fit(self):.    
+00026b60: 2020 2020 2222 2254 6573 7420 7468 6520      """Test the 
+00026b70: 6060 4669 7865 6449 6e63 7265 6d65 6e74  ``FixedIncrement
+00026b80: 732e 5f66 6974 6060 206d 6574 686f 642e  s._fit`` method.
+00026b90: 0a0a 2020 2020 2020 2020 5468 6520 6060  ..        The ``
+00026ba0: 6669 7460 6020 6d65 7468 6f64 2073 686f  fit`` method sho
+00026bb0: 756c 6420 7374 6f72 6520 7468 6520 6474  uld store the dt
+00026bc0: 7970 6520 6f66 2074 6865 2044 6174 6146  ype of the DataF
+00026bd0: 7261 6d65 2e0a 0a20 2020 2020 2020 2049  rame...        I
+00026be0: 6e70 7574 3a0a 2020 2020 2020 2020 2020  nput:.          
+00026bf0: 2020 2d20 4120 6060 7061 6e64 6173 2e44    - A ``pandas.D
+00026c00: 6174 6146 7261 6d65 6060 2077 6974 6820  ataFrame`` with 
+00026c10: 6120 666c 6f61 7420 6474 7970 652e 0a0a  a float dtype...
+00026c20: 2020 2020 2020 2020 4578 7065 6374 6564          Expected
+00026c30: 2062 6568 6176 696f 723a 0a20 2020 2020   behavior:.     
+00026c40: 2020 2020 2020 202d 2054 6865 2060 6069         - The ``i
+00026c50: 6e73 7461 6e63 652e 5f64 7479 7065 6060  nstance._dtype``
+00026c60: 2073 686f 756c 6420 6265 2073 6574 2074   should be set t
+00026c70: 6f20 666c 6f61 742e 0a20 2020 2020 2020  o float..       
+00026c80: 2022 2222 0a20 2020 2020 2020 2023 2053   """.        # S
+00026c90: 6574 7570 0a20 2020 2020 2020 2064 6174  etup.        dat
+00026ca0: 6120 3d20 7064 2e44 6174 6146 7261 6d65  a = pd.DataFrame
+00026cb0: 287b 2763 6f6c 756d 6e27 3a20 5b37 2c20  ({'column': [7, 
+00026cc0: 3134 2c20 3231 5d7d 2c20 6474 7970 653d  14, 21]}, dtype=
+00026cd0: 666c 6f61 7429 0a20 2020 2020 2020 2069  float).        i
+00026ce0: 6e73 7461 6e63 6520 3d20 4669 7865 6449  nstance = FixedI
+00026cf0: 6e63 7265 6d65 6e74 7328 636f 6c75 6d6e  ncrements(column
+00026d00: 5f6e 616d 653d 2763 6f6c 756d 6e27 2c20  _name='column', 
+00026d10: 696e 6372 656d 656e 745f 7661 6c75 653d  increment_value=
+00026d20: 3729 0a0a 2020 2020 2020 2020 2320 5275  7)..        # Ru
+00026d30: 6e0a 2020 2020 2020 2020 696e 7374 616e  n.        instan
+00026d40: 6365 2e5f 6669 7428 6461 7461 290a 0a20  ce._fit(data).. 
+00026d50: 2020 2020 2020 2023 2041 7373 6572 740a         # Assert.
+00026d60: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
+00026d70: 6e73 7461 6e63 652e 5f64 7479 7065 203d  nstance._dtype =
+00026d80: 3d20 666c 6f61 740a 0a20 2020 2064 6566  = float..    def
+00026d90: 2074 6573 745f 6973 5f76 616c 6964 2873   test_is_valid(s
+00026da0: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
+00026db0: 2254 6573 7420 7468 6520 6060 4669 7865  "Test the ``Fixe
+00026dc0: 6449 6e63 7265 6d65 6e74 732e 6973 5f76  dIncrements.is_v
+00026dd0: 616c 6964 6060 206d 6574 686f 642e 0a0a  alid`` method...
+00026de0: 2020 2020 2020 2020 5468 6520 6060 6973          The ``is
+00026df0: 5f76 616c 6964 6060 206d 6574 686f 6420  _valid`` method 
+00026e00: 7368 6f75 6c64 2072 6574 7572 6e20 6060  should return ``
+00026e10: 5472 7565 6060 2066 6f72 2072 6f77 7320  True`` for rows 
+00026e20: 7468 6174 2061 7265 204e 614e 206f 7220  that are NaN or 
+00026e30: 6576 656e 6c79 2064 6976 6973 6962 6c65  evenly divisible
+00026e40: 0a20 2020 2020 2020 2062 7920 7468 6520  .        by the 
+00026e50: 696e 6372 656d 656e 742e 0a0a 2020 2020  increment...    
+00026e60: 2020 2020 496e 7075 743a 0a20 2020 2020      Input:.     
+00026e70: 2020 2020 2020 202d 2041 2060 6070 616e         - A ``pan
+00026e80: 6461 732e 4461 7461 4672 616d 6560 6020  das.DataFrame`` 
+00026e90: 7769 7468 206f 6e65 2063 6f6c 756d 6e20  with one column 
+00026ea0: 636f 6e74 6169 6e69 6e67 2073 6f6d 6520  containing some 
+00026eb0: 4e61 4e73 2c20 736f 6d65 206e 756d 6265  NaNs, some numbe
+00026ec0: 7273 2074 6861 7420 6172 650a 2020 2020  rs that are.    
+00026ed0: 2020 2020 2020 2020 6469 7669 7369 626c          divisibl
+00026ee0: 6520 6279 2074 6865 2069 6e63 7265 6d65  e by the increme
+00026ef0: 6e74 2061 6e64 2073 6f6d 6520 6e75 6d62  nt and some numb
+00026f00: 6572 7320 7468 6174 2061 7265 206e 6f74  ers that are not
+00026f10: 2e0a 0a20 2020 2020 2020 204f 7574 7075  ...        Outpu
+00026f20: 743a 0a20 2020 2020 2020 2020 2020 202d  t:.            -
+00026f30: 2041 2060 6070 616e 6461 732e 5365 7269   A ``pandas.Seri
+00026f40: 6573 6060 2077 6865 7265 2061 6c6c 2074  es`` where all t
+00026f50: 6865 2072 6f77 7320 7468 6174 2061 7265  he rows that are
+00026f60: 204e 614e 206f 7220 6469 7669 7369 626c   NaN or divisibl
+00026f70: 6520 6279 2074 6865 2069 6e63 7265 6d65  e by the increme
+00026f80: 6e74 2061 7265 0a20 2020 2020 2020 2020  nt are.         
+00026f90: 2020 2060 6054 7275 6560 602e 0a20 2020     ``True``..   
+00026fa0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00026fb0: 2023 2053 6574 7570 0a20 2020 2020 2020   # Setup.       
+00026fc0: 2064 6174 6120 3d20 7064 2e44 6174 6146   data = pd.DataF
+00026fd0: 7261 6d65 287b 2763 6f6c 756d 6e27 3a20  rame({'column': 
+00026fe0: 5b37 2c20 3134 2c20 6e70 2e6e 616e 2c20  [7, 14, np.nan, 
+00026ff0: 3230 2c20 382c 2033 355d 7d2c 2064 7479  20, 8, 35]}, dty
+00027000: 7065 3d66 6c6f 6174 290a 2020 2020 2020  pe=float).      
+00027010: 2020 696e 7374 616e 6365 203d 2046 6978    instance = Fix
+00027020: 6564 496e 6372 656d 656e 7473 2863 6f6c  edIncrements(col
+00027030: 756d 6e5f 6e61 6d65 3d27 636f 6c75 6d6e  umn_name='column
+00027040: 272c 2069 6e63 7265 6d65 6e74 5f76 616c  ', increment_val
+00027050: 7565 3d37 290a 0a20 2020 2020 2020 2023  ue=7)..        #
+00027060: 2052 756e 0a20 2020 2020 2020 2069 735f   Run.        is_
+00027070: 7661 6c69 6420 3d20 696e 7374 616e 6365  valid = instance
+00027080: 2e69 735f 7661 6c69 6428 6461 7461 290a  .is_valid(data).
+00027090: 0a20 2020 2020 2020 2023 2041 7373 6572  .        # Asser
+000270a0: 740a 2020 2020 2020 2020 6578 7065 6374  t.        expect
+000270b0: 6564 203d 2070 642e 5365 7269 6573 285b  ed = pd.Series([
+000270c0: 5472 7565 2c20 5472 7565 2c20 5472 7565  True, True, True
+000270d0: 2c20 4661 6c73 652c 2046 616c 7365 2c20  , False, False, 
+000270e0: 5472 7565 5d2c 206e 616d 653d 2763 6f6c  True], name='col
+000270f0: 756d 6e27 290a 2020 2020 2020 2020 7064  umn').        pd
+00027100: 2e74 6573 7469 6e67 2e61 7373 6572 745f  .testing.assert_
+00027110: 7365 7269 6573 5f65 7175 616c 2869 735f  series_equal(is_
+00027120: 7661 6c69 642c 2065 7870 6563 7465 6429  valid, expected)
+00027130: 0a0a 2020 2020 6465 6620 7465 7374 5f5f  ..    def test__
+00027140: 7472 616e 7366 6f72 6d28 7365 6c66 293a  transform(self):
+00027150: 0a20 2020 2020 2020 2022 2222 5465 7374  .        """Test
+00027160: 2074 6865 2060 6046 6978 6564 496e 6372   the ``FixedIncr
+00027170: 656d 656e 7473 2e5f 7472 616e 7366 6f72  ements._transfor
+00027180: 6d60 6020 6d65 7468 6f64 2e0a 0a20 2020  m`` method...   
+00027190: 2020 2020 2054 6865 2060 605f 7472 616e       The ``_tran
+000271a0: 7366 6f72 6d60 6020 6d65 7468 6f64 2073  sform`` method s
+000271b0: 686f 756c 6420 6469 7669 6465 2061 6c6c  hould divide all
+000271c0: 2076 616c 7565 7320 696e 2074 6865 2064   values in the d
+000271d0: 6174 6120 6279 2074 6865 2060 6069 6e63  ata by the ``inc
+000271e0: 7265 6d65 6e74 5f76 616c 7565 6060 2e0a  rement_value``..
+000271f0: 0a20 2020 2020 2020 2049 6e70 7574 3a0a  .        Input:.
+00027200: 2020 2020 2020 2020 2020 2020 2d20 4120              - A 
+00027210: 6060 7064 2e44 6174 6146 7261 6d65 6060  ``pd.DataFrame``
+00027220: 2077 6974 6820 6f6e 6520 636f 6c75 6d6e   with one column
+00027230: 2063 6f6e 7461 696e 696e 6720 4e61 4e73   containing NaNs
+00027240: 2061 6e64 2076 616c 7565 7320 6469 7669   and values divi
+00027250: 7369 626c 6520 6279 2074 6865 0a20 2020  sible by the.   
+00027260: 2020 2020 2020 2020 2060 6069 6e63 7265           ``incre
+00027270: 6d65 6e74 5f76 616c 7565 6060 2e0a 0a20  ment_value``... 
+00027280: 2020 2020 2020 204f 7574 7075 743a 0a20         Output:. 
+00027290: 2020 2020 2020 2020 2020 202d 2041 2060             - A `
+000272a0: 6070 642e 4461 7461 4672 616d 6560 6020  `pd.DataFrame`` 
+000272b0: 7769 7468 2061 6c6c 2074 6865 2076 616c  with all the val
+000272c0: 7565 7320 696e 2074 6861 7420 636f 6c75  ues in that colu
+000272d0: 6d6e 2064 6976 6964 6564 2062 7920 7468  mn divided by th
+000272e0: 650a 2020 2020 2020 2020 2020 2020 6060  e.            ``
+000272f0: 696e 6372 656d 656e 745f 7661 6c75 6560  increment_value`
+00027300: 6020 616e 6420 7468 6520 4e61 4e73 206c  ` and the NaNs l
+00027310: 6566 7420 616c 6f6e 652e 0a20 2020 2020  eft alone..     
+00027320: 2020 2022 2222 0a20 2020 2020 2020 2023     """.        #
+00027330: 2053 6574 7570 0a20 2020 2020 2020 2064   Setup.        d
+00027340: 6174 6120 3d20 7064 2e44 6174 6146 7261  ata = pd.DataFra
+00027350: 6d65 287b 2763 6f6c 756d 6e27 3a20 5b37  me({'column': [7
+00027360: 2c20 3134 2c20 6e70 2e6e 616e 2c20 3335  , 14, np.nan, 35
+00027370: 5d7d 290a 2020 2020 2020 2020 696e 7374  ]}).        inst
+00027380: 616e 6365 203d 2046 6978 6564 496e 6372  ance = FixedIncr
+00027390: 656d 656e 7473 2863 6f6c 756d 6e5f 6e61  ements(column_na
+000273a0: 6d65 3d27 636f 6c75 6d6e 272c 2069 6e63  me='column', inc
+000273b0: 7265 6d65 6e74 5f76 616c 7565 3d37 290a  rement_value=7).
+000273c0: 0a20 2020 2020 2020 2023 2052 756e 0a20  .        # Run. 
+000273d0: 2020 2020 2020 2074 7261 6e73 666f 726d         transform
+000273e0: 6564 203d 2069 6e73 7461 6e63 652e 5f74  ed = instance._t
+000273f0: 7261 6e73 666f 726d 2864 6174 6129 0a0a  ransform(data)..
+00027400: 2020 2020 2020 2020 2320 4173 7365 7274          # Assert
+00027410: 0a20 2020 2020 2020 2065 7870 6563 7465  .        expecte
+00027420: 6420 3d20 7064 2e44 6174 6146 7261 6d65  d = pd.DataFrame
+00027430: 287b 2763 6f6c 756d 6e27 3a20 5b31 2c20  ({'column': [1, 
+00027440: 322c 206e 702e 6e61 6e2c 2035 5d7d 290a  2, np.nan, 5]}).
+00027450: 2020 2020 2020 2020 7064 2e74 6573 7469          pd.testi
+00027460: 6e67 2e61 7373 6572 745f 6672 616d 655f  ng.assert_frame_
+00027470: 6571 7561 6c28 7472 616e 7366 6f72 6d65  equal(transforme
+00027480: 642c 2065 7870 6563 7465 6429 0a0a 2020  d, expected)..  
+00027490: 2020 6465 6620 7465 7374 5f72 6576 6572    def test_rever
+000274a0: 7365 5f74 7261 6e73 666f 726d 2873 656c  se_transform(sel
+000274b0: 6629 3a0a 2020 2020 2020 2020 2222 2254  f):.        """T
+000274c0: 6573 7420 7468 6520 6060 4669 7865 6449  est the ``FixedI
+000274d0: 6e63 7265 6d65 6e74 732e 7265 7665 7273  ncrements.revers
+000274e0: 655f 7472 616e 7366 6f72 6d60 6020 6d65  e_transform`` me
+000274f0: 7468 6f64 2e0a 0a20 2020 2020 2020 2054  thod...        T
+00027500: 6865 2060 6072 6576 6572 7365 5f74 7261  he ``reverse_tra
+00027510: 6e73 666f 726d 6060 206d 6574 686f 6420  nsform`` method 
+00027520: 7368 6f75 6c64 2072 6f75 6e64 2061 6c6c  should round all
+00027530: 2073 616d 706c 6564 2076 616c 7565 7320   sampled values 
+00027540: 746f 2074 6865 206e 6561 7265 7374 2069  to the nearest i
+00027550: 6e74 2c0a 2020 2020 2020 2020 616e 6420  nt,.        and 
+00027560: 7468 656e 206d 756c 7469 706c 7920 7468  then multiply th
+00027570: 656d 2062 7920 7468 6520 6060 696e 6372  em by the ``incr
+00027580: 656d 656e 745f 7661 6c75 6560 6020 616e  ement_value`` an
+00027590: 6420 636f 6e76 6572 7420 7468 656d 2074  d convert them t
+000275a0: 6f20 7468 6520 6060 5f64 7479 7065 6060  o the ``_dtype``
+000275b0: 2e0a 0a20 2020 2020 2020 2053 6574 7570  ...        Setup
+000275c0: 3a0a 2020 2020 2020 2020 2020 2020 2d20  :.            - 
+000275d0: 5365 7420 7468 6520 6060 5f64 7479 7065  Set the ``_dtype
+000275e0: 6060 2074 6f20 696e 7436 342e 0a0a 2020  `` to int64...  
+000275f0: 2020 2020 2020 496e 7075 743a 0a20 2020        Input:.   
+00027600: 2020 2020 2020 2020 202d 2041 2060 6070           - A ``p
+00027610: 616e 6461 732e 4461 7461 4672 616d 6560  andas.DataFrame`
+00027620: 6020 7769 7468 2066 6c6f 6174 732e 0a0a  ` with floats...
+00027630: 2020 2020 2020 2020 4f75 7470 7574 3a0a          Output:.
+00027640: 2020 2020 2020 2020 2020 2020 2d20 4120              - A 
+00027650: 6060 7061 6e64 6173 2e44 6174 6146 7261  ``pandas.DataFra
+00027660: 6d65 6060 2077 6974 6820 7468 6520 7661  me`` with the va
+00027670: 6c75 6573 206d 756c 7469 706c 6965 6420  lues multiplied 
+00027680: 6279 2074 6865 2060 6069 6e63 7265 6d65  by the ``increme
+00027690: 6e74 5f76 616c 7565 6060 2061 6e64 0a20  nt_value`` and. 
+000276a0: 2020 2020 2020 2020 2020 2063 6f6e 7665             conve
+000276b0: 7274 6564 2074 6f20 696e 7473 2e0a 2020  rted to ints..  
+000276c0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+000276d0: 2020 2320 5365 7475 700a 2020 2020 2020    # Setup.      
+000276e0: 2020 6461 7461 203d 2070 642e 4461 7461    data = pd.Data
+000276f0: 4672 616d 6528 7b27 636f 6c75 6d6e 273a  Frame({'column':
+00027700: 205b 312e 332c 2033 2e35 2c20 342e 322c   [1.3, 3.5, 4.2,
+00027710: 2032 2e31 5d7d 290a 2020 2020 2020 2020   2.1]}).        
+00027720: 696e 7374 616e 6365 203d 2046 6978 6564  instance = Fixed
+00027730: 496e 6372 656d 656e 7473 2863 6f6c 756d  Increments(colum
+00027740: 6e5f 6e61 6d65 3d27 636f 6c75 6d6e 272c  n_name='column',
+00027750: 2069 6e63 7265 6d65 6e74 5f76 616c 7565   increment_value
+00027760: 3d37 290a 2020 2020 2020 2020 696e 7374  =7).        inst
+00027770: 616e 6365 2e5f 6474 7970 6520 3d20 6e70  ance._dtype = np
+00027780: 2e69 6e74 3634 0a0a 2020 2020 2020 2020  .int64..        
+00027790: 2320 5275 6e0a 2020 2020 2020 2020 7265  # Run.        re
+000277a0: 7665 7273 655f 7472 616e 7366 6f72 6d65  verse_transforme
+000277b0: 6420 3d20 696e 7374 616e 6365 2e72 6576  d = instance.rev
+000277c0: 6572 7365 5f74 7261 6e73 666f 726d 2864  erse_transform(d
+000277d0: 6174 6129 0a0a 2020 2020 2020 2020 2320  ata)..        # 
+000277e0: 4173 7365 7274 0a20 2020 2020 2020 2065  Assert.        e
+000277f0: 7870 6563 7465 6420 3d20 7064 2e44 6174  xpected = pd.Dat
+00027800: 6146 7261 6d65 287b 2763 6f6c 756d 6e27  aFrame({'column'
+00027810: 3a20 5b37 2c20 3238 2c20 3238 2c20 3134  : [7, 28, 28, 14
+00027820: 5d7d 290a 2020 2020 2020 2020 7064 2e74  ]}).        pd.t
+00027830: 6573 7469 6e67 2e61 7373 6572 745f 6672  esting.assert_fr
+00027840: 616d 655f 6571 7561 6c28 6578 7065 6374  ame_equal(expect
+00027850: 6564 2c20 7265 7665 7273 655f 7472 616e  ed, reverse_tran
+00027860: 7366 6f72 6d65 6429 0a0a 2020 2020 6465  sformed)..    de
+00027870: 6620 7465 7374 5f72 6576 6572 7365 5f74  f test_reverse_t
+00027880: 7261 6e73 666f 726d 5f6e 616e 7328 7365  ransform_nans(se
+00027890: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+000278a0: 5465 7374 2074 6865 2060 6046 6978 6564  Test the ``Fixed
+000278b0: 496e 6372 656d 656e 7473 2e72 6576 6572  Increments.rever
+000278c0: 7365 5f74 7261 6e73 666f 726d 6060 206d  se_transform`` m
+000278d0: 6574 686f 6420 7769 7468 204e 614e 732e  ethod with NaNs.
+000278e0: 0a0a 2020 2020 2020 2020 5468 6520 6060  ..        The ``
+000278f0: 7265 7665 7273 655f 7472 616e 7366 6f72  reverse_transfor
+00027900: 6d60 6020 6d65 7468 6f64 2073 686f 756c  m`` method shoul
+00027910: 6420 6967 6e6f 7265 2074 6865 204e 614e  d ignore the NaN
+00027920: 2076 616c 7565 732e 0a0a 2020 2020 2020   values...      
+00027930: 2020 5365 7475 703a 0a20 2020 2020 2020    Setup:.       
+00027940: 2020 2020 202d 2053 6574 2074 6865 2060       - Set the `
+00027950: 605f 6474 7970 6560 6020 746f 2066 6c6f  `_dtype`` to flo
+00027960: 6174 3634 2e0a 0a20 2020 2020 2020 2049  at64...        I
+00027970: 6e70 7574 3a0a 2020 2020 2020 2020 2020  nput:.          
+00027980: 2020 2d20 4120 6060 7061 6e64 6173 2e44    - A ``pandas.D
+00027990: 6174 6146 7261 6d65 6060 2077 6974 6820  ataFrame`` with 
+000279a0: 666c 6f61 7473 2e0a 0a20 2020 2020 2020  floats...       
+000279b0: 204f 7574 7075 743a 0a20 2020 2020 2020   Output:.       
+000279c0: 2020 2020 202d 2041 2060 6070 616e 6461       - A ``panda
+000279d0: 732e 4461 7461 4672 616d 6560 6020 7769  s.DataFrame`` wi
+000279e0: 7468 2074 6865 2076 616c 7565 7320 6d75  th the values mu
+000279f0: 6c74 6970 6c69 6564 2062 7920 7468 6520  ltiplied by the 
+00027a00: 6060 696e 6372 656d 656e 745f 7661 6c75  ``increment_valu
+00027a10: 6560 6020 616e 640a 2020 2020 2020 2020  e`` and.        
+00027a20: 2020 2020 7468 6520 4e61 4e73 2069 676e      the NaNs ign
+00027a30: 6f72 6564 2e0a 2020 2020 2020 2020 2222  ored..        ""
+00027a40: 220a 2020 2020 2020 2020 2320 5365 7475  ".        # Setu
+00027a50: 700a 2020 2020 2020 2020 6461 7461 203d  p.        data =
+00027a60: 2070 642e 4461 7461 4672 616d 6528 7b27   pd.DataFrame({'
+00027a70: 636f 6c75 6d6e 273a 205b 312e 332c 2033  column': [1.3, 3
+00027a80: 2e35 2c20 6e70 2e6e 616e 2c20 342e 322c  .5, np.nan, 4.2,
+00027a90: 206e 702e 6e61 6e2c 2032 2e31 5d7d 290a   np.nan, 2.1]}).
+00027aa0: 2020 2020 2020 2020 696e 7374 616e 6365          instance
+00027ab0: 203d 2046 6978 6564 496e 6372 656d 656e   = FixedIncremen
+00027ac0: 7473 2863 6f6c 756d 6e5f 6e61 6d65 3d27  ts(column_name='
+00027ad0: 636f 6c75 6d6e 272c 2069 6e63 7265 6d65  column', increme
+00027ae0: 6e74 5f76 616c 7565 3d37 290a 2020 2020  nt_value=7).    
+00027af0: 2020 2020 696e 7374 616e 6365 2e5f 6474      instance._dt
+00027b00: 7970 6520 3d20 6e70 2e66 6c6f 6174 3634  ype = np.float64
+00027b10: 0a0a 2020 2020 2020 2020 2320 5275 6e0a  ..        # Run.
+00027b20: 2020 2020 2020 2020 7265 7665 7273 655f          reverse_
+00027b30: 7472 616e 7366 6f72 6d65 6420 3d20 696e  transformed = in
+00027b40: 7374 616e 6365 2e72 6576 6572 7365 5f74  stance.reverse_t
+00027b50: 7261 6e73 666f 726d 2864 6174 6129 0a0a  ransform(data)..
+00027b60: 2020 2020 2020 2020 2320 4173 7365 7274          # Assert
+00027b70: 0a20 2020 2020 2020 2065 7870 6563 7465  .        expecte
+00027b80: 6420 3d20 7064 2e44 6174 6146 7261 6d65  d = pd.DataFrame
+00027b90: 287b 2763 6f6c 756d 6e27 3a20 5b37 2c20  ({'column': [7, 
+00027ba0: 3238 2c20 6e70 2e6e 616e 2c20 3238 2c20  28, np.nan, 28, 
+00027bb0: 6e70 2e6e 616e 2c20 3134 5d7d 290a 2020  np.nan, 14]}).  
+00027bc0: 2020 2020 2020 7064 2e74 6573 7469 6e67        pd.testing
+00027bd0: 2e61 7373 6572 745f 6672 616d 655f 6571  .assert_frame_eq
+00027be0: 7561 6c28 6578 7065 6374 6564 2c20 7265  ual(expected, re
+00027bf0: 7665 7273 655f 7472 616e 7366 6f72 6d65  verse_transforme
+00027c00: 6429 0a                                  d).
```

### Comparing `sdv-1.1.0.dev0/tests/unit/data_processing/test_data_processor.py` & `sdv-1.2.0.dev0/tests/unit/data_processing/test_data_processor.py`

 * *Files 7% similar despite different names*

```diff
@@ -4,16 +4,15 @@
 import numpy as np
 import pandas as pd
 import pytest
 from rdt.errors import ConfigNotSetError
 from rdt.errors import NotFittedError as RDTNotFittedError
 from rdt.transformers import FloatFormatter, LabelEncoder, UnixTimestampEncoder
 
-from sdv.constraints.errors import (
-    AggregateConstraintsError, FunctionError, MissingConstraintColumnError)
+from sdv.constraints.errors import MissingConstraintColumnError
 from sdv.constraints.tabular import Positive, ScalarRange
 from sdv.data_processing.data_processor import DataProcessor
 from sdv.data_processing.datetime_formatter import DatetimeFormatter
 from sdv.data_processing.errors import InvalidConstraintsError, NotFittedError
 from sdv.data_processing.numerical_formatter import NumericalFormatter
 from sdv.errors import SynthesizerInputError
 from sdv.metadata.single_table import SingleTableMetadata
@@ -717,166 +716,14 @@
         # Assert
         assert loaded_constraints == [constraint1, constraint2, custom_constraint.return_value]
         custom_constraint.assert_called_once_with(column_names=['a', 'b'])
 
         constraint_mock.from_dict.assert_has_calls(
             [call(constraint1_dict), call(constraint2_dict)])
 
-    def test__fit_transform_constraints(self):
-        """Test the ``_fit_transform_constraints`` method.
-
-        The method should loop through all the constraints, fit them,
-        and then call ``transform`` for all of them.
-
-        Setup:
-            - Set the ``_constraints`` to be a list of mocked constraints.
-
-        Input:
-            - A ``pandas.DataFrame``.
-
-        Output:
-            - Same ``pandas.DataFrame``.
-
-        Side effect:
-            - Each constraint should be fit and transform the data.
-        """
-        # Setup
-        data = pd.DataFrame({'a': [1, 2, 3]})
-        transformed_data = pd.DataFrame({'a': [4, 5, 6]})
-        dp = DataProcessor(SingleTableMetadata())
-        constraint1 = Mock()
-        constraint2 = Mock()
-        constraint1.transform.return_value = transformed_data
-        constraint2.transform.return_value = data
-        dp._load_constraints = Mock()
-        dp._load_constraints.return_value = [constraint1, constraint2]
-
-        # Run
-        constrained_data = dp._fit_transform_constraints(data)
-
-        # Assert
-        constraint1.fit.assert_called_once_with(data)
-        constraint2.fit.assert_called_once_with(data)
-        constraint1.transform.assert_called_once_with(data)
-        constraint2.transform.assert_called_once_with(transformed_data)
-        pd.testing.assert_frame_equal(constrained_data, data)
-
-    def test__fit_transform_constraints_fit_errors(self):
-        """Test the ``_fit_transform_constraints`` method when constraints error on fit.
-
-        The method should loop through all the constraints and try to fit them. If
-        any errors are raised, they should be caught and surfaced together.
-
-        Setup:
-            - Set the ``_constraints`` to be a list of mocked constraints.
-            - Set constraint mocks to raise Exceptions when calling fit.
-
-        Input:
-            - A ``pandas.DataFrame``.
-
-        Side effect:
-            - A ``AggregateConstraintsError`` error should be raised.
-        """
-        # Setup
-        data = pd.DataFrame({'a': [1, 2, 3]})
-        dp = DataProcessor(SingleTableMetadata())
-        constraint1 = Mock()
-        constraint2 = Mock()
-        constraint1.fit.side_effect = Exception('error 1')
-        constraint2.fit.side_effect = Exception('error 2')
-        dp._load_constraints = Mock()
-        dp._load_constraints.return_value = [constraint1, constraint2]
-
-        # Run / Assert
-        error_message = re.escape('\nerror 1\n\nerror 2')
-        with pytest.raises(AggregateConstraintsError, match=error_message):
-            dp._fit_transform_constraints(data)
-
-    def test__fit_transform_constraints_transform_errors(self):
-        """Test the ``_fit_transform_constraints`` method when constraints error on transform.
-
-        The method should loop through all the constraints and try to fit them. Then it
-        should loop through again and try to transform. If any errors are raised, they should be
-        caught and surfaced together.
-
-        Setup:
-            - Set the ``_constraints`` to be a list of mocked constraints.
-            - Set constraint mocks to raise Exceptions when calling transform.
-
-        Input:
-            - A ``pandas.DataFrame``.
-
-        Side effect:
-            - A ``AggregateConstraintsError`` error should be raised.
-        """
-        # Setup
-        data = pd.DataFrame({'a': [1, 2, 3]})
-        dp = DataProcessor(SingleTableMetadata())
-        constraint1 = Mock()
-        constraint2 = Mock()
-        constraint1.transform.side_effect = Exception('error 1')
-        constraint2.transform.side_effect = Exception('error 2')
-        dp._load_constraints = Mock()
-        dp._load_constraints.return_value = [constraint1, constraint2]
-
-        # Run / Assert
-        error_message = re.escape('\nerror 1\n\nerror 2')
-        with pytest.raises(AggregateConstraintsError, match=error_message):
-            dp._fit_transform_constraints(data)
-
-        constraint1.fit.assert_called_once_with(data)
-        constraint2.fit.assert_called_once_with(data)
-
-    @patch('sdv.data_processing.data_processor.LOGGER')
-    def test__fit_transform_constraints_missing_columns_error(self, log_mock):
-        """Test the ``_fit_transform_constraints`` method when transform raises a errors.
-
-        The method should loop through all the constraints and try to fit them. Then it
-        should loop through again and try to transform. If a ``MissingConstraintColumnError`` or
-        ``FunctionError`` is raised, a warning should be raised and reject sampling should be used.
-
-        Setup:
-            - Set the ``_constraints`` to be a list of mocked constraints.
-            - Set constraint mocks to raise ``MissingConstraintColumnError`` and ``FunctionError``
-            when calling transform.
-            - Mock warnings module.
-
-        Input:
-            - A ``pandas.DataFrame``.
-
-        Side effect:
-            - ``MissingConstraintColumnError`` and ``FunctionError`` warning messages.
-        """
-        # Setup
-        data = pd.DataFrame({'a': [1, 2, 3]})
-        dp = DataProcessor(SingleTableMetadata())
-        constraint1 = Mock()
-        constraint2 = Mock()
-        constraint3 = Mock()
-        constraint1.transform.return_value = data
-        constraint2.transform.side_effect = MissingConstraintColumnError(['column'])
-        constraint3.transform.side_effect = FunctionError()
-        dp._load_constraints = Mock()
-        dp._load_constraints.return_value = [constraint1, constraint2, constraint3]
-
-        # Run
-        dp._fit_transform_constraints(data)
-
-        # Assert
-        constraint1.fit.assert_called_once_with(data)
-        constraint2.fit.assert_called_once_with(data)
-        constraint3.fit.assert_called_once_with(data)
-        assert log_mock.info.call_count == 2
-        message1 = (
-            "Mock cannot be transformed because columns: ['column'] were not found. Using the "
-            'reject sampling approach instead.'
-        )
-        message2 = 'Error transforming Mock. Using the reject sampling approach instead.'
-        log_mock.info.assert_has_calls([call(message1), call(message2)])
-
     def test__update_transformers_by_sdtypes(self):
         """Test that we update the ``_transformers_by_sdtype`` of the current instance."""
         # Setup
         instance = Mock()
         instance._transformers_by_sdtype = {
             'categorical': 'labelencoder',
             'numerical': 'float',
@@ -1446,24 +1293,27 @@
         creating the configuration for the ``rdt.HyperTransformer``.
         """
         # Setup
         data = pd.DataFrame({'a': [1, 2, 3]}, dtype=np.int64)
         transformed_data = pd.DataFrame({'a': [4, 5, 6], 'b': [1, 2, 3]})
         dp = Mock()
         dp.table_name = 'fake_table'
-        dp._fit_transform_constraints.return_value = transformed_data
+        dp._transform_constraints.return_value = transformed_data
         dp._prepared_for_fitting = False
         dp._hyper_transformer.get_config.return_value = {'sdtypes': {}, 'transformers': {}}
+        dp._constraints_list = [1, 2, 3]
+        dp._constraints = []
 
         # Run
         DataProcessor.prepare_for_fitting(dp, data)
 
         # Assert
         pd.testing.assert_series_equal(dp._dtypes, pd.Series([np.int64], index=['a']))
-        dp._fit_transform_constraints.assert_called_once_with(data)
+        dp._transform_constraints.assert_called_once_with(data)
+        dp._fit_constraints.assert_called_once_with(data)
         dp._fit_formatters.assert_called_once_with(data)
         dp._hyper_transformer.set_config.assert_called_with(dp._create_config.return_value)
         fitting_call = call('Fitting table fake_table metadata')
         formatter_call = call('Fitting formatters for table fake_table')
         constraint_call = call('Fitting constraints for table fake_table')
         setting_config_call = call(
             'Setting the configuration for the ``HyperTransformer`` for table fake_table')
@@ -1482,27 +1332,29 @@
         already exists, it doesn't need to be created again.
         """
         # Setup
         data = pd.DataFrame({'a': [1, 2, 3]}, dtype=np.int64)
         transformed_data = pd.DataFrame({'column': [4, 5, 6]})
         dp = Mock()
         dp.table_name = 'fake_table'
-        dp._fit_transform_constraints.return_value = transformed_data
+        dp._constraints_list = []
+        dp._constraints = []
+        dp._transform_constraints.return_value = transformed_data
         dp._prepared_for_fitting = False
         dp._hyper_transformer.get_config.return_value = {
             'sdtypes': {'column': 'numerical'},
             'transformers': {'column': Mock()}
         }
 
         # Run
         DataProcessor.prepare_for_fitting(dp, data)
 
         # Assert
         pd.testing.assert_series_equal(dp._dtypes, pd.Series([np.int64], index=['a']))
-        dp._fit_transform_constraints.assert_called_once_with(data)
+        dp._transform_constraints.assert_called_once_with(data)
         dp._fit_formatters.assert_called_once_with(data)
         dp._hyper_transformer.set_config.assert_not_called()
         fitting_call = call('Fitting table fake_table metadata')
         formatter_call = call('Fitting formatters for table fake_table')
         constraint_call = call('Fitting constraints for table fake_table')
         log_mock.info.assert_has_calls([
             fitting_call,
@@ -1521,28 +1373,31 @@
         data = pd.DataFrame({'a': [1, 2, 3]}, dtype=np.int64)
         transformed_data = pd.DataFrame({
             'column': [4, 5, 6],
             'column#a': [1., 2., 3.]
         })
         dp = Mock()
         dp.table_name = 'fake_table'
-        dp._fit_transform_constraints.return_value = transformed_data
+        dp._transform_constraints.return_value = transformed_data
         dp._prepared_for_fitting = False
+        dp._constraints_list = [1, 2, 3]
+        dp._constraints = [1, 2, 3]
         config = {
             'sdtypes': {'column': 'numerical'},
             'transformers': {'column': Mock()}
         }
         dp._hyper_transformer.get_config.return_value = config
 
         # Run
         DataProcessor.prepare_for_fitting(dp, data)
 
         # Assert
         pd.testing.assert_series_equal(dp._dtypes, pd.Series([np.int64], index=['a']))
-        dp._fit_transform_constraints.assert_called_once_with(data)
+        dp._fit_constraints.assert_not_called()
+        dp._transform_constraints.assert_called_once_with(data)
         dp._fit_formatters.assert_called_once_with(data)
         dp._update_constraint_transformers.assert_called_once_with(
             transformed_data,
             {'column#a'},
             config
         )
         assert dp._hyper_transformer == mock_rdt.HyperTransformer.return_value
@@ -1551,21 +1406,23 @@
 
     @patch('sdv.data_processing.data_processor.LOGGER')
     def test_prepare_for_fitting_already_prepared(self, log_mock):
         """Test that if the preparation has already been done, it doesn't do it again."""
         # Setup
         data = pd.DataFrame({'a': [1, 2, 3]}, dtype=np.int64)
         dp = Mock()
+        dp._constraints_list = []
+        dp._constraints = []
         dp._prepared_for_fitting = True
 
         # Run
         DataProcessor.prepare_for_fitting(dp, data)
 
         # Assert
-        dp._fit_transform_constraints.assert_not_called()
+        dp._fit_constraints.assert_not_called()
         dp._fit_formatters.assert_not_called()
         log_mock.info.assert_not_called()
 
     @patch('sdv.data_processing.data_processor.LOGGER')
     def test_fit(self, log_mock):
         """Test the ``fit`` method.
 
@@ -1772,15 +1629,15 @@
         # Setup
         data = pd.DataFrame({
             'item 0': [0, 1, 2],
             'item 1': [True, True, False]
         }, index=[0, 1, 2])
         dp = DataProcessor(SingleTableMetadata(), table_name='table_name')
 
-        # Run
+        # Run and Assert
         with pytest.raises(NotFittedError):
             dp.transform(data)
 
     def test_transform_hyper_transformer_errors(self):
         """Test the ``transform`` method when ``HyperTransformer`` errors.
 
         The method should catch the error raised by the ``HyperTransformer`` and return
@@ -2074,15 +1931,15 @@
         # Setup
         data = pd.DataFrame({
             'item 0': [0, 1, 2],
             'item 1': [True, True, False]
         }, index=[0, 1, 2])
         dp = DataProcessor(SingleTableMetadata(), table_name='table_name')
 
-        # Run
+        # Run and Assert
         with pytest.raises(NotFittedError):
             dp.reverse_transform(data)
 
     def test_reverse_transform_integer_rounding(self):
         """Test the ``reverse_transform`` method correctly rounds.
 
         Expect the data to be rounded when the ``dtypes`` specifies
@@ -2108,14 +1965,76 @@
         # Run
         output = dp.reverse_transform(data)
 
         # Assert
         expected_data = pd.DataFrame({'bar': [0, 2, 2]})
         pd.testing.assert_frame_equal(output, expected_data, check_dtype=False)
 
+    @patch('sdv.data_processing.data_processor.LOGGER')
+    def test_reverse_transform_pii_numerical_column(self, mock_logger):
+        """Test the ``reverse_transform`` method doesn't break if PII value was set.
+
+        If a ``PII`` value was set to a ``numerical`` value from the dataframe, which will
+        result into ``self._dtypes`` to have it as ``numerical``, this should inform the
+        user that the value will not be set as numerical.
+        """
+        # Setup
+        data = pd.DataFrame({'bar': ['a', 'b', 'c']})
+        dp = DataProcessor(SingleTableMetadata())
+        dp.fitted = True
+        dp._hyper_transformer = Mock()
+        dp._hyper_transformer._output_columns = []
+        dp._hyper_transformer.reverse_transform_subset.return_value = data
+        dp._constraints_to_reverse = []
+        dp._dtypes = {'bar': 'int'}
+        dp.metadata = Mock()
+        dp.metadata.columns = {'bar': {'sdtype': 'address'}}
+        dp.formatters = {'bar': object()}
+
+        # Run
+        output = dp.reverse_transform(data)
+
+        # Assert
+        expected_data = pd.DataFrame({'bar': ['a', 'b', 'c']})
+        pd.testing.assert_frame_equal(output, expected_data)
+        message = (
+            "The real data in 'bar' was stored as 'int' but the synthetic data "
+            'could not be cast back to this type. If this is a problem, please check your input '
+            'data and metadata settings.'
+        )
+        mock_logger.info.assert_called_with(message)
+        assert dp.formatters == {}
+
+    @patch('sdv.data_processing.data_processor.LOGGER')
+    def test_reverse_transform_value_error_is_raised(self, mock_logger):
+        """Test the ``reverse_transform`` method raises a ``ValueError``.
+
+        If ``ValueError`` is raised while trying to set the data as type ``dtype``, if this is
+        not ``PII`` column, a value error should be raised.
+        """
+        # Setup
+        data = pd.DataFrame({'bar': ['a', 'b', 'c']})
+        dp = DataProcessor(SingleTableMetadata())
+        dp.fitted = True
+        dp._hyper_transformer = Mock()
+        dp._hyper_transformer._output_columns = []
+        dp._hyper_transformer.reverse_transform_subset.return_value = data
+        dp._constraints_to_reverse = []
+        dp._dtypes = {'bar': 'int'}
+        dp.metadata = Mock()
+        dp.metadata.columns = {'bar': {'sdtype': 'numerical'}}
+        dp.formatters = {'bar': object()}
+
+        # Run and Assert
+        error_msg = re.escape("invalid literal for int() with base 10: 'a'")
+        with pytest.raises(ValueError, match=error_msg):
+            dp.reverse_transform(data)
+
+        mock_logger.info.assert_not_called()
+
     @patch('sdv.data_processing.numerical_formatter.NumericalFormatter')
     @patch('sdv.data_processing.numerical_formatter.NumericalFormatter')
     def test_reverse_transform_numerical_formatter(self, formatter_mock1, formatter_mock2):
         """Test the ``reverse_transform`` correctly applies the ``NumericalFormatter``.
 
         Runs the method through three columns: a non-numerical column, which should
         be skipped by the method, and two numerical ones which should call the
```

### Comparing `sdv-1.1.0.dev0/tests/unit/data_processing/test_datetime_formatter.py` & `sdv-1.2.0.dev0/tests/unit/data_processing/test_datetime_formatter.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/tests/unit/data_processing/test_numerical_formatter.py` & `sdv-1.2.0.dev0/tests/unit/data_processing/test_numerical_formatter.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/tests/unit/data_processing/test_utils.py` & `sdv-1.2.0.dev0/tests/unit/data_processing/test_utils.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/tests/unit/datasets/test_demo.py` & `sdv-1.2.0.dev0/tests/unit/datasets/test_demo.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/tests/unit/datasets/test_local.py` & `sdv-1.2.0.dev0/tests/unit/datasets/test_local.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/tests/unit/evaluation/test_multi_table.py` & `sdv-1.2.0.dev0/tests/unit/evaluation/test_multi_table.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/tests/unit/evaluation/test_single_table.py` & `sdv-1.2.0.dev0/tests/unit/evaluation/test_single_table.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/tests/unit/lite/test_single_table.py` & `sdv-1.2.0.dev0/tests/unit/lite/test_single_table.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/tests/unit/metadata/test_anonymization.py` & `sdv-1.2.0.dev0/tests/unit/metadata/test_anonymization.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/tests/unit/metadata/test_metadata_upgrader.py` & `sdv-1.2.0.dev0/tests/unit/metadata/test_metadata_upgrader.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/tests/unit/metadata/test_multi_table.py` & `sdv-1.2.0.dev0/tests/unit/metadata/test_multi_table.py`

 * *Files 0% similar despite different names*

```diff
@@ -485,14 +485,43 @@
         instance._validate_missing_relationship_keys.assert_called_once_with(
             'users', 'id', 'sessions', 'user_id')
         mock_validate_relationship_key_length.assert_called_once_with(
             'users', 'id', 'sessions', 'user_id')
         instance._validate_relationship_sdtypes.assert_called_once_with(
             'users', 'id', 'sessions', 'user_id')
 
+    def test__get_foreign_keys(self):
+        """Test that this method returns the foreign keys for a given table name and child name."""
+        # Setup
+        metadata = self.get_metadata()
+
+        # Run
+        result = metadata._get_foreign_keys('users', 'sessions')
+
+        # Assert
+        assert result == ['user_id']
+
+    def test__get_all_foreign_keys(self):
+        """Test that this method returns the all the foreign keys for a table."""
+        # Setup
+        instance = self.get_metadata()
+        instance.add_column('transactions', 'user_id', sdtype='id')
+        instance.add_relationship(
+            parent_table_name='users',
+            parent_primary_key='id',
+            child_table_name='transactions',
+            child_foreign_key='user_id'
+        )
+
+        # Run
+        result = instance._get_all_foreign_keys('transactions')
+
+        # Assert
+        assert set(result) == {'user_id', 'session_id'}
+
     def test_add_relationship(self):
         """Test the ``add_relationship`` method of ``MultiTableMetadata``.
 
         Test that when passing a valid ``relationship`` this is being added to the
         ``instance.relationships``.
 
         Setup:
```

### Comparing `sdv-1.1.0.dev0/tests/unit/metadata/test_single_table.py` & `sdv-1.2.0.dev0/tests/unit/metadata/test_single_table.py`

 * *Files 1% similar despite different names*

```diff
@@ -312,20 +312,27 @@
         then an error should be raised.
         """
         # Setup
         instance = SingleTableMetadata()
 
         # Run and Assert
         error_msg = re.escape(
-            "Invalid sdtype : 'fake_type' is not recognized. Please use one of the "
+            "Invalid sdtype: 'fake_type' is not recognized. Please use one of the "
             'supported SDV sdtypes.'
         )
         with pytest.raises(InvalidMetadataError, match=error_msg):
             instance._validate_column('column', 'fake_type')
 
+        error_msg = re.escape(
+            'Invalid sdtype: None is not a string. Please use one of the '
+            'supported SDV sdtypes.'
+        )
+        with pytest.raises(InvalidMetadataError, match=error_msg):
+            instance._validate_column('column', None)
+
     @patch('sdv.metadata.single_table.SingleTableMetadata._validate_unexpected_kwargs')
     @patch('sdv.metadata.single_table.SingleTableMetadata._validate_numerical')
     def test__validate_column_numerical(self, mock__validate_numerical, mock__validate_kwargs):
         """Test ``_validate_column`` method.
 
         Test the ``_validate_column`` method when a ``numerical`` sdtype is passed.
 
@@ -584,15 +591,15 @@
         then an error should be raised.
         """
         # Setup
         instance = SingleTableMetadata()
 
         # Run and Assert
         error_msg = re.escape(
-            "Invalid sdtype : 'fake_type' is not recognized. Please use one of the "
+            "Invalid sdtype: 'fake_type' is not recognized. Please use one of the "
             'supported SDV sdtypes.'
         )
         with pytest.raises(InvalidMetadataError, match=error_msg):
             instance.add_column('column', sdtype='fake_type')
 
     def test_add_column(self):
         """Test ``add_column`` method.
```

### Comparing `sdv-1.1.0.dev0/tests/unit/multi_table/test_base.py` & `sdv-1.2.0.dev0/tests/unit/multi_table/test_base.py`

 * *Files 2% similar despite different names*

```diff
@@ -48,14 +48,58 @@
         instance._synthesizer.assert_has_calls([
             call(metadata=instance.metadata.tables['nesreca'], default_distribution='gamma',
                  locales=locales),
             call(metadata=instance.metadata.tables['oseba'], locales=locales),
             call(metadata=instance.metadata.tables['upravna_enota'], locales=locales)
         ])
 
+    def test__get_pbar_args(self):
+        """Test that ``_get_pbar_args`` returns a dictionary with disable opposite to verbose."""
+        # Setup
+        instance = Mock()
+        instance.verbose = False
+
+        # Run
+        result = BaseMultiTableSynthesizer._get_pbar_args(instance)
+
+        # Assert
+        assert result == {'disable': True}
+
+    def test__get_pbar_args_kwargs(self):
+        """Test that ``_get_pbar_args`` returns a dictionary with the given kwargs."""
+        # Setup
+        instance = Mock()
+        instance.verbose = True
+
+        # Run
+        result = BaseMultiTableSynthesizer._get_pbar_args(
+            instance,
+            desc='Process Table',
+            position=0
+        )
+
+        # Assert
+        assert result == {
+            'disable': False,
+            'desc': 'Process Table',
+            'position': 0
+        }
+
+    @patch('sdv.multi_table.base.print')
+    def test__print(self, mock_print):
+        """Test that print info will print a message if verbose is True."""
+        # Setup
+        instance = Mock(verbose=True)
+
+        # Run
+        BaseMultiTableSynthesizer._print(instance, text='Fitting', end='')
+
+        # Assert
+        mock_print.assert_called_once_with('Fitting', end='')
+
     def test___init__(self):
         """Test that when creating a new instance this sets the defaults.
 
         Test that the metadata object is being stored and also being validated. Afterwards, this
         calls the ``self._initialize_models`` which creates the initial instances of those.
         """
         # Setup
@@ -69,14 +113,28 @@
         assert instance.metadata == metadata
         assert isinstance(instance._table_synthesizers['nesreca'], GaussianCopulaSynthesizer)
         assert isinstance(instance._table_synthesizers['oseba'], GaussianCopulaSynthesizer)
         assert isinstance(instance._table_synthesizers['upravna_enota'], GaussianCopulaSynthesizer)
         assert instance._table_parameters == defaultdict(dict)
         instance.metadata.validate.assert_called_once_with()
 
+    def test___init___synthesizer_kwargs_deprecated(self):
+        """Test that the ``synthesizer_kwargs`` method is deprecated."""
+        # Setup
+        metadata = get_multi_table_metadata()
+        metadata.validate = Mock()
+
+        # Run and Assert
+        warn_message = (
+            'The `synthesizer_kwargs` parameter is deprecated as of SDV 1.2.0 and does not '
+            'affect the synthesizer. Please use the `set_table_parameters` method instead.'
+        )
+        with pytest.warns(FutureWarning, match=warn_message):
+            BaseMultiTableSynthesizer(metadata, synthesizer_kwargs={})
+
     def test_get_table_parameters_empty(self):
         """Test that this method returns an empty dictionary when there are no parameters."""
         # Setup
         metadata = get_multi_table_metadata()
         instance = BaseMultiTableSynthesizer(metadata)
 
         # Run
```

### Comparing `sdv-1.1.0.dev0/tests/unit/multi_table/test_hma.py` & `sdv-1.2.0.dev0/tests/unit/multi_table/test_hma.py`

 * *Files 3% similar despite different names*

```diff
@@ -42,15 +42,15 @@
         child_table = pd.DataFrame({
             'id_nesreca': [0, 1, 2, 3],
             'upravna_enota': [0, 1, 2, 3]
         })
         instance = HMASynthesizer(metadata)
 
         # Run
-        result = instance._get_extension('nesreca', child_table, 'upravna_enota')
+        result = instance._get_extension('nesreca', child_table, 'upravna_enota', '')
 
         # Assert
         expected = pd.DataFrame({
             '__nesreca__upravna_enota__univariates__id_nesreca__a': [1., 1., 1., 1.],
             '__nesreca__upravna_enota__univariates__id_nesreca__b': [1., 1., 1., 1.],
             '__nesreca__upravna_enota__univariates__id_nesreca__loc': [0., 1., 2., 3.],
             '__nesreca__upravna_enota__univariates__id_nesreca__scale': [np.nan] * 4,
@@ -62,32 +62,36 @@
     def test__get_extension_foreign_key_only(self):
         """Test the ``_get_extension`` method.
 
         Test when foreign key only is passed, just the ``num_rows`` is being captured.
         """
         # Setup
         instance = Mock()
+        instance._get_pbar_args.return_value = {'desc': "(1/2) Tables 'A' and 'B' ('user_id')"}
         instance._get_all_foreign_keys.return_value = ['id_upravna_enota']
         instance._table_synthesizers = {'nesreca': Mock()}
         child_table = pd.DataFrame({
             'id_upravna_enota': [0, 1, 2, 3]
         })
 
         # Run
         result = HMASynthesizer._get_extension(
             instance,
             'nesreca',
             child_table,
-            'id_upravna_enota'
+            'id_upravna_enota',
+            "(1/2) Tables 'A' and 'B' ('user_id')"
         )
 
         # Assert
         expected = pd.DataFrame({
             '__nesreca__id_upravna_enota__num_rows': [1, 1, 1, 1]
         })
+        instance._get_pbar_args.assert_called_once_with(
+            desc="(1/2) Tables 'A' and 'B' ('user_id')")
 
         pd.testing.assert_frame_equal(result, expected)
 
     def test__get_foreign_keys(self):
         """Test that this method returns the foreign keys for a given table name and child name."""
         # Setup
         metadata = get_multi_table_metadata()
@@ -122,14 +126,17 @@
         metadata.add_column('nesreca', 'value', sdtype='numerical')
         metadata.add_column('oseba', 'oseba_value', sdtype='numerical')
         metadata.add_column('upravna_enota', 'name', sdtype='categorical')
 
         data = get_multi_table_data()
         data['nesreca']['value'] = [0, 1, 2, 3]
         data['oseba']['oseba_value'] = [0, 1, 2, 3]
+        mock_get_pbar_args = Mock()
+        mock_get_pbar_args.return_value = {}
+        instance._get_pbar_args = mock_get_pbar_args
 
         # Run
         result = instance._augment_table(data['nesreca'], data, 'nesreca')
 
         # Assert
         expected_result = pd.DataFrame({
             'id_nesreca': [0, 1, 2, 3],
@@ -147,14 +154,17 @@
             '__oseba__id_nesreca__univariates__oseba_value__scale': [0.] * 4,
             '__oseba__id_nesreca__num_rows': [1.] * 4,
         })
 
         pd.testing.assert_frame_equal(expected_result, result)
         assert instance._augmented_tables == ['oseba', 'nesreca']
         assert instance._max_child_rows['__oseba__id_nesreca__num_rows'] == 1
+        mock_get_pbar_args.assert_called_once_with(
+            desc="(1/3) Tables 'nesreca' and 'oseba' ('id_nesreca')"
+        )
 
     def test__pop_foreign_keys(self):
         """Test that this method removes the foreign keys from the ``table_data``."""
         # Setup
         instance = Mock()
         instance._get_all_foreign_keys.return_value = ['a', 'b']
         table_data = pd.DataFrame({
@@ -192,49 +202,63 @@
     def test__model_tables(self):
         """Test that ``_model_tables`` performs the modeling.
 
         Modeling consists of getting the table for the given table name,
         learning the size of this table, removing the foreign keys and clearing
         any null values by using the ``_clear_nans`` method. Then, fitting the table model by
         calling ``fit_processed_data``,  adding back the foreign keys, updating the ``tables`` and
-        marking the table name as modeled within the ``instance._augmented_tables``.
+        marking the table name as modeled within the ``instance._augmented_tables``. This
+        task has to be performed only on the root tables, the childs are being skipped
+        since each row is being re-created from the parent.
         """
         # Setup
-        nesreca_model = Mock()
+        upravna_enota_model = Mock()
         instance = Mock()
         instance._synthesizer = GaussianCopulaSynthesizer
+        instance._get_pbar_args.return_value = {'desc': 'Modeling Tables'}
 
-        instance._augmented_tables = ['nesreca']
-        instance._table_sizes = {'nesreca': 3}
-        instance._table_synthesizers = {'nesreca': nesreca_model}
+        metadata = get_multi_table_metadata()
+        instance.metadata = metadata
+        instance._augmented_tables = ['upravna_enota']
+        instance._table_sizes = {'upravna_enota': 3}
+        instance._table_synthesizers = {'upravna_enota': upravna_enota_model}
         instance._pop_foreign_keys.return_value = {'fk': [1, 2, 3]}
         input_data = {
-            'nesreca': pd.DataFrame({
+            'upravna_enota': pd.DataFrame({
                 'id_nesreca': [0, 1, 2],
                 'upravna_enota': [0, 1, 2],
                 'extended': ['a', 'b', 'c']
+            }),
+            'oseba': pd.DataFrame({
+                'id_oseba': [0, 1, 2],
+                'note': [0, 1, 2],
             })
         }
         augmented_data = input_data.copy()
 
         # Run
         HMASynthesizer._model_tables(instance, augmented_data)
 
         # Assert
         expected_result = pd.DataFrame({
             'id_nesreca': [0, 1, 2],
             'upravna_enota': [0, 1, 2],
             'extended': ['a', 'b', 'c'],
             'fk': [1, 2, 3]
         })
-        pd.testing.assert_frame_equal(expected_result, augmented_data['nesreca'])
+        pd.testing.assert_frame_equal(expected_result, augmented_data['upravna_enota'])
 
-        instance._pop_foreign_keys.assert_called_once_with(input_data['nesreca'], 'nesreca')
-        instance._clear_nans.assert_called_once_with(input_data['nesreca'])
-        nesreca_model.fit_processed_data.assert_called_once_with(augmented_data['nesreca'])
+        instance._pop_foreign_keys.assert_called_once_with(
+            input_data['upravna_enota'],
+            'upravna_enota'
+        )
+        instance._clear_nans.assert_called_once_with(input_data['upravna_enota'])
+        upravna_enota_model.fit_processed_data.assert_called_once_with(
+            augmented_data['upravna_enota']
+        )
 
     def test__augment_tables(self):
         """Test that ``_fit`` calls ``_model_tables`` only if the table has no parents."""
         # Setup
         metadata = get_multi_table_metadata()
         instance = HMASynthesizer(metadata)
         instance._augment_table = Mock()
@@ -430,15 +454,15 @@
         # Setup
         instance = Mock()
         parent_row = 'row'
         table_name = 'users'
         foreign_key = 'session_id'
         table_meta = Mock()
         instance.metadata.tables = {'users': table_meta}
-        instance._synthesizer_kwargs = {'a': 1}
+        instance._table_parameters = {'users': {'a': 1}}
 
         # Run
         synthesizer = HMASynthesizer._get_child_synthesizer(
             instance,
             parent_row,
             table_name,
             foreign_key
```

### Comparing `sdv-1.1.0.dev0/tests/unit/sampling/test_tabular.py` & `sdv-1.2.0.dev0/tests/unit/sampling/test_tabular.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/tests/unit/sequential/test_par.py` & `sdv-1.2.0.dev0/tests/unit/sequential/test_par.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/tests/unit/single_table/test_base.py` & `sdv-1.2.0.dev0/tests/unit/single_table/test_base.py`

 * *Files 2% similar despite different names*

```diff
@@ -5,14 +5,15 @@
 import numpy as np
 import pandas as pd
 import pytest
 from copulas.multivariate import GaussianMultivariate
 from rdt.transformers import (
     BinaryEncoder, FloatFormatter, GaussianNormalizer, OneHotEncoder, RegexGenerator)
 
+from sdv.constraints.errors import AggregateConstraintsError
 from sdv.errors import ConstraintsNotMetError, SynthesizerInputError
 from sdv.metadata.single_table import SingleTableMetadata
 from sdv.sampling.tabular import Condition
 from sdv.single_table import (
     CopulaGANSynthesizer, CTGANSynthesizer, GaussianCopulaSynthesizer, TVAESynthesizer)
 from sdv.single_table.base import COND_IDX, BaseSingleTableSynthesizer
 from sdv.single_table.errors import InvalidDataError
@@ -661,14 +662,30 @@
         metadata.set_sequence_key(('sk_col1', 'sk_col2'))
         metadata.add_alternate_keys(['ak_col1', 'ak_col2'])
         instance = BaseSingleTableSynthesizer(metadata)
 
         # Run
         instance.validate(data)
 
+    def test__validate_constraints(self):
+        """Test that ``_validate_constraints`` calls ``fit`` and returns any errors."""
+        # Setup
+        instance = Mock()
+        msg = 'Invalid data for constraint.'
+        instance._data_processor._fit_constraints.side_effect = AggregateConstraintsError([msg])
+        data = object()
+
+        # Run
+        errors = BaseSingleTableSynthesizer._validate_constraints(instance, data)
+
+        # Assert
+        assert str(errors[0]) == '\nInvalid data for constraint.'
+        assert len(errors) == 1
+        instance._data_processor._fit_constraints.assert_called_once_with(data)
+
     def test_update_transformers_invalid_keys(self):
         """Test error is raised if passed transformer doesn't match key column.
 
         The transformers of a key column must be either AnonymizedFaker or RegexGenerator.
         Raise an error if any other transformer is passed.
         """
         # Setup
@@ -885,15 +902,18 @@
         """
         # Setup
         data = pd.DataFrame({
             'name': ['John', 'Doe', 'John Doe']
         })
         instance = Mock()
         instance._random_state_set = False
+        instance._sample.return_value = pd.DataFrame()
+        instance._data_processor.reverse_transform.return_value = data
         instance._data_processor.filter_valid.return_value = data
+        instance._data_processor._hyper_transformer._input_columns = []
 
         # Run
         sampled, num_valid = BaseSingleTableSynthesizer._sample_rows(instance, 3)
 
         # Assert
         assert num_valid == 3
         pd.testing.assert_frame_equal(sampled, data)
@@ -910,14 +930,17 @@
         """Test that sample rows calls with the transformed conditions the ``_sample``."""
         # Setup
         data = pd.DataFrame({
             'name': ['John', 'Doe', 'John Doe'],
             'salary': [90.0, 100.0, 80.0]
         })
         instance = Mock()
+        instance._sample.return_value = pd.DataFrame()
+        instance._data_processor.reverse_transform.return_value = data
+        instance._data_processor._hyper_transformer._input_columns = []
         instance._filter_conditions.return_value = data[data.name == 'John Doe']
         conditions = {'salary': 80.}
         transformed_conditions = {'salary': 80.0}
 
         # Run
         sampled, num_valid = BaseSingleTableSynthesizer._sample_rows(
             instance,
@@ -946,14 +969,16 @@
         })
         data = pd.DataFrame({
             'name': ['John', 'Doe', 'John Doe'],
             'salary': [90.0, 100.0, 80.0]
         })
 
         instance = Mock()
+        instance._sample.return_value = pd.DataFrame()
+        instance._data_processor._hyper_transformer._input_columns = []
         instance._data_processor.filter_valid = lambda x: x
         instance._data_processor.reverse_transform.return_value = data
 
         # Run
         sampled, num_valid = BaseSingleTableSynthesizer._sample_rows(
             instance, 3, previous_rows=previous_rows)
 
@@ -973,18 +998,20 @@
         """Test when the model does not support conditional sampling and raises an error."""
         # Setup
         data = pd.DataFrame({
             'name': ['John', 'Doe', 'John Doe'],
             'salary': [90.0, 100.0, 80.0]
         })
         instance = Mock()
+        instance._data_processor.reverse_transform.return_value = data
+        instance._data_processor._hyper_transformer._input_columns = []
         instance._filter_conditions.return_value = data[data.name == 'John Doe']
         conditions = {'salary': 80.}
         transformed_conditions = {'salary': 80.0}
-        instance._sample.side_effect = [NotImplementedError, None]
+        instance._sample.side_effect = [NotImplementedError, pd.DataFrame()]
 
         # Run
         sampled, num_valid = BaseSingleTableSynthesizer._sample_rows(
             instance,
             3,
             conditions=conditions,
             transformed_conditions=transformed_conditions
@@ -1018,14 +1045,15 @@
         """Test the ``_sample_batch`` without storing the samples in a file."""
         # Setup
         sampled_data = pd.DataFrame({
             'name': ['John', 'Doe', 'John Doe'],
             'salary': [80., 60., 100.]
         })
         instance = Mock()
+        instance.metadata.columns.keys.return_value = ['name', 'salary']
         instance._sample_rows.return_value = (sampled_data, 3)
 
         # Run
         result = BaseSingleTableSynthesizer._sample_batch(
             instance,
             batch_size=3,
             max_tries=100,
@@ -1034,33 +1062,36 @@
             float_rtol=0.01,
             progress_bar=None,
             output_file_path=None,
         )
 
         # Assert
         pd.testing.assert_frame_equal(result, sampled_data)
-        rows, conditions, trans_cond, float_rtol, sampled = instance._sample_rows.call_args[0]
+        _sample_rows_args = instance._sample_rows.call_args[0]
+        rows, conditions, trans_cond, float_rtol, sampled, keep_extra_columns = _sample_rows_args
         assert rows == 3
         assert conditions is None
         assert trans_cond is None
         assert float_rtol == 0.01
         pd.testing.assert_frame_equal(sampled, pd.DataFrame())
+        assert keep_extra_columns is False
 
     def test__sample_batch_with_sampled_data_bigger_than_batch_size(self):
         """Test ``sampled_data`` is bigger than the batch size.
 
         If the sampled data is bigger than the batch size, the returned data frame must be the
         ``batch_size`` size.
         """
         # Setup
         sampled_data = pd.DataFrame({
             'name': ['John', 'Doe', 'John Doe', 'John Doe John'],
             'salary': [80., 60., 100., 300.]
         })
         instance = Mock()
+        instance.metadata.columns.keys.return_value = ['name', 'salary']
         instance._sample_rows.return_value = (sampled_data, 3)
 
         # Run
         result = BaseSingleTableSynthesizer._sample_batch(
             instance,
             batch_size=3,
             max_tries=100,
@@ -1069,29 +1100,32 @@
             float_rtol=0.01,
             progress_bar=None,
             output_file_path=None,
         )
 
         # Assert
         pd.testing.assert_frame_equal(result, sampled_data.head(3))
-        rows, conditions, trans_cond, float_rtol, sampled = instance._sample_rows.call_args[0]
+        _sample_rows_args = instance._sample_rows.call_args[0]
+        rows, conditions, trans_cond, float_rtol, sampled, keep_extra_columns = _sample_rows_args
         assert rows == 3
         assert conditions is None
         assert trans_cond is None
         assert float_rtol == 0.01
         pd.testing.assert_frame_equal(sampled, pd.DataFrame())
+        assert keep_extra_columns is False
 
     def test__sample_batch_max_tries_reached(self):
         """Test that when ``max_tries`` is reached, a break occurs."""
         # Setup
         sampled_data = pd.DataFrame({
             'name': ['John', 'Doe', 'John Doe', 'John Doe John'],
             'salary': [80., 60., 100., 300.]
         })
         instance = Mock()
+        instance.metadata.columns.keys.return_value = ['name', 'salary']
         instance._sample_rows.return_value = (sampled_data, 3)
 
         # Run
         result = BaseSingleTableSynthesizer._sample_batch(
             instance,
             batch_size=10,
             max_tries=2,
@@ -1100,28 +1134,30 @@
             float_rtol=0.01,
             progress_bar=None,
             output_file_path=None,
         )
 
         # Assert
         pd.testing.assert_frame_equal(result, sampled_data)
-        rows, conditions, trans_cond, float_rtol, sampled = instance._sample_rows.call_args[0]
+        _sample_rows_args = instance._sample_rows.call_args[0]
+        rows, conditions, trans_cond, float_rtol, sampled, keep_extra_columns = _sample_rows_args
         assert instance._sample_rows.call_count == 2
 
     def test__sample_batch_storing_output_file(self, tmpdir):
         """Test that an output file is properly stored while sampling.
 
         Test that an output file is properly stored as well as that the progress bar is updated.
         """
         # Setup
         sampled_data = pd.DataFrame({
             'name': ['John', 'Doe', 'John Doe', 'John Doe John'],
             'salary': [80., 60., 100., 300.]
         })
         instance = Mock()
+        instance.metadata.columns.keys.return_value = ['name', 'salary']
         instance._sample_rows.side_effect = [
             (sampled_data, 4),
             (sampled_data, 5),
             (sampled_data, 10),
         ]
         mock_progress_bar = Mock()
 
@@ -1677,16 +1713,16 @@
         }
 
     @patch('sdv.single_table.base.os')
     @patch('sdv.single_table.base.check_num_rows')
     @patch('sdv.single_table.base.DataProcessor')
     @patch('sdv.single_table.base.tqdm')
     @patch('sdv.single_table.base.validate_file_path')
-    def test__sample_from_conditions(self, mock_validate_file_path, mock_tqdm,
-                                     mock_data_processor, mock_check_num_rows, mock_os):
+    def test_sample_from_conditions(self, mock_validate_file_path, mock_tqdm,
+                                    mock_data_processor, mock_check_num_rows, mock_os):
         """Test sample conditions with sampled data and reject sampling.
 
         An instance of ``BaseSingleTableSynthesizer`` is created and it's utility functions are
         being mocked to reach the point of calling ```_sample_with_conditions``. After the
         sampling is done, when the ``temp_file`` is the ``.sample.csv.temp``, this is being
         removed.
         """
@@ -1701,40 +1737,40 @@
         instance._model = GaussianMultivariate()
         instance._sample_with_conditions.return_value = pd.DataFrame({'name': ['John Doe']})
 
         progress_bar = MagicMock()
         mock_tqdm.tqdm.return_value = progress_bar
 
         # Run
-        result = instance._sample_from_conditions(conditions, 10, 10, '.sample.csv.temp')
+        result = instance.sample_from_conditions(conditions, 10, 10, '.sample.csv.temp')
 
         # Assert
         pd.testing.assert_frame_equal(result, pd.DataFrame({'name': ['John Doe']}))
         mock_os.remove.assert_called_once_with('.sample.csv.temp')
         mock_os.path.exists.assert_called_once_with('.sample.csv.temp')
 
     @patch('sdv.single_table.base.handle_sampling_error')
     @patch('sdv.single_table.base.tqdm')
     @patch('sdv.single_table.base.validate_file_path')
-    def test__sample_from_conditions_handle_sampling_error(self,
-                                                           mock_validate_file_path,
-                                                           mock_tqdm, mock_handle_sampling_error):
-        """Test the error handling when we are using ``_sample_from_conditions``."""
+    def test_sample_from_conditions_handle_sampling_error(self,
+                                                          mock_validate_file_path,
+                                                          mock_tqdm, mock_handle_sampling_error):
+        """Test the error handling when we are using ``sample_from_conditions``."""
         # Setup
         progress_bar = MagicMock()
         mock_tqdm.tqdm.return_value = progress_bar
         instance = Mock()
         instance._make_condition_dfs.side_effect = lambda x: x
         conditions = [Condition({'name': 'John Doe'})]
         keyboard_error = KeyboardInterrupt()
         instance._sample_with_conditions.side_effect = [keyboard_error]
         mock_validate_file_path.return_value = 'temp_file'
 
         # Run
-        result = BaseSingleTableSynthesizer._sample_from_conditions(
+        result = BaseSingleTableSynthesizer.sample_from_conditions(
             instance,
             conditions,
             10,
             10,
             '.sample.csv.temp'
         )
 
@@ -1743,38 +1779,21 @@
         pd.testing.assert_frame_equal(result, expected_result)
         mock_tqdm.tqdm.assert_called_once_with(total=1)
         progress_bar.__enter__.return_value.set_description.assert_called_once_with(
             'Sampling conditions'
         )
         mock_handle_sampling_error.assert_called_once_with(False, 'temp_file', keyboard_error)
 
-    def test_sample_from_conditions(self):
-        """Test that this method calls ``_sample_with_conditions``."""
-        # Setup
-        instance = Mock()
-
-        # Run
-        result = BaseSingleTableSynthesizer.sample_from_conditions(instance, ['conditions'])
-
-        # Assert
-        assert result == instance._sample_from_conditions.return_value
-        instance._sample_from_conditions.assert_called_once_with(
-            ['conditions'],
-            100,
-            None,
-            None
-        )
-
     @patch('sdv.single_table.base.os')
     @patch('sdv.single_table.base.check_num_rows')
     @patch('sdv.single_table.base.DataProcessor')
     @patch('sdv.single_table.base.tqdm')
     @patch('sdv.single_table.base.validate_file_path')
-    def test__sample_remaining_columns(self, mock_validate_file_path, mock_tqdm,
-                                       mock_data_processor, mock_check_num_rows, mock_os):
+    def test_sample_remaining_columns(self, mock_validate_file_path, mock_tqdm,
+                                      mock_data_processor, mock_check_num_rows, mock_os):
         """Test the this method calls ``_sample_with_conditions`` with the ``known_column."""
         # Setup
         metadata = Mock()
         instance = BaseSingleTableSynthesizer(metadata)
         known_columns = pd.DataFrame({'name': ['Johanna Doe']})
 
         instance._validate_conditions = Mock()
@@ -1783,15 +1802,15 @@
         instance._sample_with_conditions.return_value = pd.DataFrame({'name': ['John Doe']})
         mock_validate_file_path.return_value = '.sample.csv.temp'
 
         progress_bar = MagicMock()
         mock_tqdm.tqdm.return_value = progress_bar
 
         # Run
-        result = instance._sample_remaining_columns(
+        result = instance.sample_remaining_columns(
             known_columns,
             10,
             10,
             '.sample.csv.temp'
         )
 
         # Assert
@@ -1800,15 +1819,15 @@
         mock_os.path.exists.assert_called_once_with('.sample.csv.temp')
 
     @patch('sdv.single_table.base.handle_sampling_error')
     @patch('sdv.single_table.base.check_num_rows')
     @patch('sdv.single_table.base.DataProcessor')
     @patch('sdv.single_table.base.tqdm')
     @patch('sdv.single_table.base.validate_file_path')
-    def test__sample_remaining_columns_handles_sampling_error(
+    def test_sample_remaining_columns_handles_sampling_error(
         self, mock_validate_file_path, mock_tqdm, mock_data_processor,
         mock_check_num_rows, mock_handle_sampling_error
     ):
         """Test when sample remaining is being interrupted.
 
         This should properly handle the errors with the ``handle_sampling_error`` function.
         """
@@ -1824,40 +1843,25 @@
         instance._sample_with_conditions.side_effect = [keyboard_error]
         mock_validate_file_path.return_value = 'temp_file'
 
         progress_bar = MagicMock()
         mock_tqdm.tqdm.return_value = progress_bar
 
         # Run
-        result = instance._sample_remaining_columns(
+        result = instance.sample_remaining_columns(
             known_columns,
             10,
             10,
             'temp_file'
         )
 
         # Assert
         pd.testing.assert_frame_equal(result, pd.DataFrame())
         mock_handle_sampling_error.assert_called_once_with(False, 'temp_file', keyboard_error)
 
-    def test_sample_remaining_columns(self):
-        """Test that this method calls the ``_sample_remaining_columns``."""
-        # Setup
-        instance = Mock()
-        known_columns = pd.DataFrame({'name': ['Johanna']})
-        instance._validate_conditions = Mock()
-        instance._sample_with_conditions = Mock()
-
-        # Run
-        result = BaseSingleTableSynthesizer.sample_remaining_columns(instance, known_columns)
-
-        # Assert
-        assert result == instance._sample_remaining_columns.return_value
-        instance._sample_remaining_columns.assert_called_once()
-
     @patch('sdv.single_table.base.cloudpickle')
     def test_save(self, cloudpickle_mock):
         """Test that the synthesizer is saved correctly."""
         # Setup
         synthesizer = Mock()
 
         # Run
```

### Comparing `sdv-1.1.0.dev0/tests/unit/single_table/test_copulagan.py` & `sdv-1.2.0.dev0/tests/unit/single_table/test_copulagan.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/tests/unit/single_table/test_copulas.py` & `sdv-1.2.0.dev0/tests/unit/single_table/test_copulas.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/tests/unit/single_table/test_ctgan.py` & `sdv-1.2.0.dev0/tests/unit/single_table/test_ctgan.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/tests/unit/single_table/test_utils.py` & `sdv-1.2.0.dev0/tests/unit/single_table/test_utils.py`

 * *Files identical despite different names*

### Comparing `sdv-1.1.0.dev0/tests/utils.py` & `sdv-1.2.0.dev0/tests/utils.py`

 * *Files identical despite different names*

