# Comparing `tmp/redshift_connector-2.0.910-py3-none-any.whl.zip` & `tmp/redshift_connector-2.0.911-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,47 +1,47 @@
-Zip file size: 112147 bytes, number of entries: 45
--rw-r--r--  2.0 unx    17871 b- defN 23-Jan-25 18:07 redshift_connector/__init__.py
--rw-r--r--  2.0 unx     5444 b- defN 23-Jan-25 18:07 redshift_connector/config.py
--rw-r--r--  2.0 unx    93789 b- defN 23-Jan-25 18:07 redshift_connector/core.py
--rw-r--r--  2.0 unx     8205 b- defN 23-Jan-25 18:07 redshift_connector/credentials_holder.py
--rw-r--r--  2.0 unx    98343 b- defN 23-Jan-25 18:07 redshift_connector/cursor.py
--rw-r--r--  2.0 unx     3994 b- defN 23-Jan-25 18:07 redshift_connector/error.py
--rw-r--r--  2.0 unx    16994 b- defN 23-Jan-25 18:07 redshift_connector/iam_helper.py
--rw-r--r--  2.0 unx    11042 b- defN 23-Jan-25 18:07 redshift_connector/idp_auth_helper.py
--rw-r--r--  2.0 unx     3566 b- defN 23-Jan-25 18:07 redshift_connector/interval.py
--rw-r--r--  2.0 unx     3390 b- defN 23-Jan-25 18:07 redshift_connector/native_plugin_helper.py
--rw-r--r--  2.0 unx     2363 b- defN 23-Jan-25 18:07 redshift_connector/objects.py
--rw-r--r--  2.0 unx      762 b- defN 23-Jan-25 18:07 redshift_connector/pg_types.py
--rw-r--r--  2.0 unx    10092 b- defN 23-Jan-25 18:07 redshift_connector/redshift_property.py
--rw-r--r--  2.0 unx      214 b- defN 23-Jan-25 18:07 redshift_connector/version.py
--rw-r--r--  2.0 unx       61 b- defN 23-Jan-25 18:07 redshift_connector/auth/__init__.py
--rw-r--r--  2.0 unx     4349 b- defN 23-Jan-25 18:07 redshift_connector/auth/aws_credentials_provider.py
--rw-r--r--  2.0 unx     9870 b- defN 23-Jan-25 18:07 redshift_connector/files/redshift-ca-bundle.crt
--rw-r--r--  2.0 unx      741 b- defN 23-Jan-25 18:07 redshift_connector/plugin/__init__.py
--rw-r--r--  2.0 unx     5577 b- defN 23-Jan-25 18:07 redshift_connector/plugin/adfs_credentials_provider.py
--rw-r--r--  2.0 unx     7154 b- defN 23-Jan-25 18:07 redshift_connector/plugin/azure_credentials_provider.py
--rw-r--r--  2.0 unx    10640 b- defN 23-Jan-25 18:07 redshift_connector/plugin/browser_azure_credentials_provider.py
--rw-r--r--  2.0 unx    11479 b- defN 23-Jan-25 18:07 redshift_connector/plugin/browser_azure_oauth2_credentials_provider.py
--rw-r--r--  2.0 unx     4947 b- defN 23-Jan-25 18:07 redshift_connector/plugin/browser_saml_credentials_provider.py
--rw-r--r--  2.0 unx      432 b- defN 23-Jan-25 18:07 redshift_connector/plugin/credential_provider_constants.py
--rw-r--r--  2.0 unx      432 b- defN 23-Jan-25 18:07 redshift_connector/plugin/i_native_plugin.py
--rw-r--r--  2.0 unx     1493 b- defN 23-Jan-25 18:07 redshift_connector/plugin/i_plugin.py
--rw-r--r--  2.0 unx     1542 b- defN 23-Jan-25 18:07 redshift_connector/plugin/idp_credentials_provider.py
--rw-r--r--  2.0 unx     4806 b- defN 23-Jan-25 18:07 redshift_connector/plugin/jwt_credentials_provider.py
--rw-r--r--  2.0 unx      758 b- defN 23-Jan-25 18:07 redshift_connector/plugin/native_token_holder.py
--rw-r--r--  2.0 unx     6280 b- defN 23-Jan-25 18:07 redshift_connector/plugin/okta_credentials_provider.py
--rw-r--r--  2.0 unx     6656 b- defN 23-Jan-25 18:07 redshift_connector/plugin/ping_credentials_provider.py
--rw-r--r--  2.0 unx    11128 b- defN 23-Jan-25 18:07 redshift_connector/plugin/saml_credentials_provider.py
--rw-r--r--  2.0 unx      892 b- defN 23-Jan-25 18:07 redshift_connector/utils/__init__.py
--rw-r--r--  2.0 unx     1913 b- defN 23-Jan-25 18:07 redshift_connector/utils/array_util.py
--rw-r--r--  2.0 unx     1442 b- defN 23-Jan-25 18:07 redshift_connector/utils/driver_info.py
--rw-r--r--  2.0 unx     1616 b- defN 23-Jan-25 18:07 redshift_connector/utils/extensible_digest.py
--rw-r--r--  2.0 unx     1087 b- defN 23-Jan-25 18:07 redshift_connector/utils/logging_utils.py
--rw-r--r--  2.0 unx     1675 b- defN 23-Jan-25 18:07 redshift_connector/utils/oids.py
--rw-r--r--  2.0 unx    24077 b- defN 23-Jan-25 18:07 redshift_connector/utils/type_utils.py
--rw-r--r--  2.0 unx    10142 b- defN 23-Jan-25 18:08 redshift_connector-2.0.910.dist-info/LICENSE
--rw-r--r--  2.0 unx    61356 b- defN 23-Jan-25 18:08 redshift_connector-2.0.910.dist-info/METADATA
--rw-r--r--  2.0 unx       67 b- defN 23-Jan-25 18:08 redshift_connector-2.0.910.dist-info/NOTICE
--rw-r--r--  2.0 unx       93 b- defN 23-Jan-25 18:08 redshift_connector-2.0.910.dist-info/WHEEL
--rw-r--r--  2.0 unx       19 b- defN 23-Jan-25 18:08 redshift_connector-2.0.910.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     4420 b- defN 23-Jan-25 18:08 redshift_connector-2.0.910.dist-info/RECORD
-45 files, 473213 bytes uncompressed, 104881 bytes compressed:  77.8%
+Zip file size: 112616 bytes, number of entries: 45
+-rw-r--r--  2.0 unx    17905 b- defN 23-Jun-05 16:20 redshift_connector/__init__.py
+-rw-r--r--  2.0 unx     5716 b- defN 23-Jun-05 16:20 redshift_connector/config.py
+-rw-r--r--  2.0 unx    95283 b- defN 23-Jun-05 16:20 redshift_connector/core.py
+-rw-r--r--  2.0 unx     8205 b- defN 23-Jun-05 16:20 redshift_connector/credentials_holder.py
+-rw-r--r--  2.0 unx    99031 b- defN 23-Jun-05 16:20 redshift_connector/cursor.py
+-rw-r--r--  2.0 unx     3994 b- defN 23-Jun-05 16:20 redshift_connector/error.py
+-rw-r--r--  2.0 unx    16994 b- defN 23-Jun-05 16:20 redshift_connector/iam_helper.py
+-rw-r--r--  2.0 unx    11042 b- defN 23-Jun-05 16:20 redshift_connector/idp_auth_helper.py
+-rw-r--r--  2.0 unx     3566 b- defN 23-Jun-05 16:20 redshift_connector/interval.py
+-rw-r--r--  2.0 unx     3390 b- defN 23-Jun-05 16:20 redshift_connector/native_plugin_helper.py
+-rw-r--r--  2.0 unx     2363 b- defN 23-Jun-05 16:20 redshift_connector/objects.py
+-rw-r--r--  2.0 unx      762 b- defN 23-Jun-05 16:20 redshift_connector/pg_types.py
+-rw-r--r--  2.0 unx    10092 b- defN 23-Jun-05 16:20 redshift_connector/redshift_property.py
+-rw-r--r--  2.0 unx      214 b- defN 23-Jun-05 16:20 redshift_connector/version.py
+-rw-r--r--  2.0 unx       61 b- defN 23-Jun-05 16:20 redshift_connector/auth/__init__.py
+-rw-r--r--  2.0 unx     4349 b- defN 23-Jun-05 16:20 redshift_connector/auth/aws_credentials_provider.py
+-rw-r--r--  2.0 unx     9870 b- defN 23-Jun-05 16:20 redshift_connector/files/redshift-ca-bundle.crt
+-rw-r--r--  2.0 unx      741 b- defN 23-Jun-05 16:20 redshift_connector/plugin/__init__.py
+-rw-r--r--  2.0 unx     5577 b- defN 23-Jun-05 16:20 redshift_connector/plugin/adfs_credentials_provider.py
+-rw-r--r--  2.0 unx     7154 b- defN 23-Jun-05 16:20 redshift_connector/plugin/azure_credentials_provider.py
+-rw-r--r--  2.0 unx    10640 b- defN 23-Jun-05 16:20 redshift_connector/plugin/browser_azure_credentials_provider.py
+-rw-r--r--  2.0 unx    11479 b- defN 23-Jun-05 16:20 redshift_connector/plugin/browser_azure_oauth2_credentials_provider.py
+-rw-r--r--  2.0 unx     4947 b- defN 23-Jun-05 16:20 redshift_connector/plugin/browser_saml_credentials_provider.py
+-rw-r--r--  2.0 unx      432 b- defN 23-Jun-05 16:20 redshift_connector/plugin/credential_provider_constants.py
+-rw-r--r--  2.0 unx      432 b- defN 23-Jun-05 16:20 redshift_connector/plugin/i_native_plugin.py
+-rw-r--r--  2.0 unx     1493 b- defN 23-Jun-05 16:20 redshift_connector/plugin/i_plugin.py
+-rw-r--r--  2.0 unx     1542 b- defN 23-Jun-05 16:20 redshift_connector/plugin/idp_credentials_provider.py
+-rw-r--r--  2.0 unx     4806 b- defN 23-Jun-05 16:20 redshift_connector/plugin/jwt_credentials_provider.py
+-rw-r--r--  2.0 unx      758 b- defN 23-Jun-05 16:20 redshift_connector/plugin/native_token_holder.py
+-rw-r--r--  2.0 unx     6280 b- defN 23-Jun-05 16:20 redshift_connector/plugin/okta_credentials_provider.py
+-rw-r--r--  2.0 unx     6656 b- defN 23-Jun-05 16:20 redshift_connector/plugin/ping_credentials_provider.py
+-rw-r--r--  2.0 unx    11128 b- defN 23-Jun-05 16:20 redshift_connector/plugin/saml_credentials_provider.py
+-rw-r--r--  2.0 unx      892 b- defN 23-Jun-05 16:20 redshift_connector/utils/__init__.py
+-rw-r--r--  2.0 unx     1913 b- defN 23-Jun-05 16:20 redshift_connector/utils/array_util.py
+-rw-r--r--  2.0 unx     1442 b- defN 23-Jun-05 16:20 redshift_connector/utils/driver_info.py
+-rw-r--r--  2.0 unx     1616 b- defN 23-Jun-05 16:20 redshift_connector/utils/extensible_digest.py
+-rw-r--r--  2.0 unx     1087 b- defN 23-Jun-05 16:20 redshift_connector/utils/logging_utils.py
+-rw-r--r--  2.0 unx     1675 b- defN 23-Jun-05 16:20 redshift_connector/utils/oids.py
+-rw-r--r--  2.0 unx    24077 b- defN 23-Jun-05 16:20 redshift_connector/utils/type_utils.py
+-rw-r--r--  2.0 unx    10142 b- defN 23-Jun-05 16:21 redshift_connector-2.0.911.dist-info/LICENSE
+-rw-r--r--  2.0 unx    61356 b- defN 23-Jun-05 16:21 redshift_connector-2.0.911.dist-info/METADATA
+-rw-r--r--  2.0 unx       67 b- defN 23-Jun-05 16:21 redshift_connector-2.0.911.dist-info/NOTICE
+-rw-r--r--  2.0 unx       93 b- defN 23-Jun-05 16:21 redshift_connector-2.0.911.dist-info/WHEEL
+-rw-r--r--  2.0 unx       19 b- defN 23-Jun-05 16:21 redshift_connector-2.0.911.dist-info/top_level.txt
+?rw-rw-r--  2.0 unx     4420 b- defN 23-Jun-05 16:21 redshift_connector-2.0.911.dist-info/RECORD
+45 files, 475701 bytes uncompressed, 105350 bytes compressed:  77.9%
```

## zipnote {}

```diff
@@ -111,26 +111,26 @@
 
 Filename: redshift_connector/utils/oids.py
 Comment: 
 
 Filename: redshift_connector/utils/type_utils.py
 Comment: 
 
-Filename: redshift_connector-2.0.910.dist-info/LICENSE
+Filename: redshift_connector-2.0.911.dist-info/LICENSE
 Comment: 
 
-Filename: redshift_connector-2.0.910.dist-info/METADATA
+Filename: redshift_connector-2.0.911.dist-info/METADATA
 Comment: 
 
-Filename: redshift_connector-2.0.910.dist-info/NOTICE
+Filename: redshift_connector-2.0.911.dist-info/NOTICE
 Comment: 
 
-Filename: redshift_connector-2.0.910.dist-info/WHEEL
+Filename: redshift_connector-2.0.911.dist-info/WHEEL
 Comment: 
 
-Filename: redshift_connector-2.0.910.dist-info/top_level.txt
+Filename: redshift_connector-2.0.911.dist-info/top_level.txt
 Comment: 
 
-Filename: redshift_connector-2.0.910.dist-info/RECORD
+Filename: redshift_connector-2.0.911.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## redshift_connector/__init__.py

```diff
@@ -1,12 +1,16 @@
 import logging
 import typing
 
 from redshift_connector import plugin
-from redshift_connector.config import DEFAULT_PROTOCOL_VERSION, ClientProtocolVersion
+from redshift_connector.config import (
+    DEFAULT_PROTOCOL_VERSION,
+    ClientProtocolVersion,
+    DbApiParamstyle,
+)
 from redshift_connector.core import BINARY, Connection, Cursor
 from redshift_connector.error import (
     ArrayContentNotHomogenousError,
     ArrayContentNotSupportedError,
     ArrayDimensionsNotConsistentError,
     DatabaseError,
     DataError,
```

## redshift_connector/config.py

```diff
@@ -1,13 +1,13 @@
 # from utils import pack_funcs
 import typing
 from calendar import timegm
 from datetime import datetime as Datetime
 from datetime import timezone as Timezone
-from enum import IntEnum
+from enum import Enum, IntEnum
 
 FC_TEXT: int = 0
 FC_BINARY: int = 1
 _client_encoding: str = "utf8"
 
 
 class ClientProtocolVersion(IntEnum):
@@ -25,14 +25,27 @@
             return ClientProtocolVersion(i).name
         except ValueError:
             return str(i)
 
 
 DEFAULT_PROTOCOL_VERSION: int = ClientProtocolVersion.BINARY.value
 
+
+class DbApiParamstyle(Enum):
+    QMARK = "qmark"
+    NUMERIC = "numeric"
+    NAMED = "named"
+    FORMAT = "format"
+    PYFORMAT = "pyformat"
+
+    @classmethod
+    def list(cls) -> typing.List[int]:
+        return list(map(lambda p: p.value, cls))  # type: ignore
+
+
 min_int2: int = -(2 ** 15)
 max_int2: int = 2 ** 15
 min_int4: int = -(2 ** 31)
 max_int4: int = 2 ** 31
 min_int8: int = -(2 ** 63)
 max_int8: int = 2 ** 63
 EPOCH: Datetime = Datetime(2000, 1, 1)
```

## redshift_connector/core.py

```diff
@@ -16,14 +16,15 @@
 
 from packaging import version
 from scramp import ScramClient  # type: ignore
 
 from redshift_connector.config import (
     DEFAULT_PROTOCOL_VERSION,
     ClientProtocolVersion,
+    DbApiParamstyle,
     _client_encoding,
     max_int2,
     max_int4,
     max_int8,
     min_int2,
     min_int4,
     min_int8,
@@ -141,14 +142,15 @@
     # state-based scanner.  We'll use int variables for the state.
     OUTSIDE: int = 0  # outside quoted string
     INSIDE_SQ: int = 1  # inside single-quote string '...'
     INSIDE_QI: int = 2  # inside quoted identifier   "..."
     INSIDE_ES: int = 3  # inside escaped single-quote string, E'...'
     INSIDE_PN: int = 4  # inside parameter name eg. :name
     INSIDE_CO: int = 5  # inside inline comment eg. --
+    INSIDE_MC: int = 6  # inside multiline comment eg. /*
 
     in_quote_escape: bool = False
     in_param_escape: bool = False
     placeholders: typing.List[str] = []
     output_query: typing.List[str] = []
     param_idx: typing.Iterator[str] = map(lambda x: "$" + str(x), count(1))
     state: int = OUTSIDE
@@ -169,31 +171,35 @@
             elif c == '"':
                 output_query.append(c)
                 state = INSIDE_QI
             elif c == "-":
                 output_query.append(c)
                 if prev_c == "-":
                     state = INSIDE_CO
-            elif style == "qmark" and c == "?":
+            elif c == "*":
+                output_query.append(c)
+                if prev_c == "/":
+                    state = INSIDE_MC
+            elif style == DbApiParamstyle.QMARK.value and c == "?":
                 output_query.append(next(param_idx))
-            elif style == "numeric" and c == ":" and next_c not in ":=" and prev_c != ":":
+            elif style == DbApiParamstyle.NUMERIC.value and c == ":" and next_c not in ":=" and prev_c != ":":
                 # Treat : as beginning of parameter name if and only
                 # if it's the only : around
                 # Needed to properly process type conversions
                 # i.e. sum(x)::float
                 output_query.append("$")
-            elif style == "named" and c == ":" and next_c not in ":=" and prev_c != ":":
+            elif style == DbApiParamstyle.NAMED.value and c == ":" and next_c not in ":=" and prev_c != ":":
                 # Same logic for : as in numeric parameters
                 state = INSIDE_PN
                 placeholders.append("")
-            elif style == "pyformat" and c == "%" and next_c == "(":
+            elif style == DbApiParamstyle.PYFORMAT.value and c == "%" and next_c == "(":
                 state = INSIDE_PN
                 placeholders.append("")
-            elif style in ("format", "pyformat") and c == "%":
-                style = "format"
+            elif style in (DbApiParamstyle.FORMAT.value, DbApiParamstyle.PYFORMAT.value) and c == "%":
+                style = DbApiParamstyle.FORMAT.value
                 if in_param_escape:
                     in_param_escape = False
                     output_query.append(c)
                 else:
                     if next_c == "%":
                         in_param_escape = True
                     elif next_c == "s":
@@ -223,48 +229,53 @@
         elif state == INSIDE_ES:
             if c == "'" and prev_c != "\\":
                 # check for escaped single-quote
                 state = OUTSIDE
             output_query.append(c)
 
         elif state == INSIDE_PN:
-            if style == "named":
+            if style == DbApiParamstyle.NAMED.value:
                 placeholders[-1] += c
                 if next_c is None or (not next_c.isalnum() and next_c != "_"):
                     state = OUTSIDE
                     try:
                         pidx: int = placeholders.index(placeholders[-1], 0, -1)
                         output_query.append("$" + str(pidx + 1))
                         del placeholders[-1]
                     except ValueError:
                         output_query.append("$" + str(len(placeholders)))
-            elif style == "pyformat":
+            elif style == DbApiParamstyle.PYFORMAT.value:
                 if prev_c == ")" and c == "s":
                     state = OUTSIDE
                     try:
                         pidx = placeholders.index(placeholders[-1], 0, -1)
                         output_query.append("$" + str(pidx + 1))
                         del placeholders[-1]
                     except ValueError:
                         output_query.append("$" + str(len(placeholders)))
                 elif c in "()":
                     pass
                 else:
                     placeholders[-1] += c
-            elif style == "format":
+            elif style == DbApiParamstyle.FORMAT.value:
                 state = OUTSIDE
 
         elif state == INSIDE_CO:
             output_query.append(c)
             if c == "\n":
                 state = OUTSIDE
 
+        elif state == INSIDE_MC:
+            output_query.append(c)
+            if c == "/" and prev_c == "*":
+                state = OUTSIDE
+
         prev_c = c
 
-    if style in ("numeric", "qmark", "format"):
+    if style in (DbApiParamstyle.NUMERIC.value, DbApiParamstyle.QMARK.value, DbApiParamstyle.FORMAT.value):
 
         def make_args(vals):
             return vals
 
     else:
 
         def make_args(vals):
@@ -462,15 +473,15 @@
             b"COPY",
             b"SELECT",
         )
         self.notifications: deque = deque(maxlen=100)
         self.notices: deque = deque(maxlen=100)
         self.parameter_statuses: deque = deque(maxlen=100)
         self.max_prepared_statements: int = int(max_prepared_statements)
-        self._run_cursor: Cursor = Cursor(self, paramstyle="named")
+        self._run_cursor: Cursor = Cursor(self, paramstyle=DbApiParamstyle.NAMED.value)
         self._client_protocol_version: int = client_protocol_version
         self._database = database
         self.py_types = deepcopy(PY_TYPES)
         self.redshift_types = deepcopy(REDSHIFT_TYPES)
         self._database_metadata_current_db_only: bool = database_metadata_current_db_only
         self.numeric_to_float: bool = numeric_to_float
 
@@ -1450,25 +1461,25 @@
             return self.py_types[RedshiftOID.SMALLINT]
         if min_int4 < value < max_int4:
             return self.py_types[RedshiftOID.INTEGER]
         if min_int8 < value < max_int8:
             return self.py_types[RedshiftOID.BIGINT]
         return self.py_types[Decimal]
 
-    def make_params(self: "Connection", values):
-        params = []
+    def make_params(self: "Connection", values) -> typing.Tuple[typing.Tuple[int, int, typing.Callable], ...]:
+        params: typing.List[typing.Tuple[int, int, typing.Callable]] = []
         for value in values:
-            typ = type(value)
+            typ: typing.Type = type(value)
             try:
                 params.append(self.py_types[typ])
             except KeyError:
                 try:
                     params.append(self.inspect_funcs[typ](value))
                 except KeyError as e:
-                    param = None
+                    param: typing.Optional[typing.Tuple[int, int, typing.Callable]] = None
                     for k, v in self.py_types.items():
                         try:
                             if isinstance(value, typing.cast(type, k)):
                                 param = v
                                 break
                         except TypeError:
                             pass
@@ -1589,24 +1600,27 @@
         operation : str The SQL statement to execute.
         vals : If `redshift_connector.paramstyle` is `qmark`, `numeric`, or `format` this argument should be an array of parameters to bind into the statement. If `redshift_connector.paramstyle` is `named` the argument should be a `dict` mapping of parameters. If `redshift_connector.paramstyle` is `pyformat`, the argument value may be either an array or mapping.
 
         Returns
         -------
         None:None
         """
-        if vals is None:
-            vals = ()
 
         # get the process ID of the calling process.
         pid: int = getpid()
+
+        args: typing.Tuple[typing.Optional[typing.Tuple[str, typing.Any]], ...] = ()
+        # transforms user provided bind parameters to server friendly bind parameters
+        params: typing.Tuple[typing.Optional[typing.Tuple[int, int, typing.Callable]], ...] = ()
+        has_bind_parameters: bool = False if vals is None else True
         # multi dimensional dictionary to store the data
         # cache = self._caches[cursor.paramstyle][pid]
         # cache = {'statement': {}, 'ps': {}}
-        # statement store the data of statement, ps store the data of prepared statement
-        # statement = {operation(query): tuple from 'conver_paramstyle'(statement, make_args)}
+        # statement stores the data of the statement, ps store the data of the prepared statement
+        # statement = {operation(query): tuple from 'convert_paramstyle'(statement, make_args)}
         try:
             cache = self._caches[cursor.paramstyle][pid]
         except KeyError:
             try:
                 param_cache = self._caches[cursor.paramstyle]
             except KeyError:
                 param_cache = self._caches[cursor.paramstyle] = {}
@@ -1615,20 +1629,24 @@
                 cache = param_cache[pid]
             except KeyError:
                 cache = param_cache[pid] = {"statement": {}, "ps": {}}
 
         try:
             statement, make_args = cache["statement"][operation]
         except KeyError:
-            statement, make_args = cache["statement"][operation] = convert_paramstyle(cursor.paramstyle, operation)
-
-        args = make_args(vals)
-        # change the args to the format that the DB will identify
-        # take reference from self.py_types
-        params = self.make_params(args)
+            if has_bind_parameters:
+                statement, make_args = cache["statement"][operation] = convert_paramstyle(cursor.paramstyle, operation)
+            else:
+                # use a no-op make_args in lieu of parsing the sql statement
+                statement, make_args = cache["statement"][operation] = operation, lambda p: ()
+        if has_bind_parameters:
+            args = make_args(vals)
+            # change the args to the format that the DB will identify
+            # take reference from self.py_types
+            params = self.make_params(args)
         key = operation, params
 
         try:
             ps = cache["ps"][key]
             cursor.ps = ps
         except KeyError:
             statement_nums: typing.List[int] = [0]
@@ -1649,32 +1667,32 @@
             # row_desc: list that used to store metadata of rows from DB
             # param_funcs: type transform function
             ps = {
                 "statement_name_bin": statement_name_bin,
                 "pid": pid,
                 "statement_num": statement_num,
                 "row_desc": [],
-                "param_funcs": tuple(x[2] for x in params),
+                "param_funcs": tuple(x[2] for x in params),  # type: ignore
             }
             cursor.ps = ps
 
-            param_fcs = tuple(x[1] for x in params)
+            param_fcs: typing.Tuple[typing.Optional[int], ...] = tuple(x[1] for x in params)  # type: ignore
 
             # Byte1('P') - Identifies the message as a Parse command.
             # Int32 -   Message length, including self.
             # String -  Prepared statement name. An empty string selects the
             #           unnamed prepared statement.
             # String -  The query string.
             # Int16 -   Number of parameter data types specified (can be zero).
             # For each parameter:
             #   Int32 - The OID of the parameter data type.
             val: typing.Union[bytes, bytearray] = bytearray(statement_name_bin)
             typing.cast(bytearray, val).extend(statement.encode(_client_encoding) + NULL_BYTE)
             typing.cast(bytearray, val).extend(h_pack(len(params)))
-            for oid, fc, send_func in params:
+            for oid, fc, send_func in params:  # type: ignore
                 # Parse message doesn't seem to handle the -1 type_oid for NULL
                 # values that other messages handle.  So we'll provide type_oid
                 # 705, the PG "unknown" type.
                 typing.cast(bytearray, val).extend(i_pack(705 if oid == -1 else oid))
 
             # Byte1('D') - Identifies the message as a describe command.
             # Int32 - Message length, including self.
```

## redshift_connector/cursor.py

```diff
@@ -6,14 +6,15 @@
 from itertools import count, islice
 from typing import TYPE_CHECKING
 from warnings import warn
 
 import redshift_connector
 from redshift_connector.config import (
     ClientProtocolVersion,
+    DbApiParamstyle,
     _client_encoding,
     table_type_clauses,
 )
 from redshift_connector.error import (
     MISSING_MODULE_ERROR_MSG,
     InterfaceError,
     ProgrammingError,
@@ -351,15 +352,15 @@
         q: str = "select 1 from information_schema.columns where table_name = ? and column_name = ?"
         if len(split_table_name) == 2:
             q += " and table_schema = ?"
             param_list = [[split_table_name[1], c, split_table_name[0]] for c in columns]
         else:
             param_list = [[split_table_name[0], c] for c in columns]
         temp = self.paramstyle
-        self.paramstyle = "qmark"
+        self.paramstyle = DbApiParamstyle.QMARK.value
         try:
             for params in param_list:
                 self.execute(q, params)
                 res = self.fetchone()
                 if typing.cast(typing.List[int], res)[0] != 1:
                     raise InterfaceError("Invalid column name: {} specified for table: {}".format(params[1], table))
         except:
@@ -372,15 +373,15 @@
 
     def callproc(self, procname, parameters=None):
         args = [] if parameters is None else parameters
         operation = "CALL " + self.__sanitize_str(procname) + "(" + ", ".join(["%s" for _ in args]) + ")"
         from redshift_connector.core import convert_paramstyle
 
         try:
-            statement, make_args = convert_paramstyle("format", operation)
+            statement, make_args = convert_paramstyle(DbApiParamstyle.FORMAT.value, operation)
             vals = make_args(args)
             self.execute(statement, vals)
 
         except AttributeError as e:
             if self._c is None:
                 raise InterfaceError("Cursor closed")
             elif self._c._sock is None:
@@ -530,15 +531,15 @@
 
         if len(split_table_name) > 2:
             return False
 
         q: str = "select 1 from information_schema.tables where table_name = ?"
 
         temp = self.paramstyle
-        self.paramstyle = "qmark"
+        self.paramstyle = DbApiParamstyle.QMARK.value
 
         try:
             if len(split_table_name) == 2:
                 q += " and table_schema = ?"
                 self.execute(q, (split_table_name[1], split_table_name[0]))
             else:
                 self.execute(q, (split_table_name[0],))
@@ -550,15 +551,15 @@
 
         result = self.fetchone()
 
         return result[0] == 1 if result is not None else False
 
     def write_dataframe(self: "Cursor", df: "pandas.DataFrame", table: str) -> None:
         """
-        Inserts a :class:`pandas.DataFrame` into an table within the current database.
+        Inserts a :class:`pandas.DataFrame` into a table within the current database.
 
         Parameters
         ----------
         df : :class:`pandas.DataFrame` Contains row values to insert into `table`
         table : str Name of an existing table in the current Amazon Redshift database to insert the values in `df`
 
         Returns
@@ -574,18 +575,29 @@
             raise InterfaceError("Invalid table name passed to write_dataframe: {}".format(table))
         sanitized_table_name: str = self.__sanitize_str(table)
         arrays: "numpy.ndarray" = df.values
         placeholder: str = ", ".join(["%s"] * len(arrays[0]))
         sql: str = "insert into {table} values ({placeholder})".format(
             table=sanitized_table_name, placeholder=placeholder
         )
-        if len(arrays) == 1:
-            self.execute(sql, arrays[0])
-        elif len(arrays) > 1:
-            self.executemany(sql, arrays)
+        cursor_paramstyle: str = self.paramstyle
+        try:
+            # force using FORMAT i.e. %s paramstyle for the current statement, then revert the
+            # cursor to use the cursor's original paramstyle
+            self.paramstyle = DbApiParamstyle.FORMAT.value
+            if len(arrays) == 1:
+                self.execute(sql, arrays[0])
+            elif len(arrays) > 1:
+                self.executemany(sql, arrays)
+        except:
+            raise InterfaceError(
+                "An error occurred when attempting to insert the pandas.DataFrame into ${}".format(table)
+            )
+        finally:
+            self.paramstyle = cursor_paramstyle
 
     def fetch_numpy_array(self: "Cursor", num: typing.Optional[int] = None) -> "numpy.ndarray":
         """
         Fetches a user defined number of rows of a query result as a :class:`numpy.ndarray`.
 
         Parameters
         ----------
@@ -639,15 +651,15 @@
             sql += " AND p.proname LIKE ?"
             query_args.append(self.__sanitize_str(procedure_name_pattern))
         sql += " ORDER BY PROCEDURE_SCHEM, PROCEDURE_NAME, p.prooid::text "
 
         if len(query_args) > 0:
             # temporarily use qmark paramstyle
             temp = self.paramstyle
-            self.paramstyle = "qmark"
+            self.paramstyle = DbApiParamstyle.QMARK.value
 
             try:
                 self.execute(sql, tuple(query_args))
             except:
                 raise
             finally:
                 # reset the original value of paramstyle
@@ -717,15 +729,15 @@
                 sql += " AND schema_name LIKE ?"
                 query_args.append(self.__sanitize_str(schema_pattern))
             sql += " ORDER BY TABLE_CATALOG, TABLE_SCHEM"
 
         if len(query_args) == 1:
             # temporarily use qmark paramstyle
             temp = self.paramstyle
-            self.paramstyle = "qmark"
+            self.paramstyle = DbApiParamstyle.QMARK.value
             try:
                 self.execute(sql, tuple(query_args))
             except:
                 raise
             finally:
                 self.paramstyle = temp
         else:
@@ -770,15 +782,15 @@
             query_args.append(self.__sanitize_str(table))
 
         sql += " ORDER BY table_name, pk_name, key_seq"
 
         if len(query_args) > 0:
             # temporarily use qmark paramstyle
             temp = self.paramstyle
-            self.paramstyle = "qmark"
+            self.paramstyle = DbApiParamstyle.QMARK.value
             try:
                 self.execute(sql, tuple(query_args))
             except:
                 raise
             finally:
                 self.paramstyle = temp
         else:
@@ -851,15 +863,15 @@
         elif schema_pattern_type == "EXTERNAL_SCHEMA_QUERY":
             sql, sql_args = self.__build_external_schema_tables_query(
                 catalog, schema_pattern, table_name_pattern, types
             )
 
         if len(sql_args) > 0:
             temp = self.paramstyle
-            self.paramstyle = "qmark"
+            self.paramstyle = DbApiParamstyle.QMARK.value
             try:
                 self.execute(sql, sql_args)
             except:
                 raise
             finally:
                 self.paramstyle = temp
         else:
```

## redshift_connector/version.py

```diff
@@ -1,5 +1,5 @@
 # Store the version here so:
 # 1) we don't load dependencies by storing it in __init__.py
 # 2) we can import it in setup.py for the same reason
 # 3) we can import it into your module module
-__version__ = "2.0.910"
+__version__ = "2.0.911"
```

## Comparing `redshift_connector-2.0.910.dist-info/LICENSE` & `redshift_connector-2.0.911.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `redshift_connector-2.0.910.dist-info/METADATA` & `redshift_connector-2.0.911.dist-info/METADATA`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: redshift-connector
-Version: 2.0.910
+Version: 2.0.911
 Summary: Redshift interface library
 Home-page: https://github.com/aws/amazon-redshift-python-driver
 Author: Amazon Web Services
 Author-email: redshift-drivers@amazon.com
 License: Apache License 2.0
 Keywords: redshift dbapi
 Platform: UNKNOWN
```

## Comparing `redshift_connector-2.0.910.dist-info/RECORD` & `redshift_connector-2.0.911.dist-info/RECORD`

 * *Files 3% similar despite different names*

```diff
@@ -1,21 +1,21 @@
-redshift_connector/__init__.py,sha256=QmvPSOHM92wm_izwCT7FDdv0LiZDoi1Ck79X8x74KQg,17871
-redshift_connector/config.py,sha256=CiKLs5nl_200dkZO7JHwQKvG7WK2zUsyD0ZjcyKBzQI,5444
-redshift_connector/core.py,sha256=5TdKipL3Hra_LVIL-BRvXKYaDRlFl4723_OWZQyAUKI,93789
+redshift_connector/__init__.py,sha256=y406EJKqfT1-HaynlhxEzsdoafksQ9rDviY80xCDN5c,17905
+redshift_connector/config.py,sha256=FPgVMSl0l431JuKZF-xhmq8gL5Wgb0hRqW1bWOtTbEY,5716
+redshift_connector/core.py,sha256=nPj-lFkuQyeouz9y4fyWR2WMDIZG87BPBWL1UklrlcA,95283
 redshift_connector/credentials_holder.py,sha256=fJ-ygCyGRymoQ3UQNTlXoWcXQzAGc0ylniXqpStcuwk,8205
-redshift_connector/cursor.py,sha256=nWSp0MFc7I0AHgNOyic4N1T2YndIDL3Nj-MHsiiz2MA,98343
+redshift_connector/cursor.py,sha256=Dao6OQObzHU2xbBdeLlLYQ7wnjA3jjndJOraGqE55u0,99031
 redshift_connector/error.py,sha256=Af_kEIMj9VmQ9ol5J1g2GB9jii3LRmYyxMLj7dvp13o,3994
 redshift_connector/iam_helper.py,sha256=8D1LvLPIHWaMn-BqEmp_tU8fcDHTWwSLWAF8xM1W4Wo,16994
 redshift_connector/idp_auth_helper.py,sha256=Zch-xqD59uedS7fu65zWeUWpQc7aXnBpM6pxpbXan8M,11042
 redshift_connector/interval.py,sha256=DWASZf5E-HCGcSZ56KtRNgQSitox2zQtsQ4yU0R5a2M,3566
 redshift_connector/native_plugin_helper.py,sha256=kmatMyBmNqHWb5kRwB1SDwa-O4fAB1ebhUTOdE4JUDQ,3390
 redshift_connector/objects.py,sha256=CR050qJB7gp0-jBDZ22rxgmmbdi3UF-Pg5CN0hRXgC4,2363
 redshift_connector/pg_types.py,sha256=A-1I8ArT5MHW1YoRocIe-68FYBGQAxQEwwNooEaURaQ,762
 redshift_connector/redshift_property.py,sha256=U5Ftb2tIuG59903qv6KE0MDetRpUHkYCXufN_On236w,10092
-redshift_connector/version.py,sha256=JeE42lGVwwWvnVVcTJzONg2nvRli_ZnjeuzXtMaYeYU,214
+redshift_connector/version.py,sha256=Xcn6md8BmIz7lGlpRLj1A7UCaxlk9C0Z52bHqc1BK6g,214
 redshift_connector/auth/__init__.py,sha256=2UUlehVekwvYWKgH1OVhuL81EtKRISiZk5NAFpDZCRU,61
 redshift_connector/auth/aws_credentials_provider.py,sha256=RRwsCYzIgMt6KRdL-rw5ZuRaA7ydtGeoK9O1amDQ3RQ,4349
 redshift_connector/files/redshift-ca-bundle.crt,sha256=792ZdTc-pJa_hdkZt0xVzdrmoXLP3_7XJNif7z6Ge58,9870
 redshift_connector/plugin/__init__.py,sha256=K-1U25W7O1gM3DCXuenXsUAt8y0R4tXzkWJuHMjUiQ4,741
 redshift_connector/plugin/adfs_credentials_provider.py,sha256=VXLRLZb4UI0AUR1xati3v5u7W55OHevrBh3dXmYEo88,5577
 redshift_connector/plugin/azure_credentials_provider.py,sha256=Q6Rv6uHV3Y_pF1CrlHUkWYdv6jzBEwNnD_aabYvBMI0,7154
 redshift_connector/plugin/browser_azure_credentials_provider.py,sha256=oM6y_YyuDkg0_7lkoJwE_WLLvrPP9ezaFhKmjNxxLvE,10640
@@ -33,13 +33,13 @@
 redshift_connector/utils/__init__.py,sha256=jQPPXxIRYJ0KgcExi34mXEbXVIF0Pyf6rdTOpIBU3w8,892
 redshift_connector/utils/array_util.py,sha256=V0ALkEuwzfmEEKqRmgRQN77H0CBeHZI-ltE9SH1zjCM,1913
 redshift_connector/utils/driver_info.py,sha256=2L_CLxvWP7DeEpzXSfw6M0SB0AjtDqXdVkLI2zKc6T0,1442
 redshift_connector/utils/extensible_digest.py,sha256=ZZNr8ruzpN3DdBhvn6ifIGmAJ-O-OP0BCI0R7b5hzzM,1616
 redshift_connector/utils/logging_utils.py,sha256=g4RjWyGLMcXcXn5RXDmiIxFBXWlRQmlPven_EKPR4oA,1087
 redshift_connector/utils/oids.py,sha256=shPEnM8egn2u5vlkjZozrpCf5txRMmikbtKxCuu-Y38,1675
 redshift_connector/utils/type_utils.py,sha256=iH-bSxrtczIO7hQWYAlUfgUQa78kTGrekIVgkT1wu5o,24077
-redshift_connector-2.0.910.dist-info/LICENSE,sha256=CeipvOyAZxBGUsFoaFqwkx54aPnIKEtm9a5u2uXxEws,10142
-redshift_connector-2.0.910.dist-info/METADATA,sha256=1AxrULJ_ubOLLSeWvPgYJeNzixHZ9q4-SSTYSVUPy9g,61356
-redshift_connector-2.0.910.dist-info/NOTICE,sha256=1CkO1kwu3Q_OHYTj-d-yiBJA_lNN73a4zSntavaD4oc,67
-redshift_connector-2.0.910.dist-info/WHEEL,sha256=XHhP4NZKzYpC5PqCMnZLMbQyjVLCf7mGMN72SS0pQ1U,93
-redshift_connector-2.0.910.dist-info/top_level.txt,sha256=jaX7d_6R_L5fi_cdB2Pe-b5-5RkoOMCMyKpj6g6qZr0,19
-redshift_connector-2.0.910.dist-info/RECORD,,
+redshift_connector-2.0.911.dist-info/LICENSE,sha256=CeipvOyAZxBGUsFoaFqwkx54aPnIKEtm9a5u2uXxEws,10142
+redshift_connector-2.0.911.dist-info/METADATA,sha256=P43XEikhLjqkrcEJD80B3fZxxCg0wYo8IAE8_i-LjmA,61356
+redshift_connector-2.0.911.dist-info/NOTICE,sha256=1CkO1kwu3Q_OHYTj-d-yiBJA_lNN73a4zSntavaD4oc,67
+redshift_connector-2.0.911.dist-info/WHEEL,sha256=XHhP4NZKzYpC5PqCMnZLMbQyjVLCf7mGMN72SS0pQ1U,93
+redshift_connector-2.0.911.dist-info/top_level.txt,sha256=jaX7d_6R_L5fi_cdB2Pe-b5-5RkoOMCMyKpj6g6qZr0,19
+redshift_connector-2.0.911.dist-info/RECORD,,
```

