# Comparing `tmp/ebanktool-0.0.2.tar.gz` & `tmp/ebanktool-1.0.2.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "ebanktool-0.0.2.tar", last modified: Wed Mar 29 08:10:25 2023, max compression
+gzip compressed data, was "ebanktool-1.0.2.tar", last modified: Tue Jun  6 08:34:15 2023, max compression
```

## Comparing `ebanktool-0.0.2.tar` & `ebanktool-1.0.2.tar`

### file list

```diff
@@ -1,15 +1,16 @@
-drwxrwxrwx   0        0        0        0 2023-03-29 08:10:25.886922 ebanktool-0.0.2/
--rw-rw-rw-   0        0        0       56 2023-03-29 08:10:25.885806 ebanktool-0.0.2/PKG-INFO
-drwxrwxrwx   0        0        0        0 2023-03-29 08:10:25.876829 ebanktool-0.0.2/ebanktool.egg-info/
--rw-rw-rw-   0        0        0       56 2023-03-29 08:10:25.000000 ebanktool-0.0.2/ebanktool.egg-info/PKG-INFO
--rw-rw-rw-   0        0        0      237 2023-03-29 08:10:25.000000 ebanktool-0.0.2/ebanktool.egg-info/SOURCES.txt
--rw-rw-rw-   0        0        0        1 2023-03-29 08:10:25.000000 ebanktool-0.0.2/ebanktool.egg-info/dependency_links.txt
--rw-rw-rw-   0        0        0      125 2023-03-29 08:10:25.000000 ebanktool-0.0.2/ebanktool.egg-info/requires.txt
--rw-rw-rw-   0        0        0        6 2023-03-29 08:10:25.000000 ebanktool-0.0.2/ebanktool.egg-info/top_level.txt
--rw-rw-rw-   0        0        0       42 2023-03-29 08:10:25.886922 ebanktool-0.0.2/setup.cfg
--rw-rw-rw-   0        0        0      489 2023-03-29 08:10:20.000000 ebanktool-0.0.2/setup.py
-drwxrwxrwx   0        0        0        0 2023-03-29 08:10:25.884809 ebanktool-0.0.2/utils/
--rw-rw-rw-   0        0        0        0 2023-03-28 09:50:15.000000 ebanktool-0.0.2/utils/__init__.py
--rw-rw-rw-   0        0        0     2474 2023-03-28 10:05:24.000000 ebanktool-0.0.2/utils/filesearch.py
--rw-rw-rw-   0        0        0     4821 2023-03-28 10:20:48.000000 ebanktool-0.0.2/utils/misc.py
--rw-rw-rw-   0        0        0     2448 2023-03-29 05:50:50.000000 ebanktool-0.0.2/utils/ocr.py
+drwxrwxrwx   0        0        0        0 2023-06-06 08:34:15.845435 ebanktool-1.0.2/
+-rw-rw-rw-   0        0        0       56 2023-06-06 08:34:15.844376 ebanktool-1.0.2/PKG-INFO
+drwxrwxrwx   0        0        0        0 2023-06-06 08:34:15.813079 ebanktool-1.0.2/ebanktool.egg-info/
+-rw-rw-rw-   0        0        0       56 2023-06-06 08:34:15.000000 ebanktool-1.0.2/ebanktool.egg-info/PKG-INFO
+-rw-rw-rw-   0        0        0      262 2023-06-06 08:34:15.000000 ebanktool-1.0.2/ebanktool.egg-info/SOURCES.txt
+-rw-rw-rw-   0        0        0        1 2023-06-06 08:34:15.000000 ebanktool-1.0.2/ebanktool.egg-info/dependency_links.txt
+-rw-rw-rw-   0        0        0      125 2023-06-06 08:34:15.000000 ebanktool-1.0.2/ebanktool.egg-info/requires.txt
+-rw-rw-rw-   0        0        0        6 2023-06-06 08:34:15.000000 ebanktool-1.0.2/ebanktool.egg-info/top_level.txt
+-rw-rw-rw-   0        0        0       42 2023-06-06 08:34:15.845435 ebanktool-1.0.2/setup.cfg
+-rw-rw-rw-   0        0        0      504 2023-06-06 08:34:09.000000 ebanktool-1.0.2/setup.py
+drwxrwxrwx   0        0        0        0 2023-06-06 08:34:15.838873 ebanktool-1.0.2/utils/
+-rw-rw-rw-   0        0        0        2 2023-06-06 05:27:42.000000 ebanktool-1.0.2/utils/__init__.py
+-rw-rw-rw-   0        0        0     2156 2023-06-06 05:27:42.000000 ebanktool-1.0.2/utils/baiduocr.py
+-rw-rw-rw-   0        0        0     1516 2023-06-06 05:27:42.000000 ebanktool-1.0.2/utils/chaojiying.py
+-rw-rw-rw-   0        0        0     2474 2023-06-06 05:27:42.000000 ebanktool-1.0.2/utils/filesearch.py
+-rw-rw-rw-   0        0        0     4814 2023-06-06 07:10:48.000000 ebanktool-1.0.2/utils/sfun.py
```

### Comparing `ebanktool-0.0.2/utils/filesearch.py` & `ebanktool-1.0.2/utils/filesearch.py`

 * *Files identical despite different names*

### Comparing `ebanktool-0.0.2/utils/misc.py` & `ebanktool-1.0.2/utils/sfun.py`

 * *Files 5% similar despite different names*

```diff
@@ -1,302 +1,301 @@
-00000000: 0d0a 696d 706f 7274 206f 730d 0a69 6d70  ..import os..imp
-00000010: 6f72 7420 7265 0d0a 6672 6f6d 2064 6174  ort re..from dat
-00000020: 6575 7469 6c2e 7061 7273 6572 2069 6d70  eutil.parser imp
-00000030: 6f72 7420 7061 7273 6572 0d0a 696d 706f  ort parser..impo
-00000040: 7274 2078 6c77 740d 0a69 6d70 6f72 7420  rt xlwt..import 
-00000050: 786c 7264 0d0a 6672 6f6d 2070 7970 6466  xlrd..from pypdf
-00000060: 2069 6d70 6f72 7420 5064 6657 7269 7465   import PdfWrite
-00000070: 722c 2050 6466 5265 6164 6572 0d0a 0d0a  r, PdfReader....
-00000080: 2320 e6a0 b9e6 8dae 6b65 79e8 bf94 e59b  # ......key.....
-00000090: 9e56 616c 7565 efbc 8ce5 a682 e689 bee4  .Value..........
-000000a0: b88d e588 b0e8 bf94 e59b 9ee7 a9ba e5ad  ................
-000000b0: 97e7 aca6 0d0a 0d0a 0d0a 6465 6620 6469  ..........def di
-000000c0: 6374 5f67 6574 286b 763a 2064 6963 742c  ct_get(kv: dict,
-000000d0: 206b 293a 0d0a 2020 2020 7620 3d20 6b76   k):..    v = kv
-000000e0: 2e67 6574 286b 290d 0a20 2020 2069 6620  .get(k)..    if 
-000000f0: 7620 6973 206e 6f74 204e 6f6e 653a 0d0a  v is not None:..
-00000100: 2020 2020 2020 2020 7265 7475 726e 2076          return v
-00000110: 0d0a 2020 2020 656c 7365 3a0d 0a20 2020  ..    else:..   
-00000120: 2020 2020 2072 6574 7572 6e20 2222 0d0a       return ""..
-00000130: 0d0a 0d0a 6465 6620 666d 745f 616d 7428  ....def fmt_amt(
-00000140: 616d 745f 7374 723d 22e4 baba e6b0 91e5  amt_str=".......
-00000150: b881 efbc 88e5 a4a7 e586 99ef bc89 efbc  ................
-00000160: 9a20 e882 86e4 bb9f e4b8 87e5 8583 e695  . ..............
-00000170: b420 efbf a520 3430 2c30 3030 2c30 3030  . ... 40,000,000
-00000180: 2e30 30e5 8583 2229 3a0d 0a20 2020 2072  .00..."):..    r
-00000190: 6567 6578 203d 2072 2228 5b5c 647c 2c7c  egex = r"([\d|,|
-000001a0: 2e5d 292b 220d 0a20 2020 206d 6174 6368  .])+"..    match
-000001b0: 6573 203d 2072 652e 6669 6e64 6974 6572  es = re.finditer
-000001c0: 2872 6567 6578 2c20 7374 7228 616d 745f  (regex, str(amt_
-000001d0: 7374 7229 290d 0a20 2020 206d 6174 6368  str))..    match
-000001e0: 5f74 6578 7420 3d20 2222 0d0a 2020 2020  _text = ""..    
-000001f0: 666f 7220 6d61 7463 684e 756d 2c20 6d61  for matchNum, ma
-00000200: 7463 6820 696e 2065 6e75 6d65 7261 7465  tch in enumerate
-00000210: 286d 6174 6368 6573 2c20 7374 6172 743d  (matches, start=
-00000220: 3129 3a0d 0a20 2020 2020 2020 206d 6174  1):..        mat
-00000230: 6368 5f74 6578 7420 3d20 6d61 7463 682e  ch_text = match.
-00000240: 6772 6f75 7028 290d 0a20 2020 2072 6574  group()..    ret
-00000250: 7572 6e20 6d61 7463 685f 7465 7874 2e72  urn match_text.r
-00000260: 6570 6c61 6365 2822 2c22 2c20 2222 290d  eplace(",", "").
-00000270: 0a0d 0a0d 0a64 6566 2066 6d74 5f74 7261  .....def fmt_tra
-00000280: 6e73 5f64 6174 6528 7472 616e 735f 6461  ns_date(trans_da
-00000290: 7465 3d22 3230 3232 2d30 392d 3233 2031  te="2022-09-23 1
-000002a0: 313a 3431 3a33 3022 293a 0d0a 2020 2020  1:41:30"):..    
-000002b0: 7472 793a 0d0a 2020 2020 2020 2020 6966  try:..        if
-000002c0: 2028 6973 696e 7374 616e 6365 2874 7261   (isinstance(tra
-000002d0: 6e73 5f64 6174 652c 2066 6c6f 6174 2929  ns_date, float))
-000002e0: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
-000002f0: 6574 7572 6e20 786c 7264 2e78 6c64 6174  eturn xlrd.xldat
-00000300: 655f 6173 5f64 6174 6574 696d 6528 0d0a  e_as_datetime(..
-00000310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000320: 7472 616e 735f 6461 7465 2c20 3029 2e73  trans_date, 0).s
-00000330: 7472 6674 696d 6528 2225 592d 256d 2d25  trftime("%Y-%m-%
-00000340: 6422 290d 0a20 2020 2020 2020 2065 6c73  d")..        els
-00000350: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00000360: 6e65 775f 6461 7465 203d 2074 7261 6e73  new_date = trans
-00000370: 5f64 6174 652e 7265 706c 6163 6528 0d0a  _date.replace(..
-00000380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000390: 22e5 b9b4 222c 2022 2d22 292e 7265 706c  "...", "-").repl
-000003a0: 6163 6528 22e6 9c88 222c 2022 2d22 292e  ace("...", "-").
-000003b0: 7265 706c 6163 6528 22e6 97a5 222c 2022  replace("...", "
-000003c0: 2022 292e 7265 706c 6163 6528 22e6 97b6   ").replace("...
-000003d0: 222c 2022 3a22 292e 7265 706c 6163 6528  ", ":").replace(
-000003e0: 22e5 8886 222c 2022 3a22 292e 7265 706c  "...", ":").repl
-000003f0: 6163 6528 22e7 a792 222c 2022 2229 0d0a  ace("...", "")..
-00000400: 2020 2020 2020 2020 7265 7475 726e 2070          return p
-00000410: 6172 7365 7228 292e 7061 7273 6528 6e65  arser().parse(ne
-00000420: 775f 6461 7465 292e 7374 7266 7469 6d65  w_date).strftime
-00000430: 2822 2559 2d25 6d2d 2564 2229 0d0a 2020  ("%Y-%m-%d")..  
-00000440: 2020 6578 6365 7074 3a0d 0a20 2020 2020    except:..     
-00000450: 2020 2072 6574 7572 6e20 7472 616e 735f     return trans_
-00000460: 6461 7465 0d0a 0d0a 0d0a 6465 6620 6765  date......def ge
-00000470: 745f 6375 726e 6f28 6669 6c65 5f6e 616d  t_curno(file_nam
-00000480: 6529 3a0d 0a20 2020 2072 6567 6578 203d  e):..    regex =
-00000490: 2072 2228 3f3c 3d48 5f29 5c64 2a22 0d0a   r"(?<=H_)\d*"..
-000004a0: 2020 2020 6669 6e64 7320 3d20 7265 2e66      finds = re.f
-000004b0: 696e 6461 6c6c 2872 6567 6578 2c20 6669  indall(regex, fi
-000004c0: 6c65 5f6e 616d 6529 0d0a 2020 2020 6966  le_name)..    if
-000004d0: 206c 656e 2866 696e 6473 2920 3e20 303a   len(finds) > 0:
-000004e0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-000004f0: 2066 696e 6473 5b30 5d0d 0a20 2020 2065   finds[0]..    e
-00000500: 6c73 653a 0d0a 2020 2020 2020 2020 7265  lse:..        re
-00000510: 7475 726e 2022 220d 0a0d 0a0d 0a64 6566  turn ""......def
-00000520: 2072 6561 645f 786c 2878 6c5f 7061 7468   read_xl(xl_path
-00000530: 2c20 7368 6565 745f 6964 783d 3029 3a0d  , sheet_idx=0):.
-00000540: 0a20 2020 2078 6c73 203d 2078 6c72 642e  .    xls = xlrd.
-00000550: 6f70 656e 5f77 6f72 6b62 6f6f 6b28 786c  open_workbook(xl
-00000560: 5f70 6174 682c 2066 6f72 6d61 7474 696e  _path, formattin
-00000570: 675f 696e 666f 3d54 7275 6529 0d0a 2020  g_info=True)..  
-00000580: 2020 7368 6565 7420 3d20 786c 732e 7368    sheet = xls.sh
-00000590: 6565 745f 6279 5f69 6e64 6578 2873 6865  eet_by_index(she
-000005a0: 6574 5f69 6478 290d 0a20 2020 2072 6574  et_idx)..    ret
-000005b0: 7572 6e20 7368 6565 740d 0a0d 0a0d 0a64  urn sheet......d
-000005c0: 6566 2077 745f 7263 745f 6578 6365 6c28  ef wt_rct_excel(
-000005d0: 786c 5f70 6174 682c 2072 6374 5f6c 6973  xl_path, rct_lis
-000005e0: 7429 202d 3e20 7374 723a 0d0a 0d0a 2020  t) -> str:....  
-000005f0: 2020 6578 6365 6c5f 6865 6164 6572 203d    excel_header =
-00000600: 205b 22e5 9b9e e58d 95e6 b581 e6b0 b4e5   [".............
-00000610: 8fb7 222c 2022 e688 91e6 96b9 e585 ace5  ..", "..........
-00000620: 8fb8 e590 8de7 a7b0 222c 2022 e993 b6e8  ........", "....
-00000630: a18c e590 8de7 a7b0 222c 2022 e69c ace6  ........", "....
-00000640: 96b9 e993 b6e8 a18c e8b4 a6e5 8fb7 222c  ..............",
-00000650: 2022 e697 a5e6 9c9f 222c 0d0a 2020 2020   "......",..    
-00000660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000670: 22e6 94b6 e585 a5e9 8791 e9a2 9d22 2c20  "............", 
-00000680: 22e6 94af e587 bae9 8791 e9a2 9d22 2c20  "............", 
-00000690: 22e4 bd99 e9a2 9d22 2c20 22e5 afb9 e696  "......", ".....
-000006a0: b9e6 88b7 e590 8d22 2c20 22e5 afb9 e696  .......", ".....
-000006b0: b9e8 b4a6 e58f b722 2c20 22e7 94a8 e980  .......", ".....
-000006c0: 9422 2c20 22e6 9198 e8a6 8122 2c20 22e5  .", "......", ".
-000006d0: 9b9e e58d 95e8 b7af e5be 8422 5d0d 0a0d  ..........."]...
-000006e0: 0a20 2020 2078 6c20 3d20 786c 7774 2e57  .    xl = xlwt.W
-000006f0: 6f72 6b62 6f6f 6b28 656e 636f 6469 6e67  orkbook(encoding
-00000700: 3d22 7566 742d 3822 290d 0a20 2020 2073  ="uft-8")..    s
-00000710: 6865 6574 203d 2078 6c2e 6164 645f 7368  heet = xl.add_sh
-00000720: 6565 7428 2273 6865 6574 3122 2c20 6365  eet("sheet1", ce
-00000730: 6c6c 5f6f 7665 7277 7269 7465 5f6f 6b3d  ll_overwrite_ok=
-00000740: 4661 6c73 6529 0d0a 0d0a 2020 2020 636f  False)....    co
-00000750: 6c5f 6964 7820 3d20 300d 0a20 2020 2066  l_idx = 0..    f
-00000760: 6f72 2063 6f6c 5f6e 616d 6520 696e 2065  or col_name in e
-00000770: 7863 656c 5f68 6561 6465 723a 0d0a 2020  xcel_header:..  
-00000780: 2020 2020 2020 7368 6565 742e 7772 6974        sheet.writ
-00000790: 6528 302c 2063 6f6c 5f69 6478 2c20 636f  e(0, col_idx, co
-000007a0: 6c5f 6e61 6d65 290d 0a20 2020 2020 2020  l_name)..       
-000007b0: 2063 6f6c 5f69 6478 203d 2063 6f6c 5f69   col_idx = col_i
-000007c0: 6478 2b31 0d0a 0d0a 2020 2020 726f 775f  dx+1....    row_
-000007d0: 6964 7820 3d20 310d 0a20 2020 2066 6f72  idx = 1..    for
-000007e0: 2072 6374 2069 6e20 7263 745f 6c69 7374   rct in rct_list
-000007f0: 3a0d 0a20 2020 2020 2020 2073 6865 6574  :..        sheet
-00000800: 2e77 7269 7465 2872 6f77 5f69 6478 2c20  .write(row_idx, 
-00000810: 302c 2072 6374 2e66 6c6f 775f 6e6f 2920  0, rct.flow_no) 
-00000820: 2023 20e6 b581 e6b0 b4e5 8fb7 0d0a 2020   # ...........  
-00000830: 2020 2020 2020 7368 6565 742e 7772 6974        sheet.writ
-00000840: 6528 726f 775f 6964 782c 2031 2c20 7263  e(row_idx, 1, rc
-00000850: 742e 636f 6d70 616e 795f 6e61 6d65 290d  t.company_name).
-00000860: 0a20 2020 2020 2020 2073 6865 6574 2e77  .        sheet.w
-00000870: 7269 7465 2872 6f77 5f69 6478 2c20 322c  rite(row_idx, 2,
-00000880: 2072 6374 2e62 616e 6b5f 6e61 6d65 290d   rct.bank_name).
-00000890: 0a20 2020 2020 2020 2073 6865 6574 2e77  .        sheet.w
-000008a0: 7269 7465 2872 6f77 5f69 6478 2c20 332c  rite(row_idx, 3,
-000008b0: 2072 6374 2e63 7572 5f6e 6f29 0d0a 2020   rct.cur_no)..  
-000008c0: 2020 2020 2020 7368 6565 742e 7772 6974        sheet.writ
-000008d0: 6528 726f 775f 6964 782c 2034 2c20 7263  e(row_idx, 4, rc
-000008e0: 742e 7472 616e 735f 6461 7465 290d 0a20  t.trans_date).. 
-000008f0: 2020 2020 2020 2073 6865 6574 2e77 7269         sheet.wri
-00000900: 7465 2872 6f77 5f69 6478 2c20 352c 2072  te(row_idx, 5, r
-00000910: 6374 2e72 6563 5f61 6d74 290d 0a20 2020  ct.rec_amt)..   
-00000920: 2020 2020 2073 6865 6574 2e77 7269 7465       sheet.write
-00000930: 2872 6f77 5f69 6478 2c20 362c 2072 6374  (row_idx, 6, rct
-00000940: 2e70 6179 5f61 6d74 290d 0a20 2020 2020  .pay_amt)..     
-00000950: 2020 2073 6865 6574 2e77 7269 7465 2872     sheet.write(r
-00000960: 6f77 5f69 6478 2c20 382c 2072 6374 2e61  ow_idx, 8, rct.a
-00000970: 6e74 5f6e 616d 6529 0d0a 2020 2020 2020  nt_name)..      
-00000980: 2020 7368 6565 742e 7772 6974 6528 726f    sheet.write(ro
-00000990: 775f 6964 782c 2039 2c20 7263 742e 616e  w_idx, 9, rct.an
-000009a0: 745f 6e6f 290d 0a20 2020 2020 2020 2073  t_no)..        s
-000009b0: 6865 6574 2e77 7269 7465 2872 6f77 5f69  heet.write(row_i
-000009c0: 6478 2c20 3132 2c20 7263 742e 6669 6c65  dx, 12, rct.file
-000009d0: 5f70 6174 6829 0d0a 0d0a 2020 2020 2020  _path)....      
-000009e0: 2020 726f 775f 6964 7820 3d20 726f 775f    row_idx = row_
-000009f0: 6964 782b 310d 0a0d 0a20 2020 2078 6c2e  idx+1....    xl.
-00000a00: 7361 7665 2878 6c5f 7061 7468 290d 0a20  save(xl_path).. 
-00000a10: 2020 2072 6574 7572 6e20 786c 5f70 6174     return xl_pat
-00000a20: 680d 0a0d 0a0d 0a64 6566 2077 745f 6261  h......def wt_ba
-00000a30: 6e6b 666c 6f77 5f65 7863 656c 2878 6c5f  nkflow_excel(xl_
-00000a40: 7061 7468 2c20 6261 6e6b 666c 6f77 5f6c  path, bankflow_l
-00000a50: 6973 7429 202d 3e20 7374 723a 0d0a 0d0a  ist) -> str:....
-00000a60: 2020 2020 6578 6365 6c5f 6865 6164 6572      excel_header
-00000a70: 203d 205b 22e5 85ac e58f b8e5 908d e7a7   = ["...........
-00000a80: b022 2c20 22e9 93b6 e8a1 8ce5 908d e7a7  .", "...........
-00000a90: b022 2c20 22e6 9cac e696 b9e9 93b6 e8a1  .", "...........
-00000aa0: 8ce8 b4a6 e58f b722 2c20 22e6 97a5 e69c  .......", ".....
-00000ab0: 9f22 2c20 22e6 b581 e6b0 b4e5 8fb7 222c  .", ".........",
-00000ac0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00000ad0: 2020 2020 2020 22e6 94b6 e585 a5e9 8791        ".........
-00000ae0: e9a2 9d22 2c20 22e6 94af e587 bae9 8791  ...", ".........
-00000af0: e9a2 9d22 2c20 22e4 bd99 e9a2 9d22 2c20  ...", "......", 
-00000b00: 22e5 afb9 e696 b9e6 88b7 e590 8d22 2c20  "............", 
-00000b10: 22e5 afb9 e696 b9e8 b4a6 e58f b722 2c20  "............", 
-00000b20: 22e7 94a8 e980 9422 2c0d 0a20 2020 2020  "......",..     
-00000b30: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00000b40: e691 98e8 a681 222c 2022 e794 b5e5 ad90  ......", "......
-00000b50: e59b 9ee5 8d95 222c 2022 e69c 8de5 8aa1  ......", "......
-00000b60: e599 a8e5 9b9e e58d 95e8 b7af e5be 8422  ..............."
-00000b70: 2c20 2253 7276 5555 4944 225d 0d0a 0d0a  , "SrvUUID"]....
-00000b80: 2020 2020 786c 203d 2078 6c77 742e 576f      xl = xlwt.Wo
-00000b90: 726b 626f 6f6b 2865 6e63 6f64 696e 673d  rkbook(encoding=
-00000ba0: 2275 6674 2d38 2229 0d0a 2020 2020 7368  "uft-8")..    sh
-00000bb0: 6565 7420 3d20 786c 2e61 6464 5f73 6865  eet = xl.add_she
-00000bc0: 6574 2822 7368 6565 7431 222c 2063 656c  et("sheet1", cel
-00000bd0: 6c5f 6f76 6572 7772 6974 655f 6f6b 3d46  l_overwrite_ok=F
-00000be0: 616c 7365 290d 0a0d 0a20 2020 2063 6f6c  alse)....    col
-00000bf0: 5f69 6478 203d 2030 0d0a 2020 2020 666f  _idx = 0..    fo
-00000c00: 7220 636f 6c5f 6e61 6d65 2069 6e20 6578  r col_name in ex
-00000c10: 6365 6c5f 6865 6164 6572 3a0d 0a20 2020  cel_header:..   
-00000c20: 2020 2020 2073 6865 6574 2e77 7269 7465       sheet.write
-00000c30: 2830 2c20 636f 6c5f 6964 782c 2063 6f6c  (0, col_idx, col
-00000c40: 5f6e 616d 6529 0d0a 2020 2020 2020 2020  _name)..        
-00000c50: 636f 6c5f 6964 7820 3d20 636f 6c5f 6964  col_idx = col_id
-00000c60: 782b 310d 0a0d 0a20 2020 2072 6f77 5f69  x+1....    row_i
-00000c70: 6478 203d 2031 0d0a 2020 2020 666f 7220  dx = 1..    for 
-00000c80: 6266 2069 6e20 6261 6e6b 666c 6f77 5f6c  bf in bankflow_l
-00000c90: 6973 743a 0d0a 2020 2020 2020 2020 7368  ist:..        sh
-00000ca0: 6565 742e 7772 6974 6528 726f 775f 6964  eet.write(row_id
-00000cb0: 782c 2030 2c20 6266 2e63 6f6d 7061 6e79  x, 0, bf.company
-00000cc0: 5f6e 616d 6529 0d0a 2020 2020 2020 2020  _name)..        
-00000cd0: 7368 6565 742e 7772 6974 6528 726f 775f  sheet.write(row_
-00000ce0: 6964 782c 2031 2c20 6266 2e62 616e 6b5f  idx, 1, bf.bank_
-00000cf0: 6e61 6d65 290d 0a20 2020 2020 2020 2073  name)..        s
-00000d00: 6865 6574 2e77 7269 7465 2872 6f77 5f69  heet.write(row_i
-00000d10: 6478 2c20 322c 2062 662e 6261 6e6b 5f6e  dx, 2, bf.bank_n
-00000d20: 6f29 0d0a 2020 2020 2020 2020 7368 6565  o)..        shee
-00000d30: 742e 7772 6974 6528 726f 775f 6964 782c  t.write(row_idx,
-00000d40: 2033 2c20 6266 2e74 7261 6e73 5f64 6174   3, bf.trans_dat
-00000d50: 6529 0d0a 2020 2020 2020 2020 7368 6565  e)..        shee
-00000d60: 742e 7772 6974 6528 726f 775f 6964 782c  t.write(row_idx,
-00000d70: 2034 2c20 6266 2e66 6c6f 775f 6e6f 290d   4, bf.flow_no).
-00000d80: 0a20 2020 2020 2020 2073 6865 6574 2e77  .        sheet.w
-00000d90: 7269 7465 2872 6f77 5f69 6478 2c20 352c  rite(row_idx, 5,
-00000da0: 2062 662e 7265 635f 616d 7429 0d0a 2020   bf.rec_amt)..  
-00000db0: 2020 2020 2020 7368 6565 742e 7772 6974        sheet.writ
-00000dc0: 6528 726f 775f 6964 782c 2036 2c20 6266  e(row_idx, 6, bf
-00000dd0: 2e70 6179 5f61 6d74 290d 0a20 2020 2020  .pay_amt)..     
-00000de0: 2020 2073 6865 6574 2e77 7269 7465 2872     sheet.write(r
-00000df0: 6f77 5f69 6478 2c20 372c 2062 662e 6261  ow_idx, 7, bf.ba
-00000e00: 6c61 6e63 6529 0d0a 2020 2020 2020 2020  lance)..        
-00000e10: 7368 6565 742e 7772 6974 6528 726f 775f  sheet.write(row_
-00000e20: 6964 782c 2038 2c20 6266 2e61 6e74 5f6e  idx, 8, bf.ant_n
-00000e30: 616d 6529 0d0a 2020 2020 2020 2020 7368  ame)..        sh
-00000e40: 6565 742e 7772 6974 6528 726f 775f 6964  eet.write(row_id
-00000e50: 782c 2039 2c20 6266 2e61 6e74 5f6e 6f29  x, 9, bf.ant_no)
-00000e60: 0d0a 2020 2020 2020 2020 7368 6565 742e  ..        sheet.
-00000e70: 7772 6974 6528 726f 775f 6964 782c 2031  write(row_idx, 1
-00000e80: 302c 2062 662e 7075 7270 6f73 6529 0d0a  0, bf.purpose)..
-00000e90: 2020 2020 2020 2020 7368 6565 742e 7772          sheet.wr
-00000ea0: 6974 6528 726f 775f 6964 782c 2031 312c  ite(row_idx, 11,
-00000eb0: 2062 662e 7375 6d6d 6172 7929 0d0a 0d0a   bf.summary)....
-00000ec0: 2020 2020 2020 2020 726f 775f 6964 7820          row_idx 
-00000ed0: 3d20 726f 775f 6964 782b 310d 0a0d 0a20  = row_idx+1.... 
-00000ee0: 2020 2078 6c2e 7361 7665 2878 6c5f 7061     xl.save(xl_pa
-00000ef0: 7468 290d 0a20 2020 2072 6574 7572 6e20  th)..    return 
-00000f00: 786c 5f70 6174 680d 0a0d 0a0d 0a64 6566  xl_path......def
-00000f10: 2073 706c 6974 5f70 6466 2870 6466 5f66   split_pdf(pdf_f
-00000f20: 696c 652c 206f 7574 7075 745f 6469 723d  ile, output_dir=
-00000f30: 4e6f 6e65 293a 0d0a 2020 2020 665f 6e61  None):..    f_na
-00000f40: 6d65 203d 206f 732e 7061 7468 2e62 6173  me = os.path.bas
-00000f50: 656e 616d 6528 7064 665f 6669 6c65 290d  ename(pdf_file).
-00000f60: 0a20 2020 2069 6620 6f75 7470 7574 5f64  .    if output_d
-00000f70: 6972 2069 7320 4e6f 6e65 3a0d 0a20 2020  ir is None:..   
-00000f80: 2020 2020 206f 7574 7075 745f 6469 7220       output_dir 
-00000f90: 3d20 6f73 2e70 6174 682e 6a6f 696e 286f  = os.path.join(o
-00000fa0: 732e 7061 7468 2e64 6972 6e61 6d65 2870  s.path.dirname(p
-00000fb0: 6466 5f66 696c 6529 2c20 2273 7562 7064  df_file), "subpd
-00000fc0: 6622 290d 0a0d 0a20 2020 2070 6466 7320  f")....    pdfs 
-00000fd0: 3d20 5b5d 0d0a 2020 2020 7472 793a 0d0a  = []..    try:..
-00000fe0: 2020 2020 2020 2020 6966 206f 732e 7061          if os.pa
-00000ff0: 7468 2e65 7869 7374 7328 6f75 7470 7574  th.exists(output
-00001000: 5f64 6972 2920 3d3d 2046 616c 7365 3a0d  _dir) == False:.
-00001010: 0a20 2020 2020 2020 2020 2020 206f 732e  .            os.
-00001020: 6d6b 6469 7228 6f75 7470 7574 5f64 6972  mkdir(output_dir
-00001030: 290d 0a20 2020 2020 2020 2072 6561 6465  )..        reade
-00001040: 7220 3d20 5064 6652 6561 6465 7228 7064  r = PdfReader(pd
-00001050: 665f 6669 6c65 290d 0a20 2020 2020 2020  f_file)..       
-00001060: 2066 6f72 2069 6e64 6578 2069 6e20 7261   for index in ra
-00001070: 6e67 6528 6c65 6e28 7265 6164 6572 2e70  nge(len(reader.p
-00001080: 6167 6573 2929 3a0d 0a20 2020 2020 2020  ages)):..       
-00001090: 2020 2020 2077 7269 7465 7220 3d20 5064       writer = Pd
-000010a0: 6657 7269 7465 7228 290d 0a20 2020 2020  fWriter()..     
-000010b0: 2020 2020 2020 2070 6167 654f 626a 203d         pageObj =
-000010c0: 2072 6561 6465 722e 7061 6765 735b 696e   reader.pages[in
-000010d0: 6465 785d 0d0a 2020 2020 2020 2020 2020  dex]..          
-000010e0: 2020 7772 6974 6572 2e61 6464 5f70 6167    writer.add_pag
-000010f0: 6528 7061 6765 4f62 6a29 0d0a 2020 2020  e(pageObj)..    
-00001100: 2020 2020 2020 2020 6e65 7770 6174 6820          newpath 
-00001110: 3d20 6f73 2e70 6174 682e 6a6f 696e 286f  = os.path.join(o
-00001120: 7574 7075 745f 6469 722c 2066 227b 696e  utput_dir, f"{in
-00001130: 6465 787d 5f7b 665f 6e61 6d65 7d22 290d  dex}_{f_name}").
-00001140: 0a20 2020 2020 2020 2020 2020 2077 6974  .            wit
-00001150: 6820 6f70 656e 286e 6577 7061 7468 2c20  h open(newpath, 
-00001160: 2777 6227 2920 6173 2066 773a 0d0a 2020  'wb') as fw:..  
-00001170: 2020 2020 2020 2020 2020 2020 2020 7772                wr
-00001180: 6974 6572 2e77 7269 7465 2866 7729 0d0a  iter.write(fw)..
-00001190: 0d0a 2020 2020 2020 2020 2020 2020 7064  ..            pd
-000011a0: 6673 2e61 7070 656e 6428 6e65 7770 6174  fs.append(newpat
-000011b0: 6829 0d0a 2020 2020 6578 6365 7074 2045  h)..    except E
-000011c0: 7863 6570 7469 6f6e 2061 7320 653a 0d0a  xception as e:..
-000011d0: 2020 2020 2020 2020 7072 696e 7428 6529          print(e)
-000011e0: 0d0a 0d0a 2020 2020 7265 7475 726e 2070  ....    return p
-000011f0: 6466 730d 0a0d 0a69 6620 5f5f 6e61 6d65  dfs....if __name
-00001200: 5f5f 3d3d 225f 5f6d 6169 6e5f 5f22 3a0d  __=="__main__":.
-00001210: 0a20 2020 2066 733d 7370 6c69 745f 7064  .    fs=split_pd
-00001220: 6628 7222 443a 5c4f 7579 655c 3132 e5ae  f(r"D:\Ouye\12..
-00001230: b6e9 93b6 e8a1 8ce6 b581 e6b0 b4e5 9b9e  ................
-00001240: e58d 955c e6b5 99e5 9586 e993 b6e8 a18c  ...\............
-00001250: 5ce6 aca7 e586 b6e5 9586 e4b8 9ae4 bf9d  \...............
-00001260: e790 86e6 9c89 e999 90e8 b4a3 e4bb bbe5  ................
-00001270: 85ac e58f b85c 3230 3232 3131 3037 5c48  .....\20221107\H
-00001280: 2032 3930 3030 3030 3030 3031 3231 3830   290000000012180
-00001290: 3030 3439 3632 3520 3230 3232 3131 3031  0049625 20221101
-000012a0: 7e32 3032 3231 3130 372e 7064 6622 290d  ~20221107.pdf").
-000012b0: 0a20 2020 2066 6f72 2066 2069 6e20 6673  .    for f in fs
-000012c0: 3a0d 0a20 2020 2020 2020 2070 7269 6e74  :..        print
-000012d0: 2866 290d 0a                             (f)..
+00000000: 0d0a 696d 706f 7274 2062 6173 6536 340d  ..import base64.
+00000010: 0a69 6d70 6f72 7420 6f73 0d0a 696d 706f  .import os..impo
+00000020: 7274 2072 650d 0a69 6d70 6f72 7420 7572  rt re..import ur
+00000030: 6c6c 6962 0d0a 0d0a 696d 706f 7274 2078  llib....import x
+00000040: 6c72 640d 0a69 6d70 6f72 7420 786c 7774  lrd..import xlwt
+00000050: 0d0a 6672 6f6d 2064 6174 6575 7469 6c2e  ..from dateutil.
+00000060: 7061 7273 6572 2069 6d70 6f72 7420 7061  parser import pa
+00000070: 7273 6572 0d0a 6672 6f6d 2070 7970 6466  rser..from pypdf
+00000080: 2069 6d70 6f72 7420 5064 6652 6561 6465   import PdfReade
+00000090: 722c 2050 6466 5772 6974 6572 0d0a 0d0a  r, PdfWriter....
+000000a0: 0d0a 6465 6620 666d 745f 616d 7428 616d  ..def fmt_amt(am
+000000b0: 745f 7374 723d 22e4 baba e6b0 91e5 b881  t_str=".........
+000000c0: efbc 88e5 a4a7 e586 99ef bc89 efbc 9a20  ............... 
+000000d0: e882 86e4 bb9f e4b8 87e5 8583 e695 b420  ............... 
+000000e0: efbf a520 3430 2c30 3030 2c30 3030 2e30  ... 40,000,000.0
+000000f0: 30e5 8583 2229 3a0d 0a20 2020 2072 6567  0..."):..    reg
+00000100: 6578 203d 2072 2228 5b5c 647c 2c7c 2e5d  ex = r"([\d|,|.]
+00000110: 292b 220d 0a20 2020 206d 6174 6368 6573  )+"..    matches
+00000120: 203d 2072 652e 6669 6e64 6974 6572 2872   = re.finditer(r
+00000130: 6567 6578 2c20 7374 7228 616d 745f 7374  egex, str(amt_st
+00000140: 7229 290d 0a20 2020 206d 6174 6368 5f74  r))..    match_t
+00000150: 6578 7420 3d20 2222 0d0a 2020 2020 666f  ext = ""..    fo
+00000160: 7220 6d61 7463 684e 756d 2c20 6d61 7463  r matchNum, matc
+00000170: 6820 696e 2065 6e75 6d65 7261 7465 286d  h in enumerate(m
+00000180: 6174 6368 6573 2c20 7374 6172 743d 3129  atches, start=1)
+00000190: 3a0d 0a20 2020 2020 2020 206d 6174 6368  :..        match
+000001a0: 5f74 6578 7420 3d20 6d61 7463 682e 6772  _text = match.gr
+000001b0: 6f75 7028 290d 0a20 2020 2072 6574 7572  oup()..    retur
+000001c0: 6e20 6d61 7463 685f 7465 7874 2e72 6570  n match_text.rep
+000001d0: 6c61 6365 2822 2c22 2c20 2222 290d 0a0d  lace(",", "")...
+000001e0: 0a0d 0a64 6566 2066 6d74 5f74 7261 6e73  ...def fmt_trans
+000001f0: 5f64 6174 6528 7472 616e 735f 6461 7465  _date(trans_date
+00000200: 3d22 3230 3232 2d30 392d 3233 2031 313a  ="2022-09-23 11:
+00000210: 3431 3a33 3022 293a 0d0a 2020 2020 7472  41:30"):..    tr
+00000220: 793a 0d0a 2020 2020 2020 2020 6966 2028  y:..        if (
+00000230: 6973 696e 7374 616e 6365 2874 7261 6e73  isinstance(trans
+00000240: 5f64 6174 652c 2066 6c6f 6174 2929 3a0d  _date, float)):.
+00000250: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00000260: 7572 6e20 786c 7264 2e78 6c64 6174 655f  urn xlrd.xldate_
+00000270: 6173 5f64 6174 6574 696d 6528 0d0a 2020  as_datetime(..  
+00000280: 2020 2020 2020 2020 2020 2020 2020 7472                tr
+00000290: 616e 735f 6461 7465 2c20 3029 2e73 7472  ans_date, 0).str
+000002a0: 6674 696d 6528 2225 592d 256d 2d25 6422  ftime("%Y-%m-%d"
+000002b0: 290d 0a20 2020 2020 2020 2065 6c73 653a  )..        else:
+000002c0: 0d0a 2020 2020 2020 2020 2020 2020 6e65  ..            ne
+000002d0: 775f 6461 7465 203d 2074 7261 6e73 5f64  w_date = trans_d
+000002e0: 6174 652e 7265 706c 6163 6528 0d0a 2020  ate.replace(..  
+000002f0: 2020 2020 2020 2020 2020 2020 2020 22e5                ".
+00000300: b9b4 222c 2022 2d22 292e 7265 706c 6163  ..", "-").replac
+00000310: 6528 22e6 9c88 222c 2022 2d22 292e 7265  e("...", "-").re
+00000320: 706c 6163 6528 22e6 97a5 222c 2022 2022  place("...", " "
+00000330: 292e 7265 706c 6163 6528 22e6 97b6 222c  ).replace("...",
+00000340: 2022 3a22 292e 7265 706c 6163 6528 22e5   ":").replace(".
+00000350: 8886 222c 2022 3a22 292e 7265 706c 6163  ..", ":").replac
+00000360: 6528 22e7 a792 222c 2022 2229 0d0a 2020  e("...", "")..  
+00000370: 2020 2020 2020 7265 7475 726e 2070 6172        return par
+00000380: 7365 7228 292e 7061 7273 6528 6e65 775f  ser().parse(new_
+00000390: 6461 7465 292e 7374 7266 7469 6d65 2822  date).strftime("
+000003a0: 2559 2d25 6d2d 2564 2229 0d0a 2020 2020  %Y-%m-%d")..    
+000003b0: 6578 6365 7074 3a0d 0a20 2020 2020 2020  except:..       
+000003c0: 2072 6574 7572 6e20 7472 616e 735f 6461   return trans_da
+000003d0: 7465 0d0a 0d0a 0d0a 6465 6620 6765 745f  te......def get_
+000003e0: 6375 726e 6f28 6669 6c65 5f6e 616d 6529  curno(file_name)
+000003f0: 3a0d 0a20 2020 2072 6567 6578 203d 2072  :..    regex = r
+00000400: 2228 3f3c 3d48 295c 642a 220d 0a20 2020  "(?<=H)\d*"..   
+00000410: 2066 696e 6473 203d 2072 652e 6669 6e64   finds = re.find
+00000420: 616c 6c28 7265 6765 782c 2066 696c 655f  all(regex, file_
+00000430: 6e61 6d65 290d 0a20 2020 2069 6620 6c65  name)..    if le
+00000440: 6e28 6669 6e64 7329 203e 2030 3a0d 0a20  n(finds) > 0:.. 
+00000450: 2020 2020 2020 2072 6574 7572 6e20 6669         return fi
+00000460: 6e64 735b 305d 0d0a 2020 2020 656c 7365  nds[0]..    else
+00000470: 3a0d 0a20 2020 2020 2020 2072 6574 7572  :..        retur
+00000480: 6e20 2222 0d0a 0d0a 0d0a 6465 6620 7265  n ""......def re
+00000490: 6164 5f78 6c28 786c 5f70 6174 682c 2073  ad_xl(xl_path, s
+000004a0: 6865 6574 5f69 6478 3d30 293a 0d0a 2020  heet_idx=0):..  
+000004b0: 2020 786c 7320 3d20 786c 7264 2e6f 7065    xls = xlrd.ope
+000004c0: 6e5f 776f 726b 626f 6f6b 2878 6c5f 7061  n_workbook(xl_pa
+000004d0: 7468 2c20 666f 726d 6174 7469 6e67 5f69  th, formatting_i
+000004e0: 6e66 6f3d 5472 7565 290d 0a20 2020 2073  nfo=True)..    s
+000004f0: 6865 6574 203d 2078 6c73 2e73 6865 6574  heet = xls.sheet
+00000500: 5f62 795f 696e 6465 7828 7368 6565 745f  _by_index(sheet_
+00000510: 6964 7829 0d0a 2020 2020 7265 7475 726e  idx)..    return
+00000520: 2073 6865 6574 0d0a 0d0a 0d0a 6465 6620   sheet......def 
+00000530: 7774 5f72 6374 5f65 7863 656c 2878 6c5f  wt_rct_excel(xl_
+00000540: 7061 7468 2c20 7263 745f 6c69 7374 2920  path, rct_list) 
+00000550: 2d3e 2073 7472 3a0d 0a0d 0a20 2020 2065  -> str:....    e
+00000560: 7863 656c 5f68 6561 6465 7220 3d20 5b22  xcel_header = ["
+00000570: e59b 9ee5 8d95 e6b5 81e6 b0b4 e58f b722  ..............."
+00000580: 2c20 22e6 8891 e696 b9e5 85ac e58f b8e5  , ".............
+00000590: 908d e7a7 b022 2c20 22e9 93b6 e8a1 8ce5  .....", ".......
+000005a0: 908d e7a7 b022 2c20 22e6 9cac e696 b9e9  .....", ".......
+000005b0: 93b6 e8a1 8ce8 b4a6 e58f b722 2c20 22e6  ...........", ".
+000005c0: 97a5 e69c 9f22 2c0d 0a20 2020 2020 2020  .....",..       
+000005d0: 2020 2020 2020 2020 2020 2020 2022 e694               "..
+000005e0: b6e5 85a5 e987 91e9 a29d 222c 2022 e694  ..........", "..
+000005f0: afe5 87ba e987 91e9 a29d 222c 2022 e4bd  ..........", "..
+00000600: 99e9 a29d 222c 2022 e5af b9e6 96b9 e688  ....", "........
+00000610: b7e5 908d 222c 2022 e5af b9e6 96b9 e8b4  ....", "........
+00000620: a6e5 8fb7 222c 2022 e794 a8e9 8094 222c  ....", "......",
+00000630: 2022 e691 98e8 a681 222c 2022 e59b 9ee5   "......", "....
+00000640: 8d95 e8b7 afe5 be84 225d 0d0a 0d0a 2020  ........"]....  
+00000650: 2020 786c 203d 2078 6c77 742e 576f 726b    xl = xlwt.Work
+00000660: 626f 6f6b 2865 6e63 6f64 696e 673d 2275  book(encoding="u
+00000670: 6674 2d38 2229 0d0a 2020 2020 7368 6565  ft-8")..    shee
+00000680: 7420 3d20 786c 2e61 6464 5f73 6865 6574  t = xl.add_sheet
+00000690: 2822 7368 6565 7431 222c 2063 656c 6c5f  ("sheet1", cell_
+000006a0: 6f76 6572 7772 6974 655f 6f6b 3d46 616c  overwrite_ok=Fal
+000006b0: 7365 290d 0a0d 0a20 2020 2063 6f6c 5f69  se)....    col_i
+000006c0: 6478 203d 2030 0d0a 2020 2020 666f 7220  dx = 0..    for 
+000006d0: 636f 6c5f 6e61 6d65 2069 6e20 6578 6365  col_name in exce
+000006e0: 6c5f 6865 6164 6572 3a0d 0a20 2020 2020  l_header:..     
+000006f0: 2020 2073 6865 6574 2e77 7269 7465 2830     sheet.write(0
+00000700: 2c20 636f 6c5f 6964 782c 2063 6f6c 5f6e  , col_idx, col_n
+00000710: 616d 6529 0d0a 2020 2020 2020 2020 636f  ame)..        co
+00000720: 6c5f 6964 7820 3d20 636f 6c5f 6964 782b  l_idx = col_idx+
+00000730: 310d 0a0d 0a20 2020 2072 6f77 5f69 6478  1....    row_idx
+00000740: 203d 2031 0d0a 2020 2020 666f 7220 7263   = 1..    for rc
+00000750: 7420 696e 2072 6374 5f6c 6973 743a 0d0a  t in rct_list:..
+00000760: 2020 2020 2020 2020 7368 6565 742e 7772          sheet.wr
+00000770: 6974 6528 726f 775f 6964 782c 2030 2c20  ite(row_idx, 0, 
+00000780: 7263 742e 666c 6f77 5f6e 6f29 2020 2320  rct.flow_no)  # 
+00000790: e6b5 81e6 b0b4 e58f b70d 0a20 2020 2020  ...........     
+000007a0: 2020 2073 6865 6574 2e77 7269 7465 2872     sheet.write(r
+000007b0: 6f77 5f69 6478 2c20 312c 2072 6374 2e63  ow_idx, 1, rct.c
+000007c0: 6f6d 7061 6e79 5f6e 616d 6529 0d0a 2020  ompany_name)..  
+000007d0: 2020 2020 2020 7368 6565 742e 7772 6974        sheet.writ
+000007e0: 6528 726f 775f 6964 782c 2032 2c20 7263  e(row_idx, 2, rc
+000007f0: 742e 6261 6e6b 5f6e 616d 6529 0d0a 2020  t.bank_name)..  
+00000800: 2020 2020 2020 7368 6565 742e 7772 6974        sheet.writ
+00000810: 6528 726f 775f 6964 782c 2033 2c20 7263  e(row_idx, 3, rc
+00000820: 742e 6375 725f 6e6f 290d 0a20 2020 2020  t.cur_no)..     
+00000830: 2020 2073 6865 6574 2e77 7269 7465 2872     sheet.write(r
+00000840: 6f77 5f69 6478 2c20 342c 2072 6374 2e74  ow_idx, 4, rct.t
+00000850: 7261 6e73 5f64 6174 6529 0d0a 2020 2020  rans_date)..    
+00000860: 2020 2020 7368 6565 742e 7772 6974 6528      sheet.write(
+00000870: 726f 775f 6964 782c 2035 2c20 7263 742e  row_idx, 5, rct.
+00000880: 7265 635f 616d 7429 0d0a 2020 2020 2020  rec_amt)..      
+00000890: 2020 7368 6565 742e 7772 6974 6528 726f    sheet.write(ro
+000008a0: 775f 6964 782c 2036 2c20 7263 742e 7061  w_idx, 6, rct.pa
+000008b0: 795f 616d 7429 0d0a 2020 2020 2020 2020  y_amt)..        
+000008c0: 7368 6565 742e 7772 6974 6528 726f 775f  sheet.write(row_
+000008d0: 6964 782c 2038 2c20 7263 742e 616e 745f  idx, 8, rct.ant_
+000008e0: 6e61 6d65 290d 0a20 2020 2020 2020 2073  name)..        s
+000008f0: 6865 6574 2e77 7269 7465 2872 6f77 5f69  heet.write(row_i
+00000900: 6478 2c20 392c 2072 6374 2e61 6e74 5f6e  dx, 9, rct.ant_n
+00000910: 6f29 0d0a 2020 2020 2020 2020 7368 6565  o)..        shee
+00000920: 742e 7772 6974 6528 726f 775f 6964 782c  t.write(row_idx,
+00000930: 2031 322c 2072 6374 2e66 696c 655f 7061   12, rct.file_pa
+00000940: 7468 290d 0a0d 0a20 2020 2020 2020 2072  th)....        r
+00000950: 6f77 5f69 6478 203d 2072 6f77 5f69 6478  ow_idx = row_idx
+00000960: 2b31 0d0a 0d0a 2020 2020 786c 2e73 6176  +1....    xl.sav
+00000970: 6528 786c 5f70 6174 6829 0d0a 2020 2020  e(xl_path)..    
+00000980: 7265 7475 726e 2078 6c5f 7061 7468 0d0a  return xl_path..
+00000990: 0d0a 0d0a 6465 6620 7774 5f62 616e 6b66  ....def wt_bankf
+000009a0: 6c6f 775f 6578 6365 6c28 786c 5f70 6174  low_excel(xl_pat
+000009b0: 682c 2062 616e 6b66 6c6f 775f 6c69 7374  h, bankflow_list
+000009c0: 2920 2d3e 2073 7472 3a0d 0a0d 0a20 2020  ) -> str:....   
+000009d0: 2065 7863 656c 5f68 6561 6465 7220 3d20   excel_header = 
+000009e0: 5b22 e585 ace5 8fb8 e590 8de7 a7b0 222c  ["............",
+000009f0: 2022 e993 b6e8 a18c e590 8de7 a7b0 222c   "............",
+00000a00: 2022 e69c ace6 96b9 e993 b6e8 a18c e8b4   "..............
+00000a10: a6e5 8fb7 222c 2022 e697 a5e6 9c9f 222c  ....", "......",
+00000a20: 2022 e6b5 81e6 b0b4 e58f b722 2c0d 0a20   ".........",.. 
+00000a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000a40: 2020 2022 e694 b6e5 85a5 e987 91e9 a29d     "............
+00000a50: 222c 2022 e694 afe5 87ba e987 91e9 a29d  ", "............
+00000a60: 222c 2022 e4bd 99e9 a29d 222c 2022 e5af  ", "......", "..
+00000a70: b9e6 96b9 e688 b7e5 908d 222c 2022 e5af  ..........", "..
+00000a80: b9e6 96b9 e8b4 a6e5 8fb7 222c 2022 e794  ..........", "..
+00000a90: a8e9 8094 222c 0d0a 2020 2020 2020 2020  ....",..        
+00000aa0: 2020 2020 2020 2020 2020 2020 22e6 9198              "...
+00000ab0: e8a6 8122 2c20 22e7 94b5 e5ad 90e5 9b9e  ...", ".........
+00000ac0: e58d 9522 2c20 22e6 9c8d e58a a1e5 99a8  ...", ".........
+00000ad0: e59b 9ee5 8d95 e8b7 afe5 be84 222c 2022  ............", "
+00000ae0: 5372 7655 5549 4422 5d0d 0a0d 0a20 2020  SrvUUID"]....   
+00000af0: 2078 6c20 3d20 786c 7774 2e57 6f72 6b62   xl = xlwt.Workb
+00000b00: 6f6f 6b28 656e 636f 6469 6e67 3d22 7566  ook(encoding="uf
+00000b10: 742d 3822 290d 0a20 2020 2073 6865 6574  t-8")..    sheet
+00000b20: 203d 2078 6c2e 6164 645f 7368 6565 7428   = xl.add_sheet(
+00000b30: 2273 6865 6574 3122 2c20 6365 6c6c 5f6f  "sheet1", cell_o
+00000b40: 7665 7277 7269 7465 5f6f 6b3d 4661 6c73  verwrite_ok=Fals
+00000b50: 6529 0d0a 0d0a 2020 2020 636f 6c5f 6964  e)....    col_id
+00000b60: 7820 3d20 300d 0a20 2020 2066 6f72 2063  x = 0..    for c
+00000b70: 6f6c 5f6e 616d 6520 696e 2065 7863 656c  ol_name in excel
+00000b80: 5f68 6561 6465 723a 0d0a 2020 2020 2020  _header:..      
+00000b90: 2020 7368 6565 742e 7772 6974 6528 302c    sheet.write(0,
+00000ba0: 2063 6f6c 5f69 6478 2c20 636f 6c5f 6e61   col_idx, col_na
+00000bb0: 6d65 290d 0a20 2020 2020 2020 2063 6f6c  me)..        col
+00000bc0: 5f69 6478 203d 2063 6f6c 5f69 6478 2b31  _idx = col_idx+1
+00000bd0: 0d0a 0d0a 2020 2020 726f 775f 6964 7820  ....    row_idx 
+00000be0: 3d20 310d 0a20 2020 2066 6f72 2062 6620  = 1..    for bf 
+00000bf0: 696e 2062 616e 6b66 6c6f 775f 6c69 7374  in bankflow_list
+00000c00: 3a0d 0a20 2020 2020 2020 2073 6865 6574  :..        sheet
+00000c10: 2e77 7269 7465 2872 6f77 5f69 6478 2c20  .write(row_idx, 
+00000c20: 302c 2062 662e 636f 6d70 616e 795f 6e61  0, bf.company_na
+00000c30: 6d65 290d 0a20 2020 2020 2020 2073 6865  me)..        she
+00000c40: 6574 2e77 7269 7465 2872 6f77 5f69 6478  et.write(row_idx
+00000c50: 2c20 312c 2062 662e 6261 6e6b 5f6e 616d  , 1, bf.bank_nam
+00000c60: 6529 0d0a 2020 2020 2020 2020 7368 6565  e)..        shee
+00000c70: 742e 7772 6974 6528 726f 775f 6964 782c  t.write(row_idx,
+00000c80: 2032 2c20 6266 2e62 616e 6b5f 6e6f 290d   2, bf.bank_no).
+00000c90: 0a20 2020 2020 2020 2073 6865 6574 2e77  .        sheet.w
+00000ca0: 7269 7465 2872 6f77 5f69 6478 2c20 332c  rite(row_idx, 3,
+00000cb0: 2062 662e 7472 616e 735f 6461 7465 290d   bf.trans_date).
+00000cc0: 0a20 2020 2020 2020 2073 6865 6574 2e77  .        sheet.w
+00000cd0: 7269 7465 2872 6f77 5f69 6478 2c20 342c  rite(row_idx, 4,
+00000ce0: 2062 662e 666c 6f77 5f6e 6f29 0d0a 2020   bf.flow_no)..  
+00000cf0: 2020 2020 2020 7368 6565 742e 7772 6974        sheet.writ
+00000d00: 6528 726f 775f 6964 782c 2035 2c20 6266  e(row_idx, 5, bf
+00000d10: 2e72 6563 5f61 6d74 290d 0a20 2020 2020  .rec_amt)..     
+00000d20: 2020 2073 6865 6574 2e77 7269 7465 2872     sheet.write(r
+00000d30: 6f77 5f69 6478 2c20 362c 2062 662e 7061  ow_idx, 6, bf.pa
+00000d40: 795f 616d 7429 0d0a 2020 2020 2020 2020  y_amt)..        
+00000d50: 7368 6565 742e 7772 6974 6528 726f 775f  sheet.write(row_
+00000d60: 6964 782c 2037 2c20 6266 2e62 616c 616e  idx, 7, bf.balan
+00000d70: 6365 290d 0a20 2020 2020 2020 2073 6865  ce)..        she
+00000d80: 6574 2e77 7269 7465 2872 6f77 5f69 6478  et.write(row_idx
+00000d90: 2c20 382c 2062 662e 616e 745f 6e61 6d65  , 8, bf.ant_name
+00000da0: 290d 0a20 2020 2020 2020 2073 6865 6574  )..        sheet
+00000db0: 2e77 7269 7465 2872 6f77 5f69 6478 2c20  .write(row_idx, 
+00000dc0: 392c 2062 662e 616e 745f 6e6f 290d 0a20  9, bf.ant_no).. 
+00000dd0: 2020 2020 2020 2073 6865 6574 2e77 7269         sheet.wri
+00000de0: 7465 2872 6f77 5f69 6478 2c20 3130 2c20  te(row_idx, 10, 
+00000df0: 6266 2e70 7572 706f 7365 290d 0a20 2020  bf.purpose)..   
+00000e00: 2020 2020 2073 6865 6574 2e77 7269 7465       sheet.write
+00000e10: 2872 6f77 5f69 6478 2c20 3131 2c20 6266  (row_idx, 11, bf
+00000e20: 2e73 756d 6d61 7279 290d 0a0d 0a20 2020  .summary)....   
+00000e30: 2020 2020 2072 6f77 5f69 6478 203d 2072       row_idx = r
+00000e40: 6f77 5f69 6478 2b31 0d0a 0d0a 2020 2020  ow_idx+1....    
+00000e50: 786c 2e73 6176 6528 786c 5f70 6174 6829  xl.save(xl_path)
+00000e60: 0d0a 2020 2020 7265 7475 726e 2078 6c5f  ..    return xl_
+00000e70: 7061 7468 0d0a 0d0a 0d0a 6465 6620 7370  path......def sp
+00000e80: 6c69 745f 7064 6628 7064 665f 6669 6c65  lit_pdf(pdf_file
+00000e90: 2c20 6f75 7470 7574 5f64 6972 3d4e 6f6e  , output_dir=Non
+00000ea0: 6529 3a0d 0a20 2020 2066 5f6e 616d 6520  e):..    f_name 
+00000eb0: 3d20 6f73 2e70 6174 682e 6261 7365 6e61  = os.path.basena
+00000ec0: 6d65 2870 6466 5f66 696c 6529 0d0a 2020  me(pdf_file)..  
+00000ed0: 2020 6966 206f 7574 7075 745f 6469 7220    if output_dir 
+00000ee0: 6973 204e 6f6e 653a 0d0a 2020 2020 2020  is None:..      
+00000ef0: 2020 6f75 7470 7574 5f64 6972 203d 206f    output_dir = o
+00000f00: 732e 7061 7468 2e6a 6f69 6e28 6f73 2e70  s.path.join(os.p
+00000f10: 6174 682e 6469 726e 616d 6528 7064 665f  ath.dirname(pdf_
+00000f20: 6669 6c65 292c 2022 7375 6270 6466 2229  file), "subpdf")
+00000f30: 0d0a 0d0a 2020 2020 7064 6673 203d 205b  ....    pdfs = [
+00000f40: 5d0d 0a20 2020 2074 7279 3a0d 0a20 2020  ]..    try:..   
+00000f50: 2020 2020 2069 6620 6f73 2e70 6174 682e       if os.path.
+00000f60: 6578 6973 7473 286f 7574 7075 745f 6469  exists(output_di
+00000f70: 7229 203d 3d20 4661 6c73 653a 0d0a 2020  r) == False:..  
+00000f80: 2020 2020 2020 2020 2020 6f73 2e6d 6b64            os.mkd
+00000f90: 6972 286f 7574 7075 745f 6469 7229 0d0a  ir(output_dir)..
+00000fa0: 2020 2020 2020 2020 7265 6164 6572 203d          reader =
+00000fb0: 2050 6466 5265 6164 6572 2870 6466 5f66   PdfReader(pdf_f
+00000fc0: 696c 6529 0d0a 2020 2020 2020 2020 666f  ile)..        fo
+00000fd0: 7220 696e 6465 7820 696e 2072 616e 6765  r index in range
+00000fe0: 286c 656e 2872 6561 6465 722e 7061 6765  (len(reader.page
+00000ff0: 7329 293a 0d0a 2020 2020 2020 2020 2020  s)):..          
+00001000: 2020 7772 6974 6572 203d 2050 6466 5772    writer = PdfWr
+00001010: 6974 6572 2829 0d0a 2020 2020 2020 2020  iter()..        
+00001020: 2020 2020 7061 6765 4f62 6a20 3d20 7265      pageObj = re
+00001030: 6164 6572 2e70 6167 6573 5b69 6e64 6578  ader.pages[index
+00001040: 5d0d 0a20 2020 2020 2020 2020 2020 2077  ]..            w
+00001050: 7269 7465 722e 6164 645f 7061 6765 2870  riter.add_page(p
+00001060: 6167 654f 626a 290d 0a20 2020 2020 2020  ageObj)..       
+00001070: 2020 2020 206e 6577 7061 7468 203d 206f       newpath = o
+00001080: 732e 7061 7468 2e6a 6f69 6e28 6f75 7470  s.path.join(outp
+00001090: 7574 5f64 6972 2c20 6622 7b69 6e64 6578  ut_dir, f"{index
+000010a0: 7d5f 7b66 5f6e 616d 657d 2229 0d0a 2020  }_{f_name}")..  
+000010b0: 2020 2020 2020 2020 2020 7769 7468 206f            with o
+000010c0: 7065 6e28 6e65 7770 6174 682c 2027 7762  pen(newpath, 'wb
+000010d0: 2729 2061 7320 6677 3a0d 0a20 2020 2020  ') as fw:..     
+000010e0: 2020 2020 2020 2020 2020 2077 7269 7465             write
+000010f0: 722e 7772 6974 6528 6677 290d 0a0d 0a20  r.write(fw).... 
+00001100: 2020 2020 2020 2020 2020 2070 6466 732e             pdfs.
+00001110: 6170 7065 6e64 286e 6577 7061 7468 290d  append(newpath).
+00001120: 0a20 2020 2065 7863 6570 7420 4578 6365  .    except Exce
+00001130: 7074 696f 6e20 6173 2065 3a0d 0a20 2020  ption as e:..   
+00001140: 2020 2020 2070 7269 6e74 2865 290d 0a0d       print(e)...
+00001150: 0a20 2020 2072 6574 7572 6e20 7064 6673  .    return pdfs
+00001160: 0d0a 0d0a 0d0a 6465 6620 6765 745f 6669  ......def get_fi
+00001170: 6c65 5f63 6f6e 7465 6e74 5f61 735f 6261  le_content_as_ba
+00001180: 7365 3634 2870 6174 682c 2075 726c 656e  se64(path, urlen
+00001190: 636f 6465 643d 4661 6c73 6529 3a0d 0a20  coded=False):.. 
+000011a0: 2020 2077 6974 6820 6f70 656e 2870 6174     with open(pat
+000011b0: 682c 2022 7262 2229 2061 7320 663a 0d0a  h, "rb") as f:..
+000011c0: 2020 2020 2020 2020 636f 6e74 656e 7420          content 
+000011d0: 3d20 6261 7365 3634 2e62 3634 656e 636f  = base64.b64enco
+000011e0: 6465 2866 2e72 6561 6428 2929 2e64 6563  de(f.read()).dec
+000011f0: 6f64 6528 2275 7466 3822 290d 0a20 2020  ode("utf8")..   
+00001200: 2020 2020 2069 6620 7572 6c65 6e63 6f64       if urlencod
+00001210: 6564 3a0d 0a20 2020 2020 2020 2020 2020  ed:..           
+00001220: 2063 6f6e 7465 6e74 203d 2075 726c 6c69   content = urlli
+00001230: 622e 7061 7273 652e 7175 6f74 655f 706c  b.parse.quote_pl
+00001240: 7573 2863 6f6e 7465 6e74 290d 0a20 2020  us(content)..   
+00001250: 2072 6574 7572 6e20 636f 6e74 656e 740d   return content.
+00001260: 0a0d 0a0d 0a69 6620 5f5f 6e61 6d65 5f5f  .....if __name__
+00001270: 203d 3d20 225f 5f6d 6169 6e5f 5f22 3a0d   == "__main__":.
+00001280: 0a20 2020 206b 7620 3d20 7b22 6b22 3a20  .    kv = {"k": 
+00001290: 2276 227d 0d0a 2020 2020 7072 696e 7428  "v"}..    print(
+000012a0: 6b76 2e67 6574 2822 6b22 2929 0d0a 2020  kv.get("k"))..  
+000012b0: 2020 7072 696e 7428 6b76 2e67 6574 2822    print(kv.get("
+000012c0: 6b73 7322 2c20 2273 7322 2929 0d0a       kss", "ss"))..
```

### Comparing `ebanktool-0.0.2/utils/ocr.py` & `ebanktool-1.0.2/utils/baiduocr.py`

 * *Files 27% similar despite different names*

```diff
@@ -1,28 +1,29 @@
 import base64
 import json
-import urllib
 
 import requests
 from encoo.logger import Logger
 
+import sfun as util
+
 
 class BaiduOCR:
 
     __logger = Logger("BaiduOCR")
 
     def __init__(self) -> None:
         pass
 
     def ocr_table(self, file_path):
 
         url = "https://aip.baidubce.com/rest/2.0/ocr/v1/table?access_token=" + \
             self.get_access_token()
 
-        payload = f"pdf_file={BaiduOCR.get_file_content_as_base64(file_path, True)}"
+        payload = f"pdf_file={util.get_file_content_as_base64(file_path, True)}"
         headers = {
             'Content-Type': 'application/x-www-form-urlencoded',
             'Accept': 'application/json'
         }
         ocr_tables = []
 
         try:
@@ -47,22 +48,14 @@
                 ocr_t[k] = v
             # end for
             ocr_tables.append(ocr_t)
         self.__logger.debug(f"BaiduOCR ocr_tables {ocr_tables}")
 
         return ocr_tables
 
-    @staticmethod
-    def get_file_content_as_base64(path, urlencoded=False):
-        with open(path, "rb") as f:
-            content = base64.b64encode(f.read()).decode("utf8")
-            if urlencoded:
-                content = urllib.parse.quote_plus(content)
-        return content
-
     def get_access_token(self):
         API_KEY = "WYz5wiwt1PoWQkBqlG2EIGIG-"
         SECRET_KEY = "chYQKg2vkn9eTdB5h80GgKSzjwCnmxat"
 
         url = "https://aip.baidubce.com/oauth/2.0/token"
         params = {"grant_type": "client_credentials",
                   "client_id": API_KEY, "client_secret": SECRET_KEY}
```

