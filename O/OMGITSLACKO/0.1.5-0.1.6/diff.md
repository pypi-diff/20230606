# Comparing `tmp/OMGITSLACKO-0.1.5.tar.gz` & `tmp/OMGITSLACKO-0.1.6.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "OMGITSLACKO-0.1.5.tar", last modified: Mon Apr 24 07:34:31 2023, max compression
+gzip compressed data, was "OMGITSLACKO-0.1.6.tar", last modified: Tue Jun  6 09:52:32 2023, max compression
```

## Comparing `OMGITSLACKO-0.1.5.tar` & `OMGITSLACKO-0.1.6.tar`

### file list

```diff
@@ -1,15 +1,16 @@
-drwxrwxrwx   0        0        0        0 2023-04-24 07:34:31.530947 OMGITSLACKO-0.1.5/
-drwxrwxrwx   0        0        0        0 2023-04-24 07:34:31.521923 OMGITSLACKO-0.1.5/OMGITSLACKO/
--rw-rw-rw-   0        0        0      340 2023-04-24 07:33:25.000000 OMGITSLACKO-0.1.5/OMGITSLACKO/__init__.py
--rw-rw-rw-   0        0        0    21142 2023-04-24 07:33:31.000000 OMGITSLACKO-0.1.5/OMGITSLACKO/functions.py
-drwxrwxrwx   0        0        0        0 2023-04-24 07:34:31.527938 OMGITSLACKO-0.1.5/OMGITSLACKO.egg-info/
--rw-rw-rw-   0        0        0      235 2023-04-24 07:34:31.000000 OMGITSLACKO-0.1.5/OMGITSLACKO.egg-info/PKG-INFO
--rw-rw-rw-   0        0        0      275 2023-04-24 07:34:31.000000 OMGITSLACKO-0.1.5/OMGITSLACKO.egg-info/SOURCES.txt
--rw-rw-rw-   0        0        0        1 2023-04-24 07:34:31.000000 OMGITSLACKO-0.1.5/OMGITSLACKO.egg-info/dependency_links.txt
--rw-rw-rw-   0        0        0        2 2023-04-21 11:06:38.000000 OMGITSLACKO-0.1.5/OMGITSLACKO.egg-info/not-zip-safe
--rw-rw-rw-   0        0        0       13 2023-04-24 07:34:31.000000 OMGITSLACKO-0.1.5/OMGITSLACKO.egg-info/requires.txt
--rw-rw-rw-   0        0        0       12 2023-04-24 07:34:31.000000 OMGITSLACKO-0.1.5/OMGITSLACKO.egg-info/top_level.txt
--rw-rw-rw-   0        0        0      235 2023-04-24 07:34:31.530024 OMGITSLACKO-0.1.5/PKG-INFO
--rw-rw-rw-   0        0        0      293 2023-04-21 12:10:35.000000 OMGITSLACKO-0.1.5/README.md
--rw-rw-rw-   0        0        0       42 2023-04-24 07:34:31.530947 OMGITSLACKO-0.1.5/setup.cfg
--rw-rw-rw-   0        0        0      399 2023-04-24 07:34:00.000000 OMGITSLACKO-0.1.5/setup.py
+drwxrwxrwx   0        0        0        0 2023-06-06 09:52:32.220018 OMGITSLACKO-0.1.6/
+drwxrwxrwx   0        0        0        0 2023-06-06 09:52:32.210994 OMGITSLACKO-0.1.6/OMGITSLACKO/
+-rw-rw-rw-   0        0        0      784 2023-06-06 09:46:39.000000 OMGITSLACKO-0.1.6/OMGITSLACKO/__init__.py
+-rw-rw-rw-   0        0        0    24422 2023-06-06 09:46:11.000000 OMGITSLACKO-0.1.6/OMGITSLACKO/functions.py
+-rw-rw-rw-   0        0        0     5850 2023-04-27 16:27:01.000000 OMGITSLACKO-0.1.6/OMGITSLACKO/tozsdefunctions.py
+drwxrwxrwx   0        0        0        0 2023-06-06 09:52:32.218013 OMGITSLACKO-0.1.6/OMGITSLACKO.egg-info/
+-rw-rw-rw-   0        0        0      235 2023-06-06 09:52:32.000000 OMGITSLACKO-0.1.6/OMGITSLACKO.egg-info/PKG-INFO
+-rw-rw-rw-   0        0        0      306 2023-06-06 09:52:32.000000 OMGITSLACKO-0.1.6/OMGITSLACKO.egg-info/SOURCES.txt
+-rw-rw-rw-   0        0        0        1 2023-06-06 09:52:32.000000 OMGITSLACKO-0.1.6/OMGITSLACKO.egg-info/dependency_links.txt
+-rw-rw-rw-   0        0        0        2 2023-04-21 11:06:38.000000 OMGITSLACKO-0.1.6/OMGITSLACKO.egg-info/not-zip-safe
+-rw-rw-rw-   0        0        0       13 2023-06-06 09:52:32.000000 OMGITSLACKO-0.1.6/OMGITSLACKO.egg-info/requires.txt
+-rw-rw-rw-   0        0        0       12 2023-06-06 09:52:32.000000 OMGITSLACKO-0.1.6/OMGITSLACKO.egg-info/top_level.txt
+-rw-rw-rw-   0        0        0      235 2023-06-06 09:52:32.219015 OMGITSLACKO-0.1.6/PKG-INFO
+-rw-rw-rw-   0        0        0      293 2023-04-21 12:10:35.000000 OMGITSLACKO-0.1.6/README.md
+-rw-rw-rw-   0        0        0       42 2023-06-06 09:52:32.220018 OMGITSLACKO-0.1.6/setup.cfg
+-rw-rw-rw-   0        0        0      399 2023-06-06 09:47:09.000000 OMGITSLACKO-0.1.6/setup.py
```

### Comparing `OMGITSLACKO-0.1.5/OMGITSLACKO/functions.py` & `OMGITSLACKO-0.1.6/OMGITSLACKO/functions.py`

 * *Files 15% similar despite different names*

```diff
@@ -1,1322 +1,1527 @@
-00000000: 696d 706f 7274 2070 616e 6461 7320 6173  import pandas as
-00000010: 2070 640d 0a66 726f 6d20 4950 7974 686f   pd..from IPytho
-00000020: 6e2e 636f 7265 2e64 6973 706c 6179 2069  n.core.display i
-00000030: 6d70 6f72 7420 4854 4d4c 0d0a 0d0a 6465  mport HTML....de
-00000040: 6620 636f 7272 656c 6174 696f 6e28 6466  f correlation(df
-00000050: 293a 0d0a 2020 2020 636f 7272 203d 2064  ):..    corr = d
-00000060: 662e 636f 7272 2829 0d0a 2020 2020 636f  f.corr()..    co
-00000070: 7272 5f73 7461 636b 6564 203d 2063 6f72  rr_stacked = cor
-00000080: 722e 7374 6163 6b28 292e 7265 7365 745f  r.stack().reset_
-00000090: 696e 6465 7828 290d 0a20 2020 2063 6f72  index()..    cor
-000000a0: 725f 7374 6163 6b65 642e 636f 6c75 6d6e  r_stacked.column
-000000b0: 7320 3d20 5b27 7661 7231 272c 2027 7661  s = ['var1', 'va
-000000c0: 7232 272c 2027 636f 7272 275d 0d0a 2020  r2', 'corr']..  
-000000d0: 2020 636f 7272 5f73 7461 636b 6564 203d    corr_stacked =
-000000e0: 2063 6f72 725f 7374 6163 6b65 645b 2863   corr_stacked[(c
-000000f0: 6f72 725f 7374 6163 6b65 645b 2763 6f72  orr_stacked['cor
-00000100: 7227 5d20 213d 2031 2e30 2920 2620 2863  r'] != 1.0) & (c
-00000110: 6f72 725f 7374 6163 6b65 645b 2763 6f72  orr_stacked['cor
-00000120: 7227 5d20 213d 202d 312e 3029 5d0d 0a20  r'] != -1.0)].. 
-00000130: 2020 2063 6f72 725f 7374 6163 6b65 6420     corr_stacked 
-00000140: 3d20 636f 7272 5f73 7461 636b 6564 5b63  = corr_stacked[c
-00000150: 6f72 725f 7374 6163 6b65 645b 2776 6172  orr_stacked['var
-00000160: 3127 5d20 3c20 636f 7272 5f73 7461 636b  1'] < corr_stack
-00000170: 6564 5b27 7661 7232 275d 5d20 2320 5265  ed['var2']] # Re
-00000180: 6d6f 7665 2064 7570 6c69 6361 7465 730d  move duplicates.
-00000190: 0a20 2020 2063 6f72 725f 7374 6163 6b65  .    corr_stacke
-000001a0: 642e 736f 7274 5f76 616c 7565 7328 6279  d.sort_values(by
-000001b0: 3d5b 2763 6f72 7227 5d2c 2061 7363 656e  =['corr'], ascen
-000001c0: 6469 6e67 3d46 616c 7365 2c20 696e 706c  ding=False, inpl
-000001d0: 6163 653d 5472 7565 290d 0a0d 0a20 2020  ace=True)....   
-000001e0: 2068 746d 6c5f 7461 626c 6520 3d20 273c   html_table = '<
-000001f0: 7461 626c 653e 3c74 6865 6164 3e3c 7472  table><thead><tr
-00000200: 3e3c 7468 3e56 6172 6961 626c 6520 313c  ><th>Variable 1<
-00000210: 2f74 683e 3c74 683e 5661 7269 6162 6c65  /th><th>Variable
-00000220: 2032 3c2f 7468 3e3c 7468 3e43 6f72 7265   2</th><th>Corre
-00000230: 6c61 7469 6f6e 3c2f 7468 3e3c 2f74 723e  lation</th></tr>
-00000240: 3c2f 7468 6561 643e 270d 0a20 2020 2068  </thead>'..    h
-00000250: 746d 6c5f 7461 626c 6520 2b3d 2027 3c74  tml_table += '<t
-00000260: 626f 6479 3e27 0d0a 2020 2020 666f 7220  body>'..    for 
-00000270: 696e 6465 782c 2072 6f77 2069 6e20 636f  index, row in co
-00000280: 7272 5f73 7461 636b 6564 2e69 7465 7272  rr_stacked.iterr
-00000290: 6f77 7328 293a 0d0a 2020 2020 2020 2020  ows():..        
-000002a0: 6874 6d6c 5f74 6162 6c65 202b 3d20 273c  html_table += '<
-000002b0: 7472 3e3c 7464 3e7b 7d3c 2f74 643e 3c74  tr><td>{}</td><t
-000002c0: 643e 7b7d 3c2f 7464 3e3c 7464 3e7b 7d3c  d>{}</td><td>{}<
-000002d0: 2f74 643e 3c2f 7472 3e27 2e66 6f72 6d61  /td></tr>'.forma
-000002e0: 7428 726f 775b 2776 6172 3127 5d2c 2072  t(row['var1'], r
-000002f0: 6f77 5b27 7661 7232 275d 2c20 726f 756e  ow['var2'], roun
-00000300: 6428 726f 775b 2763 6f72 7227 5d2c 2032  d(row['corr'], 2
-00000310: 2929 0d0a 2020 2020 6874 6d6c 5f74 6162  ))..    html_tab
-00000320: 6c65 202b 3d20 273c 2f74 626f 6479 3e3c  le += '</tbody><
-00000330: 2f74 6162 6c65 3e27 0d0a 0d0a 2020 2020  /table>'....    
-00000340: 7265 7475 726e 2048 544d 4c28 273c 6469  return HTML('<di
-00000350: 7620 7374 796c 653d 226d 6178 2d68 6569  v style="max-hei
-00000360: 6768 743a 3330 3070 783b 206f 7665 7266  ght:300px; overf
-00000370: 6c6f 772d 793a 6175 746f 3b22 3e7b 7d3c  low-y:auto;">{}<
-00000380: 2f64 6976 3e27 2e66 6f72 6d61 7428 6874  /div>'.format(ht
-00000390: 6d6c 5f74 6162 6c65 2929 0d0a 2020 2020  ml_table))..    
-000003a0: 0d0a 6465 6620 6669 6e64 5f62 6573 745f  ..def find_best_
-000003b0: 6d6f 6465 6c5f 636c 6173 7369 6669 6361  model_classifica
-000003c0: 7469 6f6e 2864 665f 585f 7472 6169 6e2c  tion(df_X_train,
-000003d0: 2064 665f 585f 7465 7374 2c20 6466 5f79   df_X_test, df_y
-000003e0: 5f74 7261 696e 2c20 6466 5f79 5f74 6573  _train, df_y_tes
-000003f0: 7429 3a0d 0a20 2020 200d 0a20 2020 2069  t):..    ..    i
-00000400: 6d70 6f72 7420 6e75 6d70 7920 6173 206e  mport numpy as n
-00000410: 700d 0a20 2020 2069 6d70 6f72 7420 7061  p..    import pa
-00000420: 6e64 6173 2061 7320 7064 0d0a 2020 2020  ndas as pd..    
-00000430: 6672 6f6d 2073 6b6c 6561 726e 2e6c 696e  from sklearn.lin
-00000440: 6561 725f 6d6f 6465 6c20 696d 706f 7274  ear_model import
-00000450: 204c 6f67 6973 7469 6352 6567 7265 7373   LogisticRegress
-00000460: 696f 6e2c 2052 6964 6765 436c 6173 7369  ion, RidgeClassi
-00000470: 6669 6572 2c20 5061 7373 6976 6541 6767  fier, PassiveAgg
-00000480: 7265 7373 6976 6543 6c61 7373 6966 6965  ressiveClassifie
-00000490: 722c 2050 6572 6365 7074 726f 6e0d 0a20  r, Perceptron.. 
-000004a0: 2020 2066 726f 6d20 736b 6c65 6172 6e2e     from sklearn.
-000004b0: 7472 6565 2069 6d70 6f72 7420 4465 6369  tree import Deci
-000004c0: 7369 6f6e 5472 6565 436c 6173 7369 6669  sionTreeClassifi
-000004d0: 6572 0d0a 2020 2020 6672 6f6d 2073 6b6c  er..    from skl
-000004e0: 6561 726e 2e65 6e73 656d 626c 6520 696d  earn.ensemble im
-000004f0: 706f 7274 2052 616e 646f 6d46 6f72 6573  port RandomFores
-00000500: 7443 6c61 7373 6966 6965 722c 2047 7261  tClassifier, Gra
-00000510: 6469 656e 7442 6f6f 7374 696e 6743 6c61  dientBoostingCla
-00000520: 7373 6966 6965 722c 2041 6461 426f 6f73  ssifier, AdaBoos
-00000530: 7443 6c61 7373 6966 6965 722c 2045 7874  tClassifier, Ext
-00000540: 7261 5472 6565 7343 6c61 7373 6966 6965  raTreesClassifie
-00000550: 722c 2042 6167 6769 6e67 436c 6173 7369  r, BaggingClassi
-00000560: 6669 6572 2c20 4973 6f6c 6174 696f 6e46  fier, IsolationF
-00000570: 6f72 6573 742c 2053 7461 636b 696e 6743  orest, StackingC
-00000580: 6c61 7373 6966 6965 720d 0a20 2020 2066  lassifier..    f
-00000590: 726f 6d20 736b 6c65 6172 6e2e 7376 6d20  rom sklearn.svm 
-000005a0: 696d 706f 7274 2053 5643 2c20 4f6e 6543  import SVC, OneC
-000005b0: 6c61 7373 5356 4d0d 0a20 2020 2066 726f  lassSVM..    fro
-000005c0: 6d20 736b 6c65 6172 6e2e 6e65 6967 6862  m sklearn.neighb
-000005d0: 6f72 7320 696d 706f 7274 204b 4e65 6967  ors import KNeig
-000005e0: 6862 6f72 7343 6c61 7373 6966 6965 722c  hborsClassifier,
-000005f0: 204e 6561 7265 7374 4365 6e74 726f 6964   NearestCentroid
-00000600: 0d0a 2020 2020 6672 6f6d 2073 6b6c 6561  ..    from sklea
-00000610: 726e 2e6e 6169 7665 5f62 6179 6573 2069  rn.naive_bayes i
-00000620: 6d70 6f72 7420 4761 7573 7369 616e 4e42  mport GaussianNB
-00000630: 2c20 4265 726e 6f75 6c6c 694e 420d 0a20  , BernoulliNB.. 
-00000640: 2020 2066 726f 6d20 736b 6c65 6172 6e2e     from sklearn.
-00000650: 6e65 7572 616c 5f6e 6574 776f 726b 2069  neural_network i
-00000660: 6d70 6f72 7420 4d4c 5043 6c61 7373 6966  mport MLPClassif
-00000670: 6965 720d 0a20 2020 2066 726f 6d20 736b  ier..    from sk
-00000680: 6c65 6172 6e2e 6469 7363 7269 6d69 6e61  learn.discrimina
-00000690: 6e74 5f61 6e61 6c79 7369 7320 696d 706f  nt_analysis impo
-000006a0: 7274 2051 7561 6472 6174 6963 4469 7363  rt QuadraticDisc
-000006b0: 7269 6d69 6e61 6e74 416e 616c 7973 6973  riminantAnalysis
-000006c0: 2c20 4c69 6e65 6172 4469 7363 7269 6d69  , LinearDiscrimi
-000006d0: 6e61 6e74 416e 616c 7973 6973 0d0a 2020  nantAnalysis..  
-000006e0: 2020 6672 6f6d 2073 6b6c 6561 726e 2e63    from sklearn.c
-000006f0: 6c75 7374 6572 2069 6d70 6f72 7420 4b4d  luster import KM
-00000700: 6561 6e73 0d0a 2020 2020 6672 6f6d 2078  eans..    from x
-00000710: 6762 6f6f 7374 2069 6d70 6f72 7420 5847  gboost import XG
-00000720: 4243 6c61 7373 6966 6965 720d 0a20 2020  BClassifier..   
-00000730: 2066 726f 6d20 6c69 6768 7467 626d 2069   from lightgbm i
-00000740: 6d70 6f72 7420 4c47 424d 436c 6173 7369  mport LGBMClassi
-00000750: 6669 6572 0d0a 2020 2020 6672 6f6d 2063  fier..    from c
-00000760: 6174 626f 6f73 7420 696d 706f 7274 2043  atboost import C
-00000770: 6174 426f 6f73 7443 6c61 7373 6966 6965  atBoostClassifie
-00000780: 720d 0a20 2020 2066 726f 6d20 696d 626c  r..    from imbl
-00000790: 6561 726e 2e65 6e73 656d 626c 6520 696d  earn.ensemble im
-000007a0: 706f 7274 2042 616c 616e 6365 6452 616e  port BalancedRan
-000007b0: 646f 6d46 6f72 6573 7443 6c61 7373 6966  domForestClassif
-000007c0: 6965 720d 0a20 2020 2066 726f 6d20 736b  ier..    from sk
-000007d0: 6c65 6172 6e20 696d 706f 7274 206d 6574  learn import met
-000007e0: 7269 6373 0d0a 2020 2020 0d0a 2020 2020  rics..    ..    
-000007f0: 6d6f 6465 6c73 203d 205b 0d0a 2020 2020  models = [..    
-00000800: 2020 2020 2822 4c6f 6769 7374 6963 2052      ("Logistic R
-00000810: 6567 7265 7373 696f 6e22 2c20 4c6f 6769  egression", Logi
-00000820: 7374 6963 5265 6772 6573 7369 6f6e 286d  sticRegression(m
-00000830: 6178 5f69 7465 723d 3130 3030 2929 2c0d  ax_iter=1000)),.
-00000840: 0a20 2020 2020 2020 2028 2244 6563 6973  .        ("Decis
-00000850: 696f 6e20 5472 6565 222c 2044 6563 6973  ion Tree", Decis
-00000860: 696f 6e54 7265 6543 6c61 7373 6966 6965  ionTreeClassifie
-00000870: 7228 2929 2c0d 0a20 2020 2020 2020 2028  r()),..        (
-00000880: 2252 616e 646f 6d20 466f 7265 7374 222c  "Random Forest",
-00000890: 2052 616e 646f 6d46 6f72 6573 7443 6c61   RandomForestCla
-000008a0: 7373 6966 6965 7228 2929 2c0d 0a20 2020  ssifier()),..   
-000008b0: 2020 2020 2028 2247 7261 6469 656e 7420       ("Gradient 
-000008c0: 426f 6f73 7469 6e67 222c 2047 7261 6469  Boosting", Gradi
-000008d0: 656e 7442 6f6f 7374 696e 6743 6c61 7373  entBoostingClass
-000008e0: 6966 6965 7228 2929 2c0d 0a20 2020 2020  ifier()),..     
-000008f0: 2020 2028 2258 4742 6f6f 7374 222c 2058     ("XGBoost", X
-00000900: 4742 436c 6173 7369 6669 6572 2865 7661  GBClassifier(eva
-00000910: 6c5f 6d65 7472 6963 3d22 6c6f 676c 6f73  l_metric="loglos
-00000920: 7322 2929 2c0d 0a20 2020 2020 2020 2028  s")),..        (
-00000930: 224c 6967 6874 4742 4d22 2c20 4c47 424d  "LightGBM", LGBM
-00000940: 436c 6173 7369 6669 6572 2829 292c 0d0a  Classifier()),..
-00000950: 2020 2020 2020 2020 2822 5375 7070 6f72          ("Suppor
-00000960: 7420 5665 6374 6f72 204d 6163 6869 6e65  t Vector Machine
-00000970: 222c 2053 5643 2829 292c 0d0a 2020 2020  ", SVC()),..    
-00000980: 2020 2020 2822 4b2d 4e65 6172 6573 7420      ("K-Nearest 
-00000990: 4e65 6967 6862 6f72 7322 2c20 4b4e 6569  Neighbors", KNei
-000009a0: 6768 626f 7273 436c 6173 7369 6669 6572  ghborsClassifier
-000009b0: 2829 292c 0d0a 2020 2020 2020 2020 2822  ()),..        ("
-000009c0: 4e61 6976 6520 4261 7965 7322 2c20 4761  Naive Bayes", Ga
-000009d0: 7573 7369 616e 4e42 2829 292c 0d0a 2020  ussianNB()),..  
-000009e0: 2020 2020 2020 2822 4d75 6c74 692d 6c61        ("Multi-la
-000009f0: 7965 7220 5065 7263 6570 7472 6f6e 222c  yer Perceptron",
-00000a00: 204d 4c50 436c 6173 7369 6669 6572 286d   MLPClassifier(m
-00000a10: 6178 5f69 7465 723d 3130 3030 2929 2c0d  ax_iter=1000)),.
-00000a20: 0a20 2020 2020 2020 2028 2241 6461 426f  .        ("AdaBo
-00000a30: 6f73 7422 2c20 4164 6142 6f6f 7374 436c  ost", AdaBoostCl
-00000a40: 6173 7369 6669 6572 2829 292c 0d0a 2020  assifier()),..  
-00000a50: 2020 2020 2020 2822 4578 7472 6120 5472        ("Extra Tr
-00000a60: 6565 7322 2c20 4578 7472 6154 7265 6573  ees", ExtraTrees
-00000a70: 436c 6173 7369 6669 6572 2829 292c 0d0a  Classifier()),..
-00000a80: 2020 2020 2020 2020 2822 5269 6467 6520          ("Ridge 
-00000a90: 436c 6173 7369 6669 6572 222c 2052 6964  Classifier", Rid
-00000aa0: 6765 436c 6173 7369 6669 6572 2829 292c  geClassifier()),
-00000ab0: 0d0a 2020 2020 2020 2020 2822 5175 6164  ..        ("Quad
-00000ac0: 7261 7469 6320 4469 7363 7269 6d69 6e61  ratic Discrimina
-00000ad0: 6e74 2041 6e61 6c79 7369 7322 2c20 5175  nt Analysis", Qu
-00000ae0: 6164 7261 7469 6344 6973 6372 696d 696e  adraticDiscrimin
-00000af0: 616e 7441 6e61 6c79 7369 7328 2929 2c0d  antAnalysis()),.
-00000b00: 0a20 2020 2020 2020 2028 2243 6174 426f  .        ("CatBo
-00000b10: 6f73 7422 2c20 4361 7442 6f6f 7374 436c  ost", CatBoostCl
-00000b20: 6173 7369 6669 6572 2876 6572 626f 7365  assifier(verbose
-00000b30: 3d30 2c20 7261 6e64 6f6d 5f73 6565 643d  =0, random_seed=
-00000b40: 3432 2929 2c0d 0a20 2020 2020 2020 2028  42)),..        (
-00000b50: 2242 616c 616e 6365 6420 5261 6e64 6f6d  "Balanced Random
-00000b60: 2046 6f72 6573 7422 2c20 4261 6c61 6e63   Forest", Balanc
-00000b70: 6564 5261 6e64 6f6d 466f 7265 7374 436c  edRandomForestCl
-00000b80: 6173 7369 6669 6572 2829 292c 0d0a 2020  assifier()),..  
-00000b90: 2020 2020 2020 2822 4c69 6e65 6172 2044        ("Linear D
-00000ba0: 6973 6372 696d 696e 616e 7420 416e 616c  iscriminant Anal
-00000bb0: 7973 6973 222c 204c 696e 6561 7244 6973  ysis", LinearDis
-00000bc0: 6372 696d 696e 616e 7441 6e61 6c79 7369  criminantAnalysi
-00000bd0: 7328 2929 2c0d 0a20 2020 2020 2020 2028  s()),..        (
-00000be0: 224e 6561 7265 7374 2043 656e 7472 6f69  "Nearest Centroi
-00000bf0: 6420 436c 6173 7369 6669 6572 222c 204e  d Classifier", N
-00000c00: 6561 7265 7374 4365 6e74 726f 6964 2829  earestCentroid()
-00000c10: 292c 0d0a 2020 2020 2020 2020 2822 5061  ),..        ("Pa
-00000c20: 7373 6976 6520 4167 6772 6573 7369 7665  ssive Aggressive
-00000c30: 2043 6c61 7373 6966 6965 7222 2c20 5061   Classifier", Pa
-00000c40: 7373 6976 6541 6767 7265 7373 6976 6543  ssiveAggressiveC
-00000c50: 6c61 7373 6966 6965 7228 2929 2c0d 0a20  lassifier()),.. 
-00000c60: 2020 2020 2020 2028 2250 6572 6365 7074         ("Percept
-00000c70: 726f 6e22 2c20 5065 7263 6570 7472 6f6e  ron", Perceptron
-00000c80: 2829 292c 0d0a 2020 2020 2020 2020 2822  ()),..        ("
-00000c90: 4265 726e 6f75 6c6c 6920 4e61 6976 6520  Bernoulli Naive 
-00000ca0: 4261 7965 7322 2c20 4265 726e 6f75 6c6c  Bayes", Bernoull
-00000cb0: 694e 4228 2929 2c0d 0a20 2020 2020 2020  iNB()),..       
-00000cc0: 2028 2242 6167 6769 6e67 2043 6c61 7373   ("Bagging Class
-00000cd0: 6966 6965 7222 2c20 4261 6767 696e 6743  ifier", BaggingC
-00000ce0: 6c61 7373 6966 6965 7228 2929 2c0d 0a20  lassifier()),.. 
-00000cf0: 2020 2020 2020 2023 2041 6464 2061 2062         # Add a b
-00000d00: 6173 6520 6573 7469 6d61 746f 7220 666f  ase estimator fo
-00000d10: 7220 5374 6163 6b69 6e67 436c 6173 7369  r StackingClassi
-00000d20: 6669 6572 0d0a 2020 2020 2020 2020 2822  fier..        ("
-00000d30: 5374 6163 6b69 6e67 2043 6c61 7373 6966  Stacking Classif
-00000d40: 6965 7222 2c20 5374 6163 6b69 6e67 436c  ier", StackingCl
-00000d50: 6173 7369 6669 6572 2865 7374 696d 6174  assifier(estimat
-00000d60: 6f72 733d 5b28 276c 7227 2c20 4c6f 6769  ors=[('lr', Logi
-00000d70: 7374 6963 5265 6772 6573 7369 6f6e 2829  sticRegression()
-00000d80: 292c 2028 2764 7427 2c20 4465 6369 7369  ), ('dt', Decisi
-00000d90: 6f6e 5472 6565 436c 6173 7369 6669 6572  onTreeClassifier
-00000da0: 2829 295d 2929 2c0d 0a20 2020 205d 0d0a  ())])),..    ]..
-00000db0: 0d0a 0d0a 2020 2020 6265 7374 5f6d 6f64  ....    best_mod
-00000dc0: 656c 203d 204e 6f6e 650d 0a20 2020 2062  el = None..    b
-00000dd0: 6573 745f 6163 6375 7261 6379 203d 202d  est_accuracy = -
-00000de0: 310d 0a20 2020 2062 6573 745f 6d6f 6465  1..    best_mode
-00000df0: 6c5f 696e 7374 616e 6365 203d 204e 6f6e  l_instance = Non
-00000e00: 650d 0a0d 0a20 2020 2066 6f72 206e 616d  e....    for nam
-00000e10: 652c 206d 6f64 656c 2069 6e20 6d6f 6465  e, model in mode
-00000e20: 6c73 3a0d 0a20 2020 2020 2020 206d 6f64  ls:..        mod
-00000e30: 656c 2e66 6974 2864 665f 585f 7472 6169  el.fit(df_X_trai
-00000e40: 6e2c 2064 665f 795f 7472 6169 6e29 0d0a  n, df_y_train)..
-00000e50: 2020 2020 2020 2020 795f 7072 6564 5f62          y_pred_b
-00000e60: 696e 6172 7920 3d20 6d6f 6465 6c2e 7072  inary = model.pr
-00000e70: 6564 6963 7428 6466 5f58 5f74 6573 7429  edict(df_X_test)
-00000e80: 0d0a 0d0a 2020 2020 2020 2020 6966 206e  ....        if n
-00000e90: 616d 6520 696e 205b 2249 736f 6c61 7469  ame in ["Isolati
-00000ea0: 6f6e 2046 6f72 6573 7422 2c20 224f 6e65  on Forest", "One
-00000eb0: 2d43 6c61 7373 2053 564d 222c 2022 4b2d  -Class SVM", "K-
-00000ec0: 4d65 616e 7322 5d3a 0d0a 2020 2020 2020  Means"]:..      
-00000ed0: 2020 2020 2020 795f 7072 6564 5f62 696e        y_pred_bin
-00000ee0: 6172 7920 3d20 6e70 2e77 6865 7265 2879  ary = np.where(y
-00000ef0: 5f70 7265 645f 6269 6e61 7279 203d 3d20  _pred_binary == 
-00000f00: 2d31 2c20 302c 2079 5f70 7265 645f 6269  -1, 0, y_pred_bi
-00000f10: 6e61 7279 290d 0a0d 0a20 2020 2020 2020  nary)....       
-00000f20: 2070 7269 6e74 286e 616d 6520 2b20 2220   print(name + " 
-00000f30: 4d6f 6465 6c3a 2229 0d0a 2020 2020 2020  Model:")..      
-00000f40: 2020 636f 6e66 7573 696f 6e5f 6d61 7472    confusion_matr
-00000f50: 6978 203d 206d 6574 7269 6373 2e63 6f6e  ix = metrics.con
-00000f60: 6675 7369 6f6e 5f6d 6174 7269 7828 6466  fusion_matrix(df
-00000f70: 5f79 5f74 6573 742c 2079 5f70 7265 645f  _y_test, y_pred_
-00000f80: 6269 6e61 7279 290d 0a20 2020 2020 2020  binary)..       
-00000f90: 2070 7269 6e74 2822 436f 6e66 7573 696f   print("Confusio
-00000fa0: 6e20 4d61 7472 6978 3a22 290d 0a20 2020  n Matrix:")..   
-00000fb0: 2020 2020 2070 7269 6e74 2863 6f6e 6675       print(confu
-00000fc0: 7369 6f6e 5f6d 6174 7269 7829 0d0a 0d0a  sion_matrix)....
-00000fd0: 2020 2020 2020 2020 6163 6375 7261 6379          accuracy
-00000fe0: 203d 206d 6574 7269 6373 2e61 6363 7572   = metrics.accur
-00000ff0: 6163 795f 7363 6f72 6528 6466 5f79 5f74  acy_score(df_y_t
-00001000: 6573 742c 2079 5f70 7265 645f 6269 6e61  est, y_pred_bina
-00001010: 7279 290d 0a20 2020 2020 2020 2070 7265  ry)..        pre
-00001020: 6369 7369 6f6e 203d 206d 6574 7269 6373  cision = metrics
-00001030: 2e70 7265 6369 7369 6f6e 5f73 636f 7265  .precision_score
-00001040: 2864 665f 795f 7465 7374 2c20 795f 7072  (df_y_test, y_pr
-00001050: 6564 5f62 696e 6172 7929 0d0a 2020 2020  ed_binary)..    
-00001060: 2020 2020 7265 6361 6c6c 203d 206d 6574      recall = met
-00001070: 7269 6373 2e72 6563 616c 6c5f 7363 6f72  rics.recall_scor
-00001080: 6528 6466 5f79 5f74 6573 742c 2079 5f70  e(df_y_test, y_p
-00001090: 7265 645f 6269 6e61 7279 290d 0a20 2020  red_binary)..   
-000010a0: 2020 2020 2063 6c61 7373 6966 6963 6174       classificat
-000010b0: 696f 6e5f 7265 706f 7274 203d 206d 6574  ion_report = met
-000010c0: 7269 6373 2e63 6c61 7373 6966 6963 6174  rics.classificat
-000010d0: 696f 6e5f 7265 706f 7274 2864 665f 795f  ion_report(df_y_
-000010e0: 7465 7374 2c20 795f 7072 6564 5f62 696e  test, y_pred_bin
-000010f0: 6172 7929 0d0a 0d0a 2020 2020 2020 2020  ary)....        
-00001100: 7072 696e 7428 2241 6363 7572 6163 793a  print("Accuracy:
-00001110: 222c 2061 6363 7572 6163 7929 0d0a 2020  ", accuracy)..  
-00001120: 2020 2020 2020 7072 696e 7428 2250 7265        print("Pre
-00001130: 6369 7369 6f6e 3a22 2c20 7072 6563 6973  cision:", precis
-00001140: 696f 6e29 0d0a 2020 2020 2020 2020 7072  ion)..        pr
-00001150: 696e 7428 2252 6563 616c 6c3a 222c 2072  int("Recall:", r
-00001160: 6563 616c 6c29 0d0a 2020 2020 2020 2020  ecall)..        
-00001170: 7072 696e 7428 636c 6173 7369 6669 6361  print(classifica
-00001180: 7469 6f6e 5f72 6570 6f72 7429 0d0a 0d0a  tion_report)....
-00001190: 2020 2020 2020 2020 6966 2061 6363 7572          if accur
-000011a0: 6163 7920 3e20 6265 7374 5f61 6363 7572  acy > best_accur
-000011b0: 6163 793a 0d0a 2020 2020 2020 2020 2020  acy:..          
-000011c0: 2020 6265 7374 5f61 6363 7572 6163 7920    best_accuracy 
-000011d0: 3d20 6163 6375 7261 6379 0d0a 2020 2020  = accuracy..    
-000011e0: 2020 2020 2020 2020 6265 7374 5f6d 6f64          best_mod
-000011f0: 656c 203d 206e 616d 650d 0a20 2020 2020  el = name..     
-00001200: 2020 2020 2020 2062 6573 745f 6d6f 6465         best_mode
-00001210: 6c5f 696e 7374 616e 6365 203d 206d 6f64  l_instance = mod
-00001220: 656c 0d0a 0d0a 2020 2020 7072 696e 7428  el....    print(
-00001230: 2254 6865 2062 6573 7420 6d6f 6465 6c20  "The best model 
-00001240: 6973 3a22 2c20 6265 7374 5f6d 6f64 656c  is:", best_model
-00001250: 2c20 2277 6974 6820 616e 2061 6363 7572  , "with an accur
-00001260: 6163 7920 6f66 222c 2062 6573 745f 6163  acy of", best_ac
-00001270: 6375 7261 6379 290d 0a0d 0a20 2020 2023  curacy)....    #
-00001280: 2050 7269 6e74 2074 6865 2063 6f6e 6675   Print the confu
-00001290: 7369 6f6e 206d 6174 7269 7820 666f 7220  sion matrix for 
-000012a0: 7468 6520 6265 7374 206d 6f64 656c 0d0a  the best model..
-000012b0: 2020 2020 795f 7072 6564 5f62 6573 7420      y_pred_best 
-000012c0: 3d20 6265 7374 5f6d 6f64 656c 5f69 6e73  = best_model_ins
-000012d0: 7461 6e63 652e 7072 6564 6963 7428 6466  tance.predict(df
-000012e0: 5f58 5f74 6573 7429 0d0a 2020 2020 6966  _X_test)..    if
-000012f0: 2062 6573 745f 6d6f 6465 6c20 696e 205b   best_model in [
-00001300: 2249 736f 6c61 7469 6f6e 2046 6f72 6573  "Isolation Fores
-00001310: 7422 2c20 224f 6e65 2d43 6c61 7373 2053  t", "One-Class S
-00001320: 564d 222c 2022 4b2d 4d65 616e 7322 5d3a  VM", "K-Means"]:
-00001330: 0d0a 2020 2020 2020 2020 795f 7072 6564  ..        y_pred
-00001340: 5f62 6573 7420 3d20 6e70 2e77 6865 7265  _best = np.where
-00001350: 2879 5f70 7265 645f 6265 7374 203d 3d20  (y_pred_best == 
-00001360: 2d31 2c20 302c 2079 5f70 7265 645f 6265  -1, 0, y_pred_be
-00001370: 7374 290d 0a20 2020 2070 7269 6e74 2822  st)..    print("
-00001380: 436f 6e66 7573 696f 6e20 4d61 7472 6978  Confusion Matrix
-00001390: 206f 6620 7468 6520 6265 7374 206d 6f64   of the best mod
-000013a0: 656c 3a22 290d 0a20 2020 2070 7269 6e74  el:")..    print
-000013b0: 286d 6574 7269 6373 2e63 6f6e 6675 7369  (metrics.confusi
-000013c0: 6f6e 5f6d 6174 7269 7828 6466 5f79 5f74  on_matrix(df_y_t
-000013d0: 6573 742c 2079 5f70 7265 645f 6265 7374  est, y_pred_best
-000013e0: 2929 0d0a 2020 2020 0d0a 2020 2020 0d0a  ))..    ..    ..
-000013f0: 6465 6620 6669 6e64 5f62 6573 745f 6d6f  def find_best_mo
-00001400: 6465 6c5f 7265 6772 6573 7369 6f6e 2864  del_regression(d
-00001410: 665f 585f 7472 6169 6e2c 2064 665f 585f  f_X_train, df_X_
-00001420: 7465 7374 2c20 6466 5f79 5f74 7261 696e  test, df_y_train
-00001430: 2c20 6466 5f79 5f74 6573 7429 3a0d 0a20  , df_y_test):.. 
-00001440: 2020 200d 0a20 2020 2069 6d70 6f72 7420     ..    import 
-00001450: 6e75 6d70 7920 6173 206e 700d 0a20 2020  numpy as np..   
-00001460: 2069 6d70 6f72 7420 7061 6e64 6173 2061   import pandas a
-00001470: 7320 7064 0d0a 2020 2020 6672 6f6d 2073  s pd..    from s
-00001480: 6b6c 6561 726e 2e6c 696e 6561 725f 6d6f  klearn.linear_mo
-00001490: 6465 6c20 696d 706f 7274 204c 696e 6561  del import Linea
-000014a0: 7252 6567 7265 7373 696f 6e2c 2052 6964  rRegression, Rid
-000014b0: 6765 2c20 4c61 7373 6f2c 2045 6c61 7374  ge, Lasso, Elast
-000014c0: 6963 4e65 742c 2042 6179 6573 6961 6e52  icNet, BayesianR
-000014d0: 6964 6765 2c20 5347 4452 6567 7265 7373  idge, SGDRegress
-000014e0: 6f72 0d0a 2020 2020 6672 6f6d 2073 6b6c  or..    from skl
-000014f0: 6561 726e 2e74 7265 6520 696d 706f 7274  earn.tree import
-00001500: 2044 6563 6973 696f 6e54 7265 6552 6567   DecisionTreeReg
-00001510: 7265 7373 6f72 0d0a 2020 2020 6672 6f6d  ressor..    from
-00001520: 2073 6b6c 6561 726e 2e65 6e73 656d 626c   sklearn.ensembl
-00001530: 6520 696d 706f 7274 2052 616e 646f 6d46  e import RandomF
-00001540: 6f72 6573 7452 6567 7265 7373 6f72 2c20  orestRegressor, 
-00001550: 4772 6164 6965 6e74 426f 6f73 7469 6e67  GradientBoosting
-00001560: 5265 6772 6573 736f 722c 2041 6461 426f  Regressor, AdaBo
-00001570: 6f73 7452 6567 7265 7373 6f72 2c20 4578  ostRegressor, Ex
-00001580: 7472 6154 7265 6573 5265 6772 6573 736f  traTreesRegresso
-00001590: 722c 2042 6167 6769 6e67 5265 6772 6573  r, BaggingRegres
-000015a0: 736f 720d 0a20 2020 2066 726f 6d20 736b  sor..    from sk
-000015b0: 6c65 6172 6e2e 7376 6d20 696d 706f 7274  learn.svm import
-000015c0: 2053 5652 0d0a 2020 2020 6672 6f6d 2073   SVR..    from s
-000015d0: 6b6c 6561 726e 2e6e 6569 6768 626f 7273  klearn.neighbors
-000015e0: 2069 6d70 6f72 7420 4b4e 6569 6768 626f   import KNeighbo
-000015f0: 7273 5265 6772 6573 736f 720d 0a20 2020  rsRegressor..   
-00001600: 2066 726f 6d20 736b 6c65 6172 6e2e 6e65   from sklearn.ne
-00001610: 7572 616c 5f6e 6574 776f 726b 2069 6d70  ural_network imp
-00001620: 6f72 7420 4d4c 5052 6567 7265 7373 6f72  ort MLPRegressor
-00001630: 0d0a 2020 2020 6672 6f6d 2078 6762 6f6f  ..    from xgboo
-00001640: 7374 2069 6d70 6f72 7420 5847 4252 6567  st import XGBReg
-00001650: 7265 7373 6f72 0d0a 2020 2020 6672 6f6d  ressor..    from
-00001660: 206c 6967 6874 6762 6d20 696d 706f 7274   lightgbm import
-00001670: 204c 4742 4d52 6567 7265 7373 6f72 0d0a   LGBMRegressor..
-00001680: 2020 2020 6672 6f6d 2063 6174 626f 6f73      from catboos
-00001690: 7420 696d 706f 7274 2043 6174 426f 6f73  t import CatBoos
-000016a0: 7452 6567 7265 7373 6f72 0d0a 2020 2020  tRegressor..    
-000016b0: 6672 6f6d 2073 6b6c 6561 726e 2069 6d70  from sklearn imp
-000016c0: 6f72 7420 6d65 7472 6963 730d 0a0d 0a20  ort metrics.... 
-000016d0: 2020 206d 6f64 656c 7320 3d20 5b0d 0a20     models = [.. 
-000016e0: 2020 2020 2020 2028 224c 696e 6561 7220         ("Linear 
-000016f0: 5265 6772 6573 7369 6f6e 222c 204c 696e  Regression", Lin
-00001700: 6561 7252 6567 7265 7373 696f 6e28 2929  earRegression())
-00001710: 2c0d 0a20 2020 2020 2020 2028 2252 6964  ,..        ("Rid
-00001720: 6765 2052 6567 7265 7373 696f 6e22 2c20  ge Regression", 
-00001730: 5269 6467 6528 2929 2c0d 0a20 2020 2020  Ridge()),..     
-00001740: 2020 2028 224c 6173 736f 2052 6567 7265     ("Lasso Regre
-00001750: 7373 696f 6e22 2c20 4c61 7373 6f28 2929  ssion", Lasso())
-00001760: 2c0d 0a20 2020 2020 2020 2028 2245 6c61  ,..        ("Ela
-00001770: 7374 6963 4e65 7420 5265 6772 6573 7369  sticNet Regressi
-00001780: 6f6e 222c 2045 6c61 7374 6963 4e65 7428  on", ElasticNet(
-00001790: 2929 2c0d 0a20 2020 2020 2020 2028 2242  )),..        ("B
-000017a0: 6179 6573 6961 6e20 5269 6467 6520 5265  ayesian Ridge Re
-000017b0: 6772 6573 7369 6f6e 222c 2042 6179 6573  gression", Bayes
-000017c0: 6961 6e52 6964 6765 2829 292c 0d0a 2020  ianRidge()),..  
-000017d0: 2020 2020 2020 2822 4465 6369 7369 6f6e        ("Decision
-000017e0: 2054 7265 6520 5265 6772 6573 736f 7222   Tree Regressor"
-000017f0: 2c20 4465 6369 7369 6f6e 5472 6565 5265  , DecisionTreeRe
-00001800: 6772 6573 736f 7228 2929 2c0d 0a20 2020  gressor()),..   
-00001810: 2020 2020 2028 2252 616e 646f 6d20 466f       ("Random Fo
-00001820: 7265 7374 2052 6567 7265 7373 6f72 222c  rest Regressor",
-00001830: 2052 616e 646f 6d46 6f72 6573 7452 6567   RandomForestReg
-00001840: 7265 7373 6f72 2829 292c 0d0a 2020 2020  ressor()),..    
-00001850: 2020 2020 2822 4772 6164 6965 6e74 2042      ("Gradient B
-00001860: 6f6f 7374 696e 6720 5265 6772 6573 736f  oosting Regresso
-00001870: 7222 2c20 4772 6164 6965 6e74 426f 6f73  r", GradientBoos
-00001880: 7469 6e67 5265 6772 6573 736f 7228 2929  tingRegressor())
-00001890: 2c0d 0a20 2020 2020 2020 2028 2258 4742  ,..        ("XGB
-000018a0: 6f6f 7374 2052 6567 7265 7373 6f72 222c  oost Regressor",
-000018b0: 2058 4742 5265 6772 6573 736f 7228 6576   XGBRegressor(ev
-000018c0: 616c 5f6d 6574 7269 633d 2272 6d73 6522  al_metric="rmse"
-000018d0: 2929 2c0d 0a20 2020 2020 2020 2028 224c  )),..        ("L
-000018e0: 6967 6874 4742 4d20 5265 6772 6573 736f  ightGBM Regresso
-000018f0: 7222 2c20 4c47 424d 5265 6772 6573 736f  r", LGBMRegresso
-00001900: 7228 2929 2c0d 0a20 2020 2020 2020 2028  r()),..        (
-00001910: 2253 7570 706f 7274 2056 6563 746f 7220  "Support Vector 
-00001920: 5265 6772 6573 736f 7222 2c20 5356 5228  Regressor", SVR(
-00001930: 2929 2c0d 0a20 2020 2020 2020 2028 224b  )),..        ("K
-00001940: 2d4e 6561 7265 7374 204e 6569 6768 626f  -Nearest Neighbo
-00001950: 7273 2052 6567 7265 7373 6f72 222c 204b  rs Regressor", K
-00001960: 4e65 6967 6862 6f72 7352 6567 7265 7373  NeighborsRegress
-00001970: 6f72 2829 292c 0d0a 2020 2020 2020 2020  or()),..        
-00001980: 2822 4d75 6c74 692d 6c61 7965 7220 5065  ("Multi-layer Pe
-00001990: 7263 6570 7472 6f6e 2052 6567 7265 7373  rceptron Regress
-000019a0: 6f72 222c 204d 4c50 5265 6772 6573 736f  or", MLPRegresso
-000019b0: 7228 6d61 785f 6974 6572 3d31 3030 3029  r(max_iter=1000)
-000019c0: 292c 0d0a 2020 2020 2020 2020 2822 4164  ),..        ("Ad
-000019d0: 6142 6f6f 7374 2052 6567 7265 7373 6f72  aBoost Regressor
-000019e0: 222c 2041 6461 426f 6f73 7452 6567 7265  ", AdaBoostRegre
-000019f0: 7373 6f72 2829 292c 0d0a 2020 2020 2020  ssor()),..      
-00001a00: 2020 2822 4578 7472 6120 5472 6565 7320    ("Extra Trees 
-00001a10: 5265 6772 6573 736f 7222 2c20 4578 7472  Regressor", Extr
-00001a20: 6154 7265 6573 5265 6772 6573 736f 7228  aTreesRegressor(
-00001a30: 2929 2c0d 0a20 2020 2020 2020 2028 2253  )),..        ("S
-00001a40: 746f 6368 6173 7469 6320 4772 6164 6965  tochastic Gradie
-00001a50: 6e74 2044 6573 6365 6e74 2052 6567 7265  nt Descent Regre
-00001a60: 7373 6f72 222c 2053 4744 5265 6772 6573  ssor", SGDRegres
-00001a70: 736f 7228 2929 2c0d 0a20 2020 2020 2020  sor()),..       
-00001a80: 2028 2242 6167 6769 6e67 2052 6567 7265   ("Bagging Regre
-00001a90: 7373 6f72 222c 2042 6167 6769 6e67 5265  ssor", BaggingRe
-00001aa0: 6772 6573 736f 7228 2929 2c0d 0a20 2020  gressor()),..   
-00001ab0: 2020 2020 2028 2243 6174 426f 6f73 7420       ("CatBoost 
-00001ac0: 5265 6772 6573 736f 7222 2c20 4361 7442  Regressor", CatB
-00001ad0: 6f6f 7374 5265 6772 6573 736f 7228 7665  oostRegressor(ve
-00001ae0: 7262 6f73 653d 302c 2072 616e 646f 6d5f  rbose=0, random_
-00001af0: 7365 6564 3d34 3229 292c 0d0a 2020 2020  seed=42)),..    
-00001b00: 5d0d 0a0d 0a20 2020 2062 6573 745f 6d6f  ]....    best_mo
-00001b10: 6465 6c20 3d20 4e6f 6e65 0d0a 2020 2020  del = None..    
-00001b20: 6265 7374 5f6d 7365 203d 2066 6c6f 6174  best_mse = float
-00001b30: 2822 696e 6622 290d 0a20 2020 2062 6573  ("inf")..    bes
-00001b40: 745f 6d6f 6465 6c5f 696e 7374 616e 6365  t_model_instance
-00001b50: 203d 204e 6f6e 650d 0a0d 0a20 2020 2066   = None....    f
-00001b60: 6f72 206e 616d 652c 206d 6f64 656c 2069  or name, model i
-00001b70: 6e20 6d6f 6465 6c73 3a0d 0a20 2020 2020  n models:..     
-00001b80: 2020 206d 6f64 656c 2e66 6974 2864 665f     model.fit(df_
-00001b90: 585f 7472 6169 6e2c 2064 665f 795f 7472  X_train, df_y_tr
-00001ba0: 6169 6e29 0d0a 2020 2020 2020 2020 795f  ain)..        y_
-00001bb0: 7072 6564 203d 206d 6f64 656c 2e70 7265  pred = model.pre
-00001bc0: 6469 6374 2864 665f 585f 7465 7374 290d  dict(df_X_test).
-00001bd0: 0a0d 0a20 2020 2020 2020 2070 7269 6e74  ...        print
-00001be0: 286e 616d 6520 2b20 2220 4d6f 6465 6c3a  (name + " Model:
-00001bf0: 2229 0d0a 2020 2020 2020 2020 6d73 6520  ")..        mse 
-00001c00: 3d20 6d65 7472 6963 732e 6d65 616e 5f73  = metrics.mean_s
-00001c10: 7175 6172 6564 5f65 7272 6f72 2864 665f  quared_error(df_
-00001c20: 795f 7465 7374 2c20 795f 7072 6564 290d  y_test, y_pred).
-00001c30: 0a20 2020 2020 2020 2072 6d73 6520 3d20  .        rmse = 
-00001c40: 6e70 2e73 7172 7428 6d73 6529 0d0a 2020  np.sqrt(mse)..  
-00001c50: 2020 2020 2020 7232 203d 206d 6574 7269        r2 = metri
-00001c60: 6373 2e72 325f 7363 6f72 6528 6466 5f79  cs.r2_score(df_y
-00001c70: 5f74 6573 742c 2079 5f70 7265 6429 0d0a  _test, y_pred)..
-00001c80: 0d0a 2020 2020 2020 2020 7072 696e 7428  ..        print(
-00001c90: 224d 6561 6e20 5371 7561 7265 6420 4572  "Mean Squared Er
-00001ca0: 726f 723a 222c 206d 7365 290d 0a20 2020  ror:", mse)..   
-00001cb0: 2020 2020 2070 7269 6e74 2822 526f 6f74       print("Root
-00001cc0: 204d 6561 6e20 5371 7561 7265 6420 4572   Mean Squared Er
-00001cd0: 726f 723a 222c 2072 6d73 6529 0d0a 2020  ror:", rmse)..  
-00001ce0: 2020 2020 2020 7072 696e 7428 2252 2d73        print("R-s
-00001cf0: 7175 6172 6564 3a22 2c20 7232 290d 0a20  quared:", r2).. 
-00001d00: 2020 2020 2020 2070 7269 6e74 2829 0d0a         print()..
-00001d10: 0d0a 2020 2020 2020 2020 6966 206d 7365  ..        if mse
-00001d20: 203c 2062 6573 745f 6d73 653a 0d0a 2020   < best_mse:..  
-00001d30: 2020 2020 2020 2020 2020 6265 7374 5f6d            best_m
-00001d40: 7365 203d 206d 7365 0d0a 2020 2020 2020  se = mse..      
-00001d50: 2020 2020 2020 6265 7374 5f6d 6f64 656c        best_model
-00001d60: 203d 206e 616d 650d 0a20 2020 2020 2020   = name..       
-00001d70: 2020 2020 2062 6573 745f 6d6f 6465 6c5f       best_model_
-00001d80: 696e 7374 616e 6365 203d 206d 6f64 656c  instance = model
-00001d90: 0d0a 0d0a 2020 2020 7072 696e 7428 2254  ....    print("T
-00001da0: 6865 2062 6573 7420 6d6f 6465 6c20 6973  he best model is
-00001db0: 3a22 2c20 6265 7374 5f6d 6f64 656c 2c20  :", best_model, 
-00001dc0: 2277 6974 6820 6120 4d65 616e 2053 7175  "with a Mean Squ
-00001dd0: 6172 6564 2045 7272 6f72 206f 6622 2c20  ared Error of", 
-00001de0: 6265 7374 5f6d 7365 290d 0a0d 0a20 2020  best_mse)....   
-00001df0: 2023 2050 7269 6e74 2074 6865 206d 6574   # Print the met
-00001e00: 7269 6373 2066 6f72 2074 6865 2062 6573  rics for the bes
-00001e10: 7420 6d6f 6465 6c0d 0a20 2020 2079 5f70  t model..    y_p
-00001e20: 7265 645f 6265 7374 203d 2062 6573 745f  red_best = best_
-00001e30: 6d6f 6465 6c5f 696e 7374 616e 6365 2e70  model_instance.p
-00001e40: 7265 6469 6374 2864 665f 585f 7465 7374  redict(df_X_test
-00001e50: 290d 0a20 2020 2062 6573 745f 726d 7365  )..    best_rmse
-00001e60: 203d 206e 702e 7371 7274 2862 6573 745f   = np.sqrt(best_
-00001e70: 6d73 6529 0d0a 2020 2020 6265 7374 5f72  mse)..    best_r
-00001e80: 3220 3d20 6d65 7472 6963 732e 7232 5f73  2 = metrics.r2_s
-00001e90: 636f 7265 2864 665f 795f 7465 7374 2c20  core(df_y_test, 
-00001ea0: 795f 7072 6564 5f62 6573 7429 0d0a 2020  y_pred_best)..  
-00001eb0: 2020 7072 696e 7428 224d 6574 7269 6373    print("Metrics
-00001ec0: 206f 6620 7468 6520 6265 7374 206d 6f64   of the best mod
-00001ed0: 656c 3a22 290d 0a20 2020 2070 7269 6e74  el:")..    print
-00001ee0: 2822 4d65 616e 2053 7175 6172 6564 2045  ("Mean Squared E
-00001ef0: 7272 6f72 3a22 2c20 6265 7374 5f6d 7365  rror:", best_mse
-00001f00: 290d 0a20 2020 2070 7269 6e74 2822 526f  )..    print("Ro
-00001f10: 6f74 204d 6561 6e20 5371 7561 7265 6420  ot Mean Squared 
-00001f20: 4572 726f 723a 222c 2062 6573 745f 726d  Error:", best_rm
-00001f30: 7365 290d 0a20 2020 2070 7269 6e74 2822  se)..    print("
-00001f40: 522d 7371 7561 7265 643a 222c 2062 6573  R-squared:", bes
-00001f50: 745f 7232 290d 0a0d 0a0d 0a0d 0a64 6566  t_r2)........def
-00001f60: 2066 696e 645f 6265 7374 5f63 6c75 7374   find_best_clust
-00001f70: 6572 696e 675f 616c 676f 7269 7468 6d28  ering_algorithm(
-00001f80: 6461 7461 2c20 7363 616c 696e 673d 5472  data, scaling=Tr
-00001f90: 7565 2c20 6e5f 636c 7573 7465 7273 3d4e  ue, n_clusters=N
-00001fa0: 6f6e 652c 2076 6973 7561 6c69 7a65 3d54  one, visualize=T
-00001fb0: 7275 652c 2074 6573 745f 6665 6174 7572  rue, test_featur
-00001fc0: 655f 636f 6d62 696e 6174 696f 6e73 3d46  e_combinations=F
-00001fd0: 616c 7365 293a 0d0a 2020 2020 696d 706f  alse):..    impo
-00001fe0: 7274 206e 756d 7079 2061 7320 6e70 0d0a  rt numpy as np..
-00001ff0: 2020 2020 696d 706f 7274 2069 7465 7274      import itert
-00002000: 6f6f 6c73 0d0a 2020 2020 6672 6f6d 2073  ools..    from s
-00002010: 6b6c 6561 726e 2e70 7265 7072 6f63 6573  klearn.preproces
-00002020: 7369 6e67 2069 6d70 6f72 7420 5374 616e  sing import Stan
-00002030: 6461 7264 5363 616c 6572 0d0a 2020 2020  dardScaler..    
-00002040: 6672 6f6d 2073 6b6c 6561 726e 2e63 6c75  from sklearn.clu
-00002050: 7374 6572 2069 6d70 6f72 7420 4b4d 6561  ster import KMea
-00002060: 6e73 2c20 4d69 6e69 4261 7463 684b 4d65  ns, MiniBatchKMe
-00002070: 616e 732c 2041 6666 696e 6974 7950 726f  ans, AffinityPro
-00002080: 7061 6761 7469 6f6e 2c20 4d65 616e 5368  pagation, MeanSh
-00002090: 6966 742c 2065 7374 696d 6174 655f 6261  ift, estimate_ba
-000020a0: 6e64 7769 6474 680d 0a20 2020 2066 726f  ndwidth..    fro
-000020b0: 6d20 736b 6c65 6172 6e2e 636c 7573 7465  m sklearn.cluste
-000020c0: 7220 696d 706f 7274 2053 7065 6374 7261  r import Spectra
-000020d0: 6c43 6c75 7374 6572 696e 672c 2041 6767  lClustering, Agg
-000020e0: 6c6f 6d65 7261 7469 7665 436c 7573 7465  lomerativeCluste
-000020f0: 7269 6e67 2c20 4442 5343 414e 2c20 4f50  ring, DBSCAN, OP
-00002100: 5449 4353 2c20 4269 7263 680d 0a20 2020  TICS, Birch..   
-00002110: 2066 726f 6d20 736b 6c65 6172 6e2e 6d69   from sklearn.mi
-00002120: 7874 7572 6520 696d 706f 7274 2047 6175  xture import Gau
-00002130: 7373 6961 6e4d 6978 7475 7265 0d0a 2020  ssianMixture..  
-00002140: 2020 6672 6f6d 2073 6b6c 6561 726e 2e64    from sklearn.d
-00002150: 6563 6f6d 706f 7369 7469 6f6e 2069 6d70  ecomposition imp
-00002160: 6f72 7420 5043 410d 0a20 2020 2066 726f  ort PCA..    fro
-00002170: 6d20 736b 6c65 6172 6e2e 6d65 7472 6963  m sklearn.metric
-00002180: 7320 696d 706f 7274 2073 696c 686f 7565  s import silhoue
-00002190: 7474 655f 7363 6f72 650d 0a20 2020 2069  tte_score..    i
-000021a0: 6d70 6f72 7420 6d61 7470 6c6f 746c 6962  mport matplotlib
-000021b0: 2e70 7970 6c6f 7420 6173 2070 6c74 0d0a  .pyplot as plt..
-000021c0: 0d0a 2020 2020 6966 2073 6361 6c69 6e67  ..    if scaling
-000021d0: 3a0d 0a20 2020 2020 2020 2073 6361 6c65  :..        scale
-000021e0: 7220 3d20 5374 616e 6461 7264 5363 616c  r = StandardScal
-000021f0: 6572 2829 0d0a 2020 2020 2020 2020 6461  er()..        da
-00002200: 7461 203d 2073 6361 6c65 722e 6669 745f  ta = scaler.fit_
-00002210: 7472 616e 7366 6f72 6d28 6461 7461 290d  transform(data).
-00002220: 0a0d 0a20 2020 2069 6620 7465 7374 5f66  ...    if test_f
-00002230: 6561 7475 7265 5f63 6f6d 6269 6e61 7469  eature_combinati
-00002240: 6f6e 733a 0d0a 2020 2020 2020 2020 7072  ons:..        pr
-00002250: 696e 7428 225c 6e54 6573 7469 6e67 2064  int("\nTesting d
-00002260: 6966 6665 7265 6e74 2066 6561 7475 7265  ifferent feature
-00002270: 2063 6f6d 6269 6e61 7469 6f6e 733a 2229   combinations:")
-00002280: 0d0a 2020 2020 2020 2020 666f 7220 6e75  ..        for nu
-00002290: 6d5f 6665 6174 7572 6573 2069 6e20 7261  m_features in ra
-000022a0: 6e67 6528 312c 2064 6174 612e 7368 6170  nge(1, data.shap
-000022b0: 655b 315d 202b 2031 293a 0d0a 2020 2020  e[1] + 1):..    
-000022c0: 2020 2020 2020 2020 666f 7220 6665 6174          for feat
-000022d0: 7572 655f 636f 6d62 696e 6174 696f 6e20  ure_combination 
-000022e0: 696e 2069 7465 7274 6f6f 6c73 2e63 6f6d  in itertools.com
-000022f0: 6269 6e61 7469 6f6e 7328 7261 6e67 6528  binations(range(
-00002300: 6461 7461 2e73 6861 7065 5b31 5d29 2c20  data.shape[1]), 
-00002310: 6e75 6d5f 6665 6174 7572 6573 293a 0d0a  num_features):..
-00002320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002330: 7265 6475 6365 645f 6461 7461 203d 2064  reduced_data = d
-00002340: 6174 615b 3a2c 2066 6561 7475 7265 5f63  ata[:, feature_c
-00002350: 6f6d 6269 6e61 7469 6f6e 5d0d 0a20 2020  ombination]..   
-00002360: 2020 2020 2020 2020 2020 2020 205f 2c20               _, 
-00002370: 5f2c 2073 636f 7265 203d 2066 696e 645f  _, score = find_
-00002380: 6265 7374 5f63 6c75 7374 6572 696e 675f  best_clustering_
-00002390: 616c 676f 7269 7468 6d28 7265 6475 6365  algorithm(reduce
-000023a0: 645f 6461 7461 2c20 7363 616c 696e 673d  d_data, scaling=
-000023b0: 4661 6c73 652c 206e 5f63 6c75 7374 6572  False, n_cluster
-000023c0: 733d 6e5f 636c 7573 7465 7273 2c20 7669  s=n_clusters, vi
-000023d0: 7375 616c 697a 653d 4661 6c73 6529 0d0a  sualize=False)..
-000023e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000023f0: 7072 696e 7428 6622 5369 6c68 6f75 6574  print(f"Silhouet
-00002400: 7465 2073 636f 7265 2066 6f72 2066 6561  te score for fea
-00002410: 7475 7265 7320 7b66 6561 7475 7265 5f63  tures {feature_c
-00002420: 6f6d 6269 6e61 7469 6f6e 7d3a 207b 7363  ombination}: {sc
-00002430: 6f72 657d 2229 0d0a 0d0a 2020 2020 636c  ore}")....    cl
-00002440: 7573 7465 7269 6e67 5f61 6c67 6f72 6974  ustering_algorit
-00002450: 686d 7320 3d20 5b0d 0a20 2020 2020 2020  hms = [..       
-00002460: 2028 224b 4d65 616e 7322 2c20 4b4d 6561   ("KMeans", KMea
-00002470: 6e73 286e 5f63 6c75 7374 6572 733d 6e5f  ns(n_clusters=n_
-00002480: 636c 7573 7465 7273 2920 6966 206e 5f63  clusters) if n_c
-00002490: 6c75 7374 6572 7320 656c 7365 204b 4d65  lusters else KMe
-000024a0: 616e 7328 2929 2c0d 0a20 2020 2020 2020  ans()),..       
-000024b0: 2028 224d 696e 6942 6174 6368 4b4d 6561   ("MiniBatchKMea
-000024c0: 6e73 222c 204d 696e 6942 6174 6368 4b4d  ns", MiniBatchKM
-000024d0: 6561 6e73 286e 5f63 6c75 7374 6572 733d  eans(n_clusters=
-000024e0: 6e5f 636c 7573 7465 7273 2920 6966 206e  n_clusters) if n
-000024f0: 5f63 6c75 7374 6572 7320 656c 7365 204d  _clusters else M
-00002500: 696e 6942 6174 6368 4b4d 6561 6e73 2829  iniBatchKMeans()
-00002510: 292c 0d0a 2020 2020 2020 2020 2822 4166  ),..        ("Af
-00002520: 6669 6e69 7479 5072 6f70 6167 6174 696f  finityPropagatio
-00002530: 6e22 2c20 4166 6669 6e69 7479 5072 6f70  n", AffinityProp
-00002540: 6167 6174 696f 6e28 2929 2c0d 0a20 2020  agation()),..   
-00002550: 2020 2020 2028 224d 6561 6e53 6869 6674       ("MeanShift
-00002560: 222c 204d 6561 6e53 6869 6674 2862 616e  ", MeanShift(ban
-00002570: 6477 6964 7468 3d65 7374 696d 6174 655f  dwidth=estimate_
-00002580: 6261 6e64 7769 6474 6828 6461 7461 2c20  bandwidth(data, 
-00002590: 6e5f 7361 6d70 6c65 733d 6e5f 636c 7573  n_samples=n_clus
-000025a0: 7465 7273 2929 2069 6620 6e5f 636c 7573  ters)) if n_clus
-000025b0: 7465 7273 2065 6c73 6520 4d65 616e 5368  ters else MeanSh
-000025c0: 6966 7428 2929 2c0d 0a20 2020 2020 2020  ift()),..       
-000025d0: 2028 2253 7065 6374 7261 6c43 6c75 7374   ("SpectralClust
-000025e0: 6572 696e 6722 2c20 5370 6563 7472 616c  ering", Spectral
-000025f0: 436c 7573 7465 7269 6e67 286e 5f63 6c75  Clustering(n_clu
-00002600: 7374 6572 733d 6e5f 636c 7573 7465 7273  sters=n_clusters
-00002610: 2920 6966 206e 5f63 6c75 7374 6572 7320  ) if n_clusters 
-00002620: 656c 7365 2053 7065 6374 7261 6c43 6c75  else SpectralClu
-00002630: 7374 6572 696e 6728 2929 2c0d 0a20 2020  stering()),..   
-00002640: 2020 2020 2028 2241 6767 6c6f 6d65 7261       ("Agglomera
-00002650: 7469 7665 436c 7573 7465 7269 6e67 222c  tiveClustering",
-00002660: 2041 6767 6c6f 6d65 7261 7469 7665 436c   AgglomerativeCl
-00002670: 7573 7465 7269 6e67 286e 5f63 6c75 7374  ustering(n_clust
-00002680: 6572 733d 6e5f 636c 7573 7465 7273 2920  ers=n_clusters) 
-00002690: 6966 206e 5f63 6c75 7374 6572 7320 656c  if n_clusters el
-000026a0: 7365 2041 6767 6c6f 6d65 7261 7469 7665  se Agglomerative
-000026b0: 436c 7573 7465 7269 6e67 2829 292c 0d0a  Clustering()),..
-000026c0: 2020 2020 2020 2020 2822 4442 5343 414e          ("DBSCAN
-000026d0: 222c 2044 4253 4341 4e28 2929 2c0d 0a20  ", DBSCAN()),.. 
-000026e0: 2020 2020 2020 2028 224f 5054 4943 5322         ("OPTICS"
-000026f0: 2c20 4f50 5449 4353 2829 292c 0d0a 2020  , OPTICS()),..  
-00002700: 2020 2020 2020 2822 4269 7263 6822 2c20        ("Birch", 
-00002710: 4269 7263 6828 6e5f 636c 7573 7465 7273  Birch(n_clusters
-00002720: 3d6e 5f63 6c75 7374 6572 7329 2069 6620  =n_clusters) if 
-00002730: 6e5f 636c 7573 7465 7273 2065 6c73 6520  n_clusters else 
-00002740: 4269 7263 6828 2929 2c0d 0a20 2020 2020  Birch()),..     
-00002750: 2020 2028 2247 6175 7373 6961 6e4d 6978     ("GaussianMix
-00002760: 7475 7265 222c 2047 6175 7373 6961 6e4d  ture", GaussianM
-00002770: 6978 7475 7265 286e 5f63 6f6d 706f 6e65  ixture(n_compone
-00002780: 6e74 733d 6e5f 636c 7573 7465 7273 2920  nts=n_clusters) 
-00002790: 6966 206e 5f63 6c75 7374 6572 7320 656c  if n_clusters el
-000027a0: 7365 2047 6175 7373 6961 6e4d 6978 7475  se GaussianMixtu
-000027b0: 7265 2829 290d 0a20 2020 205d 0d0a 0d0a  re())..    ]....
-000027c0: 2020 2020 6265 7374 5f61 6c67 6f72 6974      best_algorit
-000027d0: 686d 203d 204e 6f6e 650d 0a20 2020 2062  hm = None..    b
-000027e0: 6573 745f 616c 676f 7269 7468 6d5f 6e61  est_algorithm_na
-000027f0: 6d65 203d 2022 220d 0a20 2020 2062 6573  me = ""..    bes
-00002800: 745f 7363 6f72 6520 3d20 2d6e 702e 696e  t_score = -np.in
-00002810: 660d 0a0d 0a20 2020 2066 6f72 206e 616d  f....    for nam
-00002820: 652c 2061 6c67 6f72 6974 686d 2069 6e20  e, algorithm in 
-00002830: 636c 7573 7465 7269 6e67 5f61 6c67 6f72  clustering_algor
-00002840: 6974 686d 733a 0d0a 2020 2020 2020 2020  ithms:..        
-00002850: 7472 793a 0d0a 2020 2020 2020 2020 2020  try:..          
-00002860: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-00002870: 616c 676f 7269 7468 6d2c 2047 6175 7373  algorithm, Gauss
-00002880: 6961 6e4d 6978 7475 7265 293a 0d0a 2020  ianMixture):..  
-00002890: 2020 2020 2020 2020 2020 2020 2020 616c                al
-000028a0: 676f 7269 7468 6d2e 6669 7428 6461 7461  gorithm.fit(data
-000028b0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-000028c0: 2020 206c 6162 656c 7320 3d20 616c 676f     labels = algo
-000028d0: 7269 7468 6d2e 7072 6564 6963 7428 6461  rithm.predict(da
-000028e0: 7461 290d 0a20 2020 2020 2020 2020 2020  ta)..           
-000028f0: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-00002900: 2020 2020 2020 2020 6c61 6265 6c73 203d          labels =
-00002910: 2061 6c67 6f72 6974 686d 2e66 6974 5f70   algorithm.fit_p
-00002920: 7265 6469 6374 2864 6174 6129 0d0a 0d0a  redict(data)....
-00002930: 2020 2020 2020 2020 2020 2020 6966 206c              if l
-00002940: 656e 286e 702e 756e 6971 7565 286c 6162  en(np.unique(lab
-00002950: 656c 7329 2920 3e20 313a 0d0a 2020 2020  els)) > 1:..    
-00002960: 2020 2020 2020 2020 2020 2020 7363 6f72              scor
-00002970: 6520 3d20 7369 6c68 6f75 6574 7465 5f73  e = silhouette_s
-00002980: 636f 7265 2864 6174 612c 206c 6162 656c  core(data, label
-00002990: 7329 0d0a 2020 2020 2020 2020 2020 2020  s)..            
-000029a0: 2020 2020 7072 696e 7428 6622 7b6e 616d      print(f"{nam
-000029b0: 657d 2041 6c67 6f72 6974 686d 3a22 290d  e} Algorithm:").
-000029c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000029d0: 2070 7269 6e74 2822 5369 6c68 6f75 6574   print("Silhouet
-000029e0: 7465 2053 636f 7265 3a22 2c20 7363 6f72  te Score:", scor
-000029f0: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
-00002a00: 2020 2020 6966 2073 636f 7265 203e 2062      if score > b
-00002a10: 6573 745f 7363 6f72 653a 0d0a 2020 2020  est_score:..    
-00002a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002a30: 6265 7374 5f73 636f 7265 203d 2073 636f  best_score = sco
-00002a40: 7265 0d0a 2020 2020 2020 2020 2020 2020  re..            
-00002a50: 2020 2020 2020 2020 6265 7374 5f61 6c67          best_alg
-00002a60: 6f72 6974 686d 203d 2061 6c67 6f72 6974  orithm = algorit
-00002a70: 686d 0d0a 2020 2020 2020 2020 2020 2020  hm..            
-00002a80: 2020 2020 2020 2020 6265 7374 5f61 6c67          best_alg
-00002a90: 6f72 6974 686d 5f6e 616d 6520 3d20 6e61  orithm_name = na
-00002aa0: 6d65 0d0a 2020 2020 2020 2020 6578 6365  me..        exce
-00002ab0: 7074 2045 7863 6570 7469 6f6e 2061 7320  pt Exception as 
-00002ac0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00002ad0: 7072 696e 7428 6622 416e 2065 7272 6f72  print(f"An error
-00002ae0: 206f 6363 7572 7265 6420 7768 696c 6520   occurred while 
-00002af0: 7072 6f63 6573 7369 6e67 207b 6e61 6d65  processing {name
-00002b00: 7d3a 207b 657d 2229 0d0a 0d0a 2020 2020  }: {e}")....    
-00002b10: 7072 696e 7428 2254 6865 2062 6573 7420  print("The best 
-00002b20: 636c 7573 7465 7269 6e67 2061 6c67 6f72  clustering algor
-00002b30: 6974 686d 2069 733a 222c 2062 6573 745f  ithm is:", best_
-00002b40: 616c 676f 7269 7468 6d5f 6e61 6d65 2c20  algorithm_name, 
-00002b50: 2277 6974 6820 6120 7369 6c68 6f75 6574  "with a silhouet
-00002b60: 7465 2073 636f 7265 206f 6622 2c20 6265  te score of", be
-00002b70: 7374 5f73 636f 7265 290d 0a20 2020 2070  st_score)..    p
-00002b80: 6361 203d 2050 4341 286e 5f63 6f6d 706f  ca = PCA(n_compo
-00002b90: 6e65 6e74 733d 3229 0d0a 2020 2020 585f  nents=2)..    X_
-00002ba0: 7063 6120 3d20 7063 612e 6669 745f 7472  pca = pca.fit_tr
-00002bb0: 616e 7366 6f72 6d28 6461 7461 290d 0a0d  ansform(data)...
-00002bc0: 0a20 2020 2069 6620 6973 696e 7374 616e  .    if isinstan
-00002bd0: 6365 2862 6573 745f 616c 676f 7269 7468  ce(best_algorith
-00002be0: 6d2c 2047 6175 7373 6961 6e4d 6978 7475  m, GaussianMixtu
-00002bf0: 7265 293a 0d0a 2020 2020 2020 2020 6265  re):..        be
-00002c00: 7374 5f61 6c67 6f72 6974 686d 2e66 6974  st_algorithm.fit
-00002c10: 2864 6174 6129 0d0a 2020 2020 2020 2020  (data)..        
-00002c20: 636c 7573 7465 725f 6c61 6265 6c73 203d  cluster_labels =
-00002c30: 2062 6573 745f 616c 676f 7269 7468 6d2e   best_algorithm.
-00002c40: 7072 6564 6963 7428 6461 7461 290d 0a20  predict(data).. 
-00002c50: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-00002c60: 2020 636c 7573 7465 725f 6c61 6265 6c73    cluster_labels
-00002c70: 203d 2062 6573 745f 616c 676f 7269 7468   = best_algorith
-00002c80: 6d2e 6669 745f 7072 6564 6963 7428 6461  m.fit_predict(da
-00002c90: 7461 290d 0a0d 0a20 2020 2070 6c74 2e66  ta)....    plt.f
-00002ca0: 6967 7572 6528 6669 6773 697a 653d 2831  igure(figsize=(1
-00002cb0: 302c 2036 2929 0d0a 2020 2020 706c 742e  0, 6))..    plt.
-00002cc0: 7363 6174 7465 7228 585f 7063 615b 3a2c  scatter(X_pca[:,
-00002cd0: 2030 5d2c 2058 5f70 6361 5b3a 2c20 315d   0], X_pca[:, 1]
-00002ce0: 2c20 633d 636c 7573 7465 725f 6c61 6265  , c=cluster_labe
-00002cf0: 6c73 2c20 636d 6170 3d27 7669 7269 6469  ls, cmap='viridi
-00002d00: 7327 2c20 6564 6765 636f 6c6f 7273 3d27  s', edgecolors='
-00002d10: 6b27 2c20 733d 3530 290d 0a20 2020 200d  k', s=50)..    .
-00002d20: 0a20 2020 2070 6c74 2e74 6974 6c65 2827  .    plt.title('
-00002d30: 5363 6174 7465 7220 506c 6f74 2066 6f72  Scatter Plot for
-00002d40: 2074 6865 2042 6573 7420 436c 7573 7465   the Best Cluste
-00002d50: 7269 6e67 204d 6f64 656c 3a20 2720 2b20  ring Model: ' + 
-00002d60: 6265 7374 5f61 6c67 6f72 6974 686d 5f6e  best_algorithm_n
-00002d70: 616d 6529 0d0a 2020 2020 706c 742e 786c  ame)..    plt.xl
-00002d80: 6162 656c 2827 5072 696e 6369 7061 6c20  abel('Principal 
-00002d90: 436f 6d70 6f6e 656e 7420 3127 290d 0a20  Component 1').. 
-00002da0: 2020 2070 6c74 2e79 6c61 6265 6c28 2750     plt.ylabel('P
-00002db0: 7269 6e63 6970 616c 2043 6f6d 706f 6e65  rincipal Compone
-00002dc0: 6e74 2032 2729 0d0a 2020 2020 706c 742e  nt 2')..    plt.
-00002dd0: 7368 6f77 2829 0d0a 2020 2020 7265 7475  show()..    retu
-00002de0: 726e 2062 6573 745f 616c 676f 7269 7468  rn best_algorith
-00002df0: 6d5f 6e61 6d65 2c20 6265 7374 5f61 6c67  m_name, best_alg
-00002e00: 6f72 6974 686d 2c20 6265 7374 5f73 636f  orithm, best_sco
-00002e10: 7265 0d0a 0d0a 0d0a 6465 6620 6669 6e64  re......def find
-00002e20: 5f62 6573 745f 6d6f 6465 6c5f 7265 6772  _best_model_regr
-00002e30: 6573 7369 6f6e 5f32 2858 2c20 792c 2074  ession_2(X, y, t
-00002e40: 6573 745f 7369 7a65 3d30 2e32 2c20 7261  est_size=0.2, ra
-00002e50: 6e64 6f6d 5f73 7461 7465 3d34 322c 2063  ndom_state=42, c
-00002e60: 763d 3529 3a0d 0a20 2020 200d 0a20 2020  v=5):..    ..   
-00002e70: 2069 6d70 6f72 7420 6e75 6d70 7920 6173   import numpy as
-00002e80: 206e 700d 0a20 2020 2069 6d70 6f72 7420   np..    import 
-00002e90: 7061 6e64 6173 2061 7320 7064 0d0a 2020  pandas as pd..  
-00002ea0: 2020 6672 6f6d 2073 6b6c 6561 726e 2e6c    from sklearn.l
-00002eb0: 696e 6561 725f 6d6f 6465 6c20 696d 706f  inear_model impo
-00002ec0: 7274 204c 696e 6561 7252 6567 7265 7373  rt LinearRegress
-00002ed0: 696f 6e2c 2052 6964 6765 2c20 4c61 7373  ion, Ridge, Lass
-00002ee0: 6f2c 2045 6c61 7374 6963 4e65 742c 2042  o, ElasticNet, B
-00002ef0: 6179 6573 6961 6e52 6964 6765 2c20 5347  ayesianRidge, SG
-00002f00: 4452 6567 7265 7373 6f72 0d0a 2020 2020  DRegressor..    
-00002f10: 6672 6f6d 2073 6b6c 6561 726e 2e74 7265  from sklearn.tre
-00002f20: 6520 696d 706f 7274 2044 6563 6973 696f  e import Decisio
-00002f30: 6e54 7265 6552 6567 7265 7373 6f72 0d0a  nTreeRegressor..
-00002f40: 2020 2020 6672 6f6d 2073 6b6c 6561 726e      from sklearn
-00002f50: 2e65 6e73 656d 626c 6520 696d 706f 7274  .ensemble import
-00002f60: 2052 616e 646f 6d46 6f72 6573 7452 6567   RandomForestReg
-00002f70: 7265 7373 6f72 2c20 4772 6164 6965 6e74  ressor, Gradient
-00002f80: 426f 6f73 7469 6e67 5265 6772 6573 736f  BoostingRegresso
-00002f90: 722c 2041 6461 426f 6f73 7452 6567 7265  r, AdaBoostRegre
-00002fa0: 7373 6f72 2c20 4578 7472 6154 7265 6573  ssor, ExtraTrees
-00002fb0: 5265 6772 6573 736f 722c 2042 6167 6769  Regressor, Baggi
-00002fc0: 6e67 5265 6772 6573 736f 720d 0a20 2020  ngRegressor..   
-00002fd0: 2066 726f 6d20 736b 6c65 6172 6e2e 7376   from sklearn.sv
-00002fe0: 6d20 696d 706f 7274 2053 5652 0d0a 2020  m import SVR..  
-00002ff0: 2020 6672 6f6d 2073 6b6c 6561 726e 2e6e    from sklearn.n
-00003000: 6569 6768 626f 7273 2069 6d70 6f72 7420  eighbors import 
-00003010: 4b4e 6569 6768 626f 7273 5265 6772 6573  KNeighborsRegres
-00003020: 736f 720d 0a20 2020 2066 726f 6d20 736b  sor..    from sk
-00003030: 6c65 6172 6e2e 6e65 7572 616c 5f6e 6574  learn.neural_net
-00003040: 776f 726b 2069 6d70 6f72 7420 4d4c 5052  work import MLPR
-00003050: 6567 7265 7373 6f72 0d0a 2020 2020 6672  egressor..    fr
-00003060: 6f6d 2078 6762 6f6f 7374 2069 6d70 6f72  om xgboost impor
-00003070: 7420 5847 4252 6567 7265 7373 6f72 0d0a  t XGBRegressor..
-00003080: 2020 2020 6672 6f6d 206c 6967 6874 6762      from lightgb
-00003090: 6d20 696d 706f 7274 204c 4742 4d52 6567  m import LGBMReg
-000030a0: 7265 7373 6f72 0d0a 2020 2020 6672 6f6d  ressor..    from
-000030b0: 2063 6174 626f 6f73 7420 696d 706f 7274   catboost import
-000030c0: 2043 6174 426f 6f73 7452 6567 7265 7373   CatBoostRegress
-000030d0: 6f72 0d0a 2020 2020 6672 6f6d 2073 6b6c  or..    from skl
-000030e0: 6561 726e 2069 6d70 6f72 7420 6d65 7472  earn import metr
-000030f0: 6963 730d 0a20 2020 2066 726f 6d20 736b  ics..    from sk
-00003100: 6c65 6172 6e2e 6d65 7472 6963 7320 696d  learn.metrics im
-00003110: 706f 7274 206d 6561 6e5f 7371 7561 7265  port mean_square
-00003120: 645f 6572 726f 722c 2072 325f 7363 6f72  d_error, r2_scor
-00003130: 650d 0a20 2020 2066 726f 6d20 736b 6c65  e..    from skle
-00003140: 6172 6e2e 6d6f 6465 6c5f 7365 6c65 6374  arn.model_select
-00003150: 696f 6e20 696d 706f 7274 2074 7261 696e  ion import train
-00003160: 5f74 6573 745f 7370 6c69 742c 2063 726f  _test_split, cro
-00003170: 7373 5f76 616c 5f73 636f 7265 2c20 6c65  ss_val_score, le
-00003180: 6172 6e69 6e67 5f63 7572 7665 0d0a 2020  arning_curve..  
-00003190: 2020 696d 706f 7274 206d 6174 706c 6f74    import matplot
-000031a0: 6c69 622e 7079 706c 6f74 2061 7320 706c  lib.pyplot as pl
-000031b0: 740d 0a0d 0a20 2020 206d 6f64 656c 7320  t....    models 
-000031c0: 3d20 5b0d 0a20 2020 2020 2020 2028 224c  = [..        ("L
-000031d0: 696e 6561 7220 5265 6772 6573 7369 6f6e  inear Regression
-000031e0: 222c 204c 696e 6561 7252 6567 7265 7373  ", LinearRegress
-000031f0: 696f 6e28 2929 2c0d 0a20 2020 2020 2020  ion()),..       
-00003200: 2028 2252 6964 6765 2052 6567 7265 7373   ("Ridge Regress
-00003210: 696f 6e22 2c20 5269 6467 6528 2929 2c0d  ion", Ridge()),.
-00003220: 0a20 2020 2020 2020 2028 224c 6173 736f  .        ("Lasso
-00003230: 2052 6567 7265 7373 696f 6e22 2c20 4c61   Regression", La
-00003240: 7373 6f28 2929 2c0d 0a20 2020 2020 2020  sso()),..       
-00003250: 2028 2245 6c61 7374 6963 4e65 7420 5265   ("ElasticNet Re
-00003260: 6772 6573 7369 6f6e 222c 2045 6c61 7374  gression", Elast
-00003270: 6963 4e65 7428 2929 2c0d 0a20 2020 2020  icNet()),..     
-00003280: 2020 2028 2242 6179 6573 6961 6e20 5269     ("Bayesian Ri
-00003290: 6467 6520 5265 6772 6573 7369 6f6e 222c  dge Regression",
-000032a0: 2042 6179 6573 6961 6e52 6964 6765 2829   BayesianRidge()
-000032b0: 292c 0d0a 2020 2020 2020 2020 2822 4465  ),..        ("De
-000032c0: 6369 7369 6f6e 2054 7265 6520 5265 6772  cision Tree Regr
-000032d0: 6573 736f 7222 2c20 4465 6369 7369 6f6e  essor", Decision
-000032e0: 5472 6565 5265 6772 6573 736f 7228 2929  TreeRegressor())
-000032f0: 2c0d 0a20 2020 2020 2020 2028 2252 616e  ,..        ("Ran
-00003300: 646f 6d20 466f 7265 7374 2052 6567 7265  dom Forest Regre
-00003310: 7373 6f72 222c 2052 616e 646f 6d46 6f72  ssor", RandomFor
-00003320: 6573 7452 6567 7265 7373 6f72 2829 292c  estRegressor()),
-00003330: 0d0a 2020 2020 2020 2020 2822 4772 6164  ..        ("Grad
-00003340: 6965 6e74 2042 6f6f 7374 696e 6720 5265  ient Boosting Re
-00003350: 6772 6573 736f 7222 2c20 4772 6164 6965  gressor", Gradie
-00003360: 6e74 426f 6f73 7469 6e67 5265 6772 6573  ntBoostingRegres
-00003370: 736f 7228 2929 2c0d 0a20 2020 2020 2020  sor()),..       
-00003380: 2028 2258 4742 6f6f 7374 2052 6567 7265   ("XGBoost Regre
-00003390: 7373 6f72 222c 2058 4742 5265 6772 6573  ssor", XGBRegres
-000033a0: 736f 7228 6576 616c 5f6d 6574 7269 633d  sor(eval_metric=
-000033b0: 2272 6d73 6522 2929 2c0d 0a20 2020 2020  "rmse")),..     
-000033c0: 2020 2028 224c 6967 6874 4742 4d20 5265     ("LightGBM Re
-000033d0: 6772 6573 736f 7222 2c20 4c47 424d 5265  gressor", LGBMRe
-000033e0: 6772 6573 736f 7228 2929 2c0d 0a20 2020  gressor()),..   
-000033f0: 2020 2020 2028 2253 7570 706f 7274 2056       ("Support V
-00003400: 6563 746f 7220 5265 6772 6573 736f 7222  ector Regressor"
-00003410: 2c20 5356 5228 2929 2c0d 0a20 2020 2020  , SVR()),..     
-00003420: 2020 2028 224b 2d4e 6561 7265 7374 204e     ("K-Nearest N
-00003430: 6569 6768 626f 7273 2052 6567 7265 7373  eighbors Regress
-00003440: 6f72 222c 204b 4e65 6967 6862 6f72 7352  or", KNeighborsR
-00003450: 6567 7265 7373 6f72 2829 292c 0d0a 2020  egressor()),..  
-00003460: 2020 2020 2020 2822 4d75 6c74 692d 6c61        ("Multi-la
-00003470: 7965 7220 5065 7263 6570 7472 6f6e 2052  yer Perceptron R
-00003480: 6567 7265 7373 6f72 222c 204d 4c50 5265  egressor", MLPRe
-00003490: 6772 6573 736f 7228 6d61 785f 6974 6572  gressor(max_iter
-000034a0: 3d31 3030 3029 292c 0d0a 2020 2020 2020  =1000)),..      
-000034b0: 2020 2822 4164 6142 6f6f 7374 2052 6567    ("AdaBoost Reg
-000034c0: 7265 7373 6f72 222c 2041 6461 426f 6f73  ressor", AdaBoos
-000034d0: 7452 6567 7265 7373 6f72 2829 292c 0d0a  tRegressor()),..
-000034e0: 2020 2020 2020 2020 2822 4578 7472 6120          ("Extra 
-000034f0: 5472 6565 7320 5265 6772 6573 736f 7222  Trees Regressor"
-00003500: 2c20 4578 7472 6154 7265 6573 5265 6772  , ExtraTreesRegr
-00003510: 6573 736f 7228 2929 2c0d 0a20 2020 2020  essor()),..     
-00003520: 2020 2028 2253 746f 6368 6173 7469 6320     ("Stochastic 
-00003530: 4772 6164 6965 6e74 2044 6573 6365 6e74  Gradient Descent
-00003540: 2052 6567 7265 7373 6f72 222c 2053 4744   Regressor", SGD
-00003550: 5265 6772 6573 736f 7228 2929 2c0d 0a20  Regressor()),.. 
-00003560: 2020 2020 2020 2028 2242 6167 6769 6e67         ("Bagging
-00003570: 2052 6567 7265 7373 6f72 222c 2042 6167   Regressor", Bag
-00003580: 6769 6e67 5265 6772 6573 736f 7228 2929  gingRegressor())
-00003590: 2c0d 0a20 2020 2020 2020 2028 2243 6174  ,..        ("Cat
-000035a0: 426f 6f73 7420 5265 6772 6573 736f 7222  Boost Regressor"
-000035b0: 2c20 4361 7442 6f6f 7374 5265 6772 6573  , CatBoostRegres
-000035c0: 736f 7228 7665 7262 6f73 653d 302c 2072  sor(verbose=0, r
-000035d0: 616e 646f 6d5f 7365 6564 3d34 3229 292c  andom_seed=42)),
-000035e0: 0d0a 2020 2020 5d0d 0a0d 0a20 2020 206e  ..    ]....    n
-000035f0: 5f73 616d 706c 6573 203d 2058 2e73 6861  _samples = X.sha
-00003600: 7065 5b30 5d0d 0a20 2020 2061 646a 7573  pe[0]..    adjus
-00003610: 7465 645f 7465 7374 5f73 697a 6520 3d20  ted_test_size = 
-00003620: 696e 7428 7465 7374 5f73 697a 6520 2a20  int(test_size * 
-00003630: 6e5f 7361 6d70 6c65 7329 0d0a 0d0a 2020  n_samples)....  
-00003640: 2020 6265 7374 5f6d 6f64 656c 203d 204e    best_model = N
-00003650: 6f6e 650d 0a20 2020 2062 6573 745f 6d73  one..    best_ms
-00003660: 6520 3d20 666c 6f61 7428 2269 6e66 2229  e = float("inf")
-00003670: 0d0a 2020 2020 6265 7374 5f6d 6f64 656c  ..    best_model
-00003680: 5f69 6e73 7461 6e63 6520 3d20 4e6f 6e65  _instance = None
-00003690: 0d0a 0d0a 2020 2020 666f 7220 6e61 6d65  ....    for name
-000036a0: 2c20 6d6f 6465 6c20 696e 206d 6f64 656c  , model in model
-000036b0: 733a 0d0a 2020 2020 2020 2020 585f 7472  s:..        X_tr
-000036c0: 6169 6e2c 2058 5f74 6573 742c 2079 5f74  ain, X_test, y_t
-000036d0: 7261 696e 2c20 795f 7465 7374 203d 2074  rain, y_test = t
-000036e0: 7261 696e 5f74 6573 745f 7370 6c69 7428  rain_test_split(
-000036f0: 582c 2079 2c20 7465 7374 5f73 697a 653d  X, y, test_size=
-00003700: 7465 7374 5f73 697a 652c 2072 616e 646f  test_size, rando
-00003710: 6d5f 7374 6174 653d 7261 6e64 6f6d 5f73  m_state=random_s
-00003720: 7461 7465 290d 0a20 2020 2020 2020 2058  tate)..        X
-00003730: 5f74 7261 696e 2c20 585f 7661 6c2c 2079  _train, X_val, y
-00003740: 5f74 7261 696e 2c20 795f 7661 6c20 3d20  _train, y_val = 
-00003750: 7472 6169 6e5f 7465 7374 5f73 706c 6974  train_test_split
-00003760: 2858 5f74 7261 696e 2c20 795f 7472 6169  (X_train, y_trai
-00003770: 6e2c 2074 6573 745f 7369 7a65 3d74 6573  n, test_size=tes
-00003780: 745f 7369 7a65 2c20 7261 6e64 6f6d 5f73  t_size, random_s
-00003790: 7461 7465 3d72 616e 646f 6d5f 7374 6174  tate=random_stat
-000037a0: 6529 0d0a 2020 2020 2020 2020 6d6f 6465  e)..        mode
-000037b0: 6c2e 6669 7428 585f 7472 6169 6e2c 2079  l.fit(X_train, y
-000037c0: 5f74 7261 696e 290d 0a20 2020 2020 2020  _train)..       
-000037d0: 200d 0a20 2020 2020 2020 2070 7269 6e74   ..        print
-000037e0: 286e 616d 6520 2b20 2220 4d6f 6465 6c3a  (name + " Model:
-000037f0: 2229 0d0a 2020 2020 2020 2020 6576 616c  ")..        eval
-00003800: 7561 7465 5f6d 6f64 656c 286d 6f64 656c  uate_model(model
-00003810: 2c20 582c 2079 2c20 7465 7374 5f73 697a  , X, y, test_siz
-00003820: 653d 6164 6a75 7374 6564 5f74 6573 745f  e=adjusted_test_
-00003830: 7369 7a65 2c20 7261 6e64 6f6d 5f73 7461  size, random_sta
-00003840: 7465 3d72 616e 646f 6d5f 7374 6174 652c  te=random_state,
-00003850: 2063 763d 6376 290d 0a20 2020 2020 2020   cv=cv)..       
-00003860: 2070 7269 6e74 2829 0d0a 0d0a 2020 2020   print()....    
-00003870: 2020 2020 795f 7072 6564 203d 206d 6f64      y_pred = mod
-00003880: 656c 2e70 7265 6469 6374 2858 5f74 6573  el.predict(X_tes
-00003890: 7429 0d0a 2020 2020 2020 2020 6d73 6520  t)..        mse 
-000038a0: 3d20 6d65 616e 5f73 7175 6172 6564 5f65  = mean_squared_e
-000038b0: 7272 6f72 2879 5f74 6573 742c 2079 5f70  rror(y_test, y_p
-000038c0: 7265 6429 0d0a 2020 2020 2020 2020 726d  red)..        rm
-000038d0: 7365 203d 206e 702e 7371 7274 286d 7365  se = np.sqrt(mse
-000038e0: 290d 0a20 2020 2020 2020 2072 3220 3d20  )..        r2 = 
-000038f0: 7232 5f73 636f 7265 2879 5f74 6573 742c  r2_score(y_test,
-00003900: 2079 5f70 7265 6429 0d0a 0d0a 2020 2020   y_pred)....    
-00003910: 2020 2020 6966 206d 7365 203c 2062 6573      if mse < bes
-00003920: 745f 6d73 653a 0d0a 2020 2020 2020 2020  t_mse:..        
-00003930: 2020 2020 6265 7374 5f6d 7365 203d 206d      best_mse = m
-00003940: 7365 0d0a 2020 2020 2020 2020 2020 2020  se..            
-00003950: 6265 7374 5f6d 6f64 656c 203d 206e 616d  best_model = nam
-00003960: 650d 0a20 2020 2020 2020 2020 2020 2062  e..            b
-00003970: 6573 745f 6d6f 6465 6c5f 696e 7374 616e  est_model_instan
-00003980: 6365 203d 206d 6f64 656c 0d0a 0d0a 2020  ce = model....  
-00003990: 2020 7072 696e 7428 2254 6865 2062 6573    print("The bes
-000039a0: 7420 6d6f 6465 6c20 6973 3a22 2c20 6265  t model is:", be
-000039b0: 7374 5f6d 6f64 656c 2c20 2277 6974 6820  st_model, "with 
-000039c0: 6120 4d65 616e 2053 7175 6172 6564 2045  a Mean Squared E
-000039d0: 7272 6f72 206f 6622 2c20 6265 7374 5f6d  rror of", best_m
-000039e0: 7365 290d 0a0d 0a20 2020 2023 2050 7269  se)....    # Pri
-000039f0: 6e74 2074 6865 206d 6574 7269 6373 2066  nt the metrics f
-00003a00: 6f72 2074 6865 2062 6573 7420 6d6f 6465  or the best mode
-00003a10: 6c0d 0a20 2020 2058 5f74 7261 696e 2c20  l..    X_train, 
-00003a20: 585f 7465 7374 2c20 795f 7472 6169 6e2c  X_test, y_train,
-00003a30: 2079 5f74 6573 7420 3d20 7472 6169 6e5f   y_test = train_
-00003a40: 7465 7374 5f73 706c 6974 2858 2c20 792c  test_split(X, y,
-00003a50: 2074 6573 745f 7369 7a65 3d74 6573 745f   test_size=test_
-00003a60: 7369 7a65 2c20 7261 6e64 6f6d 5f73 7461  size, random_sta
-00003a70: 7465 3d72 616e 646f 6d5f 7374 6174 6529  te=random_state)
-00003a80: 0d0a 2020 2020 585f 7472 6169 6e2c 2058  ..    X_train, X
-00003a90: 5f76 616c 2c20 795f 7472 6169 6e2c 2079  _val, y_train, y
-00003aa0: 5f76 616c 203d 2074 7261 696e 5f74 6573  _val = train_tes
-00003ab0: 745f 7370 6c69 7428 585f 7472 6169 6e2c  t_split(X_train,
-00003ac0: 2079 5f74 7261 696e 2c20 7465 7374 5f73   y_train, test_s
-00003ad0: 697a 653d 7465 7374 5f73 697a 652c 2072  ize=test_size, r
-00003ae0: 616e 646f 6d5f 7374 6174 653d 7261 6e64  andom_state=rand
-00003af0: 6f6d 5f73 7461 7465 290d 0a20 2020 2023  om_state)..    #
-00003b00: 2046 6974 2074 6865 2062 6573 7420 6d6f   Fit the best mo
-00003b10: 6465 6c20 6f6e 2074 6865 2074 7261 696e  del on the train
-00003b20: 696e 6720 6461 7461 0d0a 2020 2020 6265  ing data..    be
-00003b30: 7374 5f6d 6f64 656c 5f69 6e73 7461 6e63  st_model_instanc
-00003b40: 652e 6669 7428 585f 7472 6169 6e2c 2079  e.fit(X_train, y
-00003b50: 5f74 7261 696e 290d 0a0d 0a20 2020 2023  _train)....    #
-00003b60: 2050 7265 6469 6374 696f 6e73 0d0a 2020   Predictions..  
-00003b70: 2020 795f 7072 6564 5f62 6573 7420 3d20    y_pred_best = 
-00003b80: 6265 7374 5f6d 6f64 656c 5f69 6e73 7461  best_model_insta
-00003b90: 6e63 652e 7072 6564 6963 7428 585f 7465  nce.predict(X_te
-00003ba0: 7374 290d 0a20 2020 2062 6573 745f 726d  st)..    best_rm
-00003bb0: 7365 203d 206e 702e 7371 7274 2862 6573  se = np.sqrt(bes
-00003bc0: 745f 6d73 6529 0d0a 2020 2020 6265 7374  t_mse)..    best
-00003bd0: 5f72 3220 3d20 7232 5f73 636f 7265 2879  _r2 = r2_score(y
-00003be0: 5f74 6573 742c 2079 5f70 7265 645f 6265  _test, y_pred_be
-00003bf0: 7374 290d 0a0d 0a20 2020 2070 7269 6e74  st)....    print
-00003c00: 2822 4d65 7472 6963 7320 6f66 2074 6865  ("Metrics of the
-00003c10: 2062 6573 7420 6d6f 6465 6c3a 2229 0d0a   best model:")..
-00003c20: 2020 2020 7072 696e 7428 224d 6561 6e20      print("Mean 
-00003c30: 5371 7561 7265 6420 4572 726f 723a 222c  Squared Error:",
-00003c40: 2062 6573 745f 6d73 6529 0d0a 2020 2020   best_mse)..    
-00003c50: 7072 696e 7428 2252 6f6f 7420 4d65 616e  print("Root Mean
-00003c60: 2053 7175 6172 6564 2045 7272 6f72 3a22   Squared Error:"
-00003c70: 2c20 6265 7374 5f72 6d73 6529 0d0a 2020  , best_rmse)..  
-00003c80: 2020 7072 696e 7428 2252 2d73 7175 6172    print("R-squar
-00003c90: 6564 3a22 2c20 6265 7374 5f72 3229 0d0a  ed:", best_r2)..
-00003ca0: 0d0a 2020 2020 2320 4c65 6172 6e69 6e67  ..    # Learning
-00003cb0: 2063 7572 7665 2066 6f72 2074 6865 2062   curve for the b
-00003cc0: 6573 7420 6d6f 6465 6c0d 0a20 2020 2074  est model..    t
-00003cd0: 7261 696e 5f73 697a 6573 2c20 7472 6169  rain_sizes, trai
-00003ce0: 6e5f 7363 6f72 6573 2c20 7661 6c5f 7363  n_scores, val_sc
-00003cf0: 6f72 6573 203d 206c 6561 726e 696e 675f  ores = learning_
-00003d00: 6375 7276 6528 6265 7374 5f6d 6f64 656c  curve(best_model
-00003d10: 5f69 6e73 7461 6e63 652c 2058 5f74 7261  _instance, X_tra
-00003d20: 696e 2c20 795f 7472 6169 6e2c 2063 763d  in, y_train, cv=
-00003d30: 6376 2c20 7363 6f72 696e 673d 276e 6567  cv, scoring='neg
-00003d40: 5f6d 6561 6e5f 7371 7561 7265 645f 6572  _mean_squared_er
-00003d50: 726f 7227 290d 0a20 2020 2074 7261 696e  ror')..    train
-00003d60: 5f73 636f 7265 7320 3d20 6e70 2e73 7172  _scores = np.sqr
-00003d70: 7428 2d74 7261 696e 5f73 636f 7265 7329  t(-train_scores)
-00003d80: 2e6d 6561 6e28 6178 6973 3d31 290d 0a20  .mean(axis=1).. 
-00003d90: 2020 2076 616c 5f73 636f 7265 7320 3d20     val_scores = 
-00003da0: 6e70 2e73 7172 7428 2d76 616c 5f73 636f  np.sqrt(-val_sco
-00003db0: 7265 7329 2e6d 6561 6e28 6178 6973 3d31  res).mean(axis=1
-00003dc0: 290d 0a0d 0a20 2020 2070 6c74 2e70 6c6f  )....    plt.plo
-00003dd0: 7428 7472 6169 6e5f 7369 7a65 732c 2074  t(train_sizes, t
-00003de0: 7261 696e 5f73 636f 7265 732c 2027 6f2d  rain_scores, 'o-
-00003df0: 272c 206c 6162 656c 3d22 5472 6169 6e69  ', label="Traini
-00003e00: 6e67 2073 636f 7265 2229 0d0a 2020 2020  ng score")..    
-00003e10: 706c 742e 706c 6f74 2874 7261 696e 5f73  plt.plot(train_s
-00003e20: 697a 6573 2c20 7661 6c5f 7363 6f72 6573  izes, val_scores
-00003e30: 2c20 276f 2d27 2c20 6c61 6265 6c3d 2256  , 'o-', label="V
-00003e40: 616c 6964 6174 696f 6e20 7363 6f72 6522  alidation score"
-00003e50: 290d 0a20 2020 2070 6c74 2e78 6c61 6265  )..    plt.xlabe
-00003e60: 6c28 2254 7261 696e 696e 6720 7365 7420  l("Training set 
-00003e70: 7369 7a65 2229 0d0a 2020 2020 706c 742e  size")..    plt.
-00003e80: 796c 6162 656c 2822 524d 5345 2229 0d0a  ylabel("RMSE")..
-00003e90: 2020 2020 706c 742e 6c65 6765 6e64 2829      plt.legend()
-00003ea0: 0d0a 2020 2020 706c 742e 7368 6f77 2829  ..    plt.show()
-00003eb0: 0d0a 0d0a 2020 2020 7265 7475 726e 2062  ....    return b
-00003ec0: 6573 745f 6d6f 6465 6c5f 696e 7374 616e  est_model_instan
-00003ed0: 6365 0d0a 0d0a 0d0a 0d0a 0d0a 6465 6620  ce..........def 
-00003ee0: 7475 6e65 5f4d 4c50 635f 7061 7261 6d65  tune_MLPc_parame
-00003ef0: 7465 7273 2858 5f74 7261 696e 2c20 585f  ters(X_train, X_
-00003f00: 7465 7374 2c20 795f 7472 6169 6e2c 2079  test, y_train, y
-00003f10: 5f74 6573 742c 2070 6172 616d 735f 746f  _test, params_to
-00003f20: 5f74 7279 3d4e 6f6e 652c 206e 756d 5f63  _try=None, num_c
-00003f30: 6f6d 6269 6e61 7469 6f6e 733d 4e6f 6e65  ombinations=None
-00003f40: 2c20 7261 6e64 6f6d 5f73 7461 7465 3d31  , random_state=1
-00003f50: 2c20 6f70 7469 6d69 7a61 7469 6f6e 5f74  , optimization_t
-00003f60: 6172 6765 743d 2761 6363 7572 6163 7927  arget='accuracy'
-00003f70: 293a 0d0a 2020 2020 6672 6f6d 2073 6b6c  ):..    from skl
-00003f80: 6561 726e 2e6e 6575 7261 6c5f 6e65 7477  earn.neural_netw
-00003f90: 6f72 6b20 696d 706f 7274 204d 4c50 436c  ork import MLPCl
-00003fa0: 6173 7369 6669 6572 0d0a 2020 2020 6672  assifier..    fr
-00003fb0: 6f6d 2073 6b6c 6561 726e 2e6d 6574 7269  om sklearn.metri
-00003fc0: 6373 2069 6d70 6f72 7420 6163 6375 7261  cs import accura
-00003fd0: 6379 5f73 636f 7265 2c20 636f 6e66 7573  cy_score, confus
-00003fe0: 696f 6e5f 6d61 7472 6978 2c20 7072 6563  ion_matrix, prec
-00003ff0: 6973 696f 6e5f 7363 6f72 652c 2072 6563  ision_score, rec
-00004000: 616c 6c5f 7363 6f72 650d 0a20 2020 2066  all_score..    f
-00004010: 726f 6d20 6974 6572 746f 6f6c 7320 696d  rom itertools im
-00004020: 706f 7274 2070 726f 6475 6374 0d0a 2020  port product..  
-00004030: 2020 696d 706f 7274 206e 756d 7079 2061    import numpy a
-00004040: 7320 6e70 0d0a 0d0a 2020 2020 6966 2070  s np....    if p
-00004050: 6172 616d 735f 746f 5f74 7279 2069 7320  arams_to_try is 
-00004060: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2070  None:..        p
-00004070: 6172 616d 735f 746f 5f74 7279 203d 207b  arams_to_try = {
-00004080: 0d0a 2020 2020 2020 2020 2020 2020 2773  ..            's
-00004090: 6f6c 7665 7227 3a20 5b27 6c62 6667 7327  olver': ['lbfgs'
-000040a0: 2c20 2761 6461 6d27 5d2c 0d0a 2020 2020  , 'adam'],..    
-000040b0: 2020 2020 2020 2020 2761 6374 6976 6174          'activat
-000040c0: 696f 6e27 3a20 5b27 7265 6c75 272c 2027  ion': ['relu', '
-000040d0: 7461 6e68 272c 2027 6c6f 6769 7374 6963  tanh', 'logistic
-000040e0: 275d 2c0d 0a20 2020 2020 2020 2020 2020  '],..           
-000040f0: 2027 616c 7068 6127 3a20 5b30 2e30 3030   'alpha': [0.000
-00004100: 312c 2030 2e30 3031 2c20 302e 3031 5d2c  1, 0.001, 0.01],
-00004110: 0d0a 2020 2020 2020 2020 2020 2020 276c  ..            'l
-00004120: 6561 726e 696e 675f 7261 7465 5f69 6e69  earning_rate_ini
-00004130: 7427 3a20 5b30 2e30 3030 312c 2030 2e30  t': [0.0001, 0.0
-00004140: 3030 352c 2030 2e30 3031 5d2c 0d0a 2020  005, 0.001],..  
-00004150: 2020 2020 2020 2020 2020 276d 6178 5f69            'max_i
-00004160: 7465 7227 3a20 5b35 3030 302c 2031 3030  ter': [5000, 100
-00004170: 3030 2c20 3135 3030 305d 0d0a 2020 2020  00, 15000]..    
-00004180: 2020 2020 7d0d 0a0d 0a20 2020 2070 6172      }....    par
-00004190: 616d 5f63 6f6d 6269 6e61 7469 6f6e 7320  am_combinations 
-000041a0: 3d20 6c69 7374 2870 726f 6475 6374 282a  = list(product(*
-000041b0: 7061 7261 6d73 5f74 6f5f 7472 792e 7661  params_to_try.va
-000041c0: 6c75 6573 2829 2929 0d0a 0d0a 2020 2020  lues()))....    
-000041d0: 6966 206e 756d 5f63 6f6d 6269 6e61 7469  if num_combinati
-000041e0: 6f6e 7320 6973 204e 6f6e 653a 0d0a 2020  ons is None:..  
-000041f0: 2020 2020 2020 6e75 6d5f 636f 6d62 696e        num_combin
-00004200: 6174 696f 6e73 203d 2031 300d 0a20 2020  ations = 10..   
-00004210: 2065 6c69 6620 6e75 6d5f 636f 6d62 696e   elif num_combin
-00004220: 6174 696f 6e73 203d 3d20 276d 6178 273a  ations == 'max':
-00004230: 0d0a 2020 2020 2020 2020 6e75 6d5f 636f  ..        num_co
-00004240: 6d62 696e 6174 696f 6e73 203d 206c 656e  mbinations = len
-00004250: 2870 6172 616d 5f63 6f6d 6269 6e61 7469  (param_combinati
-00004260: 6f6e 7329 0d0a 0d0a 2020 2020 6265 7374  ons)....    best
-00004270: 5f6d 6f64 656c 203d 204e 6f6e 650d 0a20  _model = None.. 
-00004280: 2020 2062 6573 745f 7061 7261 6d73 203d     best_params =
-00004290: 204e 6f6e 650d 0a20 2020 2062 6573 745f   None..    best_
-000042a0: 7363 6f72 6520 3d20 2d6e 702e 696e 6620  score = -np.inf 
-000042b0: 6966 206f 7074 696d 697a 6174 696f 6e5f  if optimization_
-000042c0: 7461 7267 6574 203d 3d20 2761 6363 7572  target == 'accur
-000042d0: 6163 7927 2065 6c73 6520 6e70 2e69 6e66  acy' else np.inf
-000042e0: 0d0a 0d0a 2020 2020 666f 7220 6920 696e  ....    for i in
-000042f0: 2072 616e 6765 286e 756d 5f63 6f6d 6269   range(num_combi
-00004300: 6e61 7469 6f6e 7329 3a0d 0a20 2020 2020  nations):..     
-00004310: 2020 2063 686f 7365 6e5f 7061 7261 6d73     chosen_params
-00004320: 203d 2064 6963 7428 7a69 7028 7061 7261   = dict(zip(para
-00004330: 6d73 5f74 6f5f 7472 792e 6b65 7973 2829  ms_to_try.keys()
-00004340: 2c20 7061 7261 6d5f 636f 6d62 696e 6174  , param_combinat
-00004350: 696f 6e73 5b6e 702e 7261 6e64 6f6d 2e63  ions[np.random.c
-00004360: 686f 6963 6528 6c65 6e28 7061 7261 6d5f  hoice(len(param_
-00004370: 636f 6d62 696e 6174 696f 6e73 2929 5d29  combinations))])
-00004380: 290d 0a0d 0a20 2020 2020 2020 206d 6c70  )....        mlp
-00004390: 203d 204d 4c50 436c 6173 7369 6669 6572   = MLPClassifier
-000043a0: 2872 616e 646f 6d5f 7374 6174 653d 7261  (random_state=ra
-000043b0: 6e64 6f6d 5f73 7461 7465 2c20 2a2a 6368  ndom_state, **ch
-000043c0: 6f73 656e 5f70 6172 616d 7329 0d0a 2020  osen_params)..  
-000043d0: 2020 2020 2020 6d6c 702e 6669 7428 585f        mlp.fit(X_
-000043e0: 7472 6169 6e2c 2079 5f74 7261 696e 290d  train, y_train).
-000043f0: 0a0d 0a20 2020 2020 2020 2079 5f70 7265  ...        y_pre
-00004400: 6420 3d20 6d6c 702e 7072 6564 6963 7428  d = mlp.predict(
-00004410: 585f 7465 7374 290d 0a20 2020 2020 2020  X_test)..       
-00004420: 2063 6d20 3d20 636f 6e66 7573 696f 6e5f   cm = confusion_
-00004430: 6d61 7472 6978 2879 5f74 6573 742c 2079  matrix(y_test, y
-00004440: 5f70 7265 6429 0d0a 2020 2020 2020 2020  _pred)..        
-00004450: 6661 6c73 655f 6e65 6761 7469 7665 7320  false_negatives 
-00004460: 3d20 636d 5b31 5d5b 305d 0d0a 2020 2020  = cm[1][0]..    
-00004470: 2020 2020 6163 6375 7261 6379 203d 2061      accuracy = a
-00004480: 6363 7572 6163 795f 7363 6f72 6528 795f  ccuracy_score(y_
-00004490: 7465 7374 2c20 795f 7072 6564 290d 0a0d  test, y_pred)...
-000044a0: 0a20 2020 2020 2020 2069 6620 6f70 7469  .        if opti
-000044b0: 6d69 7a61 7469 6f6e 5f74 6172 6765 7420  mization_target 
-000044c0: 3d3d 2027 6163 6375 7261 6379 273a 0d0a  == 'accuracy':..
-000044d0: 2020 2020 2020 2020 2020 2020 7363 6f72              scor
-000044e0: 6520 3d20 6163 6375 7261 6379 0d0a 2020  e = accuracy..  
-000044f0: 2020 2020 2020 2020 2020 6265 7474 6572            better
-00004500: 203d 2073 636f 7265 203e 2062 6573 745f   = score > best_
-00004510: 7363 6f72 650d 0a20 2020 2020 2020 2065  score..        e
-00004520: 6c69 6620 6f70 7469 6d69 7a61 7469 6f6e  lif optimization
-00004530: 5f74 6172 6765 7420 3d3d 2027 6d69 6e69  _target == 'mini
-00004540: 6d69 7a65 5f66 616c 7365 5f6e 6567 6174  mize_false_negat
-00004550: 6976 6573 273a 0d0a 2020 2020 2020 2020  ives':..        
-00004560: 2020 2020 7363 6f72 6520 3d20 6661 6c73      score = fals
-00004570: 655f 6e65 6761 7469 7665 730d 0a20 2020  e_negatives..   
-00004580: 2020 2020 2020 2020 2062 6574 7465 7220           better 
-00004590: 3d20 7363 6f72 6520 3c20 6265 7374 5f73  = score < best_s
-000045a0: 636f 7265 0d0a 2020 2020 2020 2020 656c  core..        el
-000045b0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-000045c0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-000045d0: 7228 2249 6e76 616c 6964 206f 7074 696d  r("Invalid optim
-000045e0: 697a 6174 696f 6e5f 7461 7267 6574 2e20  ization_target. 
-000045f0: 4368 6f6f 7365 2027 6163 6375 7261 6379  Choose 'accuracy
-00004600: 2720 6f72 2027 6d69 6e69 6d69 7a65 5f66  ' or 'minimize_f
-00004610: 616c 7365 5f6e 6567 6174 6976 6573 272e  alse_negatives'.
-00004620: 2229 0d0a 0d0a 2020 2020 2020 2020 6966  ")....        if
-00004630: 2062 6574 7465 723a 0d0a 2020 2020 2020   better:..      
-00004640: 2020 2020 2020 6265 7374 5f6d 6f64 656c        best_model
-00004650: 203d 206d 6c70 0d0a 2020 2020 2020 2020   = mlp..        
-00004660: 2020 2020 6265 7374 5f70 6172 616d 7320      best_params 
-00004670: 3d20 6368 6f73 656e 5f70 6172 616d 730d  = chosen_params.
-00004680: 0a20 2020 2020 2020 2020 2020 2062 6573  .            bes
-00004690: 745f 7363 6f72 6520 3d20 7363 6f72 650d  t_score = score.
-000046a0: 0a0d 0a20 2020 2070 7269 6e74 2822 4265  ...    print("Be
-000046b0: 7374 2068 7970 6572 7061 7261 6d65 7465  st hyperparamete
-000046c0: 7273 3a22 290d 0a20 2020 2070 7269 6e74  rs:")..    print
-000046d0: 2862 6573 745f 7061 7261 6d73 290d 0a20  (best_params).. 
-000046e0: 2020 2070 7269 6e74 2862 6573 745f 6d6f     print(best_mo
-000046f0: 6465 6c29 0d0a 2020 2020 6265 7374 5f6d  del)..    best_m
-00004700: 6f64 656c 5f73 7472 203d 2066 224d 4c50  odel_str = f"MLP
-00004710: 203d 204d 4c50 436c 6173 7369 6669 6572   = MLPClassifier
-00004720: 2861 6374 6976 6174 696f 6e3d 277b 6265  (activation='{be
-00004730: 7374 5f70 6172 616d 735b 2761 6374 6976  st_params['activ
-00004740: 6174 696f 6e27 5d7d 272c 2061 6c70 6861  ation']}', alpha
-00004750: 3d7b 6265 7374 5f70 6172 616d 735b 2761  ={best_params['a
-00004760: 6c70 6861 275d 7d2c 2022 205c 0d0a 2020  lpha']}, " \..  
-00004770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004780: 2020 2066 226c 6561 726e 696e 675f 7261     f"learning_ra
-00004790: 7465 5f69 6e69 743d 7b62 6573 745f 7061  te_init={best_pa
-000047a0: 7261 6d73 5b27 6c65 6172 6e69 6e67 5f72  rams['learning_r
-000047b0: 6174 655f 696e 6974 275d 7d2c 206d 6178  ate_init']}, max
-000047c0: 5f69 7465 723d 7b62 6573 745f 7061 7261  _iter={best_para
-000047d0: 6d73 5b27 6d61 785f 6974 6572 275d 7d2c  ms['max_iter']},
-000047e0: 2022 205c 0d0a 2020 2020 2020 2020 2020   " \..          
-000047f0: 2020 2020 2020 2020 2020 2066 2273 6f6c             f"sol
-00004800: 7665 723d 277b 6265 7374 5f70 6172 616d  ver='{best_param
-00004810: 735b 2773 6f6c 7665 7227 5d7d 272c 2072  s['solver']}', r
-00004820: 616e 646f 6d5f 7374 6174 653d 3129 220d  andom_state=1)".
-00004830: 0a20 2020 2070 7269 6e74 2862 6573 745f  .    print(best_
-00004840: 6d6f 6465 6c5f 7374 7229 0d0a 0d0a 2020  model_str)....  
-00004850: 2020 795f 7072 6564 203d 2062 6573 745f    y_pred = best_
-00004860: 6d6f 6465 6c2e 7072 6564 6963 7428 585f  model.predict(X_
-00004870: 7465 7374 290d 0a0d 0a20 2020 2070 7269  test)....    pri
-00004880: 6e74 2866 2241 6363 7572 6163 7920 666f  nt(f"Accuracy fo
-00004890: 7220 6265 7374 206d 6f64 656c 3a20 7b61  r best model: {a
-000048a0: 6363 7572 6163 795f 7363 6f72 6528 795f  ccuracy_score(y_
-000048b0: 7465 7374 2c20 795f 7072 6564 297d 2229  test, y_pred)}")
-000048c0: 0d0a 2020 2020 7072 696e 7428 6622 436f  ..    print(f"Co
-000048d0: 6e66 7573 696f 6e20 6d61 7472 6978 2066  nfusion matrix f
-000048e0: 6f72 2062 6573 7420 6d6f 6465 6c3a 5c6e  or best model:\n
-000048f0: 7b63 6f6e 6675 7369 6f6e 5f6d 6174 7269  {confusion_matri
-00004900: 7828 795f 7465 7374 2c20 795f 7072 6564  x(y_test, y_pred
-00004910: 297d 2229 0d0a 2020 2020 7072 696e 7428  )}")..    print(
-00004920: 6622 5072 6563 6973 696f 6e20 666f 7220  f"Precision for 
-00004930: 6265 7374 206d 6f64 656c 3a20 7b70 7265  best model: {pre
-00004940: 6369 7369 6f6e 5f73 636f 7265 2879 5f74  cision_score(y_t
-00004950: 6573 742c 2079 5f70 7265 6429 7d22 290d  est, y_pred)}").
-00004960: 0a20 2020 2070 7269 6e74 2866 2252 6563  .    print(f"Rec
-00004970: 616c 6c20 666f 7220 6265 7374 206d 6f64  all for best mod
-00004980: 656c 3a20 7b72 6563 616c 6c5f 7363 6f72  el: {recall_scor
-00004990: 6528 795f 7465 7374 2c20 795f 7072 6564  e(y_test, y_pred
-000049a0: 297d 2229 0d0a 0d0a 2020 2020 7265 7475  )}")....    retu
-000049b0: 726e 2062 6573 745f 6d6f 6465 6c2c 2062  rn best_model, b
-000049c0: 6573 745f 7061 7261 6d73 0d0a 0d0a 0d0a  est_params......
-000049d0: 0d0a 0d0a 0d0a 0d0a 0d0a 6465 6620 7475  ..........def tu
-000049e0: 6e65 5f4d 4c50 725f 7061 7261 6d65 7465  ne_MLPr_paramete
-000049f0: 7273 2858 5f74 7261 696e 2c20 585f 7465  rs(X_train, X_te
-00004a00: 7374 2c20 795f 7472 6169 6e2c 2079 5f74  st, y_train, y_t
-00004a10: 6573 742c 2070 6172 616d 735f 746f 5f74  est, params_to_t
-00004a20: 7279 3d4e 6f6e 652c 206e 756d 5f63 6f6d  ry=None, num_com
-00004a30: 6269 6e61 7469 6f6e 733d 4e6f 6e65 2c20  binations=None, 
-00004a40: 7261 6e64 6f6d 5f73 7461 7465 3d31 293a  random_state=1):
-00004a50: 0d0a 2020 2020 6672 6f6d 2073 6b6c 6561  ..    from sklea
-00004a60: 726e 2e6e 6575 7261 6c5f 6e65 7477 6f72  rn.neural_networ
-00004a70: 6b20 696d 706f 7274 204d 4c50 5265 6772  k import MLPRegr
-00004a80: 6573 736f 720d 0a20 2020 2066 726f 6d20  essor..    from 
-00004a90: 736b 6c65 6172 6e2e 6d65 7472 6963 7320  sklearn.metrics 
-00004aa0: 696d 706f 7274 206d 6561 6e5f 7371 7561  import mean_squa
-00004ab0: 7265 645f 6572 726f 722c 2072 325f 7363  red_error, r2_sc
-00004ac0: 6f72 650d 0a20 2020 2066 726f 6d20 6974  ore..    from it
-00004ad0: 6572 746f 6f6c 7320 696d 706f 7274 2070  ertools import p
-00004ae0: 726f 6475 6374 0d0a 2020 2020 696d 706f  roduct..    impo
-00004af0: 7274 206e 756d 7079 2061 7320 6e70 0d0a  rt numpy as np..
-00004b00: 0d0a 2020 2020 6966 2070 6172 616d 735f  ..    if params_
-00004b10: 746f 5f74 7279 2069 7320 4e6f 6e65 3a0d  to_try is None:.
-00004b20: 0a20 2020 2020 2020 2070 6172 616d 735f  .        params_
-00004b30: 746f 5f74 7279 203d 207b 0d0a 2020 2020  to_try = {..    
-00004b40: 2020 2020 2020 2020 2773 6f6c 7665 7227          'solver'
-00004b50: 3a20 5b27 6c62 6667 7327 2c20 2761 6461  : ['lbfgs', 'ada
-00004b60: 6d27 5d2c 0d0a 2020 2020 2020 2020 2020  m'],..          
-00004b70: 2020 2761 6374 6976 6174 696f 6e27 3a20    'activation': 
-00004b80: 5b27 7265 6c75 272c 2027 7461 6e68 272c  ['relu', 'tanh',
-00004b90: 2027 6c6f 6769 7374 6963 275d 2c0d 0a20   'logistic'],.. 
-00004ba0: 2020 2020 2020 2020 2020 2027 616c 7068             'alph
-00004bb0: 6127 3a20 5b30 2e30 3030 312c 2030 2e30  a': [0.0001, 0.0
-00004bc0: 3031 2c20 302e 3031 5d2c 0d0a 2020 2020  01, 0.01],..    
-00004bd0: 2020 2020 2020 2020 276c 6561 726e 696e          'learnin
-00004be0: 675f 7261 7465 5f69 6e69 7427 3a20 5b30  g_rate_init': [0
-00004bf0: 2e30 3030 312c 2030 2e30 3030 352c 2030  .0001, 0.0005, 0
-00004c00: 2e30 3031 5d2c 0d0a 2020 2020 2020 2020  .001],..        
-00004c10: 2020 2020 276d 6178 5f69 7465 7227 3a20      'max_iter': 
-00004c20: 5b35 3030 302c 2031 3030 3030 2c20 3135  [5000, 10000, 15
-00004c30: 3030 305d 0d0a 2020 2020 2020 2020 7d0d  000]..        }.
-00004c40: 0a0d 0a20 2020 2070 6172 616d 5f63 6f6d  ...    param_com
-00004c50: 6269 6e61 7469 6f6e 7320 3d20 6c69 7374  binations = list
-00004c60: 2870 726f 6475 6374 282a 7061 7261 6d73  (product(*params
-00004c70: 5f74 6f5f 7472 792e 7661 6c75 6573 2829  _to_try.values()
-00004c80: 2929 0d0a 0d0a 2020 2020 6966 206e 756d  ))....    if num
-00004c90: 5f63 6f6d 6269 6e61 7469 6f6e 7320 6973  _combinations is
-00004ca0: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
-00004cb0: 6e75 6d5f 636f 6d62 696e 6174 696f 6e73  num_combinations
-00004cc0: 203d 2031 300d 0a20 2020 2065 6c69 6620   = 10..    elif 
-00004cd0: 6e75 6d5f 636f 6d62 696e 6174 696f 6e73  num_combinations
-00004ce0: 203d 3d20 276d 6178 273a 0d0a 2020 2020   == 'max':..    
-00004cf0: 2020 2020 6e75 6d5f 636f 6d62 696e 6174      num_combinat
-00004d00: 696f 6e73 203d 206c 656e 2870 6172 616d  ions = len(param
-00004d10: 5f63 6f6d 6269 6e61 7469 6f6e 7329 0d0a  _combinations)..
-00004d20: 0d0a 2020 2020 6265 7374 5f6d 6f64 656c  ..    best_model
-00004d30: 203d 204e 6f6e 650d 0a20 2020 2062 6573   = None..    bes
-00004d40: 745f 7061 7261 6d73 203d 204e 6f6e 650d  t_params = None.
-00004d50: 0a20 2020 2062 6573 745f 6d73 6520 3d20  .    best_mse = 
-00004d60: 6e70 2e69 6e66 0d0a 0d0a 2020 2020 666f  np.inf....    fo
-00004d70: 7220 6920 696e 2072 616e 6765 286e 756d  r i in range(num
-00004d80: 5f63 6f6d 6269 6e61 7469 6f6e 7329 3a0d  _combinations):.
-00004d90: 0a20 2020 2020 2020 2063 686f 7365 6e5f  .        chosen_
-00004da0: 7061 7261 6d73 203d 2064 6963 7428 7a69  params = dict(zi
-00004db0: 7028 7061 7261 6d73 5f74 6f5f 7472 792e  p(params_to_try.
-00004dc0: 6b65 7973 2829 2c20 7061 7261 6d5f 636f  keys(), param_co
-00004dd0: 6d62 696e 6174 696f 6e73 5b6e 702e 7261  mbinations[np.ra
-00004de0: 6e64 6f6d 2e63 686f 6963 6528 6c65 6e28  ndom.choice(len(
-00004df0: 7061 7261 6d5f 636f 6d62 696e 6174 696f  param_combinatio
-00004e00: 6e73 2929 5d29 290d 0a0d 0a20 2020 2020  ns))]))....     
-00004e10: 2020 206d 6c70 203d 204d 4c50 5265 6772     mlp = MLPRegr
-00004e20: 6573 736f 7228 7261 6e64 6f6d 5f73 7461  essor(random_sta
-00004e30: 7465 3d72 616e 646f 6d5f 7374 6174 652c  te=random_state,
-00004e40: 202a 2a63 686f 7365 6e5f 7061 7261 6d73   **chosen_params
-00004e50: 290d 0a20 2020 2020 2020 206d 6c70 2e66  )..        mlp.f
-00004e60: 6974 2858 5f74 7261 696e 2c20 795f 7472  it(X_train, y_tr
-00004e70: 6169 6e29 0d0a 0d0a 2020 2020 2020 2020  ain)....        
-00004e80: 795f 7072 6564 203d 206d 6c70 2e70 7265  y_pred = mlp.pre
-00004e90: 6469 6374 2858 5f74 6573 7429 0d0a 2020  dict(X_test)..  
-00004ea0: 2020 2020 2020 6d73 6520 3d20 6d65 616e        mse = mean
-00004eb0: 5f73 7175 6172 6564 5f65 7272 6f72 2879  _squared_error(y
-00004ec0: 5f74 6573 742c 2079 5f70 7265 6429 0d0a  _test, y_pred)..
-00004ed0: 2020 2020 2020 2020 7072 696e 7428 6622          print(f"
-00004ee0: 4d65 616e 2073 7175 6172 6564 2065 7272  Mean squared err
-00004ef0: 6f72 2066 6f72 2070 6172 616d 6574 6572  or for parameter
-00004f00: 7320 7b63 686f 7365 6e5f 7061 7261 6d73  s {chosen_params
-00004f10: 7d3a 207b 6d73 657d 2229 0d0a 0d0a 2020  }: {mse}")....  
-00004f20: 2020 2020 2020 6966 206d 7365 203c 2062        if mse < b
-00004f30: 6573 745f 6d73 653a 0d0a 2020 2020 2020  est_mse:..      
-00004f40: 2020 2020 2020 6265 7374 5f6d 6f64 656c        best_model
-00004f50: 203d 206d 6c70 0d0a 2020 2020 2020 2020   = mlp..        
-00004f60: 2020 2020 6265 7374 5f70 6172 616d 7320      best_params 
-00004f70: 3d20 6368 6f73 656e 5f70 6172 616d 730d  = chosen_params.
-00004f80: 0a20 2020 2020 2020 2020 2020 2062 6573  .            bes
-00004f90: 745f 6d73 6520 3d20 6d73 650d 0a0d 0a20  t_mse = mse.... 
-00004fa0: 2020 2070 7269 6e74 2822 4265 7374 2068     print("Best h
-00004fb0: 7970 6572 7061 7261 6d65 7465 7273 3a22  yperparameters:"
-00004fc0: 290d 0a20 2020 2070 7269 6e74 2862 6573  )..    print(bes
-00004fd0: 745f 7061 7261 6d73 290d 0a20 2020 2070  t_params)..    p
-00004fe0: 7269 6e74 2862 6573 745f 6d6f 6465 6c29  rint(best_model)
-00004ff0: 0d0a 2020 2020 6265 7374 5f6d 6f64 656c  ..    best_model
-00005000: 5f73 7472 203d 2066 224d 4c50 203d 204d  _str = f"MLP = M
-00005010: 4c50 5265 6772 6573 736f 7228 6163 7469  LPRegressor(acti
-00005020: 7661 7469 6f6e 3d27 7b62 6573 745f 7061  vation='{best_pa
-00005030: 7261 6d73 5b27 6163 7469 7661 7469 6f6e  rams['activation
-00005040: 275d 7d27 2c20 616c 7068 613d 7b62 6573  ']}', alpha={bes
-00005050: 745f 7061 7261 6d73 5b27 616c 7068 6127  t_params['alpha'
-00005060: 5d7d 2c20 2220 5c0d 0a20 2020 2020 2020  ]}, " \..       
-00005070: 2020 2020 2020 2020 2020 2020 2020 6622                f"
-00005080: 6c65 6172 6e69 6e67 5f72 6174 655f 696e  learning_rate_in
-00005090: 6974 3d7b 6265 7374 5f70 6172 616d 735b  it={best_params[
-000050a0: 276c 6561 726e 696e 675f 7261 7465 5f69  'learning_rate_i
-000050b0: 6e69 7427 5d7d 2c20 6d61 785f 6974 6572  nit']}, max_iter
-000050c0: 3d7b 6265 7374 5f70 6172 616d 735b 276d  ={best_params['m
-000050d0: 6178 5f69 7465 7227 5d7d 2c20 2220 5c0d  ax_iter']}, " \.
-000050e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000050f0: 2020 2020 2020 6622 736f 6c76 6572 3d27        f"solver='
-00005100: 7b62 6573 745f 7061 7261 6d73 5b27 736f  {best_params['so
-00005110: 6c76 6572 275d 7d27 2c20 7261 6e64 6f6d  lver']}', random
-00005120: 5f73 7461 7465 3d31 2922 0d0a 2020 2020  _state=1)"..    
-00005130: 7072 696e 7428 6265 7374 5f6d 6f64 656c  print(best_model
-00005140: 5f73 7472 290d 0a0d 0a20 2020 2079 5f70  _str)....    y_p
-00005150: 7265 6420 3d20 6265 7374 5f6d 6f64 656c  red = best_model
-00005160: 2e70 7265 6469 6374 2858 5f74 6573 7429  .predict(X_test)
-00005170: 0d0a 2020 2020 0d0a 2020 2020 7072 696e  ..    ..    prin
-00005180: 7428 6622 4d65 616e 2073 7175 6172 6564  t(f"Mean squared
-00005190: 2065 7272 6f72 2066 6f72 2062 6573 7420   error for best 
-000051a0: 6d6f 6465 6c3a 207b 6d65 616e 5f73 7175  model: {mean_squ
-000051b0: 6172 6564 5f65 7272 6f72 2879 5f74 6573  ared_error(y_tes
-000051c0: 742c 2079 5f70 7265 6429 7d22 290d 0a20  t, y_pred)}").. 
-000051d0: 2020 2070 7269 6e74 2866 2252 3220 7363     print(f"R2 sc
-000051e0: 6f72 6520 666f 7220 6265 7374 206d 6f64  ore for best mod
-000051f0: 656c 3a20 7b72 325f 7363 6f72 6528 795f  el: {r2_score(y_
-00005200: 7465 7374 2c20 795f 7072 6564 297d 2229  test, y_pred)}")
-00005210: 0d0a 2020 2020 7072 696e 7428 6622 524d  ..    print(f"RM
-00005220: 5345 2073 636f 7265 2066 6f72 2062 6573  SE score for bes
-00005230: 7420 6d6f 6465 6c3a 207b 6e70 2e73 7172  t model: {np.sqr
-00005240: 7428 6d65 616e 5f73 7175 6172 6564 5f65  t(mean_squared_e
-00005250: 7272 6f72 2879 5f74 6573 742c 2079 5f70  rror(y_test, y_p
-00005260: 7265 6429 297d 2229 0d0a 0d0a 2020 2020  red))}")....    
-00005270: 7265 7475 726e 2062 6573 745f 6d6f 6465  return best_mode
-00005280: 6c2c 2062 6573 745f 7061 7261 6d73 0d0a  l, best_params..
-00005290: 0d0a 0d0a 0d0a                           ......
+00000000: 0d0a 0d0a 6465 6620 636f 7272 656c 6174  ....def correlat
+00000010: 696f 6e28 6466 2c20 785f 7661 7269 6162  ion(df, x_variab
+00000020: 6c65 3d4e 6f6e 6529 3a0d 0a09 696d 706f  le=None):...impo
+00000030: 7274 2070 616e 6461 7320 6173 2070 640d  rt pandas as pd.
+00000040: 0a09 6672 6f6d 2049 5079 7468 6f6e 2e63  ..from IPython.c
+00000050: 6f72 652e 6469 7370 6c61 7920 696d 706f  ore.display impo
+00000060: 7274 2048 544d 4c0d 0a20 2020 2069 6620  rt HTML..    if 
+00000070: 785f 7661 7269 6162 6c65 3a0d 0a20 2020  x_variable:..   
+00000080: 2020 2020 2063 6f72 7220 3d20 6466 2e63       corr = df.c
+00000090: 6f72 7228 295b 785f 7661 7269 6162 6c65  orr()[x_variable
+000000a0: 5d2e 736f 7274 5f76 616c 7565 7328 6173  ].sort_values(as
+000000b0: 6365 6e64 696e 673d 4661 6c73 6529 2e64  cending=False).d
+000000c0: 726f 7028 785f 7661 7269 6162 6c65 290d  rop(x_variable).
+000000d0: 0a20 2020 2065 6c73 653a 0d0a 2020 2020  .    else:..    
+000000e0: 2020 2020 636f 7272 203d 2064 662e 636f      corr = df.co
+000000f0: 7272 2829 2e73 7461 636b 2829 2e72 6573  rr().stack().res
+00000100: 6574 5f69 6e64 6578 2829 0d0a 2020 2020  et_index()..    
+00000110: 2020 2020 636f 7272 2e63 6f6c 756d 6e73      corr.columns
+00000120: 203d 205b 2776 6172 3127 2c20 2776 6172   = ['var1', 'var
+00000130: 3227 2c20 2763 6f72 7227 5d0d 0a20 2020  2', 'corr']..   
+00000140: 2020 2020 2063 6f72 7220 3d20 636f 7272       corr = corr
+00000150: 5b28 636f 7272 5b27 636f 7272 275d 2021  [(corr['corr'] !
+00000160: 3d20 312e 3029 2026 2028 636f 7272 5b27  = 1.0) & (corr['
+00000170: 636f 7272 275d 2021 3d20 2d31 2e30 295d  corr'] != -1.0)]
+00000180: 0d0a 2020 2020 2020 2020 636f 7272 203d  ..        corr =
+00000190: 2063 6f72 725b 636f 7272 5b27 7661 7231   corr[corr['var1
+000001a0: 275d 203c 2063 6f72 725b 2776 6172 3227  '] < corr['var2'
+000001b0: 5d5d 0d0a 2020 2020 2020 2020 636f 7272  ]]..        corr
+000001c0: 2e73 6f72 745f 7661 6c75 6573 2862 793d  .sort_values(by=
+000001d0: 5b27 636f 7272 275d 2c20 6173 6365 6e64  ['corr'], ascend
+000001e0: 696e 673d 4661 6c73 652c 2069 6e70 6c61  ing=False, inpla
+000001f0: 6365 3d54 7275 6529 0d0a 0d0a 2020 2020  ce=True)....    
+00000200: 6874 6d6c 5f74 6162 6c65 203d 2027 3c74  html_table = '<t
+00000210: 6162 6c65 3e3c 7468 6561 643e 3c74 723e  able><thead><tr>
+00000220: 3c74 683e 5661 7269 6162 6c65 2031 3c2f  <th>Variable 1</
+00000230: 7468 3e3c 7468 3e56 6172 6961 626c 6520  th><th>Variable 
+00000240: 323c 2f74 683e 3c74 683e 436f 7272 656c  2</th><th>Correl
+00000250: 6174 696f 6e3c 2f74 683e 3c2f 7472 3e3c  ation</th></tr><
+00000260: 2f74 6865 6164 3e27 0d0a 2020 2020 6874  /thead>'..    ht
+00000270: 6d6c 5f74 6162 6c65 202b 3d20 273c 7462  ml_table += '<tb
+00000280: 6f64 793e 270d 0a20 2020 200d 0a20 2020  ody>'..    ..   
+00000290: 2069 6620 785f 7661 7269 6162 6c65 3a0d   if x_variable:.
+000002a0: 0a20 2020 2020 2020 2066 6f72 2069 6e64  .        for ind
+000002b0: 6578 2c20 726f 7720 696e 2063 6f72 722e  ex, row in corr.
+000002c0: 6974 6572 6974 656d 7328 293a 0d0a 2020  iteritems():..  
+000002d0: 2020 2020 2020 2020 2020 6874 6d6c 5f74            html_t
+000002e0: 6162 6c65 202b 3d20 273c 7472 3e3c 7464  able += '<tr><td
+000002f0: 3e7b 7d3c 2f74 643e 3c74 643e 7b7d 3c2f  >{}</td><td>{}</
+00000300: 7464 3e3c 7464 3e7b 7d3c 2f74 643e 3c2f  td><td>{}</td></
+00000310: 7472 3e27 2e66 6f72 6d61 7428 785f 7661  tr>'.format(x_va
+00000320: 7269 6162 6c65 2c20 696e 6465 782c 2072  riable, index, r
+00000330: 6f75 6e64 2872 6f77 2c20 3229 290d 0a20  ound(row, 2)).. 
+00000340: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+00000350: 2020 666f 7220 696e 6465 782c 2072 6f77    for index, row
+00000360: 2069 6e20 636f 7272 2e69 7465 7272 6f77   in corr.iterrow
+00000370: 7328 293a 0d0a 2020 2020 2020 2020 2020  s():..          
+00000380: 2020 6874 6d6c 5f74 6162 6c65 202b 3d20    html_table += 
+00000390: 273c 7472 3e3c 7464 3e7b 7d3c 2f74 643e  '<tr><td>{}</td>
+000003a0: 3c74 643e 7b7d 3c2f 7464 3e3c 7464 3e7b  <td>{}</td><td>{
+000003b0: 7d3c 2f74 643e 3c2f 7472 3e27 2e66 6f72  }</td></tr>'.for
+000003c0: 6d61 7428 726f 775b 2776 6172 3127 5d2c  mat(row['var1'],
+000003d0: 2072 6f77 5b27 7661 7232 275d 2c20 726f   row['var2'], ro
+000003e0: 756e 6428 726f 775b 2763 6f72 7227 5d2c  und(row['corr'],
+000003f0: 2032 2929 0d0a 2020 2020 2020 2020 2020   2))..          
+00000400: 2020 0d0a 2020 2020 6874 6d6c 5f74 6162    ..    html_tab
+00000410: 6c65 202b 3d20 273c 2f74 626f 6479 3e3c  le += '</tbody><
+00000420: 2f74 6162 6c65 3e27 0d0a 2020 2020 0d0a  /table>'..    ..
+00000430: 2020 2020 7265 7475 726e 2048 544d 4c28      return HTML(
+00000440: 273c 6469 7620 7374 796c 653d 226d 6178  '<div style="max
+00000450: 2d68 6569 6768 743a 3330 3070 783b 206f  -height:300px; o
+00000460: 7665 7266 6c6f 772d 793a 6175 746f 3b22  verflow-y:auto;"
+00000470: 3e7b 7d3c 2f64 6976 3e27 2e66 6f72 6d61  >{}</div>'.forma
+00000480: 7428 6874 6d6c 5f74 6162 6c65 2929 0d0a  t(html_table))..
+00000490: 0d0a 6465 6620 706c 6f74 5f73 6964 655f  ..def plot_side_
+000004a0: 6279 5f73 6964 6528 6461 7461 2c20 636f  by_side(data, co
+000004b0: 6c75 6d6e 7329 3a0d 0a20 2020 2066 6967  lumns):..    fig
+000004c0: 2c20 6178 7320 3d20 706c 742e 7375 6270  , axs = plt.subp
+000004d0: 6c6f 7473 286c 656e 2863 6f6c 756d 6e73  lots(len(columns
+000004e0: 292c 2032 2c20 6669 6773 697a 653d 2831  ), 2, figsize=(1
+000004f0: 322c 206c 656e 2863 6f6c 756d 6e73 2920  2, len(columns) 
+00000500: 2a20 3429 290d 0a0d 0a20 2020 2066 6f72  * 4))....    for
+00000510: 2069 2c20 636f 6c20 696e 2065 6e75 6d65   i, col in enume
+00000520: 7261 7465 2863 6f6c 756d 6e73 293a 0d0a  rate(columns):..
+00000530: 2020 2020 2020 2020 6178 735b 692c 2030          axs[i, 0
+00000540: 5d2e 706c 6f74 2864 6174 615b 636f 6c5d  ].plot(data[col]
+00000550: 2e76 616c 7565 7329 0d0a 2020 2020 2020  .values)..      
+00000560: 2020 6178 735b 692c 2030 5d2e 7365 745f    axs[i, 0].set_
+00000570: 7469 746c 6528 6622 7b63 6f6c 7d20 2d20  title(f"{col} - 
+00000580: 5469 6d65 2053 6572 6965 7322 290d 0a20  Time Series").. 
+00000590: 2020 2020 2020 2061 7873 5b69 2c20 305d         axs[i, 0]
+000005a0: 2e73 6574 5f78 6c61 6265 6c28 2249 6e64  .set_xlabel("Ind
+000005b0: 6578 2229 0d0a 2020 2020 2020 2020 6178  ex")..        ax
+000005c0: 735b 692c 2030 5d2e 7365 745f 796c 6162  s[i, 0].set_ylab
+000005d0: 656c 2822 5661 6c75 6522 290d 0a0d 0a20  el("Value").... 
+000005e0: 2020 2020 2020 2061 7873 5b69 2c20 315d         axs[i, 1]
+000005f0: 2e68 6973 7428 6461 7461 5b63 6f6c 5d2c  .hist(data[col],
+00000600: 2062 696e 733d 3230 290d 0a20 2020 2020   bins=20)..     
+00000610: 2020 2061 7873 5b69 2c20 315d 2e73 6574     axs[i, 1].set
+00000620: 5f74 6974 6c65 2866 227b 636f 6c7d 202d  _title(f"{col} -
+00000630: 2048 6973 746f 6772 616d 2229 0d0a 2020   Histogram")..  
+00000640: 2020 2020 2020 6178 735b 692c 2031 5d2e        axs[i, 1].
+00000650: 7365 745f 786c 6162 656c 2822 5661 6c75  set_xlabel("Valu
+00000660: 6522 290d 0a20 2020 2020 2020 2061 7873  e")..        axs
+00000670: 5b69 2c20 315d 2e73 6574 5f79 6c61 6265  [i, 1].set_ylabe
+00000680: 6c28 2246 7265 7175 656e 6379 2229 0d0a  l("Frequency")..
+00000690: 0d0a 2020 2020 706c 742e 7469 6768 745f  ..    plt.tight_
+000006a0: 6c61 796f 7574 2829 0d0a 0d0a 2020 2020  layout()....    
+000006b0: 706c 742e 6669 6775 7265 2866 6967 7369  plt.figure(figsi
+000006c0: 7a65 3d28 3132 2c20 3629 290d 0a20 2020  ze=(12, 6))..   
+000006d0: 2066 6f72 2063 6f6c 2069 6e20 636f 6c75   for col in colu
+000006e0: 6d6e 733a 0d0a 2020 2020 2020 2020 706c  mns:..        pl
+000006f0: 742e 706c 6f74 2864 6174 615b 636f 6c5d  t.plot(data[col]
+00000700: 2e76 616c 7565 732c 206c 6162 656c 3d63  .values, label=c
+00000710: 6f6c 290d 0a20 2020 2070 6c74 2e74 6974  ol)..    plt.tit
+00000720: 6c65 2822 5469 6d65 2053 6572 6965 7320  le("Time Series 
+00000730: 436f 6d70 6172 6973 6f6e 2229 0d0a 2020  Comparison")..  
+00000740: 2020 706c 742e 786c 6162 656c 2822 496e    plt.xlabel("In
+00000750: 6465 7822 290d 0a20 2020 2070 6c74 2e79  dex")..    plt.y
+00000760: 6c61 6265 6c28 2256 616c 7565 2229 0d0a  label("Value")..
+00000770: 2020 2020 706c 742e 6c65 6765 6e64 2829      plt.legend()
+00000780: 0d0a 0d0a 2020 2020 706c 742e 7368 6f77  ....    plt.show
+00000790: 2829 0d0a 0d0a 0d0a 0d0a 0d0a 6465 6620  ()..........def 
+000007a0: 706c 6f74 5f74 6172 6765 745f 7673 5f6f  plot_target_vs_o
+000007b0: 7468 6572 7328 6461 7461 2c20 7461 7267  thers(data, targ
+000007c0: 6574 5f76 6172 6961 626c 6529 3a0d 0a20  et_variable):.. 
+000007d0: 2020 2069 6d70 6f72 7420 6d61 7470 6c6f     import matplo
+000007e0: 746c 6962 2e70 7970 6c6f 7420 6173 2070  tlib.pyplot as p
+000007f0: 6c74 0d0a 2020 2020 7461 7267 6574 203d  lt..    target =
+00000800: 2064 6174 615b 7461 7267 6574 5f76 6172   data[target_var
+00000810: 6961 626c 655d 0d0a 2020 2020 6f74 6865  iable]..    othe
+00000820: 725f 7661 7269 6162 6c65 7320 3d20 6461  r_variables = da
+00000830: 7461 2e64 726f 7028 636f 6c75 6d6e 733d  ta.drop(columns=
+00000840: 7461 7267 6574 5f76 6172 6961 626c 6529  target_variable)
+00000850: 2e63 6f6c 756d 6e73 0d0a 2020 2020 0d0a  .columns..    ..
+00000860: 2020 2020 706c 742e 6669 6775 7265 2866      plt.figure(f
+00000870: 6967 7369 7a65 3d28 3132 2c20 3629 290d  igsize=(12, 6)).
+00000880: 0a20 2020 2070 6c74 2e70 6c6f 7428 7261  .    plt.plot(ra
+00000890: 6e67 6528 6c65 6e28 7461 7267 6574 2929  nge(len(target))
+000008a0: 2c20 7461 7267 6574 2c20 6c61 6265 6c3d  , target, label=
+000008b0: 7461 7267 6574 5f76 6172 6961 626c 6529  target_variable)
+000008c0: 0d0a 2020 2020 706c 742e 7469 746c 6528  ..    plt.title(
+000008d0: 6622 7b74 6172 6765 745f 7661 7269 6162  f"{target_variab
+000008e0: 6c65 7d20 2d20 5469 6d65 2053 6572 6965  le} - Time Serie
+000008f0: 7322 290d 0a20 2020 2070 6c74 2e78 6c61  s")..    plt.xla
+00000900: 6265 6c28 2244 6174 6120 506f 696e 7422  bel("Data Point"
+00000910: 290d 0a20 2020 2070 6c74 2e79 6c61 6265  )..    plt.ylabe
+00000920: 6c28 2256 616c 7565 2229 0d0a 2020 2020  l("Value")..    
+00000930: 706c 742e 6c65 6765 6e64 2829 0d0a 2020  plt.legend()..  
+00000940: 2020 706c 742e 7368 6f77 2829 0d0a 2020    plt.show()..  
+00000950: 2020 0d0a 2020 2020 666f 7220 7661 7269    ..    for vari
+00000960: 6162 6c65 2069 6e20 6f74 6865 725f 7661  able in other_va
+00000970: 7269 6162 6c65 733a 0d0a 2020 2020 2020  riables:..      
+00000980: 2020 706c 742e 6669 6775 7265 2866 6967    plt.figure(fig
+00000990: 7369 7a65 3d28 3132 2c20 3629 290d 0a20  size=(12, 6)).. 
+000009a0: 2020 2020 2020 2070 6c74 2e70 6c6f 7428         plt.plot(
+000009b0: 7261 6e67 6528 6c65 6e28 7461 7267 6574  range(len(target
+000009c0: 2929 2c20 7461 7267 6574 2c20 6c61 6265  )), target, labe
+000009d0: 6c3d 7461 7267 6574 5f76 6172 6961 626c  l=target_variabl
+000009e0: 6529 0d0a 2020 2020 2020 2020 706c 742e  e)..        plt.
+000009f0: 706c 6f74 2872 616e 6765 286c 656e 2864  plot(range(len(d
+00000a00: 6174 615b 7661 7269 6162 6c65 5d29 292c  ata[variable])),
+00000a10: 2064 6174 615b 7661 7269 6162 6c65 5d2c   data[variable],
+00000a20: 206c 6162 656c 3d76 6172 6961 626c 6529   label=variable)
+00000a30: 0d0a 2020 2020 2020 2020 706c 742e 7469  ..        plt.ti
+00000a40: 746c 6528 6622 7b74 6172 6765 745f 7661  tle(f"{target_va
+00000a50: 7269 6162 6c65 7d20 7673 207b 7661 7269  riable} vs {vari
+00000a60: 6162 6c65 7d20 2d20 5469 6d65 2053 6572  able} - Time Ser
+00000a70: 6965 7322 290d 0a20 2020 2020 2020 2070  ies")..        p
+00000a80: 6c74 2e78 6c61 6265 6c28 2244 6174 6120  lt.xlabel("Data 
+00000a90: 506f 696e 7422 290d 0a20 2020 2020 2020  Point")..       
+00000aa0: 2070 6c74 2e79 6c61 6265 6c28 2256 616c   plt.ylabel("Val
+00000ab0: 7565 2229 0d0a 2020 2020 2020 2020 706c  ue")..        pl
+00000ac0: 742e 6c65 6765 6e64 2829 0d0a 2020 2020  t.legend()..    
+00000ad0: 2020 2020 706c 742e 7368 6f77 2829 0d0a      plt.show()..
+00000ae0: 0d0a 0d0a 6465 6620 706c 6f74 5f74 6172  ....def plot_tar
+00000af0: 6765 745f 7673 5f6f 7468 6572 735f 6e6f  get_vs_others_no
+00000b00: 726d 616c 697a 6564 2864 6174 612c 2074  rmalized(data, t
+00000b10: 6172 6765 745f 7661 7269 6162 6c65 293a  arget_variable):
+00000b20: 0d0a 2020 2020 696d 706f 7274 206d 6174  ..    import mat
+00000b30: 706c 6f74 6c69 622e 7079 706c 6f74 2061  plotlib.pyplot a
+00000b40: 7320 706c 740d 0a20 2020 2066 726f 6d20  s plt..    from 
+00000b50: 736b 6c65 6172 6e2e 7072 6570 726f 6365  sklearn.preproce
+00000b60: 7373 696e 6720 696d 706f 7274 204d 696e  ssing import Min
+00000b70: 4d61 7853 6361 6c65 720d 0a20 2020 2074  MaxScaler..    t
+00000b80: 6172 6765 7420 3d20 6461 7461 5b74 6172  arget = data[tar
+00000b90: 6765 745f 7661 7269 6162 6c65 5d0d 0a20  get_variable].. 
+00000ba0: 2020 206f 7468 6572 5f76 6172 6961 626c     other_variabl
+00000bb0: 6573 203d 2064 6174 612e 6472 6f70 2863  es = data.drop(c
+00000bc0: 6f6c 756d 6e73 3d74 6172 6765 745f 7661  olumns=target_va
+00000bd0: 7269 6162 6c65 292e 636f 6c75 6d6e 730d  riable).columns.
+00000be0: 0a20 2020 200d 0a20 2020 2064 6174 615f  .    ..    data_
+00000bf0: 7769 7468 6f75 745f 7461 7267 6574 203d  without_target =
+00000c00: 2064 6174 612e 6472 6f70 2863 6f6c 756d   data.drop(colum
+00000c10: 6e73 3d74 6172 6765 745f 7661 7269 6162  ns=target_variab
+00000c20: 6c65 290d 0a20 2020 200d 0a20 2020 2073  le)..    ..    s
+00000c30: 6361 6c65 7220 3d20 4d69 6e4d 6178 5363  caler = MinMaxSc
+00000c40: 616c 6572 2829 0d0a 2020 2020 6e6f 726d  aler()..    norm
+00000c50: 616c 697a 6564 5f64 6174 6120 3d20 7363  alized_data = sc
+00000c60: 616c 6572 2e66 6974 5f74 7261 6e73 666f  aler.fit_transfo
+00000c70: 726d 2864 6174 615f 7769 7468 6f75 745f  rm(data_without_
+00000c80: 7461 7267 6574 290d 0a20 2020 200d 0a20  target)..    .. 
+00000c90: 2020 2074 6172 6765 745f 7363 616c 6572     target_scaler
+00000ca0: 203d 204d 696e 4d61 7853 6361 6c65 7228   = MinMaxScaler(
+00000cb0: 290d 0a20 2020 206e 6f72 6d61 6c69 7a65  )..    normalize
+00000cc0: 645f 7461 7267 6574 203d 2074 6172 6765  d_target = targe
+00000cd0: 745f 7363 616c 6572 2e66 6974 5f74 7261  t_scaler.fit_tra
+00000ce0: 6e73 666f 726d 2874 6172 6765 742e 7661  nsform(target.va
+00000cf0: 6c75 6573 2e72 6573 6861 7065 282d 312c  lues.reshape(-1,
+00000d00: 2031 2929 0d0a 2020 2020 0d0a 2020 2020   1))..    ..    
+00000d10: 706c 742e 6669 6775 7265 2866 6967 7369  plt.figure(figsi
+00000d20: 7a65 3d28 3132 2c20 3629 290d 0a20 2020  ze=(12, 6))..   
+00000d30: 2070 6c74 2e70 6c6f 7428 7261 6e67 6528   plt.plot(range(
+00000d40: 6c65 6e28 6e6f 726d 616c 697a 6564 5f74  len(normalized_t
+00000d50: 6172 6765 7429 292c 206e 6f72 6d61 6c69  arget)), normali
+00000d60: 7a65 645f 7461 7267 6574 2c20 6c61 6265  zed_target, labe
+00000d70: 6c3d 7461 7267 6574 5f76 6172 6961 626c  l=target_variabl
+00000d80: 6529 0d0a 2020 2020 706c 742e 7469 746c  e)..    plt.titl
+00000d90: 6528 6622 7b74 6172 6765 745f 7661 7269  e(f"{target_vari
+00000da0: 6162 6c65 7d20 2d20 5469 6d65 2053 6572  able} - Time Ser
+00000db0: 6965 7320 284e 6f72 6d61 6c69 7a65 6429  ies (Normalized)
+00000dc0: 2229 0d0a 2020 2020 706c 742e 786c 6162  ")..    plt.xlab
+00000dd0: 656c 2822 4461 7461 2050 6f69 6e74 2229  el("Data Point")
+00000de0: 0d0a 2020 2020 706c 742e 796c 6162 656c  ..    plt.ylabel
+00000df0: 2822 4e6f 726d 616c 697a 6564 2056 616c  ("Normalized Val
+00000e00: 7565 2229 0d0a 2020 2020 706c 742e 6c65  ue")..    plt.le
+00000e10: 6765 6e64 2829 0d0a 2020 2020 706c 742e  gend()..    plt.
+00000e20: 7368 6f77 2829 0d0a 2020 2020 0d0a 2020  show()..    ..  
+00000e30: 2020 666f 7220 7661 7269 6162 6c65 2069    for variable i
+00000e40: 6e20 6f74 6865 725f 7661 7269 6162 6c65  n other_variable
+00000e50: 733a 0d0a 2020 2020 2020 2020 7661 7269  s:..        vari
+00000e60: 6162 6c65 5f69 6e64 6578 203d 2064 6174  able_index = dat
+00000e70: 612e 636f 6c75 6d6e 732e 6765 745f 6c6f  a.columns.get_lo
+00000e80: 6328 7661 7269 6162 6c65 290d 0a20 2020  c(variable)..   
+00000e90: 2020 2020 206e 6f72 6d61 6c69 7a65 645f       normalized_
+00000ea0: 7661 7269 6162 6c65 203d 206e 6f72 6d61  variable = norma
+00000eb0: 6c69 7a65 645f 6461 7461 5b3a 2c20 7661  lized_data[:, va
+00000ec0: 7269 6162 6c65 5f69 6e64 6578 5d0d 0a20  riable_index].. 
+00000ed0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00000ee0: 2070 6c74 2e66 6967 7572 6528 6669 6773   plt.figure(figs
+00000ef0: 697a 653d 2831 322c 2036 2929 0d0a 2020  ize=(12, 6))..  
+00000f00: 2020 2020 2020 706c 742e 706c 6f74 2872        plt.plot(r
+00000f10: 616e 6765 286c 656e 286e 6f72 6d61 6c69  ange(len(normali
+00000f20: 7a65 645f 7461 7267 6574 2929 2c20 6e6f  zed_target)), no
+00000f30: 726d 616c 697a 6564 5f74 6172 6765 742c  rmalized_target,
+00000f40: 206c 6162 656c 3d74 6172 6765 745f 7661   label=target_va
+00000f50: 7269 6162 6c65 290d 0a20 2020 2020 2020  riable)..       
+00000f60: 2070 6c74 2e70 6c6f 7428 7261 6e67 6528   plt.plot(range(
+00000f70: 6c65 6e28 6461 7461 2929 2c20 6e6f 726d  len(data)), norm
+00000f80: 616c 697a 6564 5f76 6172 6961 626c 652c  alized_variable,
+00000f90: 206c 6162 656c 3d76 6172 6961 626c 6529   label=variable)
+00000fa0: 0d0a 2020 2020 2020 2020 706c 742e 7469  ..        plt.ti
+00000fb0: 746c 6528 6622 7b74 6172 6765 745f 7661  tle(f"{target_va
+00000fc0: 7269 6162 6c65 7d20 7673 207b 7661 7269  riable} vs {vari
+00000fd0: 6162 6c65 7d20 2d20 5469 6d65 2053 6572  able} - Time Ser
+00000fe0: 6965 7320 284e 6f72 6d61 6c69 7a65 6429  ies (Normalized)
+00000ff0: 2229 0d0a 2020 2020 2020 2020 706c 742e  ")..        plt.
+00001000: 786c 6162 656c 2822 4461 7461 2050 6f69  xlabel("Data Poi
+00001010: 6e74 2229 0d0a 2020 2020 2020 2020 706c  nt")..        pl
+00001020: 742e 796c 6162 656c 2822 4e6f 726d 616c  t.ylabel("Normal
+00001030: 697a 6564 2056 616c 7565 2229 0d0a 2020  ized Value")..  
+00001040: 2020 2020 2020 706c 742e 6c65 6765 6e64        plt.legend
+00001050: 2829 0d0a 2020 2020 2020 2020 706c 742e  ()..        plt.
+00001060: 7368 6f77 2829 0d0a 0d0a 0d0a 2020 2020  show()......    
+00001070: 0d0a 6465 6620 6669 6e64 5f62 6573 745f  ..def find_best_
+00001080: 6d6f 6465 6c5f 636c 6173 7369 6669 6361  model_classifica
+00001090: 7469 6f6e 2864 665f 585f 7472 6169 6e2c  tion(df_X_train,
+000010a0: 2064 665f 585f 7465 7374 2c20 6466 5f79   df_X_test, df_y
+000010b0: 5f74 7261 696e 2c20 6466 5f79 5f74 6573  _train, df_y_tes
+000010c0: 7429 3a0d 0a20 2020 200d 0a20 2020 2069  t):..    ..    i
+000010d0: 6d70 6f72 7420 6e75 6d70 7920 6173 206e  mport numpy as n
+000010e0: 700d 0a20 2020 2069 6d70 6f72 7420 7061  p..    import pa
+000010f0: 6e64 6173 2061 7320 7064 0d0a 2020 2020  ndas as pd..    
+00001100: 6672 6f6d 2073 6b6c 6561 726e 2e6c 696e  from sklearn.lin
+00001110: 6561 725f 6d6f 6465 6c20 696d 706f 7274  ear_model import
+00001120: 204c 6f67 6973 7469 6352 6567 7265 7373   LogisticRegress
+00001130: 696f 6e2c 2052 6964 6765 436c 6173 7369  ion, RidgeClassi
+00001140: 6669 6572 2c20 5061 7373 6976 6541 6767  fier, PassiveAgg
+00001150: 7265 7373 6976 6543 6c61 7373 6966 6965  ressiveClassifie
+00001160: 722c 2050 6572 6365 7074 726f 6e0d 0a20  r, Perceptron.. 
+00001170: 2020 2066 726f 6d20 736b 6c65 6172 6e2e     from sklearn.
+00001180: 7472 6565 2069 6d70 6f72 7420 4465 6369  tree import Deci
+00001190: 7369 6f6e 5472 6565 436c 6173 7369 6669  sionTreeClassifi
+000011a0: 6572 0d0a 2020 2020 6672 6f6d 2073 6b6c  er..    from skl
+000011b0: 6561 726e 2e65 6e73 656d 626c 6520 696d  earn.ensemble im
+000011c0: 706f 7274 2052 616e 646f 6d46 6f72 6573  port RandomFores
+000011d0: 7443 6c61 7373 6966 6965 722c 2047 7261  tClassifier, Gra
+000011e0: 6469 656e 7442 6f6f 7374 696e 6743 6c61  dientBoostingCla
+000011f0: 7373 6966 6965 722c 2041 6461 426f 6f73  ssifier, AdaBoos
+00001200: 7443 6c61 7373 6966 6965 722c 2045 7874  tClassifier, Ext
+00001210: 7261 5472 6565 7343 6c61 7373 6966 6965  raTreesClassifie
+00001220: 722c 2042 6167 6769 6e67 436c 6173 7369  r, BaggingClassi
+00001230: 6669 6572 2c20 4973 6f6c 6174 696f 6e46  fier, IsolationF
+00001240: 6f72 6573 742c 2053 7461 636b 696e 6743  orest, StackingC
+00001250: 6c61 7373 6966 6965 720d 0a20 2020 2066  lassifier..    f
+00001260: 726f 6d20 736b 6c65 6172 6e2e 7376 6d20  rom sklearn.svm 
+00001270: 696d 706f 7274 2053 5643 2c20 4f6e 6543  import SVC, OneC
+00001280: 6c61 7373 5356 4d0d 0a20 2020 2066 726f  lassSVM..    fro
+00001290: 6d20 736b 6c65 6172 6e2e 6e65 6967 6862  m sklearn.neighb
+000012a0: 6f72 7320 696d 706f 7274 204b 4e65 6967  ors import KNeig
+000012b0: 6862 6f72 7343 6c61 7373 6966 6965 722c  hborsClassifier,
+000012c0: 204e 6561 7265 7374 4365 6e74 726f 6964   NearestCentroid
+000012d0: 0d0a 2020 2020 6672 6f6d 2073 6b6c 6561  ..    from sklea
+000012e0: 726e 2e6e 6169 7665 5f62 6179 6573 2069  rn.naive_bayes i
+000012f0: 6d70 6f72 7420 4761 7573 7369 616e 4e42  mport GaussianNB
+00001300: 2c20 4265 726e 6f75 6c6c 694e 420d 0a20  , BernoulliNB.. 
+00001310: 2020 2066 726f 6d20 736b 6c65 6172 6e2e     from sklearn.
+00001320: 6e65 7572 616c 5f6e 6574 776f 726b 2069  neural_network i
+00001330: 6d70 6f72 7420 4d4c 5043 6c61 7373 6966  mport MLPClassif
+00001340: 6965 720d 0a20 2020 2066 726f 6d20 736b  ier..    from sk
+00001350: 6c65 6172 6e2e 6469 7363 7269 6d69 6e61  learn.discrimina
+00001360: 6e74 5f61 6e61 6c79 7369 7320 696d 706f  nt_analysis impo
+00001370: 7274 2051 7561 6472 6174 6963 4469 7363  rt QuadraticDisc
+00001380: 7269 6d69 6e61 6e74 416e 616c 7973 6973  riminantAnalysis
+00001390: 2c20 4c69 6e65 6172 4469 7363 7269 6d69  , LinearDiscrimi
+000013a0: 6e61 6e74 416e 616c 7973 6973 0d0a 2020  nantAnalysis..  
+000013b0: 2020 6672 6f6d 2073 6b6c 6561 726e 2e63    from sklearn.c
+000013c0: 6c75 7374 6572 2069 6d70 6f72 7420 4b4d  luster import KM
+000013d0: 6561 6e73 0d0a 2020 2020 6672 6f6d 2078  eans..    from x
+000013e0: 6762 6f6f 7374 2069 6d70 6f72 7420 5847  gboost import XG
+000013f0: 4243 6c61 7373 6966 6965 720d 0a20 2020  BClassifier..   
+00001400: 2066 726f 6d20 6c69 6768 7467 626d 2069   from lightgbm i
+00001410: 6d70 6f72 7420 4c47 424d 436c 6173 7369  mport LGBMClassi
+00001420: 6669 6572 0d0a 2020 2020 6672 6f6d 2063  fier..    from c
+00001430: 6174 626f 6f73 7420 696d 706f 7274 2043  atboost import C
+00001440: 6174 426f 6f73 7443 6c61 7373 6966 6965  atBoostClassifie
+00001450: 720d 0a20 2020 2066 726f 6d20 696d 626c  r..    from imbl
+00001460: 6561 726e 2e65 6e73 656d 626c 6520 696d  earn.ensemble im
+00001470: 706f 7274 2042 616c 616e 6365 6452 616e  port BalancedRan
+00001480: 646f 6d46 6f72 6573 7443 6c61 7373 6966  domForestClassif
+00001490: 6965 720d 0a20 2020 2066 726f 6d20 736b  ier..    from sk
+000014a0: 6c65 6172 6e20 696d 706f 7274 206d 6574  learn import met
+000014b0: 7269 6373 0d0a 2020 2020 0d0a 2020 2020  rics..    ..    
+000014c0: 6d6f 6465 6c73 203d 205b 0d0a 2020 2020  models = [..    
+000014d0: 2020 2020 2822 4c6f 6769 7374 6963 2052      ("Logistic R
+000014e0: 6567 7265 7373 696f 6e22 2c20 4c6f 6769  egression", Logi
+000014f0: 7374 6963 5265 6772 6573 7369 6f6e 286d  sticRegression(m
+00001500: 6178 5f69 7465 723d 3130 3030 2929 2c0d  ax_iter=1000)),.
+00001510: 0a20 2020 2020 2020 2028 2244 6563 6973  .        ("Decis
+00001520: 696f 6e20 5472 6565 222c 2044 6563 6973  ion Tree", Decis
+00001530: 696f 6e54 7265 6543 6c61 7373 6966 6965  ionTreeClassifie
+00001540: 7228 2929 2c0d 0a20 2020 2020 2020 2028  r()),..        (
+00001550: 2252 616e 646f 6d20 466f 7265 7374 222c  "Random Forest",
+00001560: 2052 616e 646f 6d46 6f72 6573 7443 6c61   RandomForestCla
+00001570: 7373 6966 6965 7228 2929 2c0d 0a20 2020  ssifier()),..   
+00001580: 2020 2020 2028 2247 7261 6469 656e 7420       ("Gradient 
+00001590: 426f 6f73 7469 6e67 222c 2047 7261 6469  Boosting", Gradi
+000015a0: 656e 7442 6f6f 7374 696e 6743 6c61 7373  entBoostingClass
+000015b0: 6966 6965 7228 2929 2c0d 0a20 2020 2020  ifier()),..     
+000015c0: 2020 2028 2258 4742 6f6f 7374 222c 2058     ("XGBoost", X
+000015d0: 4742 436c 6173 7369 6669 6572 2865 7661  GBClassifier(eva
+000015e0: 6c5f 6d65 7472 6963 3d22 6c6f 676c 6f73  l_metric="loglos
+000015f0: 7322 2929 2c0d 0a20 2020 2020 2020 2028  s")),..        (
+00001600: 224c 6967 6874 4742 4d22 2c20 4c47 424d  "LightGBM", LGBM
+00001610: 436c 6173 7369 6669 6572 2829 292c 0d0a  Classifier()),..
+00001620: 2020 2020 2020 2020 2822 5375 7070 6f72          ("Suppor
+00001630: 7420 5665 6374 6f72 204d 6163 6869 6e65  t Vector Machine
+00001640: 222c 2053 5643 2829 292c 0d0a 2020 2020  ", SVC()),..    
+00001650: 2020 2020 2822 4b2d 4e65 6172 6573 7420      ("K-Nearest 
+00001660: 4e65 6967 6862 6f72 7322 2c20 4b4e 6569  Neighbors", KNei
+00001670: 6768 626f 7273 436c 6173 7369 6669 6572  ghborsClassifier
+00001680: 2829 292c 0d0a 2020 2020 2020 2020 2822  ()),..        ("
+00001690: 4e61 6976 6520 4261 7965 7322 2c20 4761  Naive Bayes", Ga
+000016a0: 7573 7369 616e 4e42 2829 292c 0d0a 2020  ussianNB()),..  
+000016b0: 2020 2020 2020 2822 4d75 6c74 692d 6c61        ("Multi-la
+000016c0: 7965 7220 5065 7263 6570 7472 6f6e 222c  yer Perceptron",
+000016d0: 204d 4c50 436c 6173 7369 6669 6572 286d   MLPClassifier(m
+000016e0: 6178 5f69 7465 723d 3130 3030 2929 2c0d  ax_iter=1000)),.
+000016f0: 0a20 2020 2020 2020 2028 2241 6461 426f  .        ("AdaBo
+00001700: 6f73 7422 2c20 4164 6142 6f6f 7374 436c  ost", AdaBoostCl
+00001710: 6173 7369 6669 6572 2829 292c 0d0a 2020  assifier()),..  
+00001720: 2020 2020 2020 2822 4578 7472 6120 5472        ("Extra Tr
+00001730: 6565 7322 2c20 4578 7472 6154 7265 6573  ees", ExtraTrees
+00001740: 436c 6173 7369 6669 6572 2829 292c 0d0a  Classifier()),..
+00001750: 2020 2020 2020 2020 2822 5269 6467 6520          ("Ridge 
+00001760: 436c 6173 7369 6669 6572 222c 2052 6964  Classifier", Rid
+00001770: 6765 436c 6173 7369 6669 6572 2829 292c  geClassifier()),
+00001780: 0d0a 2020 2020 2020 2020 2822 5175 6164  ..        ("Quad
+00001790: 7261 7469 6320 4469 7363 7269 6d69 6e61  ratic Discrimina
+000017a0: 6e74 2041 6e61 6c79 7369 7322 2c20 5175  nt Analysis", Qu
+000017b0: 6164 7261 7469 6344 6973 6372 696d 696e  adraticDiscrimin
+000017c0: 616e 7441 6e61 6c79 7369 7328 2929 2c0d  antAnalysis()),.
+000017d0: 0a20 2020 2020 2020 2028 2243 6174 426f  .        ("CatBo
+000017e0: 6f73 7422 2c20 4361 7442 6f6f 7374 436c  ost", CatBoostCl
+000017f0: 6173 7369 6669 6572 2876 6572 626f 7365  assifier(verbose
+00001800: 3d30 2c20 7261 6e64 6f6d 5f73 6565 643d  =0, random_seed=
+00001810: 3432 2929 2c0d 0a20 2020 2020 2020 2028  42)),..        (
+00001820: 2242 616c 616e 6365 6420 5261 6e64 6f6d  "Balanced Random
+00001830: 2046 6f72 6573 7422 2c20 4261 6c61 6e63   Forest", Balanc
+00001840: 6564 5261 6e64 6f6d 466f 7265 7374 436c  edRandomForestCl
+00001850: 6173 7369 6669 6572 2829 292c 0d0a 2020  assifier()),..  
+00001860: 2020 2020 2020 2822 4c69 6e65 6172 2044        ("Linear D
+00001870: 6973 6372 696d 696e 616e 7420 416e 616c  iscriminant Anal
+00001880: 7973 6973 222c 204c 696e 6561 7244 6973  ysis", LinearDis
+00001890: 6372 696d 696e 616e 7441 6e61 6c79 7369  criminantAnalysi
+000018a0: 7328 2929 2c0d 0a20 2020 2020 2020 2028  s()),..        (
+000018b0: 224e 6561 7265 7374 2043 656e 7472 6f69  "Nearest Centroi
+000018c0: 6420 436c 6173 7369 6669 6572 222c 204e  d Classifier", N
+000018d0: 6561 7265 7374 4365 6e74 726f 6964 2829  earestCentroid()
+000018e0: 292c 0d0a 2020 2020 2020 2020 2822 5061  ),..        ("Pa
+000018f0: 7373 6976 6520 4167 6772 6573 7369 7665  ssive Aggressive
+00001900: 2043 6c61 7373 6966 6965 7222 2c20 5061   Classifier", Pa
+00001910: 7373 6976 6541 6767 7265 7373 6976 6543  ssiveAggressiveC
+00001920: 6c61 7373 6966 6965 7228 2929 2c0d 0a20  lassifier()),.. 
+00001930: 2020 2020 2020 2028 2250 6572 6365 7074         ("Percept
+00001940: 726f 6e22 2c20 5065 7263 6570 7472 6f6e  ron", Perceptron
+00001950: 2829 292c 0d0a 2020 2020 2020 2020 2822  ()),..        ("
+00001960: 4265 726e 6f75 6c6c 6920 4e61 6976 6520  Bernoulli Naive 
+00001970: 4261 7965 7322 2c20 4265 726e 6f75 6c6c  Bayes", Bernoull
+00001980: 694e 4228 2929 2c0d 0a20 2020 2020 2020  iNB()),..       
+00001990: 2028 2242 6167 6769 6e67 2043 6c61 7373   ("Bagging Class
+000019a0: 6966 6965 7222 2c20 4261 6767 696e 6743  ifier", BaggingC
+000019b0: 6c61 7373 6966 6965 7228 2929 2c0d 0a20  lassifier()),.. 
+000019c0: 2020 2020 2020 2023 2041 6464 2061 2062         # Add a b
+000019d0: 6173 6520 6573 7469 6d61 746f 7220 666f  ase estimator fo
+000019e0: 7220 5374 6163 6b69 6e67 436c 6173 7369  r StackingClassi
+000019f0: 6669 6572 0d0a 2020 2020 2020 2020 2822  fier..        ("
+00001a00: 5374 6163 6b69 6e67 2043 6c61 7373 6966  Stacking Classif
+00001a10: 6965 7222 2c20 5374 6163 6b69 6e67 436c  ier", StackingCl
+00001a20: 6173 7369 6669 6572 2865 7374 696d 6174  assifier(estimat
+00001a30: 6f72 733d 5b28 276c 7227 2c20 4c6f 6769  ors=[('lr', Logi
+00001a40: 7374 6963 5265 6772 6573 7369 6f6e 2829  sticRegression()
+00001a50: 292c 2028 2764 7427 2c20 4465 6369 7369  ), ('dt', Decisi
+00001a60: 6f6e 5472 6565 436c 6173 7369 6669 6572  onTreeClassifier
+00001a70: 2829 295d 2929 2c0d 0a20 2020 205d 0d0a  ())])),..    ]..
+00001a80: 0d0a 0d0a 2020 2020 6265 7374 5f6d 6f64  ....    best_mod
+00001a90: 656c 203d 204e 6f6e 650d 0a20 2020 2062  el = None..    b
+00001aa0: 6573 745f 6163 6375 7261 6379 203d 202d  est_accuracy = -
+00001ab0: 310d 0a20 2020 2062 6573 745f 6d6f 6465  1..    best_mode
+00001ac0: 6c5f 696e 7374 616e 6365 203d 204e 6f6e  l_instance = Non
+00001ad0: 650d 0a0d 0a20 2020 2066 6f72 206e 616d  e....    for nam
+00001ae0: 652c 206d 6f64 656c 2069 6e20 6d6f 6465  e, model in mode
+00001af0: 6c73 3a0d 0a20 2020 2020 2020 206d 6f64  ls:..        mod
+00001b00: 656c 2e66 6974 2864 665f 585f 7472 6169  el.fit(df_X_trai
+00001b10: 6e2c 2064 665f 795f 7472 6169 6e29 0d0a  n, df_y_train)..
+00001b20: 2020 2020 2020 2020 795f 7072 6564 5f62          y_pred_b
+00001b30: 696e 6172 7920 3d20 6d6f 6465 6c2e 7072  inary = model.pr
+00001b40: 6564 6963 7428 6466 5f58 5f74 6573 7429  edict(df_X_test)
+00001b50: 0d0a 0d0a 2020 2020 2020 2020 6966 206e  ....        if n
+00001b60: 616d 6520 696e 205b 2249 736f 6c61 7469  ame in ["Isolati
+00001b70: 6f6e 2046 6f72 6573 7422 2c20 224f 6e65  on Forest", "One
+00001b80: 2d43 6c61 7373 2053 564d 222c 2022 4b2d  -Class SVM", "K-
+00001b90: 4d65 616e 7322 5d3a 0d0a 2020 2020 2020  Means"]:..      
+00001ba0: 2020 2020 2020 795f 7072 6564 5f62 696e        y_pred_bin
+00001bb0: 6172 7920 3d20 6e70 2e77 6865 7265 2879  ary = np.where(y
+00001bc0: 5f70 7265 645f 6269 6e61 7279 203d 3d20  _pred_binary == 
+00001bd0: 2d31 2c20 302c 2079 5f70 7265 645f 6269  -1, 0, y_pred_bi
+00001be0: 6e61 7279 290d 0a0d 0a20 2020 2020 2020  nary)....       
+00001bf0: 2070 7269 6e74 286e 616d 6520 2b20 2220   print(name + " 
+00001c00: 4d6f 6465 6c3a 2229 0d0a 2020 2020 2020  Model:")..      
+00001c10: 2020 636f 6e66 7573 696f 6e5f 6d61 7472    confusion_matr
+00001c20: 6978 203d 206d 6574 7269 6373 2e63 6f6e  ix = metrics.con
+00001c30: 6675 7369 6f6e 5f6d 6174 7269 7828 6466  fusion_matrix(df
+00001c40: 5f79 5f74 6573 742c 2079 5f70 7265 645f  _y_test, y_pred_
+00001c50: 6269 6e61 7279 290d 0a20 2020 2020 2020  binary)..       
+00001c60: 2070 7269 6e74 2822 436f 6e66 7573 696f   print("Confusio
+00001c70: 6e20 4d61 7472 6978 3a22 290d 0a20 2020  n Matrix:")..   
+00001c80: 2020 2020 2070 7269 6e74 2863 6f6e 6675       print(confu
+00001c90: 7369 6f6e 5f6d 6174 7269 7829 0d0a 0d0a  sion_matrix)....
+00001ca0: 2020 2020 2020 2020 6163 6375 7261 6379          accuracy
+00001cb0: 203d 206d 6574 7269 6373 2e61 6363 7572   = metrics.accur
+00001cc0: 6163 795f 7363 6f72 6528 6466 5f79 5f74  acy_score(df_y_t
+00001cd0: 6573 742c 2079 5f70 7265 645f 6269 6e61  est, y_pred_bina
+00001ce0: 7279 290d 0a20 2020 2020 2020 2070 7265  ry)..        pre
+00001cf0: 6369 7369 6f6e 203d 206d 6574 7269 6373  cision = metrics
+00001d00: 2e70 7265 6369 7369 6f6e 5f73 636f 7265  .precision_score
+00001d10: 2864 665f 795f 7465 7374 2c20 795f 7072  (df_y_test, y_pr
+00001d20: 6564 5f62 696e 6172 7929 0d0a 2020 2020  ed_binary)..    
+00001d30: 2020 2020 7265 6361 6c6c 203d 206d 6574      recall = met
+00001d40: 7269 6373 2e72 6563 616c 6c5f 7363 6f72  rics.recall_scor
+00001d50: 6528 6466 5f79 5f74 6573 742c 2079 5f70  e(df_y_test, y_p
+00001d60: 7265 645f 6269 6e61 7279 290d 0a20 2020  red_binary)..   
+00001d70: 2020 2020 2063 6c61 7373 6966 6963 6174       classificat
+00001d80: 696f 6e5f 7265 706f 7274 203d 206d 6574  ion_report = met
+00001d90: 7269 6373 2e63 6c61 7373 6966 6963 6174  rics.classificat
+00001da0: 696f 6e5f 7265 706f 7274 2864 665f 795f  ion_report(df_y_
+00001db0: 7465 7374 2c20 795f 7072 6564 5f62 696e  test, y_pred_bin
+00001dc0: 6172 7929 0d0a 0d0a 2020 2020 2020 2020  ary)....        
+00001dd0: 7072 696e 7428 2241 6363 7572 6163 793a  print("Accuracy:
+00001de0: 222c 2061 6363 7572 6163 7929 0d0a 2020  ", accuracy)..  
+00001df0: 2020 2020 2020 7072 696e 7428 2250 7265        print("Pre
+00001e00: 6369 7369 6f6e 3a22 2c20 7072 6563 6973  cision:", precis
+00001e10: 696f 6e29 0d0a 2020 2020 2020 2020 7072  ion)..        pr
+00001e20: 696e 7428 2252 6563 616c 6c3a 222c 2072  int("Recall:", r
+00001e30: 6563 616c 6c29 0d0a 2020 2020 2020 2020  ecall)..        
+00001e40: 7072 696e 7428 636c 6173 7369 6669 6361  print(classifica
+00001e50: 7469 6f6e 5f72 6570 6f72 7429 0d0a 0d0a  tion_report)....
+00001e60: 2020 2020 2020 2020 6966 2061 6363 7572          if accur
+00001e70: 6163 7920 3e20 6265 7374 5f61 6363 7572  acy > best_accur
+00001e80: 6163 793a 0d0a 2020 2020 2020 2020 2020  acy:..          
+00001e90: 2020 6265 7374 5f61 6363 7572 6163 7920    best_accuracy 
+00001ea0: 3d20 6163 6375 7261 6379 0d0a 2020 2020  = accuracy..    
+00001eb0: 2020 2020 2020 2020 6265 7374 5f6d 6f64          best_mod
+00001ec0: 656c 203d 206e 616d 650d 0a20 2020 2020  el = name..     
+00001ed0: 2020 2020 2020 2062 6573 745f 6d6f 6465         best_mode
+00001ee0: 6c5f 696e 7374 616e 6365 203d 206d 6f64  l_instance = mod
+00001ef0: 656c 0d0a 0d0a 2020 2020 7072 696e 7428  el....    print(
+00001f00: 2254 6865 2062 6573 7420 6d6f 6465 6c20  "The best model 
+00001f10: 6973 3a22 2c20 6265 7374 5f6d 6f64 656c  is:", best_model
+00001f20: 2c20 2277 6974 6820 616e 2061 6363 7572  , "with an accur
+00001f30: 6163 7920 6f66 222c 2062 6573 745f 6163  acy of", best_ac
+00001f40: 6375 7261 6379 290d 0a0d 0a20 2020 2023  curacy)....    #
+00001f50: 2050 7269 6e74 2074 6865 2063 6f6e 6675   Print the confu
+00001f60: 7369 6f6e 206d 6174 7269 7820 666f 7220  sion matrix for 
+00001f70: 7468 6520 6265 7374 206d 6f64 656c 0d0a  the best model..
+00001f80: 2020 2020 795f 7072 6564 5f62 6573 7420      y_pred_best 
+00001f90: 3d20 6265 7374 5f6d 6f64 656c 5f69 6e73  = best_model_ins
+00001fa0: 7461 6e63 652e 7072 6564 6963 7428 6466  tance.predict(df
+00001fb0: 5f58 5f74 6573 7429 0d0a 2020 2020 6966  _X_test)..    if
+00001fc0: 2062 6573 745f 6d6f 6465 6c20 696e 205b   best_model in [
+00001fd0: 2249 736f 6c61 7469 6f6e 2046 6f72 6573  "Isolation Fores
+00001fe0: 7422 2c20 224f 6e65 2d43 6c61 7373 2053  t", "One-Class S
+00001ff0: 564d 222c 2022 4b2d 4d65 616e 7322 5d3a  VM", "K-Means"]:
+00002000: 0d0a 2020 2020 2020 2020 795f 7072 6564  ..        y_pred
+00002010: 5f62 6573 7420 3d20 6e70 2e77 6865 7265  _best = np.where
+00002020: 2879 5f70 7265 645f 6265 7374 203d 3d20  (y_pred_best == 
+00002030: 2d31 2c20 302c 2079 5f70 7265 645f 6265  -1, 0, y_pred_be
+00002040: 7374 290d 0a20 2020 2070 7269 6e74 2822  st)..    print("
+00002050: 436f 6e66 7573 696f 6e20 4d61 7472 6978  Confusion Matrix
+00002060: 206f 6620 7468 6520 6265 7374 206d 6f64   of the best mod
+00002070: 656c 3a22 290d 0a20 2020 2070 7269 6e74  el:")..    print
+00002080: 286d 6574 7269 6373 2e63 6f6e 6675 7369  (metrics.confusi
+00002090: 6f6e 5f6d 6174 7269 7828 6466 5f79 5f74  on_matrix(df_y_t
+000020a0: 6573 742c 2079 5f70 7265 645f 6265 7374  est, y_pred_best
+000020b0: 2929 0d0a 2020 2020 0d0a 2020 2020 0d0a  ))..    ..    ..
+000020c0: 6465 6620 6669 6e64 5f62 6573 745f 6d6f  def find_best_mo
+000020d0: 6465 6c5f 7265 6772 6573 7369 6f6e 2864  del_regression(d
+000020e0: 665f 585f 7472 6169 6e2c 2064 665f 585f  f_X_train, df_X_
+000020f0: 7465 7374 2c20 6466 5f79 5f74 7261 696e  test, df_y_train
+00002100: 2c20 6466 5f79 5f74 6573 7429 3a0d 0a20  , df_y_test):.. 
+00002110: 2020 200d 0a20 2020 2069 6d70 6f72 7420     ..    import 
+00002120: 6e75 6d70 7920 6173 206e 700d 0a20 2020  numpy as np..   
+00002130: 2069 6d70 6f72 7420 7061 6e64 6173 2061   import pandas a
+00002140: 7320 7064 0d0a 2020 2020 6672 6f6d 2073  s pd..    from s
+00002150: 6b6c 6561 726e 2e6c 696e 6561 725f 6d6f  klearn.linear_mo
+00002160: 6465 6c20 696d 706f 7274 204c 696e 6561  del import Linea
+00002170: 7252 6567 7265 7373 696f 6e2c 2052 6964  rRegression, Rid
+00002180: 6765 2c20 4c61 7373 6f2c 2045 6c61 7374  ge, Lasso, Elast
+00002190: 6963 4e65 742c 2042 6179 6573 6961 6e52  icNet, BayesianR
+000021a0: 6964 6765 2c20 5347 4452 6567 7265 7373  idge, SGDRegress
+000021b0: 6f72 0d0a 2020 2020 6672 6f6d 2073 6b6c  or..    from skl
+000021c0: 6561 726e 2e74 7265 6520 696d 706f 7274  earn.tree import
+000021d0: 2044 6563 6973 696f 6e54 7265 6552 6567   DecisionTreeReg
+000021e0: 7265 7373 6f72 0d0a 2020 2020 6672 6f6d  ressor..    from
+000021f0: 2073 6b6c 6561 726e 2e65 6e73 656d 626c   sklearn.ensembl
+00002200: 6520 696d 706f 7274 2052 616e 646f 6d46  e import RandomF
+00002210: 6f72 6573 7452 6567 7265 7373 6f72 2c20  orestRegressor, 
+00002220: 4772 6164 6965 6e74 426f 6f73 7469 6e67  GradientBoosting
+00002230: 5265 6772 6573 736f 722c 2041 6461 426f  Regressor, AdaBo
+00002240: 6f73 7452 6567 7265 7373 6f72 2c20 4578  ostRegressor, Ex
+00002250: 7472 6154 7265 6573 5265 6772 6573 736f  traTreesRegresso
+00002260: 722c 2042 6167 6769 6e67 5265 6772 6573  r, BaggingRegres
+00002270: 736f 720d 0a20 2020 2066 726f 6d20 736b  sor..    from sk
+00002280: 6c65 6172 6e2e 7376 6d20 696d 706f 7274  learn.svm import
+00002290: 2053 5652 0d0a 2020 2020 6672 6f6d 2073   SVR..    from s
+000022a0: 6b6c 6561 726e 2e6e 6569 6768 626f 7273  klearn.neighbors
+000022b0: 2069 6d70 6f72 7420 4b4e 6569 6768 626f   import KNeighbo
+000022c0: 7273 5265 6772 6573 736f 720d 0a20 2020  rsRegressor..   
+000022d0: 2066 726f 6d20 736b 6c65 6172 6e2e 6e65   from sklearn.ne
+000022e0: 7572 616c 5f6e 6574 776f 726b 2069 6d70  ural_network imp
+000022f0: 6f72 7420 4d4c 5052 6567 7265 7373 6f72  ort MLPRegressor
+00002300: 0d0a 2020 2020 6672 6f6d 2078 6762 6f6f  ..    from xgboo
+00002310: 7374 2069 6d70 6f72 7420 5847 4252 6567  st import XGBReg
+00002320: 7265 7373 6f72 0d0a 2020 2020 6672 6f6d  ressor..    from
+00002330: 206c 6967 6874 6762 6d20 696d 706f 7274   lightgbm import
+00002340: 204c 4742 4d52 6567 7265 7373 6f72 0d0a   LGBMRegressor..
+00002350: 2020 2020 6672 6f6d 2063 6174 626f 6f73      from catboos
+00002360: 7420 696d 706f 7274 2043 6174 426f 6f73  t import CatBoos
+00002370: 7452 6567 7265 7373 6f72 0d0a 2020 2020  tRegressor..    
+00002380: 6672 6f6d 2073 6b6c 6561 726e 2069 6d70  from sklearn imp
+00002390: 6f72 7420 6d65 7472 6963 730d 0a0d 0a20  ort metrics.... 
+000023a0: 2020 206d 6f64 656c 7320 3d20 5b0d 0a20     models = [.. 
+000023b0: 2020 2020 2020 2028 224c 696e 6561 7220         ("Linear 
+000023c0: 5265 6772 6573 7369 6f6e 222c 204c 696e  Regression", Lin
+000023d0: 6561 7252 6567 7265 7373 696f 6e28 2929  earRegression())
+000023e0: 2c0d 0a20 2020 2020 2020 2028 2252 6964  ,..        ("Rid
+000023f0: 6765 2052 6567 7265 7373 696f 6e22 2c20  ge Regression", 
+00002400: 5269 6467 6528 2929 2c0d 0a20 2020 2020  Ridge()),..     
+00002410: 2020 2028 224c 6173 736f 2052 6567 7265     ("Lasso Regre
+00002420: 7373 696f 6e22 2c20 4c61 7373 6f28 2929  ssion", Lasso())
+00002430: 2c0d 0a20 2020 2020 2020 2028 2245 6c61  ,..        ("Ela
+00002440: 7374 6963 4e65 7420 5265 6772 6573 7369  sticNet Regressi
+00002450: 6f6e 222c 2045 6c61 7374 6963 4e65 7428  on", ElasticNet(
+00002460: 2929 2c0d 0a20 2020 2020 2020 2028 2242  )),..        ("B
+00002470: 6179 6573 6961 6e20 5269 6467 6520 5265  ayesian Ridge Re
+00002480: 6772 6573 7369 6f6e 222c 2042 6179 6573  gression", Bayes
+00002490: 6961 6e52 6964 6765 2829 292c 0d0a 2020  ianRidge()),..  
+000024a0: 2020 2020 2020 2822 4465 6369 7369 6f6e        ("Decision
+000024b0: 2054 7265 6520 5265 6772 6573 736f 7222   Tree Regressor"
+000024c0: 2c20 4465 6369 7369 6f6e 5472 6565 5265  , DecisionTreeRe
+000024d0: 6772 6573 736f 7228 2929 2c0d 0a20 2020  gressor()),..   
+000024e0: 2020 2020 2028 2252 616e 646f 6d20 466f       ("Random Fo
+000024f0: 7265 7374 2052 6567 7265 7373 6f72 222c  rest Regressor",
+00002500: 2052 616e 646f 6d46 6f72 6573 7452 6567   RandomForestReg
+00002510: 7265 7373 6f72 2829 292c 0d0a 2020 2020  ressor()),..    
+00002520: 2020 2020 2822 4772 6164 6965 6e74 2042      ("Gradient B
+00002530: 6f6f 7374 696e 6720 5265 6772 6573 736f  oosting Regresso
+00002540: 7222 2c20 4772 6164 6965 6e74 426f 6f73  r", GradientBoos
+00002550: 7469 6e67 5265 6772 6573 736f 7228 2929  tingRegressor())
+00002560: 2c0d 0a20 2020 2020 2020 2028 2258 4742  ,..        ("XGB
+00002570: 6f6f 7374 2052 6567 7265 7373 6f72 222c  oost Regressor",
+00002580: 2058 4742 5265 6772 6573 736f 7228 6576   XGBRegressor(ev
+00002590: 616c 5f6d 6574 7269 633d 2272 6d73 6522  al_metric="rmse"
+000025a0: 2929 2c0d 0a20 2020 2020 2020 2028 224c  )),..        ("L
+000025b0: 6967 6874 4742 4d20 5265 6772 6573 736f  ightGBM Regresso
+000025c0: 7222 2c20 4c47 424d 5265 6772 6573 736f  r", LGBMRegresso
+000025d0: 7228 2929 2c0d 0a20 2020 2020 2020 2028  r()),..        (
+000025e0: 2253 7570 706f 7274 2056 6563 746f 7220  "Support Vector 
+000025f0: 5265 6772 6573 736f 7222 2c20 5356 5228  Regressor", SVR(
+00002600: 2929 2c0d 0a20 2020 2020 2020 2028 224b  )),..        ("K
+00002610: 2d4e 6561 7265 7374 204e 6569 6768 626f  -Nearest Neighbo
+00002620: 7273 2052 6567 7265 7373 6f72 222c 204b  rs Regressor", K
+00002630: 4e65 6967 6862 6f72 7352 6567 7265 7373  NeighborsRegress
+00002640: 6f72 2829 292c 0d0a 2020 2020 2020 2020  or()),..        
+00002650: 2822 4d75 6c74 692d 6c61 7965 7220 5065  ("Multi-layer Pe
+00002660: 7263 6570 7472 6f6e 2052 6567 7265 7373  rceptron Regress
+00002670: 6f72 222c 204d 4c50 5265 6772 6573 736f  or", MLPRegresso
+00002680: 7228 6d61 785f 6974 6572 3d31 3030 3029  r(max_iter=1000)
+00002690: 292c 0d0a 2020 2020 2020 2020 2822 4164  ),..        ("Ad
+000026a0: 6142 6f6f 7374 2052 6567 7265 7373 6f72  aBoost Regressor
+000026b0: 222c 2041 6461 426f 6f73 7452 6567 7265  ", AdaBoostRegre
+000026c0: 7373 6f72 2829 292c 0d0a 2020 2020 2020  ssor()),..      
+000026d0: 2020 2822 4578 7472 6120 5472 6565 7320    ("Extra Trees 
+000026e0: 5265 6772 6573 736f 7222 2c20 4578 7472  Regressor", Extr
+000026f0: 6154 7265 6573 5265 6772 6573 736f 7228  aTreesRegressor(
+00002700: 2929 2c0d 0a20 2020 2020 2020 2028 2253  )),..        ("S
+00002710: 746f 6368 6173 7469 6320 4772 6164 6965  tochastic Gradie
+00002720: 6e74 2044 6573 6365 6e74 2052 6567 7265  nt Descent Regre
+00002730: 7373 6f72 222c 2053 4744 5265 6772 6573  ssor", SGDRegres
+00002740: 736f 7228 2929 2c0d 0a20 2020 2020 2020  sor()),..       
+00002750: 2028 2242 6167 6769 6e67 2052 6567 7265   ("Bagging Regre
+00002760: 7373 6f72 222c 2042 6167 6769 6e67 5265  ssor", BaggingRe
+00002770: 6772 6573 736f 7228 2929 2c0d 0a20 2020  gressor()),..   
+00002780: 2020 2020 2028 2243 6174 426f 6f73 7420       ("CatBoost 
+00002790: 5265 6772 6573 736f 7222 2c20 4361 7442  Regressor", CatB
+000027a0: 6f6f 7374 5265 6772 6573 736f 7228 7665  oostRegressor(ve
+000027b0: 7262 6f73 653d 302c 2072 616e 646f 6d5f  rbose=0, random_
+000027c0: 7365 6564 3d34 3229 292c 0d0a 2020 2020  seed=42)),..    
+000027d0: 5d0d 0a0d 0a20 2020 2062 6573 745f 6d6f  ]....    best_mo
+000027e0: 6465 6c20 3d20 4e6f 6e65 0d0a 2020 2020  del = None..    
+000027f0: 6265 7374 5f6d 7365 203d 2066 6c6f 6174  best_mse = float
+00002800: 2822 696e 6622 290d 0a20 2020 2062 6573  ("inf")..    bes
+00002810: 745f 6d6f 6465 6c5f 696e 7374 616e 6365  t_model_instance
+00002820: 203d 204e 6f6e 650d 0a0d 0a20 2020 2066   = None....    f
+00002830: 6f72 206e 616d 652c 206d 6f64 656c 2069  or name, model i
+00002840: 6e20 6d6f 6465 6c73 3a0d 0a20 2020 2020  n models:..     
+00002850: 2020 206d 6f64 656c 2e66 6974 2864 665f     model.fit(df_
+00002860: 585f 7472 6169 6e2c 2064 665f 795f 7472  X_train, df_y_tr
+00002870: 6169 6e29 0d0a 2020 2020 2020 2020 795f  ain)..        y_
+00002880: 7072 6564 203d 206d 6f64 656c 2e70 7265  pred = model.pre
+00002890: 6469 6374 2864 665f 585f 7465 7374 290d  dict(df_X_test).
+000028a0: 0a0d 0a20 2020 2020 2020 2070 7269 6e74  ...        print
+000028b0: 286e 616d 6520 2b20 2220 4d6f 6465 6c3a  (name + " Model:
+000028c0: 2229 0d0a 2020 2020 2020 2020 6d73 6520  ")..        mse 
+000028d0: 3d20 6d65 7472 6963 732e 6d65 616e 5f73  = metrics.mean_s
+000028e0: 7175 6172 6564 5f65 7272 6f72 2864 665f  quared_error(df_
+000028f0: 795f 7465 7374 2c20 795f 7072 6564 290d  y_test, y_pred).
+00002900: 0a20 2020 2020 2020 2072 6d73 6520 3d20  .        rmse = 
+00002910: 6e70 2e73 7172 7428 6d73 6529 0d0a 2020  np.sqrt(mse)..  
+00002920: 2020 2020 2020 7232 203d 206d 6574 7269        r2 = metri
+00002930: 6373 2e72 325f 7363 6f72 6528 6466 5f79  cs.r2_score(df_y
+00002940: 5f74 6573 742c 2079 5f70 7265 6429 0d0a  _test, y_pred)..
+00002950: 0d0a 2020 2020 2020 2020 7072 696e 7428  ..        print(
+00002960: 224d 6561 6e20 5371 7561 7265 6420 4572  "Mean Squared Er
+00002970: 726f 723a 222c 206d 7365 290d 0a20 2020  ror:", mse)..   
+00002980: 2020 2020 2070 7269 6e74 2822 526f 6f74       print("Root
+00002990: 204d 6561 6e20 5371 7561 7265 6420 4572   Mean Squared Er
+000029a0: 726f 723a 222c 2072 6d73 6529 0d0a 2020  ror:", rmse)..  
+000029b0: 2020 2020 2020 7072 696e 7428 2252 2d73        print("R-s
+000029c0: 7175 6172 6564 3a22 2c20 7232 290d 0a20  quared:", r2).. 
+000029d0: 2020 2020 2020 2070 7269 6e74 2829 0d0a         print()..
+000029e0: 0d0a 2020 2020 2020 2020 6966 206d 7365  ..        if mse
+000029f0: 203c 2062 6573 745f 6d73 653a 0d0a 2020   < best_mse:..  
+00002a00: 2020 2020 2020 2020 2020 6265 7374 5f6d            best_m
+00002a10: 7365 203d 206d 7365 0d0a 2020 2020 2020  se = mse..      
+00002a20: 2020 2020 2020 6265 7374 5f6d 6f64 656c        best_model
+00002a30: 203d 206e 616d 650d 0a20 2020 2020 2020   = name..       
+00002a40: 2020 2020 2062 6573 745f 6d6f 6465 6c5f       best_model_
+00002a50: 696e 7374 616e 6365 203d 206d 6f64 656c  instance = model
+00002a60: 0d0a 0d0a 2020 2020 7072 696e 7428 2254  ....    print("T
+00002a70: 6865 2062 6573 7420 6d6f 6465 6c20 6973  he best model is
+00002a80: 3a22 2c20 6265 7374 5f6d 6f64 656c 2c20  :", best_model, 
+00002a90: 2277 6974 6820 6120 4d65 616e 2053 7175  "with a Mean Squ
+00002aa0: 6172 6564 2045 7272 6f72 206f 6622 2c20  ared Error of", 
+00002ab0: 6265 7374 5f6d 7365 290d 0a0d 0a20 2020  best_mse)....   
+00002ac0: 2023 2050 7269 6e74 2074 6865 206d 6574   # Print the met
+00002ad0: 7269 6373 2066 6f72 2074 6865 2062 6573  rics for the bes
+00002ae0: 7420 6d6f 6465 6c0d 0a20 2020 2079 5f70  t model..    y_p
+00002af0: 7265 645f 6265 7374 203d 2062 6573 745f  red_best = best_
+00002b00: 6d6f 6465 6c5f 696e 7374 616e 6365 2e70  model_instance.p
+00002b10: 7265 6469 6374 2864 665f 585f 7465 7374  redict(df_X_test
+00002b20: 290d 0a20 2020 2062 6573 745f 726d 7365  )..    best_rmse
+00002b30: 203d 206e 702e 7371 7274 2862 6573 745f   = np.sqrt(best_
+00002b40: 6d73 6529 0d0a 2020 2020 6265 7374 5f72  mse)..    best_r
+00002b50: 3220 3d20 6d65 7472 6963 732e 7232 5f73  2 = metrics.r2_s
+00002b60: 636f 7265 2864 665f 795f 7465 7374 2c20  core(df_y_test, 
+00002b70: 795f 7072 6564 5f62 6573 7429 0d0a 2020  y_pred_best)..  
+00002b80: 2020 7072 696e 7428 224d 6574 7269 6373    print("Metrics
+00002b90: 206f 6620 7468 6520 6265 7374 206d 6f64   of the best mod
+00002ba0: 656c 3a22 290d 0a20 2020 2070 7269 6e74  el:")..    print
+00002bb0: 2822 4d65 616e 2053 7175 6172 6564 2045  ("Mean Squared E
+00002bc0: 7272 6f72 3a22 2c20 6265 7374 5f6d 7365  rror:", best_mse
+00002bd0: 290d 0a20 2020 2070 7269 6e74 2822 526f  )..    print("Ro
+00002be0: 6f74 204d 6561 6e20 5371 7561 7265 6420  ot Mean Squared 
+00002bf0: 4572 726f 723a 222c 2062 6573 745f 726d  Error:", best_rm
+00002c00: 7365 290d 0a20 2020 2070 7269 6e74 2822  se)..    print("
+00002c10: 522d 7371 7561 7265 643a 222c 2062 6573  R-squared:", bes
+00002c20: 745f 7232 290d 0a0d 0a0d 0a0d 0a64 6566  t_r2)........def
+00002c30: 2066 696e 645f 6265 7374 5f63 6c75 7374   find_best_clust
+00002c40: 6572 696e 675f 616c 676f 7269 7468 6d28  ering_algorithm(
+00002c50: 6461 7461 2c20 7363 616c 696e 673d 5472  data, scaling=Tr
+00002c60: 7565 2c20 6e5f 636c 7573 7465 7273 3d4e  ue, n_clusters=N
+00002c70: 6f6e 652c 2076 6973 7561 6c69 7a65 3d54  one, visualize=T
+00002c80: 7275 652c 2074 6573 745f 6665 6174 7572  rue, test_featur
+00002c90: 655f 636f 6d62 696e 6174 696f 6e73 3d46  e_combinations=F
+00002ca0: 616c 7365 293a 0d0a 2020 2020 696d 706f  alse):..    impo
+00002cb0: 7274 206e 756d 7079 2061 7320 6e70 0d0a  rt numpy as np..
+00002cc0: 2020 2020 696d 706f 7274 2069 7465 7274      import itert
+00002cd0: 6f6f 6c73 0d0a 2020 2020 6672 6f6d 2073  ools..    from s
+00002ce0: 6b6c 6561 726e 2e70 7265 7072 6f63 6573  klearn.preproces
+00002cf0: 7369 6e67 2069 6d70 6f72 7420 5374 616e  sing import Stan
+00002d00: 6461 7264 5363 616c 6572 0d0a 2020 2020  dardScaler..    
+00002d10: 6672 6f6d 2073 6b6c 6561 726e 2e63 6c75  from sklearn.clu
+00002d20: 7374 6572 2069 6d70 6f72 7420 4b4d 6561  ster import KMea
+00002d30: 6e73 2c20 4d69 6e69 4261 7463 684b 4d65  ns, MiniBatchKMe
+00002d40: 616e 732c 2041 6666 696e 6974 7950 726f  ans, AffinityPro
+00002d50: 7061 6761 7469 6f6e 2c20 4d65 616e 5368  pagation, MeanSh
+00002d60: 6966 742c 2065 7374 696d 6174 655f 6261  ift, estimate_ba
+00002d70: 6e64 7769 6474 680d 0a20 2020 2066 726f  ndwidth..    fro
+00002d80: 6d20 736b 6c65 6172 6e2e 636c 7573 7465  m sklearn.cluste
+00002d90: 7220 696d 706f 7274 2053 7065 6374 7261  r import Spectra
+00002da0: 6c43 6c75 7374 6572 696e 672c 2041 6767  lClustering, Agg
+00002db0: 6c6f 6d65 7261 7469 7665 436c 7573 7465  lomerativeCluste
+00002dc0: 7269 6e67 2c20 4442 5343 414e 2c20 4f50  ring, DBSCAN, OP
+00002dd0: 5449 4353 2c20 4269 7263 680d 0a20 2020  TICS, Birch..   
+00002de0: 2066 726f 6d20 736b 6c65 6172 6e2e 6d69   from sklearn.mi
+00002df0: 7874 7572 6520 696d 706f 7274 2047 6175  xture import Gau
+00002e00: 7373 6961 6e4d 6978 7475 7265 0d0a 2020  ssianMixture..  
+00002e10: 2020 6672 6f6d 2073 6b6c 6561 726e 2e64    from sklearn.d
+00002e20: 6563 6f6d 706f 7369 7469 6f6e 2069 6d70  ecomposition imp
+00002e30: 6f72 7420 5043 410d 0a20 2020 2066 726f  ort PCA..    fro
+00002e40: 6d20 736b 6c65 6172 6e2e 6d65 7472 6963  m sklearn.metric
+00002e50: 7320 696d 706f 7274 2073 696c 686f 7565  s import silhoue
+00002e60: 7474 655f 7363 6f72 650d 0a20 2020 2069  tte_score..    i
+00002e70: 6d70 6f72 7420 6d61 7470 6c6f 746c 6962  mport matplotlib
+00002e80: 2e70 7970 6c6f 7420 6173 2070 6c74 0d0a  .pyplot as plt..
+00002e90: 0d0a 2020 2020 6966 2073 6361 6c69 6e67  ..    if scaling
+00002ea0: 3a0d 0a20 2020 2020 2020 2073 6361 6c65  :..        scale
+00002eb0: 7220 3d20 5374 616e 6461 7264 5363 616c  r = StandardScal
+00002ec0: 6572 2829 0d0a 2020 2020 2020 2020 6461  er()..        da
+00002ed0: 7461 203d 2073 6361 6c65 722e 6669 745f  ta = scaler.fit_
+00002ee0: 7472 616e 7366 6f72 6d28 6461 7461 290d  transform(data).
+00002ef0: 0a0d 0a20 2020 2069 6620 7465 7374 5f66  ...    if test_f
+00002f00: 6561 7475 7265 5f63 6f6d 6269 6e61 7469  eature_combinati
+00002f10: 6f6e 733a 0d0a 2020 2020 2020 2020 7072  ons:..        pr
+00002f20: 696e 7428 225c 6e54 6573 7469 6e67 2064  int("\nTesting d
+00002f30: 6966 6665 7265 6e74 2066 6561 7475 7265  ifferent feature
+00002f40: 2063 6f6d 6269 6e61 7469 6f6e 733a 2229   combinations:")
+00002f50: 0d0a 2020 2020 2020 2020 666f 7220 6e75  ..        for nu
+00002f60: 6d5f 6665 6174 7572 6573 2069 6e20 7261  m_features in ra
+00002f70: 6e67 6528 312c 2064 6174 612e 7368 6170  nge(1, data.shap
+00002f80: 655b 315d 202b 2031 293a 0d0a 2020 2020  e[1] + 1):..    
+00002f90: 2020 2020 2020 2020 666f 7220 6665 6174          for feat
+00002fa0: 7572 655f 636f 6d62 696e 6174 696f 6e20  ure_combination 
+00002fb0: 696e 2069 7465 7274 6f6f 6c73 2e63 6f6d  in itertools.com
+00002fc0: 6269 6e61 7469 6f6e 7328 7261 6e67 6528  binations(range(
+00002fd0: 6461 7461 2e73 6861 7065 5b31 5d29 2c20  data.shape[1]), 
+00002fe0: 6e75 6d5f 6665 6174 7572 6573 293a 0d0a  num_features):..
+00002ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003000: 7265 6475 6365 645f 6461 7461 203d 2064  reduced_data = d
+00003010: 6174 615b 3a2c 2066 6561 7475 7265 5f63  ata[:, feature_c
+00003020: 6f6d 6269 6e61 7469 6f6e 5d0d 0a20 2020  ombination]..   
+00003030: 2020 2020 2020 2020 2020 2020 205f 2c20               _, 
+00003040: 5f2c 2073 636f 7265 203d 2066 696e 645f  _, score = find_
+00003050: 6265 7374 5f63 6c75 7374 6572 696e 675f  best_clustering_
+00003060: 616c 676f 7269 7468 6d28 7265 6475 6365  algorithm(reduce
+00003070: 645f 6461 7461 2c20 7363 616c 696e 673d  d_data, scaling=
+00003080: 4661 6c73 652c 206e 5f63 6c75 7374 6572  False, n_cluster
+00003090: 733d 6e5f 636c 7573 7465 7273 2c20 7669  s=n_clusters, vi
+000030a0: 7375 616c 697a 653d 4661 6c73 6529 0d0a  sualize=False)..
+000030b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000030c0: 7072 696e 7428 6622 5369 6c68 6f75 6574  print(f"Silhouet
+000030d0: 7465 2073 636f 7265 2066 6f72 2066 6561  te score for fea
+000030e0: 7475 7265 7320 7b66 6561 7475 7265 5f63  tures {feature_c
+000030f0: 6f6d 6269 6e61 7469 6f6e 7d3a 207b 7363  ombination}: {sc
+00003100: 6f72 657d 2229 0d0a 0d0a 2020 2020 636c  ore}")....    cl
+00003110: 7573 7465 7269 6e67 5f61 6c67 6f72 6974  ustering_algorit
+00003120: 686d 7320 3d20 5b0d 0a20 2020 2020 2020  hms = [..       
+00003130: 2028 224b 4d65 616e 7322 2c20 4b4d 6561   ("KMeans", KMea
+00003140: 6e73 286e 5f63 6c75 7374 6572 733d 6e5f  ns(n_clusters=n_
+00003150: 636c 7573 7465 7273 2920 6966 206e 5f63  clusters) if n_c
+00003160: 6c75 7374 6572 7320 656c 7365 204b 4d65  lusters else KMe
+00003170: 616e 7328 2929 2c0d 0a20 2020 2020 2020  ans()),..       
+00003180: 2028 224d 696e 6942 6174 6368 4b4d 6561   ("MiniBatchKMea
+00003190: 6e73 222c 204d 696e 6942 6174 6368 4b4d  ns", MiniBatchKM
+000031a0: 6561 6e73 286e 5f63 6c75 7374 6572 733d  eans(n_clusters=
+000031b0: 6e5f 636c 7573 7465 7273 2920 6966 206e  n_clusters) if n
+000031c0: 5f63 6c75 7374 6572 7320 656c 7365 204d  _clusters else M
+000031d0: 696e 6942 6174 6368 4b4d 6561 6e73 2829  iniBatchKMeans()
+000031e0: 292c 0d0a 2020 2020 2020 2020 2822 4166  ),..        ("Af
+000031f0: 6669 6e69 7479 5072 6f70 6167 6174 696f  finityPropagatio
+00003200: 6e22 2c20 4166 6669 6e69 7479 5072 6f70  n", AffinityProp
+00003210: 6167 6174 696f 6e28 2929 2c0d 0a20 2020  agation()),..   
+00003220: 2020 2020 2028 224d 6561 6e53 6869 6674       ("MeanShift
+00003230: 222c 204d 6561 6e53 6869 6674 2862 616e  ", MeanShift(ban
+00003240: 6477 6964 7468 3d65 7374 696d 6174 655f  dwidth=estimate_
+00003250: 6261 6e64 7769 6474 6828 6461 7461 2c20  bandwidth(data, 
+00003260: 6e5f 7361 6d70 6c65 733d 6e5f 636c 7573  n_samples=n_clus
+00003270: 7465 7273 2929 2069 6620 6e5f 636c 7573  ters)) if n_clus
+00003280: 7465 7273 2065 6c73 6520 4d65 616e 5368  ters else MeanSh
+00003290: 6966 7428 2929 2c0d 0a20 2020 2020 2020  ift()),..       
+000032a0: 2028 2253 7065 6374 7261 6c43 6c75 7374   ("SpectralClust
+000032b0: 6572 696e 6722 2c20 5370 6563 7472 616c  ering", Spectral
+000032c0: 436c 7573 7465 7269 6e67 286e 5f63 6c75  Clustering(n_clu
+000032d0: 7374 6572 733d 6e5f 636c 7573 7465 7273  sters=n_clusters
+000032e0: 2920 6966 206e 5f63 6c75 7374 6572 7320  ) if n_clusters 
+000032f0: 656c 7365 2053 7065 6374 7261 6c43 6c75  else SpectralClu
+00003300: 7374 6572 696e 6728 2929 2c0d 0a20 2020  stering()),..   
+00003310: 2020 2020 2028 2241 6767 6c6f 6d65 7261       ("Agglomera
+00003320: 7469 7665 436c 7573 7465 7269 6e67 222c  tiveClustering",
+00003330: 2041 6767 6c6f 6d65 7261 7469 7665 436c   AgglomerativeCl
+00003340: 7573 7465 7269 6e67 286e 5f63 6c75 7374  ustering(n_clust
+00003350: 6572 733d 6e5f 636c 7573 7465 7273 2920  ers=n_clusters) 
+00003360: 6966 206e 5f63 6c75 7374 6572 7320 656c  if n_clusters el
+00003370: 7365 2041 6767 6c6f 6d65 7261 7469 7665  se Agglomerative
+00003380: 436c 7573 7465 7269 6e67 2829 292c 0d0a  Clustering()),..
+00003390: 2020 2020 2020 2020 2822 4442 5343 414e          ("DBSCAN
+000033a0: 222c 2044 4253 4341 4e28 2929 2c0d 0a20  ", DBSCAN()),.. 
+000033b0: 2020 2020 2020 2028 224f 5054 4943 5322         ("OPTICS"
+000033c0: 2c20 4f50 5449 4353 2829 292c 0d0a 2020  , OPTICS()),..  
+000033d0: 2020 2020 2020 2822 4269 7263 6822 2c20        ("Birch", 
+000033e0: 4269 7263 6828 6e5f 636c 7573 7465 7273  Birch(n_clusters
+000033f0: 3d6e 5f63 6c75 7374 6572 7329 2069 6620  =n_clusters) if 
+00003400: 6e5f 636c 7573 7465 7273 2065 6c73 6520  n_clusters else 
+00003410: 4269 7263 6828 2929 2c0d 0a20 2020 2020  Birch()),..     
+00003420: 2020 2028 2247 6175 7373 6961 6e4d 6978     ("GaussianMix
+00003430: 7475 7265 222c 2047 6175 7373 6961 6e4d  ture", GaussianM
+00003440: 6978 7475 7265 286e 5f63 6f6d 706f 6e65  ixture(n_compone
+00003450: 6e74 733d 6e5f 636c 7573 7465 7273 2920  nts=n_clusters) 
+00003460: 6966 206e 5f63 6c75 7374 6572 7320 656c  if n_clusters el
+00003470: 7365 2047 6175 7373 6961 6e4d 6978 7475  se GaussianMixtu
+00003480: 7265 2829 290d 0a20 2020 205d 0d0a 0d0a  re())..    ]....
+00003490: 2020 2020 6265 7374 5f61 6c67 6f72 6974      best_algorit
+000034a0: 686d 203d 204e 6f6e 650d 0a20 2020 2062  hm = None..    b
+000034b0: 6573 745f 616c 676f 7269 7468 6d5f 6e61  est_algorithm_na
+000034c0: 6d65 203d 2022 220d 0a20 2020 2062 6573  me = ""..    bes
+000034d0: 745f 7363 6f72 6520 3d20 2d6e 702e 696e  t_score = -np.in
+000034e0: 660d 0a0d 0a20 2020 2066 6f72 206e 616d  f....    for nam
+000034f0: 652c 2061 6c67 6f72 6974 686d 2069 6e20  e, algorithm in 
+00003500: 636c 7573 7465 7269 6e67 5f61 6c67 6f72  clustering_algor
+00003510: 6974 686d 733a 0d0a 2020 2020 2020 2020  ithms:..        
+00003520: 7472 793a 0d0a 2020 2020 2020 2020 2020  try:..          
+00003530: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+00003540: 616c 676f 7269 7468 6d2c 2047 6175 7373  algorithm, Gauss
+00003550: 6961 6e4d 6978 7475 7265 293a 0d0a 2020  ianMixture):..  
+00003560: 2020 2020 2020 2020 2020 2020 2020 616c                al
+00003570: 676f 7269 7468 6d2e 6669 7428 6461 7461  gorithm.fit(data
+00003580: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00003590: 2020 206c 6162 656c 7320 3d20 616c 676f     labels = algo
+000035a0: 7269 7468 6d2e 7072 6564 6963 7428 6461  rithm.predict(da
+000035b0: 7461 290d 0a20 2020 2020 2020 2020 2020  ta)..           
+000035c0: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+000035d0: 2020 2020 2020 2020 6c61 6265 6c73 203d          labels =
+000035e0: 2061 6c67 6f72 6974 686d 2e66 6974 5f70   algorithm.fit_p
+000035f0: 7265 6469 6374 2864 6174 6129 0d0a 0d0a  redict(data)....
+00003600: 2020 2020 2020 2020 2020 2020 6966 206c              if l
+00003610: 656e 286e 702e 756e 6971 7565 286c 6162  en(np.unique(lab
+00003620: 656c 7329 2920 3e20 313a 0d0a 2020 2020  els)) > 1:..    
+00003630: 2020 2020 2020 2020 2020 2020 7363 6f72              scor
+00003640: 6520 3d20 7369 6c68 6f75 6574 7465 5f73  e = silhouette_s
+00003650: 636f 7265 2864 6174 612c 206c 6162 656c  core(data, label
+00003660: 7329 0d0a 2020 2020 2020 2020 2020 2020  s)..            
+00003670: 2020 2020 7072 696e 7428 6622 7b6e 616d      print(f"{nam
+00003680: 657d 2041 6c67 6f72 6974 686d 3a22 290d  e} Algorithm:").
+00003690: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000036a0: 2070 7269 6e74 2822 5369 6c68 6f75 6574   print("Silhouet
+000036b0: 7465 2053 636f 7265 3a22 2c20 7363 6f72  te Score:", scor
+000036c0: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
+000036d0: 2020 2020 6966 2073 636f 7265 203e 2062      if score > b
+000036e0: 6573 745f 7363 6f72 653a 0d0a 2020 2020  est_score:..    
+000036f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003700: 6265 7374 5f73 636f 7265 203d 2073 636f  best_score = sco
+00003710: 7265 0d0a 2020 2020 2020 2020 2020 2020  re..            
+00003720: 2020 2020 2020 2020 6265 7374 5f61 6c67          best_alg
+00003730: 6f72 6974 686d 203d 2061 6c67 6f72 6974  orithm = algorit
+00003740: 686d 0d0a 2020 2020 2020 2020 2020 2020  hm..            
+00003750: 2020 2020 2020 2020 6265 7374 5f61 6c67          best_alg
+00003760: 6f72 6974 686d 5f6e 616d 6520 3d20 6e61  orithm_name = na
+00003770: 6d65 0d0a 2020 2020 2020 2020 6578 6365  me..        exce
+00003780: 7074 2045 7863 6570 7469 6f6e 2061 7320  pt Exception as 
+00003790: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+000037a0: 7072 696e 7428 6622 416e 2065 7272 6f72  print(f"An error
+000037b0: 206f 6363 7572 7265 6420 7768 696c 6520   occurred while 
+000037c0: 7072 6f63 6573 7369 6e67 207b 6e61 6d65  processing {name
+000037d0: 7d3a 207b 657d 2229 0d0a 0d0a 2020 2020  }: {e}")....    
+000037e0: 7072 696e 7428 2254 6865 2062 6573 7420  print("The best 
+000037f0: 636c 7573 7465 7269 6e67 2061 6c67 6f72  clustering algor
+00003800: 6974 686d 2069 733a 222c 2062 6573 745f  ithm is:", best_
+00003810: 616c 676f 7269 7468 6d5f 6e61 6d65 2c20  algorithm_name, 
+00003820: 2277 6974 6820 6120 7369 6c68 6f75 6574  "with a silhouet
+00003830: 7465 2073 636f 7265 206f 6622 2c20 6265  te score of", be
+00003840: 7374 5f73 636f 7265 290d 0a20 2020 2070  st_score)..    p
+00003850: 6361 203d 2050 4341 286e 5f63 6f6d 706f  ca = PCA(n_compo
+00003860: 6e65 6e74 733d 3229 0d0a 2020 2020 585f  nents=2)..    X_
+00003870: 7063 6120 3d20 7063 612e 6669 745f 7472  pca = pca.fit_tr
+00003880: 616e 7366 6f72 6d28 6461 7461 290d 0a0d  ansform(data)...
+00003890: 0a20 2020 2069 6620 6973 696e 7374 616e  .    if isinstan
+000038a0: 6365 2862 6573 745f 616c 676f 7269 7468  ce(best_algorith
+000038b0: 6d2c 2047 6175 7373 6961 6e4d 6978 7475  m, GaussianMixtu
+000038c0: 7265 293a 0d0a 2020 2020 2020 2020 6265  re):..        be
+000038d0: 7374 5f61 6c67 6f72 6974 686d 2e66 6974  st_algorithm.fit
+000038e0: 2864 6174 6129 0d0a 2020 2020 2020 2020  (data)..        
+000038f0: 636c 7573 7465 725f 6c61 6265 6c73 203d  cluster_labels =
+00003900: 2062 6573 745f 616c 676f 7269 7468 6d2e   best_algorithm.
+00003910: 7072 6564 6963 7428 6461 7461 290d 0a20  predict(data).. 
+00003920: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+00003930: 2020 636c 7573 7465 725f 6c61 6265 6c73    cluster_labels
+00003940: 203d 2062 6573 745f 616c 676f 7269 7468   = best_algorith
+00003950: 6d2e 6669 745f 7072 6564 6963 7428 6461  m.fit_predict(da
+00003960: 7461 290d 0a0d 0a20 2020 2070 6c74 2e66  ta)....    plt.f
+00003970: 6967 7572 6528 6669 6773 697a 653d 2831  igure(figsize=(1
+00003980: 302c 2036 2929 0d0a 2020 2020 706c 742e  0, 6))..    plt.
+00003990: 7363 6174 7465 7228 585f 7063 615b 3a2c  scatter(X_pca[:,
+000039a0: 2030 5d2c 2058 5f70 6361 5b3a 2c20 315d   0], X_pca[:, 1]
+000039b0: 2c20 633d 636c 7573 7465 725f 6c61 6265  , c=cluster_labe
+000039c0: 6c73 2c20 636d 6170 3d27 7669 7269 6469  ls, cmap='viridi
+000039d0: 7327 2c20 6564 6765 636f 6c6f 7273 3d27  s', edgecolors='
+000039e0: 6b27 2c20 733d 3530 290d 0a20 2020 200d  k', s=50)..    .
+000039f0: 0a20 2020 2070 6c74 2e74 6974 6c65 2827  .    plt.title('
+00003a00: 5363 6174 7465 7220 506c 6f74 2066 6f72  Scatter Plot for
+00003a10: 2074 6865 2042 6573 7420 436c 7573 7465   the Best Cluste
+00003a20: 7269 6e67 204d 6f64 656c 3a20 2720 2b20  ring Model: ' + 
+00003a30: 6265 7374 5f61 6c67 6f72 6974 686d 5f6e  best_algorithm_n
+00003a40: 616d 6529 0d0a 2020 2020 706c 742e 786c  ame)..    plt.xl
+00003a50: 6162 656c 2827 5072 696e 6369 7061 6c20  abel('Principal 
+00003a60: 436f 6d70 6f6e 656e 7420 3127 290d 0a20  Component 1').. 
+00003a70: 2020 2070 6c74 2e79 6c61 6265 6c28 2750     plt.ylabel('P
+00003a80: 7269 6e63 6970 616c 2043 6f6d 706f 6e65  rincipal Compone
+00003a90: 6e74 2032 2729 0d0a 2020 2020 706c 742e  nt 2')..    plt.
+00003aa0: 7368 6f77 2829 0d0a 2020 2020 7265 7475  show()..    retu
+00003ab0: 726e 2062 6573 745f 616c 676f 7269 7468  rn best_algorith
+00003ac0: 6d5f 6e61 6d65 2c20 6265 7374 5f61 6c67  m_name, best_alg
+00003ad0: 6f72 6974 686d 2c20 6265 7374 5f73 636f  orithm, best_sco
+00003ae0: 7265 0d0a 0d0a 0d0a 6465 6620 6669 6e64  re......def find
+00003af0: 5f62 6573 745f 6d6f 6465 6c5f 7265 6772  _best_model_regr
+00003b00: 6573 7369 6f6e 5f32 2858 2c20 792c 2074  ession_2(X, y, t
+00003b10: 6573 745f 7369 7a65 3d30 2e32 2c20 7261  est_size=0.2, ra
+00003b20: 6e64 6f6d 5f73 7461 7465 3d34 322c 2063  ndom_state=42, c
+00003b30: 763d 3529 3a0d 0a20 2020 200d 0a20 2020  v=5):..    ..   
+00003b40: 2069 6d70 6f72 7420 6e75 6d70 7920 6173   import numpy as
+00003b50: 206e 700d 0a20 2020 2069 6d70 6f72 7420   np..    import 
+00003b60: 7061 6e64 6173 2061 7320 7064 0d0a 2020  pandas as pd..  
+00003b70: 2020 6672 6f6d 2073 6b6c 6561 726e 2e6c    from sklearn.l
+00003b80: 696e 6561 725f 6d6f 6465 6c20 696d 706f  inear_model impo
+00003b90: 7274 204c 696e 6561 7252 6567 7265 7373  rt LinearRegress
+00003ba0: 696f 6e2c 2052 6964 6765 2c20 4c61 7373  ion, Ridge, Lass
+00003bb0: 6f2c 2045 6c61 7374 6963 4e65 742c 2042  o, ElasticNet, B
+00003bc0: 6179 6573 6961 6e52 6964 6765 2c20 5347  ayesianRidge, SG
+00003bd0: 4452 6567 7265 7373 6f72 0d0a 2020 2020  DRegressor..    
+00003be0: 6672 6f6d 2073 6b6c 6561 726e 2e74 7265  from sklearn.tre
+00003bf0: 6520 696d 706f 7274 2044 6563 6973 696f  e import Decisio
+00003c00: 6e54 7265 6552 6567 7265 7373 6f72 0d0a  nTreeRegressor..
+00003c10: 2020 2020 6672 6f6d 2073 6b6c 6561 726e      from sklearn
+00003c20: 2e65 6e73 656d 626c 6520 696d 706f 7274  .ensemble import
+00003c30: 2052 616e 646f 6d46 6f72 6573 7452 6567   RandomForestReg
+00003c40: 7265 7373 6f72 2c20 4772 6164 6965 6e74  ressor, Gradient
+00003c50: 426f 6f73 7469 6e67 5265 6772 6573 736f  BoostingRegresso
+00003c60: 722c 2041 6461 426f 6f73 7452 6567 7265  r, AdaBoostRegre
+00003c70: 7373 6f72 2c20 4578 7472 6154 7265 6573  ssor, ExtraTrees
+00003c80: 5265 6772 6573 736f 722c 2042 6167 6769  Regressor, Baggi
+00003c90: 6e67 5265 6772 6573 736f 720d 0a20 2020  ngRegressor..   
+00003ca0: 2066 726f 6d20 736b 6c65 6172 6e2e 7376   from sklearn.sv
+00003cb0: 6d20 696d 706f 7274 2053 5652 0d0a 2020  m import SVR..  
+00003cc0: 2020 6672 6f6d 2073 6b6c 6561 726e 2e6e    from sklearn.n
+00003cd0: 6569 6768 626f 7273 2069 6d70 6f72 7420  eighbors import 
+00003ce0: 4b4e 6569 6768 626f 7273 5265 6772 6573  KNeighborsRegres
+00003cf0: 736f 720d 0a20 2020 2066 726f 6d20 736b  sor..    from sk
+00003d00: 6c65 6172 6e2e 6e65 7572 616c 5f6e 6574  learn.neural_net
+00003d10: 776f 726b 2069 6d70 6f72 7420 4d4c 5052  work import MLPR
+00003d20: 6567 7265 7373 6f72 0d0a 2020 2020 6672  egressor..    fr
+00003d30: 6f6d 2078 6762 6f6f 7374 2069 6d70 6f72  om xgboost impor
+00003d40: 7420 5847 4252 6567 7265 7373 6f72 0d0a  t XGBRegressor..
+00003d50: 2020 2020 6672 6f6d 206c 6967 6874 6762      from lightgb
+00003d60: 6d20 696d 706f 7274 204c 4742 4d52 6567  m import LGBMReg
+00003d70: 7265 7373 6f72 0d0a 2020 2020 6672 6f6d  ressor..    from
+00003d80: 2063 6174 626f 6f73 7420 696d 706f 7274   catboost import
+00003d90: 2043 6174 426f 6f73 7452 6567 7265 7373   CatBoostRegress
+00003da0: 6f72 0d0a 2020 2020 6672 6f6d 2073 6b6c  or..    from skl
+00003db0: 6561 726e 2069 6d70 6f72 7420 6d65 7472  earn import metr
+00003dc0: 6963 730d 0a20 2020 2066 726f 6d20 736b  ics..    from sk
+00003dd0: 6c65 6172 6e2e 6d65 7472 6963 7320 696d  learn.metrics im
+00003de0: 706f 7274 206d 6561 6e5f 7371 7561 7265  port mean_square
+00003df0: 645f 6572 726f 722c 2072 325f 7363 6f72  d_error, r2_scor
+00003e00: 650d 0a20 2020 2066 726f 6d20 736b 6c65  e..    from skle
+00003e10: 6172 6e2e 6d6f 6465 6c5f 7365 6c65 6374  arn.model_select
+00003e20: 696f 6e20 696d 706f 7274 2074 7261 696e  ion import train
+00003e30: 5f74 6573 745f 7370 6c69 742c 2063 726f  _test_split, cro
+00003e40: 7373 5f76 616c 5f73 636f 7265 2c20 6c65  ss_val_score, le
+00003e50: 6172 6e69 6e67 5f63 7572 7665 0d0a 2020  arning_curve..  
+00003e60: 2020 696d 706f 7274 206d 6174 706c 6f74    import matplot
+00003e70: 6c69 622e 7079 706c 6f74 2061 7320 706c  lib.pyplot as pl
+00003e80: 740d 0a0d 0a20 2020 206d 6f64 656c 7320  t....    models 
+00003e90: 3d20 5b0d 0a20 2020 2020 2020 2028 224c  = [..        ("L
+00003ea0: 696e 6561 7220 5265 6772 6573 7369 6f6e  inear Regression
+00003eb0: 222c 204c 696e 6561 7252 6567 7265 7373  ", LinearRegress
+00003ec0: 696f 6e28 2929 2c0d 0a20 2020 2020 2020  ion()),..       
+00003ed0: 2028 2252 6964 6765 2052 6567 7265 7373   ("Ridge Regress
+00003ee0: 696f 6e22 2c20 5269 6467 6528 2929 2c0d  ion", Ridge()),.
+00003ef0: 0a20 2020 2020 2020 2028 224c 6173 736f  .        ("Lasso
+00003f00: 2052 6567 7265 7373 696f 6e22 2c20 4c61   Regression", La
+00003f10: 7373 6f28 2929 2c0d 0a20 2020 2020 2020  sso()),..       
+00003f20: 2028 2245 6c61 7374 6963 4e65 7420 5265   ("ElasticNet Re
+00003f30: 6772 6573 7369 6f6e 222c 2045 6c61 7374  gression", Elast
+00003f40: 6963 4e65 7428 2929 2c0d 0a20 2020 2020  icNet()),..     
+00003f50: 2020 2028 2242 6179 6573 6961 6e20 5269     ("Bayesian Ri
+00003f60: 6467 6520 5265 6772 6573 7369 6f6e 222c  dge Regression",
+00003f70: 2042 6179 6573 6961 6e52 6964 6765 2829   BayesianRidge()
+00003f80: 292c 0d0a 2020 2020 2020 2020 2822 4465  ),..        ("De
+00003f90: 6369 7369 6f6e 2054 7265 6520 5265 6772  cision Tree Regr
+00003fa0: 6573 736f 7222 2c20 4465 6369 7369 6f6e  essor", Decision
+00003fb0: 5472 6565 5265 6772 6573 736f 7228 2929  TreeRegressor())
+00003fc0: 2c0d 0a20 2020 2020 2020 2028 2252 616e  ,..        ("Ran
+00003fd0: 646f 6d20 466f 7265 7374 2052 6567 7265  dom Forest Regre
+00003fe0: 7373 6f72 222c 2052 616e 646f 6d46 6f72  ssor", RandomFor
+00003ff0: 6573 7452 6567 7265 7373 6f72 2829 292c  estRegressor()),
+00004000: 0d0a 2020 2020 2020 2020 2822 4772 6164  ..        ("Grad
+00004010: 6965 6e74 2042 6f6f 7374 696e 6720 5265  ient Boosting Re
+00004020: 6772 6573 736f 7222 2c20 4772 6164 6965  gressor", Gradie
+00004030: 6e74 426f 6f73 7469 6e67 5265 6772 6573  ntBoostingRegres
+00004040: 736f 7228 2929 2c0d 0a20 2020 2020 2020  sor()),..       
+00004050: 2028 2258 4742 6f6f 7374 2052 6567 7265   ("XGBoost Regre
+00004060: 7373 6f72 222c 2058 4742 5265 6772 6573  ssor", XGBRegres
+00004070: 736f 7228 6576 616c 5f6d 6574 7269 633d  sor(eval_metric=
+00004080: 2272 6d73 6522 2929 2c0d 0a20 2020 2020  "rmse")),..     
+00004090: 2020 2028 224c 6967 6874 4742 4d20 5265     ("LightGBM Re
+000040a0: 6772 6573 736f 7222 2c20 4c47 424d 5265  gressor", LGBMRe
+000040b0: 6772 6573 736f 7228 2929 2c0d 0a20 2020  gressor()),..   
+000040c0: 2020 2020 2028 2253 7570 706f 7274 2056       ("Support V
+000040d0: 6563 746f 7220 5265 6772 6573 736f 7222  ector Regressor"
+000040e0: 2c20 5356 5228 2929 2c0d 0a20 2020 2020  , SVR()),..     
+000040f0: 2020 2028 224b 2d4e 6561 7265 7374 204e     ("K-Nearest N
+00004100: 6569 6768 626f 7273 2052 6567 7265 7373  eighbors Regress
+00004110: 6f72 222c 204b 4e65 6967 6862 6f72 7352  or", KNeighborsR
+00004120: 6567 7265 7373 6f72 2829 292c 0d0a 2020  egressor()),..  
+00004130: 2020 2020 2020 2822 4d75 6c74 692d 6c61        ("Multi-la
+00004140: 7965 7220 5065 7263 6570 7472 6f6e 2052  yer Perceptron R
+00004150: 6567 7265 7373 6f72 222c 204d 4c50 5265  egressor", MLPRe
+00004160: 6772 6573 736f 7228 6d61 785f 6974 6572  gressor(max_iter
+00004170: 3d31 3030 3029 292c 0d0a 2020 2020 2020  =1000)),..      
+00004180: 2020 2822 4164 6142 6f6f 7374 2052 6567    ("AdaBoost Reg
+00004190: 7265 7373 6f72 222c 2041 6461 426f 6f73  ressor", AdaBoos
+000041a0: 7452 6567 7265 7373 6f72 2829 292c 0d0a  tRegressor()),..
+000041b0: 2020 2020 2020 2020 2822 4578 7472 6120          ("Extra 
+000041c0: 5472 6565 7320 5265 6772 6573 736f 7222  Trees Regressor"
+000041d0: 2c20 4578 7472 6154 7265 6573 5265 6772  , ExtraTreesRegr
+000041e0: 6573 736f 7228 2929 2c0d 0a20 2020 2020  essor()),..     
+000041f0: 2020 2028 2253 746f 6368 6173 7469 6320     ("Stochastic 
+00004200: 4772 6164 6965 6e74 2044 6573 6365 6e74  Gradient Descent
+00004210: 2052 6567 7265 7373 6f72 222c 2053 4744   Regressor", SGD
+00004220: 5265 6772 6573 736f 7228 2929 2c0d 0a20  Regressor()),.. 
+00004230: 2020 2020 2020 2028 2242 6167 6769 6e67         ("Bagging
+00004240: 2052 6567 7265 7373 6f72 222c 2042 6167   Regressor", Bag
+00004250: 6769 6e67 5265 6772 6573 736f 7228 2929  gingRegressor())
+00004260: 2c0d 0a20 2020 2020 2020 2028 2243 6174  ,..        ("Cat
+00004270: 426f 6f73 7420 5265 6772 6573 736f 7222  Boost Regressor"
+00004280: 2c20 4361 7442 6f6f 7374 5265 6772 6573  , CatBoostRegres
+00004290: 736f 7228 7665 7262 6f73 653d 302c 2072  sor(verbose=0, r
+000042a0: 616e 646f 6d5f 7365 6564 3d34 3229 292c  andom_seed=42)),
+000042b0: 0d0a 2020 2020 5d0d 0a0d 0a20 2020 206e  ..    ]....    n
+000042c0: 5f73 616d 706c 6573 203d 2058 2e73 6861  _samples = X.sha
+000042d0: 7065 5b30 5d0d 0a20 2020 2061 646a 7573  pe[0]..    adjus
+000042e0: 7465 645f 7465 7374 5f73 697a 6520 3d20  ted_test_size = 
+000042f0: 696e 7428 7465 7374 5f73 697a 6520 2a20  int(test_size * 
+00004300: 6e5f 7361 6d70 6c65 7329 0d0a 0d0a 2020  n_samples)....  
+00004310: 2020 6265 7374 5f6d 6f64 656c 203d 204e    best_model = N
+00004320: 6f6e 650d 0a20 2020 2062 6573 745f 6d73  one..    best_ms
+00004330: 6520 3d20 666c 6f61 7428 2269 6e66 2229  e = float("inf")
+00004340: 0d0a 2020 2020 6265 7374 5f6d 6f64 656c  ..    best_model
+00004350: 5f69 6e73 7461 6e63 6520 3d20 4e6f 6e65  _instance = None
+00004360: 0d0a 0d0a 2020 2020 666f 7220 6e61 6d65  ....    for name
+00004370: 2c20 6d6f 6465 6c20 696e 206d 6f64 656c  , model in model
+00004380: 733a 0d0a 2020 2020 2020 2020 585f 7472  s:..        X_tr
+00004390: 6169 6e2c 2058 5f74 6573 742c 2079 5f74  ain, X_test, y_t
+000043a0: 7261 696e 2c20 795f 7465 7374 203d 2074  rain, y_test = t
+000043b0: 7261 696e 5f74 6573 745f 7370 6c69 7428  rain_test_split(
+000043c0: 582c 2079 2c20 7465 7374 5f73 697a 653d  X, y, test_size=
+000043d0: 7465 7374 5f73 697a 652c 2072 616e 646f  test_size, rando
+000043e0: 6d5f 7374 6174 653d 7261 6e64 6f6d 5f73  m_state=random_s
+000043f0: 7461 7465 290d 0a20 2020 2020 2020 2058  tate)..        X
+00004400: 5f74 7261 696e 2c20 585f 7661 6c2c 2079  _train, X_val, y
+00004410: 5f74 7261 696e 2c20 795f 7661 6c20 3d20  _train, y_val = 
+00004420: 7472 6169 6e5f 7465 7374 5f73 706c 6974  train_test_split
+00004430: 2858 5f74 7261 696e 2c20 795f 7472 6169  (X_train, y_trai
+00004440: 6e2c 2074 6573 745f 7369 7a65 3d74 6573  n, test_size=tes
+00004450: 745f 7369 7a65 2c20 7261 6e64 6f6d 5f73  t_size, random_s
+00004460: 7461 7465 3d72 616e 646f 6d5f 7374 6174  tate=random_stat
+00004470: 6529 0d0a 2020 2020 2020 2020 6d6f 6465  e)..        mode
+00004480: 6c2e 6669 7428 585f 7472 6169 6e2c 2079  l.fit(X_train, y
+00004490: 5f74 7261 696e 290d 0a20 2020 2020 2020  _train)..       
+000044a0: 200d 0a20 2020 2020 2020 2070 7269 6e74   ..        print
+000044b0: 286e 616d 6520 2b20 2220 4d6f 6465 6c3a  (name + " Model:
+000044c0: 2229 0d0a 2020 2020 2020 2020 6576 616c  ")..        eval
+000044d0: 7561 7465 5f6d 6f64 656c 286d 6f64 656c  uate_model(model
+000044e0: 2c20 582c 2079 2c20 7465 7374 5f73 697a  , X, y, test_siz
+000044f0: 653d 6164 6a75 7374 6564 5f74 6573 745f  e=adjusted_test_
+00004500: 7369 7a65 2c20 7261 6e64 6f6d 5f73 7461  size, random_sta
+00004510: 7465 3d72 616e 646f 6d5f 7374 6174 652c  te=random_state,
+00004520: 2063 763d 6376 290d 0a20 2020 2020 2020   cv=cv)..       
+00004530: 2070 7269 6e74 2829 0d0a 0d0a 2020 2020   print()....    
+00004540: 2020 2020 795f 7072 6564 203d 206d 6f64      y_pred = mod
+00004550: 656c 2e70 7265 6469 6374 2858 5f74 6573  el.predict(X_tes
+00004560: 7429 0d0a 2020 2020 2020 2020 6d73 6520  t)..        mse 
+00004570: 3d20 6d65 616e 5f73 7175 6172 6564 5f65  = mean_squared_e
+00004580: 7272 6f72 2879 5f74 6573 742c 2079 5f70  rror(y_test, y_p
+00004590: 7265 6429 0d0a 2020 2020 2020 2020 726d  red)..        rm
+000045a0: 7365 203d 206e 702e 7371 7274 286d 7365  se = np.sqrt(mse
+000045b0: 290d 0a20 2020 2020 2020 2072 3220 3d20  )..        r2 = 
+000045c0: 7232 5f73 636f 7265 2879 5f74 6573 742c  r2_score(y_test,
+000045d0: 2079 5f70 7265 6429 0d0a 0d0a 2020 2020   y_pred)....    
+000045e0: 2020 2020 6966 206d 7365 203c 2062 6573      if mse < bes
+000045f0: 745f 6d73 653a 0d0a 2020 2020 2020 2020  t_mse:..        
+00004600: 2020 2020 6265 7374 5f6d 7365 203d 206d      best_mse = m
+00004610: 7365 0d0a 2020 2020 2020 2020 2020 2020  se..            
+00004620: 6265 7374 5f6d 6f64 656c 203d 206e 616d  best_model = nam
+00004630: 650d 0a20 2020 2020 2020 2020 2020 2062  e..            b
+00004640: 6573 745f 6d6f 6465 6c5f 696e 7374 616e  est_model_instan
+00004650: 6365 203d 206d 6f64 656c 0d0a 0d0a 2020  ce = model....  
+00004660: 2020 7072 696e 7428 2254 6865 2062 6573    print("The bes
+00004670: 7420 6d6f 6465 6c20 6973 3a22 2c20 6265  t model is:", be
+00004680: 7374 5f6d 6f64 656c 2c20 2277 6974 6820  st_model, "with 
+00004690: 6120 4d65 616e 2053 7175 6172 6564 2045  a Mean Squared E
+000046a0: 7272 6f72 206f 6622 2c20 6265 7374 5f6d  rror of", best_m
+000046b0: 7365 290d 0a0d 0a20 2020 2023 2050 7269  se)....    # Pri
+000046c0: 6e74 2074 6865 206d 6574 7269 6373 2066  nt the metrics f
+000046d0: 6f72 2074 6865 2062 6573 7420 6d6f 6465  or the best mode
+000046e0: 6c0d 0a20 2020 2058 5f74 7261 696e 2c20  l..    X_train, 
+000046f0: 585f 7465 7374 2c20 795f 7472 6169 6e2c  X_test, y_train,
+00004700: 2079 5f74 6573 7420 3d20 7472 6169 6e5f   y_test = train_
+00004710: 7465 7374 5f73 706c 6974 2858 2c20 792c  test_split(X, y,
+00004720: 2074 6573 745f 7369 7a65 3d74 6573 745f   test_size=test_
+00004730: 7369 7a65 2c20 7261 6e64 6f6d 5f73 7461  size, random_sta
+00004740: 7465 3d72 616e 646f 6d5f 7374 6174 6529  te=random_state)
+00004750: 0d0a 2020 2020 585f 7472 6169 6e2c 2058  ..    X_train, X
+00004760: 5f76 616c 2c20 795f 7472 6169 6e2c 2079  _val, y_train, y
+00004770: 5f76 616c 203d 2074 7261 696e 5f74 6573  _val = train_tes
+00004780: 745f 7370 6c69 7428 585f 7472 6169 6e2c  t_split(X_train,
+00004790: 2079 5f74 7261 696e 2c20 7465 7374 5f73   y_train, test_s
+000047a0: 697a 653d 7465 7374 5f73 697a 652c 2072  ize=test_size, r
+000047b0: 616e 646f 6d5f 7374 6174 653d 7261 6e64  andom_state=rand
+000047c0: 6f6d 5f73 7461 7465 290d 0a20 2020 2023  om_state)..    #
+000047d0: 2046 6974 2074 6865 2062 6573 7420 6d6f   Fit the best mo
+000047e0: 6465 6c20 6f6e 2074 6865 2074 7261 696e  del on the train
+000047f0: 696e 6720 6461 7461 0d0a 2020 2020 6265  ing data..    be
+00004800: 7374 5f6d 6f64 656c 5f69 6e73 7461 6e63  st_model_instanc
+00004810: 652e 6669 7428 585f 7472 6169 6e2c 2079  e.fit(X_train, y
+00004820: 5f74 7261 696e 290d 0a0d 0a20 2020 2023  _train)....    #
+00004830: 2050 7265 6469 6374 696f 6e73 0d0a 2020   Predictions..  
+00004840: 2020 795f 7072 6564 5f62 6573 7420 3d20    y_pred_best = 
+00004850: 6265 7374 5f6d 6f64 656c 5f69 6e73 7461  best_model_insta
+00004860: 6e63 652e 7072 6564 6963 7428 585f 7465  nce.predict(X_te
+00004870: 7374 290d 0a20 2020 2062 6573 745f 726d  st)..    best_rm
+00004880: 7365 203d 206e 702e 7371 7274 2862 6573  se = np.sqrt(bes
+00004890: 745f 6d73 6529 0d0a 2020 2020 6265 7374  t_mse)..    best
+000048a0: 5f72 3220 3d20 7232 5f73 636f 7265 2879  _r2 = r2_score(y
+000048b0: 5f74 6573 742c 2079 5f70 7265 645f 6265  _test, y_pred_be
+000048c0: 7374 290d 0a0d 0a20 2020 2070 7269 6e74  st)....    print
+000048d0: 2822 4d65 7472 6963 7320 6f66 2074 6865  ("Metrics of the
+000048e0: 2062 6573 7420 6d6f 6465 6c3a 2229 0d0a   best model:")..
+000048f0: 2020 2020 7072 696e 7428 224d 6561 6e20      print("Mean 
+00004900: 5371 7561 7265 6420 4572 726f 723a 222c  Squared Error:",
+00004910: 2062 6573 745f 6d73 6529 0d0a 2020 2020   best_mse)..    
+00004920: 7072 696e 7428 2252 6f6f 7420 4d65 616e  print("Root Mean
+00004930: 2053 7175 6172 6564 2045 7272 6f72 3a22   Squared Error:"
+00004940: 2c20 6265 7374 5f72 6d73 6529 0d0a 2020  , best_rmse)..  
+00004950: 2020 7072 696e 7428 2252 2d73 7175 6172    print("R-squar
+00004960: 6564 3a22 2c20 6265 7374 5f72 3229 0d0a  ed:", best_r2)..
+00004970: 0d0a 2020 2020 2320 4c65 6172 6e69 6e67  ..    # Learning
+00004980: 2063 7572 7665 2066 6f72 2074 6865 2062   curve for the b
+00004990: 6573 7420 6d6f 6465 6c0d 0a20 2020 2074  est model..    t
+000049a0: 7261 696e 5f73 697a 6573 2c20 7472 6169  rain_sizes, trai
+000049b0: 6e5f 7363 6f72 6573 2c20 7661 6c5f 7363  n_scores, val_sc
+000049c0: 6f72 6573 203d 206c 6561 726e 696e 675f  ores = learning_
+000049d0: 6375 7276 6528 6265 7374 5f6d 6f64 656c  curve(best_model
+000049e0: 5f69 6e73 7461 6e63 652c 2058 5f74 7261  _instance, X_tra
+000049f0: 696e 2c20 795f 7472 6169 6e2c 2063 763d  in, y_train, cv=
+00004a00: 6376 2c20 7363 6f72 696e 673d 276e 6567  cv, scoring='neg
+00004a10: 5f6d 6561 6e5f 7371 7561 7265 645f 6572  _mean_squared_er
+00004a20: 726f 7227 290d 0a20 2020 2074 7261 696e  ror')..    train
+00004a30: 5f73 636f 7265 7320 3d20 6e70 2e73 7172  _scores = np.sqr
+00004a40: 7428 2d74 7261 696e 5f73 636f 7265 7329  t(-train_scores)
+00004a50: 2e6d 6561 6e28 6178 6973 3d31 290d 0a20  .mean(axis=1).. 
+00004a60: 2020 2076 616c 5f73 636f 7265 7320 3d20     val_scores = 
+00004a70: 6e70 2e73 7172 7428 2d76 616c 5f73 636f  np.sqrt(-val_sco
+00004a80: 7265 7329 2e6d 6561 6e28 6178 6973 3d31  res).mean(axis=1
+00004a90: 290d 0a0d 0a20 2020 2070 6c74 2e70 6c6f  )....    plt.plo
+00004aa0: 7428 7472 6169 6e5f 7369 7a65 732c 2074  t(train_sizes, t
+00004ab0: 7261 696e 5f73 636f 7265 732c 2027 6f2d  rain_scores, 'o-
+00004ac0: 272c 206c 6162 656c 3d22 5472 6169 6e69  ', label="Traini
+00004ad0: 6e67 2073 636f 7265 2229 0d0a 2020 2020  ng score")..    
+00004ae0: 706c 742e 706c 6f74 2874 7261 696e 5f73  plt.plot(train_s
+00004af0: 697a 6573 2c20 7661 6c5f 7363 6f72 6573  izes, val_scores
+00004b00: 2c20 276f 2d27 2c20 6c61 6265 6c3d 2256  , 'o-', label="V
+00004b10: 616c 6964 6174 696f 6e20 7363 6f72 6522  alidation score"
+00004b20: 290d 0a20 2020 2070 6c74 2e78 6c61 6265  )..    plt.xlabe
+00004b30: 6c28 2254 7261 696e 696e 6720 7365 7420  l("Training set 
+00004b40: 7369 7a65 2229 0d0a 2020 2020 706c 742e  size")..    plt.
+00004b50: 796c 6162 656c 2822 524d 5345 2229 0d0a  ylabel("RMSE")..
+00004b60: 2020 2020 706c 742e 6c65 6765 6e64 2829      plt.legend()
+00004b70: 0d0a 2020 2020 706c 742e 7368 6f77 2829  ..    plt.show()
+00004b80: 0d0a 0d0a 2020 2020 7265 7475 726e 2062  ....    return b
+00004b90: 6573 745f 6d6f 6465 6c5f 696e 7374 616e  est_model_instan
+00004ba0: 6365 0d0a 0d0a 0d0a 0d0a 0d0a 6465 6620  ce..........def 
+00004bb0: 7475 6e65 5f4d 4c50 635f 7061 7261 6d65  tune_MLPc_parame
+00004bc0: 7465 7273 2858 5f74 7261 696e 2c20 585f  ters(X_train, X_
+00004bd0: 7465 7374 2c20 795f 7472 6169 6e2c 2079  test, y_train, y
+00004be0: 5f74 6573 742c 2070 6172 616d 735f 746f  _test, params_to
+00004bf0: 5f74 7279 3d4e 6f6e 652c 206e 756d 5f63  _try=None, num_c
+00004c00: 6f6d 6269 6e61 7469 6f6e 733d 4e6f 6e65  ombinations=None
+00004c10: 2c20 7261 6e64 6f6d 5f73 7461 7465 3d31  , random_state=1
+00004c20: 2c20 6f70 7469 6d69 7a61 7469 6f6e 5f74  , optimization_t
+00004c30: 6172 6765 743d 2761 6363 7572 6163 7927  arget='accuracy'
+00004c40: 293a 0d0a 2020 2020 6672 6f6d 2073 6b6c  ):..    from skl
+00004c50: 6561 726e 2e6e 6575 7261 6c5f 6e65 7477  earn.neural_netw
+00004c60: 6f72 6b20 696d 706f 7274 204d 4c50 436c  ork import MLPCl
+00004c70: 6173 7369 6669 6572 0d0a 2020 2020 6672  assifier..    fr
+00004c80: 6f6d 2073 6b6c 6561 726e 2e6d 6574 7269  om sklearn.metri
+00004c90: 6373 2069 6d70 6f72 7420 6163 6375 7261  cs import accura
+00004ca0: 6379 5f73 636f 7265 2c20 636f 6e66 7573  cy_score, confus
+00004cb0: 696f 6e5f 6d61 7472 6978 2c20 7072 6563  ion_matrix, prec
+00004cc0: 6973 696f 6e5f 7363 6f72 652c 2072 6563  ision_score, rec
+00004cd0: 616c 6c5f 7363 6f72 650d 0a20 2020 2066  all_score..    f
+00004ce0: 726f 6d20 6974 6572 746f 6f6c 7320 696d  rom itertools im
+00004cf0: 706f 7274 2070 726f 6475 6374 0d0a 2020  port product..  
+00004d00: 2020 696d 706f 7274 206e 756d 7079 2061    import numpy a
+00004d10: 7320 6e70 0d0a 0d0a 2020 2020 6966 2070  s np....    if p
+00004d20: 6172 616d 735f 746f 5f74 7279 2069 7320  arams_to_try is 
+00004d30: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2070  None:..        p
+00004d40: 6172 616d 735f 746f 5f74 7279 203d 207b  arams_to_try = {
+00004d50: 0d0a 2020 2020 2020 2020 2020 2020 2773  ..            's
+00004d60: 6f6c 7665 7227 3a20 5b27 6c62 6667 7327  olver': ['lbfgs'
+00004d70: 2c20 2761 6461 6d27 5d2c 0d0a 2020 2020  , 'adam'],..    
+00004d80: 2020 2020 2020 2020 2761 6374 6976 6174          'activat
+00004d90: 696f 6e27 3a20 5b27 7265 6c75 272c 2027  ion': ['relu', '
+00004da0: 7461 6e68 272c 2027 6c6f 6769 7374 6963  tanh', 'logistic
+00004db0: 275d 2c0d 0a20 2020 2020 2020 2020 2020  '],..           
+00004dc0: 2027 616c 7068 6127 3a20 5b30 2e30 3030   'alpha': [0.000
+00004dd0: 312c 2030 2e30 3031 2c20 302e 3031 5d2c  1, 0.001, 0.01],
+00004de0: 0d0a 2020 2020 2020 2020 2020 2020 276c  ..            'l
+00004df0: 6561 726e 696e 675f 7261 7465 5f69 6e69  earning_rate_ini
+00004e00: 7427 3a20 5b30 2e30 3030 312c 2030 2e30  t': [0.0001, 0.0
+00004e10: 3030 352c 2030 2e30 3031 5d2c 0d0a 2020  005, 0.001],..  
+00004e20: 2020 2020 2020 2020 2020 276d 6178 5f69            'max_i
+00004e30: 7465 7227 3a20 5b35 3030 302c 2031 3030  ter': [5000, 100
+00004e40: 3030 2c20 3135 3030 305d 0d0a 2020 2020  00, 15000]..    
+00004e50: 2020 2020 7d0d 0a0d 0a20 2020 2070 6172      }....    par
+00004e60: 616d 5f63 6f6d 6269 6e61 7469 6f6e 7320  am_combinations 
+00004e70: 3d20 6c69 7374 2870 726f 6475 6374 282a  = list(product(*
+00004e80: 7061 7261 6d73 5f74 6f5f 7472 792e 7661  params_to_try.va
+00004e90: 6c75 6573 2829 2929 0d0a 0d0a 2020 2020  lues()))....    
+00004ea0: 6966 206e 756d 5f63 6f6d 6269 6e61 7469  if num_combinati
+00004eb0: 6f6e 7320 6973 204e 6f6e 653a 0d0a 2020  ons is None:..  
+00004ec0: 2020 2020 2020 6e75 6d5f 636f 6d62 696e        num_combin
+00004ed0: 6174 696f 6e73 203d 2031 300d 0a20 2020  ations = 10..   
+00004ee0: 2065 6c69 6620 6e75 6d5f 636f 6d62 696e   elif num_combin
+00004ef0: 6174 696f 6e73 203d 3d20 276d 6178 273a  ations == 'max':
+00004f00: 0d0a 2020 2020 2020 2020 6e75 6d5f 636f  ..        num_co
+00004f10: 6d62 696e 6174 696f 6e73 203d 206c 656e  mbinations = len
+00004f20: 2870 6172 616d 5f63 6f6d 6269 6e61 7469  (param_combinati
+00004f30: 6f6e 7329 0d0a 0d0a 2020 2020 6265 7374  ons)....    best
+00004f40: 5f6d 6f64 656c 203d 204e 6f6e 650d 0a20  _model = None.. 
+00004f50: 2020 2062 6573 745f 7061 7261 6d73 203d     best_params =
+00004f60: 204e 6f6e 650d 0a20 2020 2062 6573 745f   None..    best_
+00004f70: 7363 6f72 6520 3d20 2d6e 702e 696e 6620  score = -np.inf 
+00004f80: 6966 206f 7074 696d 697a 6174 696f 6e5f  if optimization_
+00004f90: 7461 7267 6574 203d 3d20 2761 6363 7572  target == 'accur
+00004fa0: 6163 7927 2065 6c73 6520 6e70 2e69 6e66  acy' else np.inf
+00004fb0: 0d0a 0d0a 2020 2020 666f 7220 6920 696e  ....    for i in
+00004fc0: 2072 616e 6765 286e 756d 5f63 6f6d 6269   range(num_combi
+00004fd0: 6e61 7469 6f6e 7329 3a0d 0a20 2020 2020  nations):..     
+00004fe0: 2020 2063 686f 7365 6e5f 7061 7261 6d73     chosen_params
+00004ff0: 203d 2064 6963 7428 7a69 7028 7061 7261   = dict(zip(para
+00005000: 6d73 5f74 6f5f 7472 792e 6b65 7973 2829  ms_to_try.keys()
+00005010: 2c20 7061 7261 6d5f 636f 6d62 696e 6174  , param_combinat
+00005020: 696f 6e73 5b6e 702e 7261 6e64 6f6d 2e63  ions[np.random.c
+00005030: 686f 6963 6528 6c65 6e28 7061 7261 6d5f  hoice(len(param_
+00005040: 636f 6d62 696e 6174 696f 6e73 2929 5d29  combinations))])
+00005050: 290d 0a0d 0a20 2020 2020 2020 206d 6c70  )....        mlp
+00005060: 203d 204d 4c50 436c 6173 7369 6669 6572   = MLPClassifier
+00005070: 2872 616e 646f 6d5f 7374 6174 653d 7261  (random_state=ra
+00005080: 6e64 6f6d 5f73 7461 7465 2c20 2a2a 6368  ndom_state, **ch
+00005090: 6f73 656e 5f70 6172 616d 7329 0d0a 2020  osen_params)..  
+000050a0: 2020 2020 2020 6d6c 702e 6669 7428 585f        mlp.fit(X_
+000050b0: 7472 6169 6e2c 2079 5f74 7261 696e 290d  train, y_train).
+000050c0: 0a0d 0a20 2020 2020 2020 2079 5f70 7265  ...        y_pre
+000050d0: 6420 3d20 6d6c 702e 7072 6564 6963 7428  d = mlp.predict(
+000050e0: 585f 7465 7374 290d 0a20 2020 2020 2020  X_test)..       
+000050f0: 2063 6d20 3d20 636f 6e66 7573 696f 6e5f   cm = confusion_
+00005100: 6d61 7472 6978 2879 5f74 6573 742c 2079  matrix(y_test, y
+00005110: 5f70 7265 6429 0d0a 2020 2020 2020 2020  _pred)..        
+00005120: 6661 6c73 655f 6e65 6761 7469 7665 7320  false_negatives 
+00005130: 3d20 636d 5b31 5d5b 305d 0d0a 2020 2020  = cm[1][0]..    
+00005140: 2020 2020 6163 6375 7261 6379 203d 2061      accuracy = a
+00005150: 6363 7572 6163 795f 7363 6f72 6528 795f  ccuracy_score(y_
+00005160: 7465 7374 2c20 795f 7072 6564 290d 0a0d  test, y_pred)...
+00005170: 0a20 2020 2020 2020 2069 6620 6f70 7469  .        if opti
+00005180: 6d69 7a61 7469 6f6e 5f74 6172 6765 7420  mization_target 
+00005190: 3d3d 2027 6163 6375 7261 6379 273a 0d0a  == 'accuracy':..
+000051a0: 2020 2020 2020 2020 2020 2020 7363 6f72              scor
+000051b0: 6520 3d20 6163 6375 7261 6379 0d0a 2020  e = accuracy..  
+000051c0: 2020 2020 2020 2020 2020 6265 7474 6572            better
+000051d0: 203d 2073 636f 7265 203e 2062 6573 745f   = score > best_
+000051e0: 7363 6f72 650d 0a20 2020 2020 2020 2065  score..        e
+000051f0: 6c69 6620 6f70 7469 6d69 7a61 7469 6f6e  lif optimization
+00005200: 5f74 6172 6765 7420 3d3d 2027 6d69 6e69  _target == 'mini
+00005210: 6d69 7a65 5f66 616c 7365 5f6e 6567 6174  mize_false_negat
+00005220: 6976 6573 273a 0d0a 2020 2020 2020 2020  ives':..        
+00005230: 2020 2020 7363 6f72 6520 3d20 6661 6c73      score = fals
+00005240: 655f 6e65 6761 7469 7665 730d 0a20 2020  e_negatives..   
+00005250: 2020 2020 2020 2020 2062 6574 7465 7220           better 
+00005260: 3d20 7363 6f72 6520 3c20 6265 7374 5f73  = score < best_s
+00005270: 636f 7265 0d0a 2020 2020 2020 2020 656c  core..        el
+00005280: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+00005290: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+000052a0: 7228 2249 6e76 616c 6964 206f 7074 696d  r("Invalid optim
+000052b0: 697a 6174 696f 6e5f 7461 7267 6574 2e20  ization_target. 
+000052c0: 4368 6f6f 7365 2027 6163 6375 7261 6379  Choose 'accuracy
+000052d0: 2720 6f72 2027 6d69 6e69 6d69 7a65 5f66  ' or 'minimize_f
+000052e0: 616c 7365 5f6e 6567 6174 6976 6573 272e  alse_negatives'.
+000052f0: 2229 0d0a 0d0a 2020 2020 2020 2020 6966  ")....        if
+00005300: 2062 6574 7465 723a 0d0a 2020 2020 2020   better:..      
+00005310: 2020 2020 2020 6265 7374 5f6d 6f64 656c        best_model
+00005320: 203d 206d 6c70 0d0a 2020 2020 2020 2020   = mlp..        
+00005330: 2020 2020 6265 7374 5f70 6172 616d 7320      best_params 
+00005340: 3d20 6368 6f73 656e 5f70 6172 616d 730d  = chosen_params.
+00005350: 0a20 2020 2020 2020 2020 2020 2062 6573  .            bes
+00005360: 745f 7363 6f72 6520 3d20 7363 6f72 650d  t_score = score.
+00005370: 0a0d 0a20 2020 2070 7269 6e74 2822 4265  ...    print("Be
+00005380: 7374 2068 7970 6572 7061 7261 6d65 7465  st hyperparamete
+00005390: 7273 3a22 290d 0a20 2020 2070 7269 6e74  rs:")..    print
+000053a0: 2862 6573 745f 7061 7261 6d73 290d 0a20  (best_params).. 
+000053b0: 2020 2070 7269 6e74 2862 6573 745f 6d6f     print(best_mo
+000053c0: 6465 6c29 0d0a 2020 2020 6265 7374 5f6d  del)..    best_m
+000053d0: 6f64 656c 5f73 7472 203d 2066 224d 4c50  odel_str = f"MLP
+000053e0: 203d 204d 4c50 436c 6173 7369 6669 6572   = MLPClassifier
+000053f0: 2861 6374 6976 6174 696f 6e3d 277b 6265  (activation='{be
+00005400: 7374 5f70 6172 616d 735b 2761 6374 6976  st_params['activ
+00005410: 6174 696f 6e27 5d7d 272c 2061 6c70 6861  ation']}', alpha
+00005420: 3d7b 6265 7374 5f70 6172 616d 735b 2761  ={best_params['a
+00005430: 6c70 6861 275d 7d2c 2022 205c 0d0a 2020  lpha']}, " \..  
+00005440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005450: 2020 2066 226c 6561 726e 696e 675f 7261     f"learning_ra
+00005460: 7465 5f69 6e69 743d 7b62 6573 745f 7061  te_init={best_pa
+00005470: 7261 6d73 5b27 6c65 6172 6e69 6e67 5f72  rams['learning_r
+00005480: 6174 655f 696e 6974 275d 7d2c 206d 6178  ate_init']}, max
+00005490: 5f69 7465 723d 7b62 6573 745f 7061 7261  _iter={best_para
+000054a0: 6d73 5b27 6d61 785f 6974 6572 275d 7d2c  ms['max_iter']},
+000054b0: 2022 205c 0d0a 2020 2020 2020 2020 2020   " \..          
+000054c0: 2020 2020 2020 2020 2020 2066 2273 6f6c             f"sol
+000054d0: 7665 723d 277b 6265 7374 5f70 6172 616d  ver='{best_param
+000054e0: 735b 2773 6f6c 7665 7227 5d7d 272c 2072  s['solver']}', r
+000054f0: 616e 646f 6d5f 7374 6174 653d 3129 220d  andom_state=1)".
+00005500: 0a20 2020 2070 7269 6e74 2862 6573 745f  .    print(best_
+00005510: 6d6f 6465 6c5f 7374 7229 0d0a 0d0a 2020  model_str)....  
+00005520: 2020 795f 7072 6564 203d 2062 6573 745f    y_pred = best_
+00005530: 6d6f 6465 6c2e 7072 6564 6963 7428 585f  model.predict(X_
+00005540: 7465 7374 290d 0a0d 0a20 2020 2070 7269  test)....    pri
+00005550: 6e74 2866 2241 6363 7572 6163 7920 666f  nt(f"Accuracy fo
+00005560: 7220 6265 7374 206d 6f64 656c 3a20 7b61  r best model: {a
+00005570: 6363 7572 6163 795f 7363 6f72 6528 795f  ccuracy_score(y_
+00005580: 7465 7374 2c20 795f 7072 6564 297d 2229  test, y_pred)}")
+00005590: 0d0a 2020 2020 7072 696e 7428 6622 436f  ..    print(f"Co
+000055a0: 6e66 7573 696f 6e20 6d61 7472 6978 2066  nfusion matrix f
+000055b0: 6f72 2062 6573 7420 6d6f 6465 6c3a 5c6e  or best model:\n
+000055c0: 7b63 6f6e 6675 7369 6f6e 5f6d 6174 7269  {confusion_matri
+000055d0: 7828 795f 7465 7374 2c20 795f 7072 6564  x(y_test, y_pred
+000055e0: 297d 2229 0d0a 2020 2020 7072 696e 7428  )}")..    print(
+000055f0: 6622 5072 6563 6973 696f 6e20 666f 7220  f"Precision for 
+00005600: 6265 7374 206d 6f64 656c 3a20 7b70 7265  best model: {pre
+00005610: 6369 7369 6f6e 5f73 636f 7265 2879 5f74  cision_score(y_t
+00005620: 6573 742c 2079 5f70 7265 6429 7d22 290d  est, y_pred)}").
+00005630: 0a20 2020 2070 7269 6e74 2866 2252 6563  .    print(f"Rec
+00005640: 616c 6c20 666f 7220 6265 7374 206d 6f64  all for best mod
+00005650: 656c 3a20 7b72 6563 616c 6c5f 7363 6f72  el: {recall_scor
+00005660: 6528 795f 7465 7374 2c20 795f 7072 6564  e(y_test, y_pred
+00005670: 297d 2229 0d0a 0d0a 2020 2020 7265 7475  )}")....    retu
+00005680: 726e 2062 6573 745f 6d6f 6465 6c2c 2062  rn best_model, b
+00005690: 6573 745f 7061 7261 6d73 0d0a 0d0a 0d0a  est_params......
+000056a0: 0d0a 0d0a 0d0a 0d0a 0d0a 6465 6620 7475  ..........def tu
+000056b0: 6e65 5f4d 4c50 725f 7061 7261 6d65 7465  ne_MLPr_paramete
+000056c0: 7273 2858 5f74 7261 696e 2c20 585f 7465  rs(X_train, X_te
+000056d0: 7374 2c20 795f 7472 6169 6e2c 2079 5f74  st, y_train, y_t
+000056e0: 6573 742c 2070 6172 616d 735f 746f 5f74  est, params_to_t
+000056f0: 7279 3d4e 6f6e 652c 206e 756d 5f63 6f6d  ry=None, num_com
+00005700: 6269 6e61 7469 6f6e 733d 4e6f 6e65 2c20  binations=None, 
+00005710: 7261 6e64 6f6d 5f73 7461 7465 3d31 293a  random_state=1):
+00005720: 0d0a 2020 2020 6672 6f6d 2073 6b6c 6561  ..    from sklea
+00005730: 726e 2e6e 6575 7261 6c5f 6e65 7477 6f72  rn.neural_networ
+00005740: 6b20 696d 706f 7274 204d 4c50 5265 6772  k import MLPRegr
+00005750: 6573 736f 720d 0a20 2020 2066 726f 6d20  essor..    from 
+00005760: 736b 6c65 6172 6e2e 6d65 7472 6963 7320  sklearn.metrics 
+00005770: 696d 706f 7274 206d 6561 6e5f 7371 7561  import mean_squa
+00005780: 7265 645f 6572 726f 722c 2072 325f 7363  red_error, r2_sc
+00005790: 6f72 650d 0a20 2020 2066 726f 6d20 6974  ore..    from it
+000057a0: 6572 746f 6f6c 7320 696d 706f 7274 2070  ertools import p
+000057b0: 726f 6475 6374 0d0a 2020 2020 696d 706f  roduct..    impo
+000057c0: 7274 206e 756d 7079 2061 7320 6e70 0d0a  rt numpy as np..
+000057d0: 0d0a 2020 2020 6966 2070 6172 616d 735f  ..    if params_
+000057e0: 746f 5f74 7279 2069 7320 4e6f 6e65 3a0d  to_try is None:.
+000057f0: 0a20 2020 2020 2020 2070 6172 616d 735f  .        params_
+00005800: 746f 5f74 7279 203d 207b 0d0a 2020 2020  to_try = {..    
+00005810: 2020 2020 2020 2020 2773 6f6c 7665 7227          'solver'
+00005820: 3a20 5b27 6c62 6667 7327 2c20 2761 6461  : ['lbfgs', 'ada
+00005830: 6d27 5d2c 0d0a 2020 2020 2020 2020 2020  m'],..          
+00005840: 2020 2761 6374 6976 6174 696f 6e27 3a20    'activation': 
+00005850: 5b27 7265 6c75 272c 2027 7461 6e68 272c  ['relu', 'tanh',
+00005860: 2027 6c6f 6769 7374 6963 275d 2c0d 0a20   'logistic'],.. 
+00005870: 2020 2020 2020 2020 2020 2027 616c 7068             'alph
+00005880: 6127 3a20 5b30 2e30 3030 312c 2030 2e30  a': [0.0001, 0.0
+00005890: 3031 2c20 302e 3031 5d2c 0d0a 2020 2020  01, 0.01],..    
+000058a0: 2020 2020 2020 2020 276c 6561 726e 696e          'learnin
+000058b0: 675f 7261 7465 5f69 6e69 7427 3a20 5b30  g_rate_init': [0
+000058c0: 2e30 3030 312c 2030 2e30 3030 352c 2030  .0001, 0.0005, 0
+000058d0: 2e30 3031 5d2c 0d0a 2020 2020 2020 2020  .001],..        
+000058e0: 2020 2020 276d 6178 5f69 7465 7227 3a20      'max_iter': 
+000058f0: 5b35 3030 302c 2031 3030 3030 2c20 3135  [5000, 10000, 15
+00005900: 3030 305d 0d0a 2020 2020 2020 2020 7d0d  000]..        }.
+00005910: 0a0d 0a20 2020 2070 6172 616d 5f63 6f6d  ...    param_com
+00005920: 6269 6e61 7469 6f6e 7320 3d20 6c69 7374  binations = list
+00005930: 2870 726f 6475 6374 282a 7061 7261 6d73  (product(*params
+00005940: 5f74 6f5f 7472 792e 7661 6c75 6573 2829  _to_try.values()
+00005950: 2929 0d0a 0d0a 2020 2020 6966 206e 756d  ))....    if num
+00005960: 5f63 6f6d 6269 6e61 7469 6f6e 7320 6973  _combinations is
+00005970: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
+00005980: 6e75 6d5f 636f 6d62 696e 6174 696f 6e73  num_combinations
+00005990: 203d 2031 300d 0a20 2020 2065 6c69 6620   = 10..    elif 
+000059a0: 6e75 6d5f 636f 6d62 696e 6174 696f 6e73  num_combinations
+000059b0: 203d 3d20 276d 6178 273a 0d0a 2020 2020   == 'max':..    
+000059c0: 2020 2020 6e75 6d5f 636f 6d62 696e 6174      num_combinat
+000059d0: 696f 6e73 203d 206c 656e 2870 6172 616d  ions = len(param
+000059e0: 5f63 6f6d 6269 6e61 7469 6f6e 7329 0d0a  _combinations)..
+000059f0: 0d0a 2020 2020 6265 7374 5f6d 6f64 656c  ..    best_model
+00005a00: 203d 204e 6f6e 650d 0a20 2020 2062 6573   = None..    bes
+00005a10: 745f 7061 7261 6d73 203d 204e 6f6e 650d  t_params = None.
+00005a20: 0a20 2020 2062 6573 745f 6d73 6520 3d20  .    best_mse = 
+00005a30: 6e70 2e69 6e66 0d0a 0d0a 2020 2020 666f  np.inf....    fo
+00005a40: 7220 6920 696e 2072 616e 6765 286e 756d  r i in range(num
+00005a50: 5f63 6f6d 6269 6e61 7469 6f6e 7329 3a0d  _combinations):.
+00005a60: 0a20 2020 2020 2020 2063 686f 7365 6e5f  .        chosen_
+00005a70: 7061 7261 6d73 203d 2064 6963 7428 7a69  params = dict(zi
+00005a80: 7028 7061 7261 6d73 5f74 6f5f 7472 792e  p(params_to_try.
+00005a90: 6b65 7973 2829 2c20 7061 7261 6d5f 636f  keys(), param_co
+00005aa0: 6d62 696e 6174 696f 6e73 5b6e 702e 7261  mbinations[np.ra
+00005ab0: 6e64 6f6d 2e63 686f 6963 6528 6c65 6e28  ndom.choice(len(
+00005ac0: 7061 7261 6d5f 636f 6d62 696e 6174 696f  param_combinatio
+00005ad0: 6e73 2929 5d29 290d 0a0d 0a20 2020 2020  ns))]))....     
+00005ae0: 2020 206d 6c70 203d 204d 4c50 5265 6772     mlp = MLPRegr
+00005af0: 6573 736f 7228 7261 6e64 6f6d 5f73 7461  essor(random_sta
+00005b00: 7465 3d72 616e 646f 6d5f 7374 6174 652c  te=random_state,
+00005b10: 202a 2a63 686f 7365 6e5f 7061 7261 6d73   **chosen_params
+00005b20: 290d 0a20 2020 2020 2020 206d 6c70 2e66  )..        mlp.f
+00005b30: 6974 2858 5f74 7261 696e 2c20 795f 7472  it(X_train, y_tr
+00005b40: 6169 6e29 0d0a 0d0a 2020 2020 2020 2020  ain)....        
+00005b50: 795f 7072 6564 203d 206d 6c70 2e70 7265  y_pred = mlp.pre
+00005b60: 6469 6374 2858 5f74 6573 7429 0d0a 2020  dict(X_test)..  
+00005b70: 2020 2020 2020 6d73 6520 3d20 6d65 616e        mse = mean
+00005b80: 5f73 7175 6172 6564 5f65 7272 6f72 2879  _squared_error(y
+00005b90: 5f74 6573 742c 2079 5f70 7265 6429 0d0a  _test, y_pred)..
+00005ba0: 2020 2020 2020 2020 7072 696e 7428 6622          print(f"
+00005bb0: 4d65 616e 2073 7175 6172 6564 2065 7272  Mean squared err
+00005bc0: 6f72 2066 6f72 2070 6172 616d 6574 6572  or for parameter
+00005bd0: 7320 7b63 686f 7365 6e5f 7061 7261 6d73  s {chosen_params
+00005be0: 7d3a 207b 6d73 657d 2229 0d0a 0d0a 2020  }: {mse}")....  
+00005bf0: 2020 2020 2020 6966 206d 7365 203c 2062        if mse < b
+00005c00: 6573 745f 6d73 653a 0d0a 2020 2020 2020  est_mse:..      
+00005c10: 2020 2020 2020 6265 7374 5f6d 6f64 656c        best_model
+00005c20: 203d 206d 6c70 0d0a 2020 2020 2020 2020   = mlp..        
+00005c30: 2020 2020 6265 7374 5f70 6172 616d 7320      best_params 
+00005c40: 3d20 6368 6f73 656e 5f70 6172 616d 730d  = chosen_params.
+00005c50: 0a20 2020 2020 2020 2020 2020 2062 6573  .            bes
+00005c60: 745f 6d73 6520 3d20 6d73 650d 0a0d 0a20  t_mse = mse.... 
+00005c70: 2020 2070 7269 6e74 2822 4265 7374 2068     print("Best h
+00005c80: 7970 6572 7061 7261 6d65 7465 7273 3a22  yperparameters:"
+00005c90: 290d 0a20 2020 2070 7269 6e74 2862 6573  )..    print(bes
+00005ca0: 745f 7061 7261 6d73 290d 0a20 2020 2070  t_params)..    p
+00005cb0: 7269 6e74 2862 6573 745f 6d6f 6465 6c29  rint(best_model)
+00005cc0: 0d0a 2020 2020 6265 7374 5f6d 6f64 656c  ..    best_model
+00005cd0: 5f73 7472 203d 2066 224d 4c50 203d 204d  _str = f"MLP = M
+00005ce0: 4c50 5265 6772 6573 736f 7228 6163 7469  LPRegressor(acti
+00005cf0: 7661 7469 6f6e 3d27 7b62 6573 745f 7061  vation='{best_pa
+00005d00: 7261 6d73 5b27 6163 7469 7661 7469 6f6e  rams['activation
+00005d10: 275d 7d27 2c20 616c 7068 613d 7b62 6573  ']}', alpha={bes
+00005d20: 745f 7061 7261 6d73 5b27 616c 7068 6127  t_params['alpha'
+00005d30: 5d7d 2c20 2220 5c0d 0a20 2020 2020 2020  ]}, " \..       
+00005d40: 2020 2020 2020 2020 2020 2020 2020 6622                f"
+00005d50: 6c65 6172 6e69 6e67 5f72 6174 655f 696e  learning_rate_in
+00005d60: 6974 3d7b 6265 7374 5f70 6172 616d 735b  it={best_params[
+00005d70: 276c 6561 726e 696e 675f 7261 7465 5f69  'learning_rate_i
+00005d80: 6e69 7427 5d7d 2c20 6d61 785f 6974 6572  nit']}, max_iter
+00005d90: 3d7b 6265 7374 5f70 6172 616d 735b 276d  ={best_params['m
+00005da0: 6178 5f69 7465 7227 5d7d 2c20 2220 5c0d  ax_iter']}, " \.
+00005db0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00005dc0: 2020 2020 2020 6622 736f 6c76 6572 3d27        f"solver='
+00005dd0: 7b62 6573 745f 7061 7261 6d73 5b27 736f  {best_params['so
+00005de0: 6c76 6572 275d 7d27 2c20 7261 6e64 6f6d  lver']}', random
+00005df0: 5f73 7461 7465 3d31 2922 0d0a 2020 2020  _state=1)"..    
+00005e00: 7072 696e 7428 6265 7374 5f6d 6f64 656c  print(best_model
+00005e10: 5f73 7472 290d 0a0d 0a20 2020 2079 5f70  _str)....    y_p
+00005e20: 7265 6420 3d20 6265 7374 5f6d 6f64 656c  red = best_model
+00005e30: 2e70 7265 6469 6374 2858 5f74 6573 7429  .predict(X_test)
+00005e40: 0d0a 2020 2020 0d0a 2020 2020 7072 696e  ..    ..    prin
+00005e50: 7428 6622 4d65 616e 2073 7175 6172 6564  t(f"Mean squared
+00005e60: 2065 7272 6f72 2066 6f72 2062 6573 7420   error for best 
+00005e70: 6d6f 6465 6c3a 207b 6d65 616e 5f73 7175  model: {mean_squ
+00005e80: 6172 6564 5f65 7272 6f72 2879 5f74 6573  ared_error(y_tes
+00005e90: 742c 2079 5f70 7265 6429 7d22 290d 0a20  t, y_pred)}").. 
+00005ea0: 2020 2070 7269 6e74 2866 2252 3220 7363     print(f"R2 sc
+00005eb0: 6f72 6520 666f 7220 6265 7374 206d 6f64  ore for best mod
+00005ec0: 656c 3a20 7b72 325f 7363 6f72 6528 795f  el: {r2_score(y_
+00005ed0: 7465 7374 2c20 795f 7072 6564 297d 2229  test, y_pred)}")
+00005ee0: 0d0a 2020 2020 7072 696e 7428 6622 524d  ..    print(f"RM
+00005ef0: 5345 2073 636f 7265 2066 6f72 2062 6573  SE score for bes
+00005f00: 7420 6d6f 6465 6c3a 207b 6e70 2e73 7172  t model: {np.sqr
+00005f10: 7428 6d65 616e 5f73 7175 6172 6564 5f65  t(mean_squared_e
+00005f20: 7272 6f72 2879 5f74 6573 742c 2079 5f70  rror(y_test, y_p
+00005f30: 7265 6429 297d 2229 0d0a 0d0a 2020 2020  red))}")....    
+00005f40: 7265 7475 726e 2062 6573 745f 6d6f 6465  return best_mode
+00005f50: 6c2c 2062 6573 745f 7061 7261 6d73 0d0a  l, best_params..
+00005f60: 0d0a 0d0a 0d0a                           ......
```

